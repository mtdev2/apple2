(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var Ajax=require("./ac-ajax/Ajax");var Request=require("./ac-ajax/Request");module.exports=new Ajax;module.exports.Ajax=Ajax;module.exports.Request=Request},{"./ac-ajax/Ajax":2,"./ac-ajax/Request":3}],2:[function(require,module,exports){"use strict";var Request=require("./Request");var XDRequest=require("./XDomain-request");var URLParser=require("./URLParser");var Ajax=function(){};Ajax._Request=Request;Ajax.prototype={_defaults:{method:"get",timeout:5e3},_extend:function(){for(var i=1;i<arguments.length;i++){for(var key in arguments[i]){if(arguments[i].hasOwnProperty(key)){arguments[0][key]=arguments[i][key]}}}return arguments[0]},_getOptions:function(constants,configuration){return this._extend({},this._defaults,configuration,constants)},_isCrossDomainRequest:function(url){var urlParser=new URLParser;var currentOrigin=urlParser.parse(window.location.href).origin;var requestOrigin=urlParser.parse(url).origin;urlParser.destroy();return requestOrigin!==currentOrigin},create:function(configuration){return new Request(configuration)},cors:function(configuration){var RequestClient=window.XDomainRequest&&document.documentMode<10?XDRequest:Request;return new RequestClient(configuration)},get:function(configuration){var request;configuration=this._getOptions({method:"get"},configuration);if(this._isCrossDomainRequest(configuration.url)){request=this.cors(configuration)}else{request=this.create(configuration)}return request.send()},getJSON:function(configuration){return this.get(configuration).then(function(xhr){return JSON.parse(xhr.responseText)})},head:function(configuration){configuration=this._getOptions({method:"head"},configuration);return this.create(configuration).send()},isCrossDomainRequest:function(url){return this._isCrossDomainRequest(url)},post:function(configuration){configuration=this._getOptions({method:"post"},configuration);return this.create(configuration).send()}};module.exports=Ajax},{"./Request":3,"./URLParser":4,"./XDomain-request":5}],3:[function(require,module,exports){"use strict";var Request=function(configuration){this._initialize(configuration)};Request.create=function(){var F=function(){};F.prototype=Request.prototype;return new F};Request.prototype={_addReadyStateChangeHandler:function(){this.xhr.onreadystatechange=function(e){if(this.xhr.readyState===4){clearTimeout(this._timeout);if(this.xhr.status>=200&&this.xhr.status<300){this.resolve(this.xhr)}else{this.reject(this.xhr)}}}.bind(this)},_getPromise:function(){this.promise=new Promise(function(resolve,reject){this.resolve=resolve;this.reject=reject}.bind(this))},_getTransport:function(){return new XMLHttpRequest},_initialize:function(configuration){var errors=this._validateConfiguration(configuration);if(errors){throw errors}this._configuration=configuration;var method=this._configuration.method.toUpperCase();this.xhr=this._getTransport();this._getPromise();this.xhr.open(method,this._configuration.url);this._setRequestHeaders(configuration.headers);this._addReadyStateChangeHandler()},_sendXHR:function(){if(this.xhr){if(this._configuration&&this._configuration.data){this.xhr.send(this._configuration.data)}else{this.xhr.send()}}},_setRequestHeaders:function(headers){if(headers){headers.forEach(function(header){this.xhr.setRequestHeader(header.name,header.value)},this)}},_setTimeout:function(delay){if(!delay){if(this._configuration&&this._configuration.timeout){delay=this._configuration.timeout}else{clearTimeout(this._timeout);this._timeout=null}}if(this._timeout!==null){clearTimeout(this._timeout)}if(delay>0){this._timeout=setTimeout(function(){this.xhr.abort();this.reject()}.bind(this),delay)}},_timeout:null,_validateConfiguration:function(configuration){if(!configuration){return"Must provide a configuration object"}var errors=[];var headers=configuration.headers;if(!configuration.url){errors.push("Must provide a url")}if(!configuration.method){errors.push("Must provide a method")}if(headers){if(!Array.isArray(headers)){return"Must provide an array of headers"}this._validateHeaders(headers,errors)}return errors.join(", ")},_validateHeaders:function(headers,errors){for(var i=0,len=headers.length;i<len;i++){if(!headers[i].hasOwnProperty("name")||!headers[i].hasOwnProperty("value")){errors.push("Must provide a name and value key for all headers");break}}},promise:null,reject:null,resolve:null,send:function(){this._setTimeout();this._sendXHR();return this.promise},xhr:null};module.exports=Request},{}],4:[function(require,module,exports){"use strict";var URLParser=function(){this.parser=null};var proto=URLParser.prototype;proto.parse=function(path){var origin;var protocol;var hostname;var port;var search;if(typeof path!=="string"){throw new TypeError(path+" must be a string")}if(!this.parser){this.parser=document.createElement("a")}this._qualifyPath(path);hostname=this.parser.hostname;protocol=this.parser.protocol;port=this._normalizePort(this.parser);origin=this.parser.origin||this._constructOriginString(this.parser,port);search=this.parser.search;return{originalPath:path,qualifiedPath:this.parser.href,protocol:protocol,hostname:hostname,origin:origin,port:port,search:search}};proto.destroy=function(){this.parser=null};proto._constructOriginString=function(parser,port){var portString=port?":"+port:"";return parser.protocol+"//"+parser.hostname+portString};proto._normalizePort=function(parser){return parser.port==="80"||parser.port==="443"||parser.port==="0"?"":parser.port};proto._qualifyPath=function(path){this.parser.href=path;this.parser.href=this.parser.href};module.exports=URLParser},{}],5:[function(require,module,exports){"use strict";var Request=require("./Request");var XDRequest=function(configuration){Request.apply(this,arguments)};XDRequest.prototype=Request.create();XDRequest.prototype._getTransport=function(){return new XDomainRequest};XDRequest.prototype._addReadyStateChangeHandler=function(){this.xhr.ontimeout=function(){this.reject(this.xhr)}.bind(this);this.xhr.onerror=function(){this.reject(this.xhr)}.bind(this);this.xhr.onload=function(){this.resolve(this.xhr)}.bind(this)};XDRequest.prototype._setTimeout=function(delay){if(!delay){if(this._configuration&&this._configuration.timeout){delay=this._configuration.timeout}}if(delay>0){this.xhr.timeout=delay}};XDRequest.prototype._sendXHR=function(){setTimeout(function(){Request.prototype._sendXHR.call(this)}.bind(this),0)};module.exports=XDRequest},{"./Request":3}],6:[function(require,module,exports){"use strict";module.exports={BreakpointsDelegate:require("./ac-breakpoints-delegate/BreakpointsDelegate")}},{"./ac-breakpoints-delegate/BreakpointsDelegate":7}],7:[function(require,module,exports){"use strict";var SharedInstance=require("@marcom/ac-shared-instance").SharedInstance,AC_Object=require("@marcom/ac-object"),WindowDelegate=require("@marcom/ac-window-delegate").WindowDelegate,WindowDelegateCustomEvent=require("@marcom/ac-window-delegate").WindowDelegateCustomEvent,EventEmitter=require("@marcom/ac-event-emitter").EventEmitter;var sharedInstanceName="ac-breakpoints-delegate:BreakpointsDelegate",sharedInstanceVersion="2.1.1";var breakpointEventString="breakpoint",resizeEventsString="resize orientationchange";var defaultBreakpoints={large:{"min-width":1069,"max-width":1441,content:980,oldie:true},xlarge:{"min-width":1442,content:980},medium:{"min-width":736,"max-width":1068,content:692},small:{"min-width":320,"max-width":735,content:288,"max-device-width":768}};var viewportProperties={minWidth:"min-width",maxWidth:"max-width",maxDeviceWidth:"max-device-width",content:"content",oldIE:"oldie"};function BreakpointsDelegate(options){this._customEvent=new WindowDelegateCustomEvent(breakpointEventString,this._onBreakpointListenerAdded.bind(this),this._onBreakpointListenerRemoved.bind(this));this.setBreakpoints(defaultBreakpoints)}var proto=BreakpointsDelegate.prototype;proto.initialize=function(){this._breakpoint=null;this._lastBreakpoint=null;this._handleOldIE();this._breakpointOrder=this._setBreakpointOrder();if(!this._isOldIE){this._handleResize()}};proto.getCustomEvent=function(){return this._customEvent};proto.getBreakpoint=function(){if(!this._customEvent.active){this._handleResize()}return this._breakpoint};proto.setBreakpoints=function(breakpoints){this.breakpoints=AC_Object.clone(breakpoints);this.initialize()};proto._handleResize=function(){var width=WindowDelegate.clientWidth(),newBreakpoint;var i,key,breakpoint,len=this._breakpointOrder.length;for(i=0;i<len;i++){key=this._breakpointOrder[i];breakpoint=this.breakpoints[key];if(breakpoint._breakPosition>width){break}}if(i>0){i=i-1}newBreakpoint=this.breakpoints[this._breakpointOrder[i]];if(!this._breakpoint){this._breakpoint=newBreakpoint;return}if(newBreakpoint.name===this._breakpoint.name){return}this._lastBreakpoint=this._breakpoint;this._breakpoint=newBreakpoint;WindowDelegate.trigger(breakpointEventString,{incoming:this._breakpoint,outgoing:this._lastBreakpoint})};proto._setBreakpointOrder=function(){var breakPosition=0,order=[],result=[],minWidth=viewportProperties.minWidth,i;for(i in this.breakpoints){if(this.breakpoints.hasOwnProperty(i)){this.breakpoints[i].name=i;order.push(this.breakpoints[i][minWidth])}}order.sort(function(a,b){return a-b});order.forEach(function(val){var i;for(i in this.breakpoints){if(this.breakpoints.hasOwnProperty(i)){if(this.breakpoints[i][minWidth]===val){result.push(i)}}}},this);result.forEach(function(key,i){this.breakpoints[key]._breakPosition=breakPosition;if(result[i+1]){breakPosition=this.breakpoints[result[i+1]][minWidth]}},this);return result};proto._handleOldIE=function(){var classTarget=document.documentElement,oldIE=viewportProperties.oldIE;if(classTarget.className.indexOf("no-"+oldIE)>-1||classTarget.className.indexOf(oldIE)===-1){return}this._isOldIE=true;this._replaceBreakpoints(function(breakpoint){return breakpoint[oldIE]===true});var i;for(i in this.breakpoints){if(this.breakpoints.hasOwnProperty(i)){this._breakpoint=this.breakpoints[i];return}}};proto._replaceBreakpoints=function(condition){var i,newBreakpoints={},breakpoint;for(i in this.breakpoints){if(this.breakpoints.hasOwnProperty(i)){breakpoint=this.breakpoints[i];if(condition(breakpoint)){newBreakpoints[i]=AC_Object.clone(this.breakpoints[i])}}}this.breakpoints=newBreakpoints};proto._onBreakpointListenerAdded=function(){WindowDelegate.on(resizeEventsString,this._handleResize,this)};proto._onBreakpointListenerRemoved=function(){WindowDelegate.off(resizeEventsString,this._handleResize,this)};module.exports=SharedInstance.share(sharedInstanceName,sharedInstanceVersion,BreakpointsDelegate)},{"@marcom/ac-event-emitter":135,"@marcom/ac-object":184,"@marcom/ac-shared-instance":240,"@marcom/ac-window-delegate":280}],8:[function(require,module,exports){"use strict";var BrowserPrefixed=function(){var cssPrefix=["","-webkit-","-moz-","-o-","-ms-"];var transitionEndMap={"animation-delay":"transitionend","-o-animation-delay":"oTransitionEnd","-moz-animation-delay":"transitionend","-webkit-animation-delay":"webkitTransitionEnd","-ms-animation-delay":"transitionend"};var animationStartMap={"animation-delay":"animationstart","-o-animation-delay":"oanimationstart","-moz-animation-delay":"animationstart","-webkit-animation-delay":"webkitAnimationStart","-ms-animation-delay":"MSAnimationStart"};var animationIterationMap={"animation-delay":"animationiteration","-o-animation-delay":"oanimationiteration","-moz-animation-delay":"animationiteration","-webkit-animation-delay":"webkitAnimationIteration","-ms-animation-delay":"MSAnimationIteration"};var animationEndMap={"animation-delay":"animationend","-o-animation-delay":"oanimationend","-moz-animation-delay":"animationend","-webkit-animation-delay":"webkitAnimationEnd","-ms-animation-delay":"MSAnimationEnd"};var el=document.createElement("_");var cssPrefixes=["","-webkit-","-moz-","-o-","-ms-"];function getStyleProp(propSuffix){for(var i=0;i<cssPrefixes.length;i++){var propName=cssPrefix[i]+propSuffix;if(el.style[propName]!==undefined){return propName}}return undefined}var cssFilterPrefix=["-webkit-","","-moz-","-o-","-ms-"];function getFilterPrefix(propSuffix){for(var i=0;i<cssFilterPrefix.length;i++){var propName=cssFilterPrefix[i]+propSuffix;if(el.style[propName]!==undefined){return propName}}return undefined}return{filter:getFilterPrefix("filter"),transform:getStyleProp("transform"),transformOrigin:getStyleProp("transform-origin"),transition:getStyleProp("transition"),transitionDelay:getStyleProp("transition-delay"),transitionDuration:getStyleProp("transition-duration"),transitionProperty:getStyleProp("transition-property"),transitionTimingFunction:getStyleProp("transition-timing-function"),transitionEnd:transitionEndMap[getStyleProp("animation-delay")],animation:getStyleProp("animation"),animationDelay:getStyleProp("animation-delay"),animationDirection:getStyleProp("animation-direction"),animationDuration:getStyleProp("animation-duration"),animationFillMode:getStyleProp("animation-fill-mode"),animationIterationCount:getStyleProp("animation-iteration-count"),animationName:getStyleProp("animation-name"),animationTimingFunction:getStyleProp("animation-timing-function"),animationPlayState:getStyleProp("animation-play-state"),animationStart:animationStartMap[getStyleProp("animation-delay")],animationIteration:animationIterationMap[getStyleProp("animation-delay")],animationEnd:animationEndMap[getStyleProp("animation-delay")]}}();module.exports=BrowserPrefixed},{}],9:[function(require,module,exports){"use strict";var BrowserData=require("./ac-browser/BrowserData");var webkitRegExp=/applewebkit/i;var IE=require("./ac-browser/IE");var browser=BrowserData.create();browser.isWebKit=function(userAgentString){var userAgent=userAgentString||window.navigator.userAgent;return userAgent?!!webkitRegExp.test(userAgent):false};browser.lowerCaseUserAgent=navigator.userAgent.toLowerCase();if(browser.name==="IE"){browser.IE={documentMode:IE.getDocumentMode()}}module.exports=browser},{"./ac-browser/BrowserData":10,"./ac-browser/IE":11}],10:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.filter");require("@marcom/ac-polyfills/Array/prototype.some");var _data=require("./data");function BrowserData(){}BrowserData.prototype={__getBrowserVersion:function(stringToSearch,identity){var version;if(!stringToSearch||!identity){return}var filteredData=_data.browser.filter(function(item){return item.identity===identity});filteredData.some(function(item){var versionSearchString=item.versionSearch||identity;var index=stringToSearch.indexOf(versionSearchString);if(index>-1){version=parseFloat(stringToSearch.substring(index+versionSearchString.length+1));return true}});return version},__getName:function(dataBrowser){return this.__getIdentityStringFromArray(dataBrowser)},__getIdentity:function(item){if(item.string){return this.__matchSubString(item)}else if(item.prop){return item.identity}},__getIdentityStringFromArray:function(dataArray){for(var i=0,l=dataArray.length,identity;i<l;i++){identity=this.__getIdentity(dataArray[i]);if(identity){return identity}}},__getOS:function(dataOS){return this.__getIdentityStringFromArray(dataOS)},__getOSVersion:function(stringToSearch,osIdentity){if(!stringToSearch||!osIdentity){return}var filteredData=_data.os.filter(function(item){return item.identity===osIdentity})[0];var versionSearchString=filteredData.versionSearch||osIdentity;var regex=new RegExp(versionSearchString+" ([\\d_\\.]+)","i");var version=stringToSearch.match(regex);if(version!==null){return version[1].replace(/_/g,".")}},__matchSubString:function(item){var subString=item.subString;if(subString){var matches=subString.test?!!subString.test(item.string):item.string.indexOf(subString)>-1;if(matches){return item.identity}}}};BrowserData.create=function(){var instance=new BrowserData;var out={};out.name=instance.__getName(_data.browser);out.version=instance.__getBrowserVersion(_data.versionString,out.name);out.os=instance.__getOS(_data.os);out.osVersion=instance.__getOSVersion(_data.versionString,out.os);return out};module.exports=BrowserData},{"./data":12,"@marcom/ac-polyfills/Array/prototype.filter":"@marcom/ac-polyfills/Array/prototype.filter","@marcom/ac-polyfills/Array/prototype.some":"@marcom/ac-polyfills/Array/prototype.some"}],11:[function(require,module,exports){"use strict";module.exports={getDocumentMode:function(){var ie;if(document.documentMode){ie=parseInt(document.documentMode,10)}else{ie=5;if(document.compatMode){if(document.compatMode==="CSS1Compat"){ie=7}}}return ie}}},{}],12:[function(require,module,exports){"use strict";module.exports={browser:[{string:window.navigator.userAgent,subString:"Edge",identity:"Edge"},{string:window.navigator.userAgent,subString:/silk/i,identity:"Silk"},{string:window.navigator.userAgent,subString:/(android).*(version\/[0-9+].[0-9+])/i,identity:"Android"},{string:window.navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:window.navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:window.navigator.userAgent,subString:/mobile\/[^\s]*\ssafari\//i,identity:"Safari Mobile",versionSearch:"Version"},{string:window.navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:window.navigator.vendor,subString:"iCab",identity:"iCab"},{string:window.navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:window.navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:window.navigator.vendor,subString:"Camino",identity:"Camino"},{string:window.navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:window.navigator.userAgent,subString:"MSIE",identity:"IE",versionSearch:"MSIE"},{string:window.navigator.userAgent,subString:"Trident",identity:"IE",versionSearch:"rv"},{string:window.navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:window.navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],os:[{string:window.navigator.platform,subString:"Win",identity:"Windows",versionSearch:"Windows NT"},{string:window.navigator.platform,subString:"Mac",identity:"OS X"},{string:window.navigator.userAgent,subString:"iPhone",identity:"iOS",versionSearch:"iPhone OS"},{string:window.navigator.userAgent,subString:"iPad",identity:"iOS",versionSearch:"CPU OS"},{string:window.navigator.userAgent,subString:/android/i,identity:"Android"},{string:window.navigator.platform,subString:"Linux",identity:"Linux"}],versionString:window.navigator.userAgent||window.navigator.appVersion||undefined}},{}],13:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.slice");require("@marcom/ac-polyfills/Element/prototype.classList");var classNameAdd=require("./className/add");module.exports=function add(){var tokens=Array.prototype.slice.call(arguments);var el=tokens.shift(tokens);var i;if(el.classList&&el.classList.add){el.classList.add.apply(el.classList,tokens);return}for(i=0;i<tokens.length;i++){classNameAdd(el,tokens[i])}}},{"./className/add":15,"@marcom/ac-polyfills/Array/prototype.slice":"@marcom/ac-polyfills/Array/prototype.slice","@marcom/ac-polyfills/Element/prototype.classList":"@marcom/ac-polyfills/Element/prototype.classList"}],14:[function(require,module,exports){"use strict";module.exports={add:require("./className/add"),contains:require("./className/contains"),remove:require("./className/remove")}},{"./className/add":15,"./className/contains":16,"./className/remove":18}],15:[function(require,module,exports){"use strict";var classNameContains=require("./contains");module.exports=function add(el,token){if(!classNameContains(el,token)){el.className+=" "+token}}},{"./contains":16}],16:[function(require,module,exports){"use strict";var getTokenRegExp=require("./getTokenRegExp");module.exports=function classNameAdd(el,token){return getTokenRegExp(token).test(el.className)}},{"./getTokenRegExp":17}],17:[function(require,module,exports){"use strict";module.exports=function getTokenRegExp(token){return new RegExp("(\\s|^)"+token+"(\\s|$)")}},{}],18:[function(require,module,exports){"use strict";var classNameContains=require("./contains");var getTokenRegExp=require("./getTokenRegExp");module.exports=function remove(el,token){if(classNameContains(el,token)){el.className=el.className.replace(getTokenRegExp(token),"$1").trim()}}},{"./contains":16,"./getTokenRegExp":17}],19:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Element/prototype.classList");var classNameContains=require("./className/contains");module.exports=function contains(el,token){if(el.classList&&el.classList.contains){return el.classList.contains(token)}return classNameContains(el,token)}},{"./className/contains":16,"@marcom/ac-polyfills/Element/prototype.classList":"@marcom/ac-polyfills/Element/prototype.classList"}],20:[function(require,module,exports){"use strict";module.exports={add:require("./add"),contains:require("./contains"),remove:require("./remove"),toggle:require("./toggle")}},{"./add":13,"./contains":19,"./remove":21,"./toggle":22}],21:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.slice");require("@marcom/ac-polyfills/Element/prototype.classList");var classNameRemove=require("./className/remove");module.exports=function remove(){var tokens=Array.prototype.slice.call(arguments);var el=tokens.shift(tokens);var i;if(el.classList&&el.classList.remove){el.classList.remove.apply(el.classList,tokens);return}for(i=0;i<tokens.length;i++){classNameRemove(el,tokens[i])}}},{"./className/remove":18,"@marcom/ac-polyfills/Array/prototype.slice":"@marcom/ac-polyfills/Array/prototype.slice","@marcom/ac-polyfills/Element/prototype.classList":"@marcom/ac-polyfills/Element/prototype.classList"}],22:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Element/prototype.classList");var className=require("./className");module.exports=function toggle(el,token,force){var hasForce=typeof force!=="undefined";var addToken;if(el.classList&&el.classList.toggle){if(hasForce){return el.classList.toggle(token,force)}return el.classList.toggle(token)}if(hasForce){addToken=!!force}else{addToken=!className.contains(el,token)}if(addToken){className.add(el,token)}else{className.remove(el,token)}return addToken}},{"./className":14,"@marcom/ac-polyfills/Element/prototype.classList":"@marcom/ac-polyfills/Element/prototype.classList"}],23:[function(require,module,exports){"use strict";module.exports={EventEmitterMicro:require("./ac-event-emitter-micro/EventEmitterMicro")}},{"./ac-event-emitter-micro/EventEmitterMicro":24}],24:[function(require,module,exports){"use strict";function EventEmitterMicro(){this._events={}}var proto=EventEmitterMicro.prototype;proto.on=function(eventName,callback){this._events[eventName]=this._events[eventName]||[];this._events[eventName].unshift(callback)};proto.once=function(eventName,callback){var that=this;function fn(data){that.off(eventName,fn);if(data!==undefined)callback(data);else callback()}this.on(eventName,fn)};proto.off=function(eventName,callback){if(!this.has(eventName))return;var index=this._events[eventName].indexOf(callback);if(index===-1)return;this._events[eventName].splice(index,1)};proto.trigger=function(eventName,data){if(!this.has(eventName))return;for(var i=this._events[eventName].length-1;i>=0;i--){if(data!==undefined)this._events[eventName][i](data);else this._events[eventName][i]()}};proto.has=function(eventName){if(eventName in this._events===false||this._events[eventName].length===0){return false}return true};proto.destroy=function(){for(var eventName in this._events){this._events[eventName]=null}this._events=null};module.exports=EventEmitterMicro},{}],25:[function(require,module,exports){"use strict";module.exports={Clip:require("./ac-clip/Clip")}},{"./ac-clip/Clip":26}],26:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/isArray");var create=require("@marcom/ac-object/create");var createPredefined=require("@marcom/ac-easing").createPredefined;var Clock=require("@marcom/ac-clock");var Ease=require("@marcom/ac-easing").Ease;var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var DEFAULT_EASE="ease";function Clip(target,duration,propsTo,options){options=options||{};this._options=options;this._isYoyo=options.yoyo;this._direction=1;this._timeScale=1;this._loop=options.loop||0;this._loopCount=0;this._target=target;this.duration(duration);this._delay=(options.delay||0)*1e3;this._remainingDelay=this._delay;this._progress=0;this._clock=options.clock||Clock;this._playing=false;this._getTime=Date.now||function(){return(new Date).getTime()};this._propsTo=propsTo||{};this._propsFrom=options.propsFrom||{};this._onStart=options.onStart||null;this._onUpdate=options.onUpdate||null;this._onDraw=options.onDraw||null;this._onComplete=options.onComplete||null;var ease=options.ease||DEFAULT_EASE;this._ease=typeof ease==="function"?new Ease(ease):createPredefined(ease);this._start=this._start.bind(this);this._update=this._update.bind(this);this._draw=this._draw.bind(this);this._isPrepared=false;Clip._add(this);EventEmitterMicro.call(this)}var proto=Clip.prototype=create(EventEmitterMicro.prototype);Clip.COMPLETE="complete";Clip.PAUSE="pause";Clip.PLAY="play";proto.play=function(){if(!this._playing){this._playing=true;if(this._delay===0||this._remainingDelay===0){this._start()}else{if(!this._isPrepared){this._setDiff();this._updateProps()}this._startTimeout=setTimeout(this._start,this._remainingDelay/this._timeScale);this._delayStart=this._getTime()}}return this};proto.pause=function(){if(this._playing){if(this._startTimeout){this._remainingDelay=this._getTime()-this._delayStart;clearTimeout(this._startTimeout)}this._stop();this.trigger(Clip.PAUSE,this)}return this};proto.destroy=function(){this.pause();this._options=null;this._target=null;this._storeTarget=null;this._ease=null;this._clock=null;this._propsTo=null;this._propsFrom=null;this._storePropsTo=null;this._storePropsFrom=null;this._propsDiff=null;this._propsEase=null;this._onStart=null;this._onUpdate=null;this._onDraw=null;this._onComplete=null;Clip._remove(this);EventEmitterMicro.prototype.destroy.call(this);return this};proto.reset=function(){if(!this._isPrepared){return}this._stop();this._resetLoop(this._target,this._storeTarget);this._direction=1;this._loop=this._options.loop||0;this._loopCount=0;this._propsFrom=this._storePropsFrom;this._propsTo=this._storePropsTo;this._progress=0;this._setStartTime();if(this._onUpdate){this._onUpdate.call(this,this)}if(this._onDraw){this._onDraw.call(this,this)}return this};proto.playing=function(){return this._playing};proto.target=function(){return this._target};proto.duration=function(duration){if(duration!==undefined){this._duration=duration;this._durationMs=duration*1e3/this._timeScale;if(this._playing){this._setStartTime()}}return this._duration};proto.timeScale=function(timeScale){if(timeScale!==undefined){this._timeScale=timeScale;this.duration(this._duration)}return this._timeScale};proto.currentTime=function(time){if(time!==undefined){return this.progress(time/this._duration)*this._duration}return this.progress()*this._duration};proto.progress=function(progress){if(progress!==undefined){this._progress=Math.min(1,Math.max(0,progress));this._setStartTime();if(!this._isPrepared){this._setDiff()}if(this._playing&&progress===1){this._completeProps();if(this._onUpdate){this._onUpdate.call(this,this)}if(this._onDraw){this._onDraw.call(this,this)}this._complete()}else{this._updateProps();if(this._onUpdate){this._onUpdate.call(this,this)}if(this._onDraw){this._onDraw.call(this,this)}}}return this._progress};proto._resetLoop=function(target,stored){var prop;for(prop in stored){if(stored.hasOwnProperty(prop)){if(stored[prop]!==null){if(typeof stored[prop]==="object"){this._resetLoop(target[prop],stored[prop])}else{target[prop]=stored[prop]}}}}};proto._cloneObjects=function(){var cloneTarget={};var clonePropsTo={};var clonePropsFrom={};this._cloneObjectsLoop(this._target,this._propsTo,this._propsFrom,cloneTarget,clonePropsTo,clonePropsFrom);return{target:cloneTarget,propsTo:clonePropsTo,propsFrom:clonePropsFrom}};proto._cloneObjectsLoop=function(target,to,from,cloneTarget,clonePropsTo,clonePropsFrom){var type;var prop;for(prop in from){if(from.hasOwnProperty(prop)&&to[prop]===undefined&&target[prop]!==undefined){cloneTarget[prop]=target[prop];clonePropsTo[prop]=target[prop];clonePropsFrom[prop]=from[prop]}}for(prop in to){if(target.hasOwnProperty(prop)){type=typeof target[prop];if(target[prop]!==null&&type==="object"){if(Array.isArray(target[prop])){cloneTarget[prop]=[];clonePropsTo[prop]=[];clonePropsFrom[prop]=[]}else{cloneTarget[prop]={};clonePropsTo[prop]={};clonePropsFrom[prop]={}}this._cloneObjectsLoop(target[prop],to[prop]||{},from[prop]||{},cloneTarget[prop],clonePropsTo[prop],clonePropsFrom[prop])}else if(to[prop]!==null&&type==="number"){cloneTarget[prop]=target[prop];clonePropsTo[prop]=to[prop];if(from&&from[prop]!==undefined){clonePropsFrom[prop]=from[prop]}}}}};proto._prepareProperties=function(){if(!this._isPrepared){var clones=this._cloneObjects();this._storeTarget=clones.target;this._propsTo=clones.propsTo;this._storePropsTo=this._propsTo;this._propsFrom=clones.propsFrom;this._storePropsFrom=this._propsFrom;this._isPrepared=true}};proto._setStartTime=function(){this._startTime=this._getTime()-this.progress()*this._durationMs};proto._setDiff=function(){if(!this._isPrepared){this._prepareProperties()}this._propsDiff={};this._setDiffLoop(this._propsTo,this._propsFrom,this._target,this._propsDiff)};proto._setDiffLoop=function(to,from,target,diff){var type;var prop;for(prop in to){if(to.hasOwnProperty(prop)){type=typeof to[prop];if(to[prop]!==null&&type==="object"){from[prop]=from[prop]||{};diff[prop]=diff[prop]||{};this._setDiffLoop(to[prop],from[prop],target[prop],diff[prop])}else if(type==="number"&&target[prop]!==undefined){if(from[prop]!==undefined){target[prop]=from[prop]}else{from[prop]=target[prop]}diff[prop]=to[prop]-target[prop]}else{to[prop]=null;from[prop]=null}}}};proto._start=function(){this._startTimeout=null;this._remainingDelay=0;this._setStartTime();this._clock.on("update",this._update);this._clock.on("draw",this._draw);if(!this._clock.isRunning()){this._clock.start()}this._setDiff();this._playing=true;this._running=true;if(this._onStart){this._onStart.call(this,this)}this.trigger(Clip.PLAY,this)};proto._stop=function(){this._playing=false;this._running=false;this._clock.off("update",this._update);this._clock.off("draw",this._draw)};proto._updateProps=function(){var eased;if(this._direction===1){eased=this._ease.getValue(this._progress)}else{eased=1-this._ease.getValue(1-this._progress)}this._updatePropsLoop(this._propsTo,this._propsFrom,this._target,this._propsDiff,eased)};proto._updatePropsLoop=function(to,from,target,diff,eased){var prop;for(prop in to){if(to.hasOwnProperty(prop)&&to[prop]!==null){if(typeof to[prop]!=="number"){this._updatePropsLoop(to[prop],from[prop],target[prop],diff[prop],eased)}else{target[prop]=from[prop]+diff[prop]*eased}}}};proto._completeProps=function(){this._completePropsLoop(this._propsTo,this._target)};proto._completePropsLoop=function(to,target){var prop;for(prop in to){if(to.hasOwnProperty(prop)&&to[prop]!==null){if(typeof to[prop]!=="number"){this._completePropsLoop(to[prop],target[prop])}else{target[prop]=to[prop]}}}};proto._complete=function(){if(this._isYoyo&&(this._loop>0&&this._loopCount<=this._loop||this._loop===0&&this._loopCount===0)){this._propsFrom=this._direction===1?this._storePropsTo:this._storePropsFrom;this._propsTo=this._direction===1?this._storePropsFrom:this._storePropsTo;this._direction*=-1;if(this._direction===-1){++this._loopCount}this.progress(0);this._start()}else if(this._loopCount<this._loop){++this._loopCount;this.progress(0);this._start()}else{this.trigger(Clip.COMPLETE,this);if(this._onComplete){this._onComplete.call(this,this)}if(this._options&&this._options.destroyOnComplete){this.destroy()}}};proto._update=function(evt){if(this._running){this._progress=(evt.timeNow-this._startTime)/this._durationMs;if(this._progress>=1){this._progress=1;this._running=false;this._completeProps()}else{this._updateProps()}if(this._onUpdate){this._onUpdate.call(this,this)}}};proto._draw=function(evt){if(this._onDraw){this._onDraw.call(this,this)}if(!this._running){this._stop();if(this._progress===1){this._complete()}}};Clip._instantiate=function(){this._clips=[];return this};Clip._add=function(clip){this._clips.push(clip)};Clip._remove=function(clip){var index=this._clips.indexOf(clip);if(index>-1){this._clips.splice(index,1)}};Clip.getAll=function(target){if(target!==undefined){var clips=[];var i=this._clips.length;while(i--){if(this._clips[i].target()===target){clips.push(this._clips[i])}}return clips}return Array.prototype.slice.call(this._clips)};Clip.destroyAll=function(target){var clips=this.getAll(target);if(this._clips.length===clips.length){this._clips=[]}var i=clips.length;while(i--){clips[i].destroy()}return clips};Clip.to=function(target,duration,propsTo,options){options=options||{};if(options.destroyOnComplete===undefined){options.destroyOnComplete=true}return new Clip(target,duration,propsTo,options).play()};Clip.from=function(target,duration,propsFrom,options){options=options||{};options.propsFrom=propsFrom;if(options.destroyOnComplete===undefined){options.destroyOnComplete=true}return new Clip(target,duration,options.propsTo,options).play()};module.exports=Clip._instantiate()},{"@marcom/ac-clock":27,"@marcom/ac-easing":102,"@marcom/ac-event-emitter-micro":23,"@marcom/ac-object/create":186,"@marcom/ac-polyfills/Array/isArray":"@marcom/ac-polyfills/Array/isArray"}],27:[function(require,module,exports){var Clock=require("./ac-clock/Clock"),ThrottledClock=require("./ac-clock/ThrottledClock"),sharedClockInstance=require("./ac-clock/sharedClockInstance");sharedClockInstance.Clock=Clock;sharedClockInstance.ThrottledClock=ThrottledClock;module.exports=sharedClockInstance},{"./ac-clock/Clock":28,"./ac-clock/ThrottledClock":29,"./ac-clock/sharedClockInstance":30}],28:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Function/prototype.bind");require("@marcom/ac-polyfills/requestAnimationFrame");var proto;var EventEmitter=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var pageLoadTime=(new Date).getTime();function Clock(){EventEmitter.call(this);this.lastFrameTime=null;this._animationFrame=null;this._active=false;this._startTime=null;this._boundOnAnimationFrame=this._onAnimationFrame.bind(this);this._getTime=Date.now||function(){return(new Date).getTime()}}proto=Clock.prototype=new EventEmitter(null);proto.start=function(){if(this._active){return}this._tick()};proto.stop=function(){if(this._active){window.cancelAnimationFrame(this._animationFrame)}this._animationFrame=null;this.lastFrameTime=null;this._active=false};proto.destroy=function(){this.stop();this.off();var i;for(i in this){if(this.hasOwnProperty(i)){this[i]=null}}};proto.isRunning=function(){return this._active};proto._tick=function(){if(!this._active){this._active=true}this._animationFrame=window.requestAnimationFrame(this._boundOnAnimationFrame)};proto._onAnimationFrame=function(time){if(this.lastFrameTime===null){this.lastFrameTime=time}var delta=time-this.lastFrameTime;var fps=0;if(delta>=1e3){delta=0}if(delta!==0){fps=1e3/delta}if(this._firstFrame===true){delta=0;this._firstFrame=false}if(fps===0){this._firstFrame=true}else{var data={time:time,delta:delta,fps:fps,naturalFps:fps,timeNow:this._getTime()};this.trigger("update",data);this.trigger("draw",data)}this._animationFrame=null;this.lastFrameTime=time;if(this._active!==false){this._tick()}else{this.lastFrameTime=null}};module.exports=Clock},{"@marcom/ac-event-emitter-micro":133,"@marcom/ac-polyfills/Function/prototype.bind":"@marcom/ac-polyfills/Function/prototype.bind","@marcom/ac-polyfills/requestAnimationFrame":"@marcom/ac-polyfills/requestAnimationFrame"}],29:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/requestAnimationFrame");var proto;var sharedClockInstance=require("./sharedClockInstance"),EventEmitter=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;function ThrottledClock(fps,options){if(fps===null){return}EventEmitter.call(this);options=options||{};this._fps=fps||null;this._clock=options.clock||sharedClockInstance;this._lastThrottledTime=null;this._clockEvent=null;this._boundOnClockDraw=this._onClockDraw.bind(this);this._boundOnClockUpdate=this._onClockUpdate.bind(this);this._clock.on("update",this._boundOnClockUpdate)}proto=ThrottledClock.prototype=new EventEmitter(null);proto.setFps=function(fps){this._fps=fps;return this};proto.getFps=function(){return this._fps};proto.start=function(){this._clock.start();return this};proto.stop=function(){this._clock.stop();return this};proto.isRunning=function(){return this._clock.isRunning()};proto.destroy=function(){this._clock.off("update",this._boundOnClockUpdate);this._clock.destroy.call(this)};proto._onClockUpdate=function(e){if(this._lastThrottledTime===null){this._lastThrottledTime=this._clock.lastFrameTime}var delta=e.time-this._lastThrottledTime;if(!this._fps){throw new TypeError("FPS is not defined.")}if(Math.ceil(1e3/delta)>=this._fps+2){return}this._clockEvent=e;this._clockEvent.delta=delta;this._clockEvent.fps=1e3/delta;this._lastThrottledTime=this._clockEvent.time;this._clock.once("draw",this._boundOnClockDraw);this.trigger("update",this._clockEvent)};proto._onClockDraw=function(){this.trigger("draw",this._clockEvent)};module.exports=ThrottledClock},{"./sharedClockInstance":30,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-polyfills/requestAnimationFrame":"@marcom/ac-polyfills/requestAnimationFrame"}],30:[function(require,module,exports){"use strict";var Clock=require("./Clock");module.exports=new Clock},{"./Clock":28}],31:[function(require,module,exports){"use strict";var Color=require("./ac-color/Color");Color.decimalToHex=require("./ac-color/static/decimalToHex");Color.hexToDecimal=require("./ac-color/static/hexToDecimal");Color.hexToRgb=require("./ac-color/static/hexToRgb");Color.isColor=require("./ac-color/static/isColor");Color.isHex=require("./ac-color/static/isHex");Color.isRgb=require("./ac-color/static/isRgb");Color.isRgba=require("./ac-color/static/isRgba");Color.mixColors=require("./ac-color/static/mixColors");Color.rgbaToArray=require("./ac-color/static/rgbaToArray");Color.rgbToArray=require("./ac-color/static/rgbToArray");Color.rgbToDecimal=require("./ac-color/static/rgbToDecimal");Color.rgbToHex=require("./ac-color/static/rgbToHex");Color.rgbToHsl=require("./ac-color/static/rgbToHsl");Color.rgbToHsv=require("./ac-color/static/rgbToHsv");Color.rgbaToObject=require("./ac-color/static/rgbaToObject");Color.rgbToObject=require("./ac-color/static/rgbToObject");Color.shortToLongHex=require("./ac-color/static/shortToLongHex");module.exports={Color:Color}},{"./ac-color/Color":32,"./ac-color/static/decimalToHex":34,"./ac-color/static/hexToDecimal":35,"./ac-color/static/hexToRgb":36,"./ac-color/static/isColor":37,"./ac-color/static/isHex":38,"./ac-color/static/isRgb":39,"./ac-color/static/isRgba":40,"./ac-color/static/mixColors":41,"./ac-color/static/rgbToArray":42,"./ac-color/static/rgbToDecimal":43,"./ac-color/static/rgbToHex":44,"./ac-color/static/rgbToHsl":45,"./ac-color/static/rgbToHsv":46,"./ac-color/static/rgbToObject":47,"./ac-color/static/rgbaToArray":48,"./ac-color/static/rgbaToObject":49,"./ac-color/static/shortToLongHex":50}],32:[function(require,module,exports){"use strict";var cssColorNames=require("./helpers/cssColorNames");var hexToRgb=require("./static/hexToRgb");var isColor=require("./static/isColor");var isHex=require("./static/isHex");var isRgba=require("./static/isRgba");var mixColors=require("./static/mixColors");var rgbaToArray=require("./static/rgbaToArray");var rgbToArray=require("./static/rgbToArray");var rgbToDecimal=require("./static/rgbToDecimal");var rgbToHex=require("./static/rgbToHex");var rgbaToObject=require("./static/rgbaToObject");var rgbToObject=require("./static/rgbToObject");var shortToLongHex=require("./static/shortToLongHex");function Color(color){if(!isColor(color)&&!cssColorNames.nameToRgbObject[color]){throw new Error(color+" is not a supported color.")}this._setColor(color)}var proto=Color.prototype;proto._setColor=function(color){this._color={};if(isHex(color)){this._color.hex=shortToLongHex(color);this._color.rgb={color:hexToRgb(color)}}else if(isRgba(color)){this._color.rgba={color:color};var rgbaObject=this.rgbaObject();this._color.rgb={color:"rgb("+rgbaObject.r+", "+rgbaObject.g+", "+rgbaObject.b+")"}}else if(cssColorNames.nameToRgbObject[color]){var rgbObject=cssColorNames.nameToRgbObject[color];this._color.rgb={object:rgbObject,color:"rgb("+rgbObject.r+", "+rgbObject.g+", "+rgbObject.b+")"}}else{this._color.rgb={color:color}}};proto.rgb=function(){return this._color.rgb.color};proto.rgba=function(){if(this._color.rgba===undefined){var rgbObject=this.rgbObject();this._color.rgba={color:"rgba("+rgbObject.r+", "+rgbObject.g+", "+rgbObject.b+", 1)"}}return this._color.rgba.color};proto.hex=function(){if(this._color.hex===undefined){this._color.hex=rgbToHex.apply(this,this.rgbArray())}return this._color.hex};proto.decimal=function(){if(this._color.decimal===undefined){this._color.decimal=rgbToDecimal(this.rgb())}return this._color.decimal};proto.cssName=function(){return cssColorNames.rgbToName[this.rgb()]||null};proto.rgbArray=function(){if(this._color.rgb.array===undefined){this._color.rgb.array=rgbToArray(this.rgb())}return this._color.rgb.array};proto.rgbaArray=function(){if(this._color.rgba===undefined){this.rgba()}if(this._color.rgba.array===undefined){this._color.rgba.array=rgbaToArray(this.rgba())}return this._color.rgba.array};proto.rgbObject=function(){if(this._color.rgb.object===undefined){this._color.rgb.object=rgbToObject(this.rgb())}return this._color.rgb.object};proto.rgbaObject=function(){if(this._color.rgba===undefined){this.rgba()}if(this._color.rgba.object===undefined){this._color.rgba.object=rgbaToObject(this.rgba())}return this._color.rgba.object};proto.getRed=function(){return this.rgbObject().r};proto.getGreen=function(){return this.rgbObject().g};proto.getBlue=function(){return this.rgbObject().b};proto.getAlpha=function(){if(this._color.rgba===undefined){return 1}return this.rgbaObject().a};proto.setRed=function(red){if(red!==this.getRed()){this._setColor("rgba("+red+", "+this.getGreen()+", "+this.getBlue()+", "+this.getAlpha()+")")}return this.rgbObject().r};proto.setGreen=function(green){if(green!==this.getGreen()){this._setColor("rgba("+this.getRed()+", "+green+", "+this.getBlue()+", "+this.getAlpha()+")")}return this.rgbObject().g};proto.setBlue=function(blue){if(blue!==this.getBlue()){this._setColor("rgba("+this.getRed()+", "+this.getGreen()+", "+blue+", "+this.getAlpha()+")")}return this.rgbObject().b};proto.setAlpha=function(alpha){if(alpha!==this.getAlpha()){this._setColor("rgba("+this.getRed()+", "+this.getGreen()+", "+this.getBlue()+", "+alpha+")")}return this.rgbaObject().a};proto.mix=function(color,percent){var rgbObject=rgbToObject(mixColors(this.rgb(),color,percent));this._setColor("rgba("+rgbObject.r+", "+rgbObject.g+", "+rgbObject.b+", "+this.getAlpha()+")");return this.rgb()};proto.clone=function(){return new Color(this.rgb())};module.exports=Color},{"./helpers/cssColorNames":33,"./static/hexToRgb":36,"./static/isColor":37,"./static/isHex":38,"./static/isRgba":40,"./static/mixColors":41,"./static/rgbToArray":42,"./static/rgbToDecimal":43,"./static/rgbToHex":44,"./static/rgbToObject":47,"./static/rgbaToArray":48,"./static/rgbaToObject":49,"./static/shortToLongHex":50}],33:[function(require,module,exports){"use strict";var rgbToName={"rgb(240, 248, 255)":"aliceblue","rgb(250, 235, 215)":"antiquewhite","rgb(0, 0, 0)":"black","rgb(0, 0, 255)":"blue","rgb(0, 255, 255)":"cyan","rgb(0, 0, 139)":"darkblue","rgb(0, 139, 139)":"darkcyan","rgb(0, 100, 0)":"darkgreen","rgb(0, 206, 209)":"darkturquoise","rgb(0, 191, 255)":"deepskyblue","rgb(0, 128, 0)":"green","rgb(0, 255, 0)":"lime","rgb(0, 0, 205)":"mediumblue","rgb(0, 250, 154)":"mediumspringgreen","rgb(0, 0, 128)":"navy","rgb(0, 255, 127)":"springgreen","rgb(0, 128, 128)":"teal","rgb(25, 25, 112)":"midnightblue","rgb(30, 144, 255)":"dodgerblue","rgb(32, 178, 170)":"lightseagreen","rgb(34, 139, 34)":"forestgreen","rgb(46, 139, 87)":"seagreen","rgb(47, 79, 79)":"darkslategray","rgb(50, 205, 50)":"limegreen","rgb(60, 179, 113)":"mediumseagreen","rgb(64, 224, 208)":"turquoise","rgb(65, 105, 225)":"royalblue","rgb(70, 130, 180)":"steelblue","rgb(72, 61, 139)":"darkslateblue","rgb(72, 209, 204)":"mediumturquoise","rgb(75, 0, 130)":"indigo","rgb(85, 107, 47)":"darkolivegreen","rgb(95, 158, 160)":"cadetblue","rgb(100, 149, 237)":"cornflowerblue","rgb(102, 205, 170)":"mediumaquamarine","rgb(105, 105, 105)":"dimgray","rgb(106, 90, 205)":"slateblue","rgb(107, 142, 35)":"olivedrab","rgb(112, 128, 144)":"slategray","rgb(119, 136, 153)":"lightslategray","rgb(123, 104, 238)":"mediumslateblue","rgb(124, 252, 0)":"lawngreen","rgb(127, 255, 212)":"aquamarine","rgb(127, 255, 0)":"chartreuse","rgb(128, 128, 128)":"gray","rgb(128, 0, 0)":"maroon","rgb(128, 128, 0)":"olive","rgb(128, 0, 128)":"purple","rgb(135, 206, 250)":"lightskyblue","rgb(135, 206, 235)":"skyblue","rgb(138, 43, 226)":"blueviolet","rgb(139, 0, 139)":"darkmagenta","rgb(139, 0, 0)":"darkred","rgb(139, 69, 19)":"saddlebrown","rgb(143, 188, 143)":"darkseagreen","rgb(144, 238, 144)":"lightgreen","rgb(147, 112, 219)":"mediumpurple","rgb(148, 0, 211)":"darkviolet","rgb(152, 251, 152)":"palegreen","rgb(153, 50, 204)":"darkorchid","rgb(154, 205, 50)":"yellowgreen","rgb(160, 82, 45)":"sienna","rgb(165, 42, 42)":"brown","rgb(169, 169, 169)":"darkgray","rgb(173, 255, 47)":"greenyellow","rgb(173, 216, 230)":"lightblue","rgb(175, 238, 238)":"paleturquoise","rgb(176, 196, 222)":"lightsteelblue","rgb(176, 224, 230)":"powderblue","rgb(178, 34, 34)":"firebrick","rgb(184, 134, 11)":"darkgoldenrod","rgb(186, 85, 211)":"mediumorchid","rgb(188, 143, 143)":"rosybrown","rgb(189, 183, 107)":"darkkhaki","rgb(192, 192, 192)":"silver","rgb(199, 21, 133)":"mediumvioletred","rgb(205, 92, 92)":"indianred","rgb(205, 133, 63)":"peru","rgb(210, 105, 30)":"chocolate","rgb(210, 180, 140)":"tan","rgb(211, 211, 211)":"lightgray","rgb(216, 191, 216)":"thistle","rgb(218, 165, 32)":"goldenrod","rgb(218, 112, 214)":"orchid","rgb(219, 112, 147)":"palevioletred","rgb(220, 20, 60)":"crimson","rgb(220, 220, 220)":"gainsboro","rgb(221, 160, 221)":"plum","rgb(222, 184, 135)":"burlywood","rgb(224, 255, 255)":"lightcyan","rgb(230, 230, 250)":"lavender","rgb(233, 150, 122)":"darksalmon","rgb(238, 232, 170)":"palegoldenrod","rgb(238, 130, 238)":"violet","rgb(240, 255, 255)":"azure","rgb(240, 255, 240)":"honeydew","rgb(240, 230, 140)":"khaki","rgb(240, 128, 128)":"lightcoral","rgb(244, 164, 96)":"sandybrown","rgb(245, 245, 220)":"beige","rgb(245, 255, 250)":"mintcream","rgb(245, 222, 179)":"wheat","rgb(245, 245, 245)":"whitesmoke","rgb(248, 248, 255)":"ghostwhite","rgb(250, 250, 210)":"lightgoldenrodyellow","rgb(250, 240, 230)":"linen","rgb(250, 128, 114)":"salmon","rgb(253, 245, 230)":"oldlace","rgb(255, 228, 196)":"bisque","rgb(255, 235, 205)":"blanchedalmond","rgb(255, 127, 80)":"coral","rgb(255, 248, 220)":"cornsilk","rgb(255, 140, 0)":"darkorange","rgb(255, 20, 147)":"deeppink","rgb(255, 250, 240)":"floralwhite","rgb(255, 215, 0)":"gold","rgb(255, 105, 180)":"hotpink","rgb(255, 255, 240)":"ivory","rgb(255, 240, 245)":"lavenderblush","rgb(255, 250, 205)":"lemonchiffon","rgb(255, 182, 193)":"lightpink","rgb(255, 160, 122)":"lightsalmon","rgb(255, 255, 224)":"lightyellow","rgb(255, 0, 255)":"magenta","rgb(255, 228, 225)":"mistyrose","rgb(255, 228, 181)":"moccasin","rgb(255, 222, 173)":"navajowhite","rgb(255, 165, 0)":"orange","rgb(255, 69, 0)":"orangered","rgb(255, 239, 213)":"papayawhip","rgb(255, 218, 185)":"peachpuff","rgb(255, 192, 203)":"pink","rgb(255, 0, 0)":"red","rgb(255, 245, 238)":"seashell","rgb(255, 250, 250)":"snow","rgb(255, 99, 71)":"tomato","rgb(255, 255, 255)":"white","rgb(255, 255, 0)":"yellow","rgb(102, 51, 153)":"rebeccapurple"};var nameToRgbObject={aqua:{r:0,g:255,b:255},aliceblue:{r:240,g:248,b:255},antiquewhite:{r:250,g:235,b:215},black:{r:0,g:0,b:0},blue:{r:0,g:0,b:255},cyan:{r:0,g:255,b:255},darkblue:{r:0,g:0,b:139},darkcyan:{r:0,g:139,b:139},darkgreen:{r:0,g:100,b:0},darkturquoise:{r:0,g:206,b:209},deepskyblue:{r:0,g:191,b:255},green:{r:0,g:128,b:0},lime:{r:0,g:255,b:0},mediumblue:{r:0,g:0,b:205},mediumspringgreen:{r:0,g:250,b:154},navy:{r:0,g:0,b:128},springgreen:{r:0,g:255,b:127},teal:{r:0,g:128,b:128},midnightblue:{r:25,g:25,b:112},dodgerblue:{r:30,g:144,b:255},lightseagreen:{r:32,g:178,b:170},forestgreen:{r:34,g:139,b:34},seagreen:{r:46,g:139,b:87},darkslategray:{r:47,g:79,b:79},darkslategrey:{r:47,g:79,b:79},limegreen:{r:50,g:205,b:50},mediumseagreen:{r:60,g:179,b:113},turquoise:{r:64,g:224,b:208},royalblue:{r:65,g:105,b:225},steelblue:{r:70,g:130,b:180},darkslateblue:{r:72,g:61,b:139},mediumturquoise:{r:72,g:209,b:204},indigo:{r:75,g:0,b:130},darkolivegreen:{r:85,g:107,b:47},cadetblue:{r:95,g:158,b:160},cornflowerblue:{r:100,g:149,b:237},mediumaquamarine:{r:102,g:205,b:170},dimgray:{r:105,g:105,b:105},dimgrey:{r:105,g:105,b:105},slateblue:{r:106,g:90,b:205},olivedrab:{r:107,g:142,b:35},slategray:{r:112,g:128,b:144},slategrey:{r:112,g:128,b:144},lightslategray:{r:119,g:136,b:153},lightslategrey:{r:119,g:136,b:153},mediumslateblue:{r:123,g:104,b:238},lawngreen:{r:124,g:252,b:0},aquamarine:{r:127,g:255,b:212},chartreuse:{r:127,g:255,b:0},gray:{r:128,g:128,b:128},grey:{r:128,g:128,b:128},maroon:{r:128,g:0,b:0},olive:{r:128,g:128,b:0},purple:{r:128,g:0,b:128},lightskyblue:{r:135,g:206,b:250},skyblue:{r:135,g:206,b:235},blueviolet:{r:138,g:43,b:226},darkmagenta:{r:139,g:0,b:139},darkred:{r:139,g:0,b:0},saddlebrown:{r:139,g:69,b:19},darkseagreen:{r:143,g:188,b:143},lightgreen:{r:144,g:238,b:144},mediumpurple:{r:147,g:112,b:219},darkviolet:{r:148,g:0,b:211},palegreen:{r:152,g:251,b:152},darkorchid:{r:153,g:50,b:204},yellowgreen:{r:154,g:205,b:50},sienna:{r:160,g:82,b:45},brown:{r:165,g:42,b:42},darkgray:{r:169,g:169,b:169},darkgrey:{r:169,g:169,b:169},greenyellow:{r:173,g:255,b:47},lightblue:{r:173,g:216,b:230},paleturquoise:{r:175,g:238,b:238},lightsteelblue:{r:176,g:196,b:222},powderblue:{r:176,g:224,b:230},firebrick:{r:178,g:34,b:34},darkgoldenrod:{r:184,g:134,b:11},mediumorchid:{r:186,g:85,b:211},rosybrown:{r:188,g:143,b:143},darkkhaki:{r:189,g:183,b:107},silver:{r:192,g:192,b:192},mediumvioletred:{r:199,g:21,b:133},indianred:{r:205,g:92,b:92},peru:{r:205,g:133,b:63},chocolate:{r:210,g:105,b:30},tan:{r:210,g:180,b:140},lightgray:{r:211,g:211,b:211},lightgrey:{r:211,g:211,b:211},thistle:{r:216,g:191,b:216},goldenrod:{r:218,g:165,b:32},orchid:{r:218,g:112,b:214},palevioletred:{r:219,g:112,b:147},crimson:{r:220,g:20,b:60},gainsboro:{r:220,g:220,b:220},plum:{r:221,g:160,b:221},burlywood:{r:222,g:184,b:135},lightcyan:{r:224,g:255,b:255},lavender:{r:230,g:230,b:250},darksalmon:{r:233,g:150,b:122},palegoldenrod:{r:238,g:232,b:170},violet:{r:238,g:130,b:238},azure:{r:240,g:255,b:255},honeydew:{r:240,g:255,b:240},khaki:{r:240,g:230,b:140},lightcoral:{r:240,g:128,b:128},sandybrown:{r:244,g:164,b:96},beige:{r:245,g:245,b:220},mintcream:{r:245,g:255,b:250},wheat:{r:245,g:222,b:179},whitesmoke:{r:245,g:245,b:245},ghostwhite:{r:248,g:248,b:255},lightgoldenrodyellow:{r:250,g:250,b:210},linen:{r:250,g:240,b:230},salmon:{r:250,g:128,b:114},oldlace:{r:253,g:245,b:230},bisque:{r:255,g:228,b:196},blanchedalmond:{r:255,g:235,b:205},coral:{r:255,g:127,b:80},cornsilk:{r:255,g:248,b:220},darkorange:{r:255,g:140,b:0},deeppink:{r:255,g:20,b:147},floralwhite:{r:255,g:250,b:240},fuchsia:{r:255,g:0,b:255},gold:{r:255,g:215,b:0},hotpink:{r:255,g:105,b:180},ivory:{r:255,g:255,b:240},lavenderblush:{r:255,g:240,b:245},lemonchiffon:{r:255,g:250,b:205},lightpink:{r:255,g:182,b:193},lightsalmon:{r:255,g:160,b:122},lightyellow:{r:255,g:255,b:224},magenta:{r:255,g:0,b:255},mistyrose:{r:255,g:228,b:225},moccasin:{r:255,g:228,b:181},navajowhite:{r:255,g:222,b:173},orange:{r:255,g:165,b:0},orangered:{r:255,g:69,b:0},papayawhip:{r:255,g:239,b:213},peachpuff:{r:255,g:218,b:185},pink:{r:255,g:192,b:203},red:{r:255,g:0,b:0},seashell:{r:255,g:245,b:238},snow:{r:255,g:250,b:250},tomato:{r:255,g:99,b:71},white:{r:255,g:255,b:255},yellow:{r:255,g:255,b:0},rebeccapurple:{r:102,g:51,b:153}};module.exports={rgbToName:rgbToName,nameToRgbObject:nameToRgbObject}},{}],34:[function(require,module,exports){"use strict";module.exports=function decimalToHex(decimal){return"#"+decimal.toString(16)}},{}],35:[function(require,module,exports){"use strict";module.exports=function hexToDecimal(hex){return parseInt(hex.substr(1),16)}},{}],36:[function(require,module,exports){"use strict";var shortToLongHex=require("./shortToLongHex");module.exports=function hexToRgb(hex){hex=shortToLongHex(hex);var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?"rgb("+parseInt(result[1],16)+", "+parseInt(result[2],16)+", "+parseInt(result[3],16)+")":null}},{"./shortToLongHex":50}],37:[function(require,module,exports){"use strict";var isRgb=require("./isRgb");var isRgba=require("./isRgba");var isHex=require("./isHex");module.exports=function isColor(str){return isHex(str)||isRgb(str)||isRgba(str)}},{"./isHex":38,"./isRgb":39,"./isRgba":40}],38:[function(require,module,exports){"use strict";module.exports=function isHex(str){var regex=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i;return regex.test(str)}},{}],39:[function(require,module,exports){"use strict";module.exports=function isRgb(str){var regex=/^rgb\(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]),\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]),\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*\)$/;return regex.exec(str)!==null}},{}],40:[function(require,module,exports){"use strict";module.exports=function isRgba(str){var regex=/^rgba\(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]),\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]),\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]),\s*(0(\.\d+)?|1(\.0+)?)\s*\)$/;return regex.exec(str)!==null}},{}],41:[function(require,module,exports){"use strict";var isHex=require("./isHex");var hexToRgb=require("./hexToRgb");var rgbToObject=require("./rgbToObject");module.exports=function mixColors(from,to,percent){from=isHex(from)?hexToRgb(from):from;to=isHex(to)?hexToRgb(to):to;from=rgbToObject(from);to=rgbToObject(to);var r=from.r+(to.r-from.r)*percent;var g=from.g+(to.g-from.g)*percent;var b=from.b+(to.b-from.b)*percent;return"rgb("+Math.round(r)+", "+Math.round(g)+", "+Math.round(b)+")"}},{"./hexToRgb":36,"./isHex":38,"./rgbToObject":47}],42:[function(require,module,exports){"use strict";var rgbToObject=require("./rgbToObject");module.exports=function rgbToArray(rgb){var o=rgbToObject(rgb);return[o.r,o.g,o.b]}},{"./rgbToObject":47}],43:[function(require,module,exports){"use strict";var hexToDecimal=require("./hexToDecimal");var rgbToArray=require("./rgbToArray");var rgbToHex=require("./rgbToHex");module.exports=function rgbToDecimal(rgb){var hex=rgbToHex.apply(this,rgbToArray(rgb));return hexToDecimal(hex)}},{"./hexToDecimal":35,"./rgbToArray":42,"./rgbToHex":44}],44:[function(require,module,exports){"use strict";module.exports=function rgbToHex(r,g,b){return"#"+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1)}},{}],45:[function(require,module,exports){"use strict";module.exports=function rgbToHsl(r,g,b){if(arguments.length!==3){return false}r/=255;g/=255;b/=255;var max=Math.max(r,g,b);var min=Math.min(r,g,b);var sum=max+min;var diff=max-min;var h;var s;var l=sum/2;if(max===min){h=s=0}else{s=l>.5?diff/(2-max-min):diff/sum;switch(max){case r:h=(g-b)/diff;break;case g:h=2+(b-r)/diff;break;case b:h=4+(r-g)/diff;break}h*=60;if(h<0){h+=360}}return[h,Math.round(100*s),Math.round(100*l)]}},{}],46:[function(require,module,exports){"use strict";module.exports=function rgbToHsv(r,g,b){if(arguments.length!==3){return false}var red=r/255;var green=g/255;var blue=b/255;var max=Math.max(red,green,blue);var min=Math.min(red,green,blue);var h;var s;var v=max;var delta=max-min;s=max===0?0:delta/max;if(max===min){h=0}else{switch(max){case red:h=(green-blue)/delta+(green<blue?6:0);break;case green:h=(blue-red)/delta+2;break;case blue:h=(red-green)/delta+4;break}h/=6}return[Math.round(360*h),Math.round(100*s),Math.round(100*v)]}},{}],47:[function(require,module,exports){"use strict";module.exports=function rgbToObject(rgb){var regex=/rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)/;var match=regex.exec(rgb);return{r:Number(match[1]),g:Number(match[2]),b:Number(match[3])}}},{}],48:[function(require,module,exports){"use strict";var rgbaToObject=require("./rgbaToObject");module.exports=function rgbaToArray(rgba){var o=rgbaToObject(rgba);return[o.r,o.g,o.b,o.a]}},{"./rgbaToObject":49}],49:[function(require,module,exports){"use strict";module.exports=function rgbaToObject(rgba){var regex=/rgba\(\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(0(\.\d+)?|1(\.0+)?)\s*\)/;var match=regex.exec(rgba);return{r:Number(match[1]),g:Number(match[2]),b:Number(match[3]),a:Number(match[4])}}},{}],50:[function(require,module,exports){"use strict";module.exports=function shortToLongHex(hex){var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;hex=hex.replace(shorthandRegex,function(m,r,g,b){return"#"+r+r+g+g+b+b});return hex}},{}],51:[function(require,module,exports){"use strict";module.exports={DOMEmitter:require("./ac-dom-emitter/DOMEmitter")}},{"./ac-dom-emitter/DOMEmitter":52}],52:[function(require,module,exports){"use strict";var proto;var EventEmitter=require("ac-event-emitter").EventEmitter,DOMEmitterEvent=require("./DOMEmitterEvent"),ac_dom_events={addEventListener:require("@marcom/ac-dom-events/addEventListener"),removeEventListener:require("@marcom/ac-dom-events/removeEventListener"),dispatchEvent:require("@marcom/ac-dom-events/dispatchEvent")},ac_dom_traversal={querySelectorAll:require("@marcom/ac-dom-traversal/querySelectorAll"),matchesSelector:require("@marcom/ac-dom-traversal/matchesSelector")};var internalEventPrefix="dom-emitter";function DOMEmitter(el){if(el===null){return}this.el=el;this._bindings={};this._delegateFuncs={};this._eventEmitter=new EventEmitter}proto=DOMEmitter.prototype;proto.on=function(){this._normalizeArgumentsAndCall(Array.prototype.slice.call(arguments,0),this._on);return this};proto.once=function(){this._normalizeArgumentsAndCall(Array.prototype.slice.call(arguments,0),this._once);return this};proto.off=function(){this._normalizeArgumentsAndCall(Array.prototype.slice.call(arguments,0),this._off);return this};proto.has=function(evt,callbackOrDelegateQuery,callbackOrContext,context){var delegateQuery,callback;if(typeof callbackOrDelegateQuery==="string"){delegateQuery=callbackOrDelegateQuery;callback=callbackOrContext}else{callback=callbackOrDelegateQuery;context=callbackOrContext}if(delegateQuery){var matchIdx=this._getDelegateFuncBindingIdx(evt,delegateQuery,callback,context,true);if(matchIdx>-1){return true}return false}if(this._eventEmitter&&this._eventEmitter.has.apply(this._eventEmitter,arguments)){return true}return false};proto.trigger=function(evts,dataOrDelegateQuery,doNotPropogateOrData,doNotPropogate){evts=this._parseEventNames(evts);evts=this._cleanStringData(evts);var delegateQuery,data,i,len=evts.length;if(typeof dataOrDelegateQuery==="string"){delegateQuery=this._cleanStringData(dataOrDelegateQuery);data=doNotPropogateOrData}else{data=dataOrDelegateQuery;doNotPropogate=doNotPropogateOrData}for(i=0;i<len;i++){this._triggerDOMEvents(evts[i],data,delegateQuery)}return this};proto.emitterTrigger=function(evts,data,doNotPropogate){if(!this._eventEmitter){return this}evts=this._parseEventNames(evts);evts=this._cleanStringData(evts);data=new DOMEmitterEvent(data,this);var i,len=evts.length;for(i=0;i<len;i++){this._eventEmitter.trigger(evts[i],data,doNotPropogate)}return this};proto.propagateTo=function(eventEmitter,prefix){this._eventEmitter.propagateTo(eventEmitter,prefix);return this};proto.stopPropagatingTo=function(eventEmitter){this._eventEmitter.stopPropagatingTo(eventEmitter);return this};proto.stopImmediatePropagation=function(){this._eventEmitter.stopImmediatePropagation();return this};proto.destroy=function(){this._triggerInternalEvent("willdestroy");this.off();var i;for(i in this){if(this.hasOwnProperty(i)){this[i]=null}}};proto._parseEventNames=function(evt){if(!evt){return[evt]}return evt.split(" ")};proto._onListenerEvent=function(evtName,e){var data=new DOMEmitterEvent(e,this);this._eventEmitter.trigger(evtName,data,false)};proto._setListener=function(evt){this._bindings[evt]=this._onListenerEvent.bind(this,evt);ac_dom_events.addEventListener(this.el,evt,this._bindings[evt])};proto._removeListener=function(evt){ac_dom_events.removeEventListener(this.el,evt,this._bindings[evt]);this._bindings[evt]=null};proto._triggerInternalEvent=function(evt,data){this.emitterTrigger(internalEventPrefix+":"+evt,data)};proto._normalizeArgumentsAndCall=function(argsArr,func){var binding={};if(argsArr.length===0){func.call(this,binding);return}if(typeof argsArr[0]==="string"||argsArr[0]===null){argsArr=this._cleanStringData(argsArr);binding.events=argsArr[0];if(typeof argsArr[1]==="string"){binding.delegateQuery=argsArr[1];binding.callback=argsArr[2];binding.context=argsArr[3]}else{binding.callback=argsArr[1];binding.context=argsArr[2]}func.call(this,binding);return}var i,splits,splitChar=":",obj=argsArr[0];for(i in obj){if(obj.hasOwnProperty(i)){binding={};splits=this._cleanStringData(i.split(splitChar));binding.events=splits[0];binding.delegateQuery=splits[1];binding.callback=obj[i];binding.context=argsArr[1];func.call(this,binding)}}};proto._registerDelegateFunc=function(evt,delegateQuery,callback,unboundCallback,context){var delegateFunc=this._delegateFunc.bind(this,evt,delegateQuery,callback,context);this._delegateFuncs[delegateQuery]=this._delegateFuncs[delegateQuery]||{};this._delegateFuncs[delegateQuery][evt]=this._delegateFuncs[delegateQuery][evt]||[];this._delegateFuncs[delegateQuery][evt].push({func:unboundCallback,context:context,delegateFunc:delegateFunc});return delegateFunc};proto._cleanStringData=function(arr){var isString=false;if(typeof arr==="string"){arr=[arr];isString=true}var result=[],i,val,valLen,spaceIdx,len=arr.length;for(i=0;i<len;i++){val=arr[i];if(typeof val==="string"){if(val===""||val===" "){continue}valLen=val.length;while(val[0]===" "){val=val.slice(1,valLen);valLen--}while(val[valLen-1]===" "){val=val.slice(0,valLen-1);valLen--}}result.push(val)}if(isString){return result[0]}return result};proto._unregisterDelegateFunc=function(evt,delegateQuery,unboundCallback,context){if(!this._delegateFuncs[delegateQuery]||!this._delegateFuncs[delegateQuery][evt]){return}var matchIdx=this._getDelegateFuncBindingIdx(evt,delegateQuery,unboundCallback,context),delegateFunc;if(matchIdx>-1){delegateFunc=this._delegateFuncs[delegateQuery][evt][matchIdx].delegateFunc;this._delegateFuncs[delegateQuery][evt].splice(matchIdx,1);if(this._delegateFuncs[delegateQuery][evt].length===0){this._delegateFuncs[delegateQuery][evt]=null}}return delegateFunc};proto._unregisterDelegateFuncs=function(evt,delegateQuery){if(!this._delegateFuncs[delegateQuery]){return}if(evt!==null&&!this._delegateFuncs[delegateQuery][evt]){return}if(evt===null){var i;for(i in this._delegateFuncs[delegateQuery]){if(this._delegateFuncs[delegateQuery].hasOwnProperty(i)){this._unbindDelegateFunc(i,delegateQuery)}}return}this._unbindDelegateFunc(evt,delegateQuery)};proto._unbindDelegateFunc=function(evt,delegateQuery){var binding,preRemoveLen,i=0;while(this._delegateFuncs[delegateQuery][evt]&&this._delegateFuncs[delegateQuery][evt][i]){binding=this._delegateFuncs[delegateQuery][evt][i];preRemoveLen=this._delegateFuncs[delegateQuery][evt][i].length;this._off({events:evt,delegateQuery:delegateQuery,callback:binding.func,context:binding.context});if(this._delegateFuncs[delegateQuery][evt]&&preRemoveLen===this._delegateFuncs[delegateQuery][evt].length){i++}}binding=preRemoveLen=null};proto._unregisterDelegateFuncsByEvent=function(evt){var i;for(i in this._delegateFuncs){if(this._delegateFuncs.hasOwnProperty(i)){this._unregisterDelegateFuncs(evt,i)}}};proto._delegateFunc=function(evt,delegateQuery,callback,context,e){if(this._targetHasDelegateAncestor(e.target,delegateQuery)){var args=Array.prototype.slice.call(arguments,0),unboundArgs=args.slice(4,args.length);context=context||window;if(typeof e.detail==="object"){unboundArgs[0]=e.detail}callback.apply(context,unboundArgs)}};proto._targetHasDelegateAncestor=function(target,delegateQuery){var ancestor=target;while(ancestor&&ancestor!==this.el&&ancestor!==document.documentElement){if(ac_dom_traversal.matchesSelector(ancestor,delegateQuery)){return true}ancestor=ancestor.parentNode}return false};proto._on=function(binding){var evts=binding.events,callback=binding.callback,delegateQuery=binding.delegateQuery,context=binding.context,unboundCallback=binding.unboundCallback||callback;evts=this._parseEventNames(evts);evts.forEach(function(callback,unboundCallback,context,delegateQuery,evt){if(!this.has(evt)){this._setListener(evt)}if(typeof delegateQuery==="string"){callback=this._registerDelegateFunc(evt,delegateQuery,callback,unboundCallback,context)}this._triggerInternalEvent("willon",{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});this._eventEmitter.on(evt,callback,context);this._triggerInternalEvent("didon",{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery})}.bind(this,callback,unboundCallback,context,delegateQuery));evts=callback=unboundCallback=delegateQuery=context=null};proto._off=function(binding){var evts=binding.events,callback=binding.callback,delegateQuery=binding.delegateQuery,context=binding.context,unboundCallback=binding.unboundCallback||callback;if(typeof evts==="undefined"){this._eventEmitter.off();var i;for(i in this._bindings){if(this._bindings.hasOwnProperty(i)){this._removeListener(i)}}for(i in this._delegateFuncs){if(this._delegateFuncs.hasOwnProperty(i)){this._delegateFuncs[i]=null}}return}evts=this._parseEventNames(evts);evts.forEach(function(callback,unboundCallback,context,delegateQuery,evt){if(typeof delegateQuery==="string"&&typeof unboundCallback==="function"){callback=this._unregisterDelegateFunc(evt,delegateQuery,unboundCallback,context);if(!callback){return}}if(typeof delegateQuery==="string"&&typeof callback==="undefined"){this._unregisterDelegateFuncs(evt,delegateQuery);return}if(typeof evt==="string"&&typeof callback==="undefined"){this._unregisterDelegateFuncsByEvent(evt);if(typeof delegateQuery==="string"){return}}this._triggerInternalEvent("willoff",{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});this._eventEmitter.off(evt,callback,context);this._triggerInternalEvent("didoff",{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});if(!this.has(evt)){this._removeListener(evt)}}.bind(this,callback,unboundCallback,context,delegateQuery));evts=callback=unboundCallback=delegateQuery=context=null};proto._once=function(binding){var evts=binding.events,callback=binding.callback,delegateQuery=binding.delegateQuery,context=binding.context;evts=this._parseEventNames(evts);evts.forEach(function(callback,context,delegateQuery,evt){if(typeof delegateQuery==="string"){return this._handleDelegateOnce(evt,callback,context,delegateQuery)}if(!this.has(evt)){this._setListener(evt)}this._triggerInternalEvent("willonce",{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});this._eventEmitter.once.call(this,evt,callback,context);this._triggerInternalEvent("didonce",{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery})}.bind(this,callback,context,delegateQuery));evts=callback=delegateQuery=context=null};proto._handleDelegateOnce=function(evt,callback,context,delegateQuery){this._triggerInternalEvent("willonce",{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});this._on({events:evt,context:context,delegateQuery:delegateQuery,callback:this._getDelegateOnceCallback.bind(this,evt,callback,context,delegateQuery),unboundCallback:callback});this._triggerInternalEvent("didonce",{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});return this};proto._getDelegateOnceCallback=function(evt,callback,context,delegateQuery){var args=Array.prototype.slice.call(arguments,0),passedArgs=args.slice(4,args.length);callback.apply(context,passedArgs);this._off({events:evt,delegateQuery:delegateQuery,callback:callback,context:context})};proto._getDelegateFuncBindingIdx=function(evt,delegateQuery,unboundCallback,context,ignoreFuncMatch){var idx=-1;if(this._delegateFuncs[delegateQuery]&&this._delegateFuncs[delegateQuery][evt]){var i,bindingObj,len=this._delegateFuncs[delegateQuery][evt].length;for(i=0;i<len;i++){bindingObj=this._delegateFuncs[delegateQuery][evt][i];if(ignoreFuncMatch&&typeof unboundCallback==="undefined"){unboundCallback=bindingObj.func}if(bindingObj.func===unboundCallback&&bindingObj.context===context){idx=i;break}}}return idx};proto._triggerDOMEvents=function(evt,data,delegateQuery){var targets=[this.el];if(delegateQuery){targets=ac_dom_traversal.querySelectorAll(delegateQuery,this.el)}var i,target,len=targets.length;for(i=0;i<len;i++){ac_dom_events.dispatchEvent(targets[i],evt,{bubbles:true,cancelable:true,detail:data})}};module.exports=DOMEmitter},{"./DOMEmitterEvent":53,"@marcom/ac-dom-events/addEventListener":54,"@marcom/ac-dom-events/dispatchEvent":55,"@marcom/ac-dom-events/removeEventListener":58,"@marcom/ac-dom-traversal/matchesSelector":96,"@marcom/ac-dom-traversal/querySelectorAll":98,"ac-event-emitter":369}],53:[function(require,module,exports){"use strict";var ac_dom_events={preventDefault:require("@marcom/ac-dom-events/preventDefault"),stopPropagation:require("@marcom/ac-dom-events/stopPropagation"),target:require("@marcom/ac-dom-events/target")};var proto;var DOMEmitterEvent=function(eventData,domEmitter){this._domEmitter=domEmitter;this.originalEvent=eventData||{};this._originalTarget=ac_dom_events.target(this.originalEvent);this.target=this._originalTarget||this._domEmitter.el;this.currentTarget=this._domEmitter.el;this.timeStamp=this.originalEvent.timeStamp||Date.now();if(this._isDOMEvent(this.originalEvent)){if(typeof this.originalEvent.detail==="object"){this.data=this.originalEvent.detail}}else if(eventData){this.data=this.originalEvent;this.originalEvent={}}};proto=DOMEmitterEvent.prototype;proto.preventDefault=function(){ac_dom_events.preventDefault(this.originalEvent)};proto.stopPropagation=function(){ac_dom_events.stopPropagation(this.originalEvent)};proto.stopImmediatePropagation=function(){if(this.originalEvent.stopImmediatePropagation){this.originalEvent.stopImmediatePropagation()}this._domEmitter.stopImmediatePropagation()};proto._isDOMEvent=function(e){if(this._originalTarget||document.createEvent!=="undefined"&&typeof CustomEvent!=="undefined"&&e instanceof CustomEvent){return true}return false};module.exports=DOMEmitterEvent},{"@marcom/ac-dom-events/preventDefault":57,"@marcom/ac-dom-events/stopPropagation":61,"@marcom/ac-dom-events/target":62}],54:[function(require,module,exports){"use strict";var addEventListenerUtil=require("./utils/addEventListener");var getEventType=require("./shared/getEventType");module.exports=function addEventListener(target,type,listener,useCapture){type=getEventType(target,type);return addEventListenerUtil(target,type,listener,useCapture)}},{"./shared/getEventType":59,"./utils/addEventListener":63}],55:[function(require,module,exports){"use strict";var dispatchEventUtil=require("./utils/dispatchEvent");var getEventType=require("./shared/getEventType");module.exports=function dispatchEvent(target,type,options){type=getEventType(target,type);return dispatchEventUtil(target,type,options)}},{"./shared/getEventType":59,"./utils/dispatchEvent":64}],56:[function(require,module,exports){"use strict";module.exports={addEventListener:require("./addEventListener"),dispatchEvent:require("./dispatchEvent"),preventDefault:require("./preventDefault"),removeEventListener:require("./removeEventListener"),stop:require("./stop"),stopPropagation:require("./stopPropagation"),target:require("./target")}},{"./addEventListener":54,"./dispatchEvent":55,"./preventDefault":57,"./removeEventListener":58,"./stop":60,"./stopPropagation":61,"./target":62}],57:[function(require,module,exports){"use strict";module.exports=function preventDefault(evt){evt=evt||window.event;if(evt.preventDefault){evt.preventDefault()}else{evt.returnValue=false}}},{}],58:[function(require,module,exports){"use strict";var removeEventListenerUtil=require("./utils/removeEventListener");var getEventType=require("./shared/getEventType");module.exports=function removeEventListener(target,type,listener,useCapture){type=getEventType(target,type);return removeEventListenerUtil(target,type,listener,useCapture)}},{"./shared/getEventType":59,"./utils/removeEventListener":65}],59:[function(require,module,exports){"use strict";var getPrefixedEventType=require("@marcom/ac-prefixer/getEventType");module.exports=function getEventType(target,type){var tagName;var prefixed;if("tagName"in target){tagName=target.tagName}else if(target===window){tagName="window"}else{tagName="document"}prefixed=getPrefixedEventType(type,tagName);if(prefixed){return prefixed}return type}},{"@marcom/ac-prefixer/getEventType":200}],60:[function(require,module,exports){"use strict";var stopPropagation=require("./stopPropagation");var preventDefault=require("./preventDefault");module.exports=function stop(evt){evt=evt||window.event;stopPropagation(evt);preventDefault(evt);evt.stopped=true;evt.returnValue=false}},{"./preventDefault":57,"./stopPropagation":61}],61:[function(require,module,exports){"use strict";module.exports=function stopPropagation(evt){evt=evt||window.event;if(evt.stopPropagation){evt.stopPropagation()}else{evt.cancelBubble=true}}},{}],62:[function(require,module,exports){"use strict";module.exports=function target(evt){evt=evt||window.event;return typeof evt.target!=="undefined"?evt.target:evt.srcElement}},{}],63:[function(require,module,exports){"use strict";module.exports=function addEventListener(target,type,listener,useCapture){if(target.addEventListener){target.addEventListener(type,listener,!!useCapture)}else{target.attachEvent("on"+type,listener)}return target}},{}],64:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/CustomEvent");module.exports=function dispatchEvent(target,type,options){var evt;if(target.dispatchEvent){if(options){evt=new CustomEvent(type,options)}else{evt=new CustomEvent(type)}target.dispatchEvent(evt)}else{evt=document.createEventObject();if(options&&"detail"in options){evt.detail=options.detail}target.fireEvent("on"+type,evt)}return target}},{"@marcom/ac-polyfills/CustomEvent":"@marcom/ac-polyfills/CustomEvent"}],65:[function(require,module,exports){"use strict";module.exports=function removeEventListener(target,type,listener,useCapture){if(target.removeEventListener){target.removeEventListener(type,listener,!!useCapture)}else{target.detachEvent("on"+type,listener)}return target}},{}],66:[function(require,module,exports){"use strict";var getBoundingClientRect=require("./utils/getBoundingClientRect");module.exports=function getContentDimensions(el,rendered){var scale=1;if(rendered){scale=getBoundingClientRect(el).width/el.offsetWidth}return{width:el.scrollWidth*scale,height:el.scrollHeight*scale}}},{"./utils/getBoundingClientRect":76}],67:[function(require,module,exports){"use strict";var getBoundingClientRect=require("./utils/getBoundingClientRect");module.exports=function getDimensions(el,rendered){var rect;if(rendered){rect=getBoundingClientRect(el);return{width:rect.width,height:rect.height}}return{width:el.offsetWidth,height:el.offsetHeight}}},{"./utils/getBoundingClientRect":76}],68:[function(require,module,exports){"use strict";var getDimensions=require("./getDimensions");var getBoundingClientRect=require("./utils/getBoundingClientRect");var getScrollX=require("./getScrollX");var getScrollY=require("./getScrollY");module.exports=function getPagePosition(el,rendered){var rect;var scrollX;var scrollY;var dimensions;if(rendered){rect=getBoundingClientRect(el);scrollX=getScrollX();scrollY=getScrollY();return{top:rect.top+scrollY,right:rect.right+scrollX,bottom:rect.bottom+scrollY,left:rect.left+scrollX}}dimensions=getDimensions(el,rendered);rect={top:el.offsetTop,left:el.offsetLeft,width:dimensions.width,height:dimensions.height};while(el=el.offsetParent){rect.top+=el.offsetTop;rect.left+=el.offsetLeft}return{top:rect.top,right:rect.left+rect.width,bottom:rect.top+rect.height,left:rect.left}}},{"./getDimensions":67,"./getScrollX":72,"./getScrollY":73,"./utils/getBoundingClientRect":76}],69:[function(require,module,exports){"use strict";var getDimensions=require("./getDimensions");var getPixelsInViewport=require("./getPixelsInViewport");module.exports=function getPercentInViewport(el,rendered){var inViewport=getPixelsInViewport(el,rendered);var height=getDimensions(el,rendered).height;return inViewport/height}},{"./getDimensions":67,"./getPixelsInViewport":70}],70:[function(require,module,exports){"use strict";var getViewportPosition=require("./getViewportPosition");module.exports=function getPixelsInViewport(el,rendered){var vh=document.documentElement.clientHeight;var position=getViewportPosition(el,rendered);var pixels;if(position.top>=vh||position.bottom<=0){return 0}pixels=position.bottom-position.top;if(position.top<0){pixels+=position.top}if(position.bottom>vh){pixels-=position.bottom-vh}return pixels}},{"./getViewportPosition":74}],71:[function(require,module,exports){"use strict";var getDimensions=require("./getDimensions");var getBoundingClientRect=require("./utils/getBoundingClientRect");module.exports=function getPosition(el,rendered){var rect;var parentRect;var dimensions;if(rendered){rect=getBoundingClientRect(el);if(el.offsetParent){parentRect=getBoundingClientRect(el.offsetParent);rect.top-=parentRect.top;rect.left-=parentRect.left}}else{dimensions=getDimensions(el,rendered);rect={top:el.offsetTop,left:el.offsetLeft,width:dimensions.width,height:dimensions.height}}return{top:rect.top,right:rect.left+rect.width,bottom:rect.top+rect.height,left:rect.left}}},{"./getDimensions":67,"./utils/getBoundingClientRect":76}],72:[function(require,module,exports){"use strict";module.exports=function getScrollX(el){var offset;el=el||window;if(el===window){offset=window.pageXOffset;if(!offset){el=document.documentElement||document.body.parentNode||document.body}else{return offset}}return el.scrollLeft}},{}],73:[function(require,module,exports){"use strict";module.exports=function getScrollY(el){var offset;el=el||window;if(el===window){offset=window.pageYOffset;if(!offset){el=document.documentElement||document.body.parentNode||document.body}else{return offset}}return el.scrollTop}},{}],74:[function(require,module,exports){"use strict";var getPagePosition=require("./getPagePosition");var getBoundingClientRect=require("./utils/getBoundingClientRect");var getScrollX=require("./getScrollX");var getScrollY=require("./getScrollY");module.exports=function getViewportPosition(el,rendered){var position;var scrollX;var scrollY;if(rendered){position=getBoundingClientRect(el);return{top:position.top,right:position.right,bottom:position.bottom,left:position.left}}position=getPagePosition(el);scrollX=getScrollX();scrollY=getScrollY();return{top:position.top-scrollY,right:position.right-scrollX,bottom:position.bottom-scrollY,left:position.left-scrollX}}},{"./getPagePosition":68,"./getScrollX":72,"./getScrollY":73,"./utils/getBoundingClientRect":76}],75:[function(require,module,exports){"use strict";var getPixelsInViewport=require("./getPixelsInViewport");var getPercentInViewport=require("./getPercentInViewport");module.exports=function isInViewport(el,rendered,threshold){var inViewport;threshold=threshold||0;if(typeof threshold==="string"&&threshold.slice(-2)==="px"){threshold=parseInt(threshold,10);inViewport=getPixelsInViewport(el,rendered)}else{inViewport=getPercentInViewport(el,rendered)}return inViewport>0&&inViewport>=threshold}},{"./getPercentInViewport":69,"./getPixelsInViewport":70}],76:[function(require,module,exports){"use strict";module.exports=function getBoundingClientRect(el){var rect=el.getBoundingClientRect();return{top:rect.top,right:rect.right,bottom:rect.bottom,left:rect.left,width:rect.width||rect.right-rect.left,height:rect.height||rect.bottom-rect.top}}},{}],77:[function(require,module,exports){"use strict";module.exports=8},{}],78:[function(require,module,exports){"use strict";module.exports=11},{}],79:[function(require,module,exports){"use strict";module.exports=9},{}],80:[function(require,module,exports){"use strict";module.exports=1},{}],81:[function(require,module,exports){"use strict";module.exports=3},{}],82:[function(require,module,exports){"use strict";var isNode=require("../isNode");module.exports=function isNodeType(node,nodeType){if(!isNode(node)){return false}if(typeof nodeType==="number"){return node.nodeType===nodeType}return nodeType.indexOf(node.nodeType)!==-1}},{"../isNode":86}],83:[function(require,module,exports){"use strict";var isNodeType=require("./isNodeType");var COMMENT_NODE=require("../COMMENT_NODE");var DOCUMENT_FRAGMENT_NODE=require("../DOCUMENT_FRAGMENT_NODE");var ELEMENT_NODE=require("../ELEMENT_NODE");var TEXT_NODE=require("../TEXT_NODE");var VALID_INSERT_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_INSERT_NODE=" must be an Element, TextNode, Comment, or Document Fragment";var VALID_CHILD_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE];var ERR_INVALID_CHILD_NODE=" must be an Element, TextNode, or Comment";var VALID_PARENT_NODE=[ELEMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_PARENT_NODE=" must be an Element, or Document Fragment";var ERR_NO_PARENT_NODE=" must have a parentNode";module.exports={parentNode:function(node,required,funcName,paramName){paramName=paramName||"target";if((node||required)&&!isNodeType(node,VALID_PARENT_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_PARENT_NODE)}},childNode:function(node,required,funcName,paramName){paramName=paramName||"target";if(!node&&!required){return}if(!isNodeType(node,VALID_CHILD_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_CHILD_NODE)}},insertNode:function(node,required,funcName,paramName){paramName=paramName||"node";if(!node&&!required){return}if(!isNodeType(node,VALID_INSERT_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_INSERT_NODE)}},hasParentNode:function(node,funcName,paramName){paramName=paramName||"target";if(!node.parentNode){throw new TypeError(funcName+": "+paramName+ERR_NO_PARENT_NODE)}}}},{"../COMMENT_NODE":77,"../DOCUMENT_FRAGMENT_NODE":78,"../ELEMENT_NODE":80,"../TEXT_NODE":81,"./isNodeType":82}],84:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var DOCUMENT_FRAGMENT_NODE=require("./DOCUMENT_FRAGMENT_NODE");module.exports=function isDocumentFragment(obj){return isNodeType(obj,DOCUMENT_FRAGMENT_NODE)}},{"./DOCUMENT_FRAGMENT_NODE":78,"./internal/isNodeType":82}],85:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var ELEMENT_NODE=require("./ELEMENT_NODE");module.exports=function isElement(obj){return isNodeType(obj,ELEMENT_NODE)}},{"./ELEMENT_NODE":80,"./internal/isNodeType":82}],86:[function(require,module,exports){"use strict";module.exports=function isNode(obj){return!!(obj&&obj.nodeType)}},{}],87:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function remove(node){validate.childNode(node,true,"remove");if(!node.parentNode){return node}return node.parentNode.removeChild(node)}},{"./internal/validate":83}],88:[function(require,module,exports){"use strict";module.exports={getStyle:require("./getStyle"),setStyle:require("./setStyle")}},{"./getStyle":89,"./setStyle":91}],89:[function(require,module,exports){"use strict";var getStyleProperty=require("@marcom/ac-prefixer/getStyleProperty");var stripPrefixes=require("@marcom/ac-prefixer/stripPrefixes");module.exports=function getStyle(){var properties=Array.prototype.slice.call(arguments);var target=properties.shift(properties);var computed=window.getComputedStyle(target);var styles={};var property;var prefixed;var value;var i;if(typeof properties[0]!=="string"){properties=properties[0]}for(i=0;i<properties.length;i++){property=properties[i];prefixed=getStyleProperty(property);if(prefixed){property=stripPrefixes(prefixed);value=computed[prefixed];if(!value||value==="auto"){value=null}if(value){value=stripPrefixes(value)}}else{value=null}styles[property]=value}return styles}},{"@marcom/ac-prefixer/getStyleProperty":202,"@marcom/ac-prefixer/stripPrefixes":210}],90:[function(require,module,exports){"use strict";module.exports=function normalizeValue(value){var combined;var partials;var i;if(!value&&value!==0){return""}if(Array.isArray(value)){return value+""}if(typeof value==="object"){combined="";partials=Object.keys(value);for(i=0;i<partials.length;i++){combined+=partials[i]+"("+value[partials[i]]+") "}return combined.trim()}return value}},{}],91:[function(require,module,exports){"use strict";var getStyleCSS=require("@marcom/ac-prefixer/getStyleCSS");var getStyleProperty=require("@marcom/ac-prefixer/getStyleProperty");var normalizeValue=require("./internal/normalizeValue");module.exports=function setStyle(target,styles){var cssText="";var cssRule;var property;var domProperty;var value;var targetCSSText;if(typeof styles!=="object"){throw new TypeError("setStyle: styles must be an Object")}for(property in styles){value=normalizeValue(styles[property]);if(!value&&value!==0){domProperty=getStyleProperty(property);if("removeAttribute"in target.style){target.style.removeAttribute(domProperty)}else{target.style[domProperty]=""}}else{cssRule=getStyleCSS(property,value);if(cssRule!==false){cssText+=" "+cssRule}}}if(cssText.length){targetCSSText=target.style.cssText;if(targetCSSText.charAt(targetCSSText.length-1)!==";"){targetCSSText+=";"}targetCSSText+=cssText;target.style.cssText=targetCSSText}return target}},{"./internal/normalizeValue":90,"@marcom/ac-prefixer/getStyleCSS":201,"@marcom/ac-prefixer/getStyleProperty":202}],92:[function(require,module,exports){"use strict";var isElement=require("@marcom/ac-dom-nodes/isElement");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function ancestor(node,selector,inclusive,context){validate.childNode(node,true,"ancestors");validate.selector(selector,false,"ancestors");if(inclusive&&isElement(node)&&(!selector||matchesSelector(node,selector))){return node}context=context||document.body;if(node!==context){while((node=node.parentNode)&&isElement(node)){if(!selector||matchesSelector(node,selector)){return node}if(node===context){break}}}return null}},{"./internal/validate":95,"./matchesSelector":96,"@marcom/ac-dom-nodes/isElement":85}],93:[function(require,module,exports){"use strict";var isElement=require("@marcom/ac-dom-nodes/isElement");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function ancestors(node,selector,inclusive,context){var els=[];validate.childNode(node,true,"ancestors");validate.selector(selector,false,"ancestors");if(inclusive&&isElement(node)&&(!selector||matchesSelector(node,selector))){els.push(node)}context=context||document.body;if(node!==context){while((node=node.parentNode)&&isElement(node)){if(!selector||matchesSelector(node,selector)){els.push(node)}if(node===context){break}}}return els}},{"./internal/validate":95,"./matchesSelector":96,"@marcom/ac-dom-nodes/isElement":85}],94:[function(require,module,exports){"use strict";module.exports=window.Element?function(proto){return proto.matches||proto.matchesSelector||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector}(Element.prototype):null},{}],95:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.indexOf");var isNode=require("@marcom/ac-dom-nodes/isNode");var COMMENT_NODE=require("@marcom/ac-dom-nodes/COMMENT_NODE");var DOCUMENT_FRAGMENT_NODE=require("@marcom/ac-dom-nodes/DOCUMENT_FRAGMENT_NODE");var DOCUMENT_NODE=require("@marcom/ac-dom-nodes/DOCUMENT_NODE");var ELEMENT_NODE=require("@marcom/ac-dom-nodes/ELEMENT_NODE");var TEXT_NODE=require("@marcom/ac-dom-nodes/TEXT_NODE");var isNodeType=function(node,nodeType){if(!isNode(node)){return false}if(typeof nodeType==="number"){return node.nodeType===nodeType}return nodeType.indexOf(node.nodeType)!==-1};var VALID_PARENT_NODE=[ELEMENT_NODE,DOCUMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_PARENT_NODE=" must be an Element, Document, or Document Fragment";var VALID_CHILD_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE];var ERR_INVALID_CHILD_NODE=" must be an Element, TextNode, or Comment";var ERR_INVALID_SELECTOR=" must be a string";module.exports={parentNode:function(node,required,funcName,paramName){paramName=paramName||"node";if((node||required)&&!isNodeType(node,VALID_PARENT_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_PARENT_NODE)}},childNode:function(node,required,funcName,paramName){paramName=paramName||"node";if(!node&&!required){return}if(!isNodeType(node,VALID_CHILD_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_CHILD_NODE)}},selector:function(selector,required,funcName,paramName){paramName=paramName||"selector";if((selector||required)&&typeof selector!=="string"){throw new TypeError(funcName+": "+paramName+ERR_INVALID_SELECTOR)}}}},{"@marcom/ac-dom-nodes/COMMENT_NODE":77,"@marcom/ac-dom-nodes/DOCUMENT_FRAGMENT_NODE":78,"@marcom/ac-dom-nodes/DOCUMENT_NODE":79,"@marcom/ac-dom-nodes/ELEMENT_NODE":80,"@marcom/ac-dom-nodes/TEXT_NODE":81,"@marcom/ac-dom-nodes/isNode":86,"@marcom/ac-polyfills/Array/prototype.indexOf":"@marcom/ac-polyfills/Array/prototype.indexOf"}],96:[function(require,module,exports){"use strict";var isElement=require("@marcom/ac-dom-nodes/isElement");var validate=require("./internal/validate");var nativeMatches=require("./internal/nativeMatches");var matchesSelectorShim=require("./shims/matchesSelector");module.exports=function matchesSelector(node,selector){validate.selector(selector,true,"matchesSelector");if(!isElement(node)){return false}if(!nativeMatches){return matchesSelectorShim(node,selector)}return nativeMatches.call(node,selector)}},{"./internal/nativeMatches":94,"./internal/validate":95,"./shims/matchesSelector":99,"@marcom/ac-dom-nodes/isElement":85}],97:[function(require,module,exports){"use strict";var validate=require("./internal/validate");var querySelectorShim=require("./shims/querySelector");var querySelectorAvailable="querySelector"in document;module.exports=function querySelector(selector,context){context=context||document;validate.parentNode(context,true,"querySelector","context");validate.selector(selector,true,"querySelector");if(!querySelectorAvailable){return querySelectorShim(selector,context)}return context.querySelector(selector)}},{"./internal/validate":95,"./shims/querySelector":100}],98:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.slice");var validate=require("./internal/validate");var querySelectorAllShim=require("./shims/querySelectorAll");var querySelectorAllAvailable="querySelectorAll"in document;module.exports=function querySelectorAll(selector,context){context=context||document;validate.parentNode(context,true,"querySelectorAll","context");validate.selector(selector,true,"querySelectorAll");if(!querySelectorAllAvailable){return querySelectorAllShim(selector,context)}return Array.prototype.slice.call(context.querySelectorAll(selector))}},{"./internal/validate":95,"./shims/querySelectorAll":101,"@marcom/ac-polyfills/Array/prototype.slice":"@marcom/ac-polyfills/Array/prototype.slice"}],99:[function(require,module,exports){"use strict";var querySelectorAll=require("../querySelectorAll");module.exports=function matchesSelector(node,selector){var context=node.parentNode||document;var nodes=querySelectorAll(selector,context);var i;for(i=0;i<nodes.length;i++){if(nodes[i]===node){return true}}return false}},{"../querySelectorAll":98}],100:[function(require,module,exports){"use strict";var querySelectorAll=require("./querySelectorAll");module.exports=function querySelector(selector,context){var allResults=querySelectorAll(selector,context);return allResults.length?allResults[0]:null}},{"./querySelectorAll":101}],101:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.indexOf");var isElement=require("@marcom/ac-dom-nodes/isElement");var isDocumentFragment=require("@marcom/ac-dom-nodes/isDocumentFragment");var removeElement=require("@marcom/ac-dom-nodes/remove");var COLLECTION_PREFIX="_ac_qsa_";var isElementInContext=function(el,context){var parent;if(context===document){return true}parent=el;while((parent=parent.parentNode)&&isElement(parent)){if(parent===context){return true}}return false};var recalcStyles=function(context){if("recalc"in context){context.recalc(false)}else{document.recalc(false)}window.scrollBy(0,0)};module.exports=function querySelectorAll(selector,context){var style=document.createElement("style");var id=COLLECTION_PREFIX+(Math.random()+"").slice(-6);var els=[];var el;context=context||document;document[id]=[];if(isDocumentFragment(context)){context.appendChild(style)}else{document.documentElement.firstChild.appendChild(style)}style.styleSheet.cssText="*{display:recalc;}"+selector+'{ac-qsa:expression(document["'+id+'"] && document["'+id+'"].push(this));}';recalcStyles(context);while(document[id].length){el=document[id].shift();el.style.removeAttribute("ac-qsa");if(els.indexOf(el)===-1&&isElementInContext(el,context)){els.push(el)}}document[id]=null;removeElement(style);recalcStyles(context);return els}},{"@marcom/ac-dom-nodes/isDocumentFragment":84,"@marcom/ac-dom-nodes/isElement":85,"@marcom/ac-dom-nodes/remove":87,"@marcom/ac-polyfills/Array/prototype.indexOf":"@marcom/ac-polyfills/Array/prototype.indexOf"}],102:[function(require,module,exports){"use strict";module.exports={createBezier:require("./ac-easing/createBezier"),createPredefined:require("./ac-easing/createPredefined"),createStep:require("./ac-easing/createStep"),Ease:require("./ac-easing/Ease")}},{"./ac-easing/Ease":103,"./ac-easing/createBezier":104,"./ac-easing/createPredefined":105,"./ac-easing/createStep":106}],103:[function(require,module,exports){"use strict";var ERR_FUNCTION_REQUIRE="Ease expects an easing function.";function Ease(func,cssString){if(typeof func!=="function"){throw new TypeError(ERR_FUNCTION_REQUIRE)}this.easingFunction=func;this.cssString=cssString||null}var proto=Ease.prototype;proto.getValue=function(value){return this.easingFunction(value,0,1,1)};module.exports=Ease},{}],104:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.every");var Ease=require("./Ease");var KeySpline=require("./helpers/KeySpline");var ERR_BEZIER_VALUES="Bezier curve expects exactly four (4) numbers. Given: ";module.exports=function createBezier(x1,y1,x2,y2){var pts=Array.prototype.slice.call(arguments);var allNums=pts.every(function(pt){return typeof pt==="number"});if(pts.length!==4||!allNums){throw new TypeError(ERR_BEZIER_VALUES+pts)}var keySpline=new KeySpline(x1,y1,x2,y2);var easingFn=function(time,begin,change,duration){return keySpline.get(time/duration)*change+begin};var cssString="cubic-bezier("+pts.join(", ")+")";return new Ease(easingFn,cssString)}},{"./Ease":103,"./helpers/KeySpline":107,"@marcom/ac-polyfills/Array/prototype.every":"@marcom/ac-polyfills/Array/prototype.every"}],105:[function(require,module,exports){"use strict";var createStep=require("./createStep");var cssAliases=require("./helpers/cssAliases");var easingFunctions=require("./helpers/easingFunctions");var Ease=require("./Ease");var ERR_PREDEFINED='Easing function "%TYPE%" not recognized among the following: '+Object.keys(easingFunctions).join(", ");module.exports=function createPredefined(type){var easingFn;if(type==="step-start"){return createStep(1,"start")}else if(type==="step-end"){return createStep(1,"end")}else{easingFn=easingFunctions[type]}if(!easingFn){throw new Error(ERR_PREDEFINED.replace("%TYPE%",type))}return new Ease(easingFn,cssAliases[type])}},{"./Ease":103,"./createStep":106,"./helpers/cssAliases":108,"./helpers/easingFunctions":109}],106:[function(require,module,exports){"use strict";var Ease=require("./Ease");var ERR_STEP_TYPE="Step function expects a numeric value greater than zero. Given: ";var ERR_STEP_DIRECTION='Step function direction must be either "start" or "end" (default). Given: ';module.exports=function createStep(steps,direction){direction=direction||"end";if(typeof steps!=="number"||steps<1){throw new TypeError(ERR_STEP_TYPE+steps)}if(direction!=="start"&&direction!=="end"){throw new TypeError(ERR_STEP_DIRECTION+direction)}var easingFn=function(time,begin,change,duration){var length=change/steps;var step=Math[direction==="start"?"floor":"ceil"](time/duration*steps);return begin+length*step};var cssString="steps("+steps+", "+direction+")";return new Ease(easingFn,cssString)}},{"./Ease":103}],107:[function(require,module,exports){function KeySpline(mX1,mY1,mX2,mY2){this.get=function(aX){if(mX1===mY1&&mX2===mY2){return aX}return CalcBezier(GetTForX(aX),mY1,mY2)};function A(aA1,aA2){return 1-3*aA2+3*aA1}function B(aA1,aA2){return 3*aA2-6*aA1}function C(aA1){return 3*aA1}function CalcBezier(aT,aA1,aA2){return((A(aA1,aA2)*aT+B(aA1,aA2))*aT+C(aA1))*aT}function GetSlope(aT,aA1,aA2){return 3*A(aA1,aA2)*aT*aT+2*B(aA1,aA2)*aT+C(aA1)}function GetTForX(aX){var aGuessT=aX;for(var i=0;i<4;++i){var currentSlope=GetSlope(aGuessT,mX1,mX2);if(currentSlope===0){return aGuessT}var currentX=CalcBezier(aGuessT,mX1,mX2)-aX;aGuessT-=currentX/currentSlope}return aGuessT}}module.exports=KeySpline},{}],108:[function(require,module,exports){"use strict";var aliases={linear:"cubic-bezier(0, 0, 1, 1)",ease:"cubic-bezier(0.25, 0.1, 0.25, 1)","ease-in":"cubic-bezier(0.42, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.58, 1)","ease-in-out":"cubic-bezier(0.42, 0, 0.58, 1)","ease-in-cubic":"cubic-bezier(0.55, 0.055, 0.675, 0.19)","ease-out-cubic":"cubic-bezier(0.215, 0.61, 0.355, 1)","ease-in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1)","ease-in-quad":"cubic-bezier(0.55, 0.085, 0.68, 0.53)","ease-out-quad":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","ease-in-out-quad":"cubic-bezier(0.455, 0.03, 0.515, 0.955)","ease-in-quart":"cubic-bezier(0.895, 0.03, 0.685, 0.22)","ease-out-quart":"cubic-bezier(0.165, 0.84, 0.44, 1)","ease-in-out-quart":"cubic-bezier(0.77, 0, 0.175, 1)","ease-in-quint":"cubic-bezier(0.755, 0.05, 0.855, 0.06)","ease-out-quint":"cubic-bezier(0.23, 1, 0.32, 1)","ease-in-out-quint":"cubic-bezier(0.86, 0, 0.07, 1)","ease-in-sine":"cubic-bezier(0.47, 0, 0.745, 0.715)","ease-out-sine":"cubic-bezier(0.39, 0.575, 0.565, 1)","ease-in-out-sine":"cubic-bezier(0.445, 0.05, 0.55, 0.95)","ease-in-expo":"cubic-bezier(0.95, 0.05, 0.795, 0.035)","ease-out-expo":"cubic-bezier(0.19, 1, 0.22, 1)","ease-in-out-expo":"cubic-bezier(1, 0, 0, 1)","ease-in-circ":"cubic-bezier(0.6, 0.04, 0.98, 0.335)","ease-out-circ":"cubic-bezier(0.075, 0.82, 0.165, 1)","ease-in-out-circ":"cubic-bezier(0.785, 0.135, 0.15, 0.86)","ease-in-back":"cubic-bezier(0.6, -0.28, 0.735, 0.045)","ease-out-back":"cubic-bezier(0.175, 0.885, 0.32, 1.275)","ease-in-out-back":"cubic-bezier(0.68, -0.55, 0.265, 1.55)"};aliases["easeIn"]=aliases["ease-in"];aliases["easeOut"]=aliases["ease-out"];aliases["easeInOut"]=aliases["ease-in-out"];aliases["easeInCubic"]=aliases["ease-in-cubic"];aliases["easeOutCubic"]=aliases["ease-out-cubic"];aliases["easeInOutCubic"]=aliases["ease-in-out-cubic"];aliases["easeInQuad"]=aliases["ease-in-quad"];aliases["easeOutQuad"]=aliases["ease-out-quad"];aliases["easeInOutQuad"]=aliases["ease-in-out-quad"];aliases["easeInQuart"]=aliases["ease-in-quart"];aliases["easeOutQuart"]=aliases["ease-out-quart"];aliases["easeInOutQuart"]=aliases["ease-in-out-quart"];aliases["easeInQuint"]=aliases["ease-in-quint"];aliases["easeOutQuint"]=aliases["ease-out-quint"];aliases["easeInOutQuint"]=aliases["ease-in-out-quint"];aliases["easeInSine"]=aliases["ease-in-sine"];aliases["easeOutSine"]=aliases["ease-out-sine"];aliases["easeInOutSine"]=aliases["ease-in-out-sine"];aliases["easeInExpo"]=aliases["ease-in-expo"];aliases["easeOutExpo"]=aliases["ease-out-expo"];aliases["easeInOutExpo"]=aliases["ease-in-out-expo"];aliases["easeInCirc"]=aliases["ease-in-circ"];aliases["easeOutCirc"]=aliases["ease-out-circ"];aliases["easeInOutCirc"]=aliases["ease-in-out-circ"];aliases["easeInBack"]=aliases["ease-in-back"];aliases["easeOutBack"]=aliases["ease-out-back"];aliases["easeInOutBack"]=aliases["ease-in-out-back"];module.exports=aliases},{}],109:[function(require,module,exports){"use strict";var createBezier=require("../createBezier");var ease=createBezier(.25,.1,.25,1).easingFunction;var easeIn=createBezier(.42,0,1,1).easingFunction;var easeOut=createBezier(0,0,.58,1).easingFunction;var easeInOut=createBezier(.42,0,.58,1).easingFunction;var linear=function(time,begin,change,duration){return change*time/duration+begin};var easeInQuad=function(time,begin,change,duration){return change*(time/=duration)*time+begin};var easeOutQuad=function(time,begin,change,duration){return-change*(time/=duration)*(time-2)+begin};var easeInOutQuad=function(time,begin,change,duration){if((time/=duration/2)<1){return change/2*time*time+begin}return-change/2*(--time*(time-2)-1)+begin};var easeInCubic=function(time,begin,change,duration){return change*(time/=duration)*time*time+begin};var easeOutCubic=function(time,begin,change,duration){return change*((time=time/duration-1)*time*time+1)+begin};var easeInOutCubic=function(time,begin,change,duration){if((time/=duration/2)<1){return change/2*time*time*time+begin}return change/2*((time-=2)*time*time+2)+begin};var easeInQuart=function(time,begin,change,duration){return change*(time/=duration)*time*time*time+begin};var easeOutQuart=function(time,begin,change,duration){return-change*((time=time/duration-1)*time*time*time-1)+begin};var easeInOutQuart=function(time,begin,change,duration){if((time/=duration/2)<1){return change/2*time*time*time*time+begin}return-change/2*((time-=2)*time*time*time-2)+begin};var easeInQuint=function(time,begin,change,duration){return change*(time/=duration)*time*time*time*time+begin};var easeOutQuint=function(time,begin,change,duration){return change*((time=time/duration-1)*time*time*time*time+1)+begin};var easeInOutQuint=function(time,begin,change,duration){if((time/=duration/2)<1){return change/2*time*time*time*time*time+begin}return change/2*((time-=2)*time*time*time*time+2)+begin};var easeInSine=function(time,begin,change,duration){return-change*Math.cos(time/duration*(Math.PI/2))+change+begin};var easeOutSine=function(time,begin,change,duration){return change*Math.sin(time/duration*(Math.PI/2))+begin};var easeInOutSine=function(time,begin,change,duration){return-change/2*(Math.cos(Math.PI*time/duration)-1)+begin};var easeInExpo=function(time,begin,change,duration){return time===0?begin:change*Math.pow(2,10*(time/duration-1))+begin};var easeOutExpo=function(time,begin,change,duration){return time===duration?begin+change:change*(-Math.pow(2,-10*time/duration)+1)+begin};var easeInOutExpo=function(time,begin,change,duration){if(time===0){return begin}else if(time===duration){return begin+change}else if((time/=duration/2)<1){return change/2*Math.pow(2,10*(time-1))+begin}return change/2*(-Math.pow(2,-10*--time)+2)+begin};var easeInCirc=function(time,begin,change,duration){return-change*(Math.sqrt(1-(time/=duration)*time)-1)+begin};var easeOutCirc=function(time,begin,change,duration){return change*Math.sqrt(1-(time=time/duration-1)*time)+begin};var easeInOutCirc=function(time,begin,change,duration){if((time/=duration/2)<1){return-change/2*(Math.sqrt(1-time*time)-1)+begin}return change/2*(Math.sqrt(1-(time-=2)*time)+1)+begin};var easeInElastic=function(time,begin,change,duration){var shootover=1.70158;var period=0;var amplitude=change;if(time===0){return begin}else if((time/=duration)===1){return begin+change}if(!period){period=duration*.3}if(amplitude<Math.abs(change)){amplitude=change;shootover=period/4}else{shootover=period/(2*Math.PI)*Math.asin(change/amplitude)}return-(amplitude*Math.pow(2,10*(time-=1))*Math.sin((time*duration-shootover)*(2*Math.PI)/period))+begin};var easeOutElastic=function(time,begin,change,duration){var shootover=1.70158;var period=0;var amplitude=change;if(time===0){return begin}else if((time/=duration)===1){return begin+change}if(!period){period=duration*.3}if(amplitude<Math.abs(change)){amplitude=change;shootover=period/4}else{shootover=period/(2*Math.PI)*Math.asin(change/amplitude)}return amplitude*Math.pow(2,-10*time)*Math.sin((time*duration-shootover)*(2*Math.PI)/period)+change+begin};var easeInOutElastic=function(time,begin,change,duration){var shootover=1.70158;var period=0;var amplitude=change;if(time===0){return begin}else if((time/=duration/2)===2){return begin+change}if(!period){period=duration*(.3*1.5)}if(amplitude<Math.abs(change)){amplitude=change;shootover=period/4}else{shootover=period/(2*Math.PI)*Math.asin(change/amplitude)}if(time<1){return-.5*(amplitude*Math.pow(2,10*(time-=1))*Math.sin((time*duration-shootover)*(2*Math.PI)/period))+begin}return amplitude*Math.pow(2,-10*(time-=1))*Math.sin((time*duration-shootover)*(2*Math.PI)/period)*.5+change+begin};var easeInBack=function(time,begin,change,duration,shootover){if(shootover===undefined){shootover=1.70158}return change*(time/=duration)*time*((shootover+1)*time-shootover)+begin};var easeOutBack=function(time,begin,change,duration,shootover){if(shootover===undefined){shootover=1.70158}return change*((time=time/duration-1)*time*((shootover+1)*time+shootover)+1)+begin};var easeInOutBack=function(time,begin,change,duration,shootover){if(shootover===undefined){shootover=1.70158}if((time/=duration/2)<1){return change/2*(time*time*(((shootover*=1.525)+1)*time-shootover))+begin}return change/2*((time-=2)*time*(((shootover*=1.525)+1)*time+shootover)+2)+begin};var easeOutBounce=function(time,begin,change,duration){if((time/=duration)<1/2.75){return change*(7.5625*time*time)+begin}else if(time<2/2.75){return change*(7.5625*(time-=1.5/2.75)*time+.75)+begin}else if(time<2.5/2.75){return change*(7.5625*(time-=2.25/2.75)*time+.9375)+begin}return change*(7.5625*(time-=2.625/2.75)*time+.984375)+begin};var easeInBounce=function(time,begin,change,duration){return change-easeOutBounce(duration-time,0,change,duration)+begin};var easeInOutBounce=function(time,begin,change,duration){if(time<duration/2){return easeInBounce(time*2,0,change,duration)*.5+begin}return easeOutBounce(time*2-duration,0,change,duration)*.5+change*.5+begin};module.exports={linear:linear,ease:ease,easeIn:easeIn,"ease-in":easeIn,easeOut:easeOut,"ease-out":easeOut,easeInOut:easeInOut,"ease-in-out":easeInOut,easeInCubic:easeInCubic,"ease-in-cubic":easeInCubic,easeOutCubic:easeOutCubic,"ease-out-cubic":easeOutCubic,easeInOutCubic:easeInOutCubic,"ease-in-out-cubic":easeInOutCubic,easeInQuad:easeInQuad,"ease-in-quad":easeInQuad,easeOutQuad:easeOutQuad,"ease-out-quad":easeOutQuad,easeInOutQuad:easeInOutQuad,"ease-in-out-quad":easeInOutQuad,easeInQuart:easeInQuart,"ease-in-quart":easeInQuart,easeOutQuart:easeOutQuart,"ease-out-quart":easeOutQuart,easeInOutQuart:easeInOutQuart,"ease-in-out-quart":easeInOutQuart,easeInQuint:easeInQuint,"ease-in-quint":easeInQuint,easeOutQuint:easeOutQuint,"ease-out-quint":easeOutQuint,easeInOutQuint:easeInOutQuint,"ease-in-out-quint":easeInOutQuint,easeInSine:easeInSine,"ease-in-sine":easeInSine,easeOutSine:easeOutSine,"ease-out-sine":easeOutSine,easeInOutSine:easeInOutSine,"ease-in-out-sine":easeInOutSine,easeInExpo:easeInExpo,"ease-in-expo":easeInExpo,easeOutExpo:easeOutExpo,"ease-out-expo":easeOutExpo,easeInOutExpo:easeInOutExpo,"ease-in-out-expo":easeInOutExpo,easeInCirc:easeInCirc,"ease-in-circ":easeInCirc,easeOutCirc:easeOutCirc,"ease-out-circ":easeOutCirc,easeInOutCirc:easeInOutCirc,"ease-in-out-circ":easeInOutCirc,easeInBack:easeInBack,"ease-in-back":easeInBack,easeOutBack:easeOutBack,"ease-out-back":easeOutBack,easeInOutBack:easeInOutBack,"ease-in-out-back":easeInOutBack,easeInElastic:easeInElastic,"ease-in-elastic":easeInElastic,easeOutElastic:easeOutElastic,"ease-out-elastic":easeOutElastic,easeInOutElastic:easeInOutElastic,"ease-in-out-elastic":easeInOutElastic,easeInBounce:easeInBounce,"ease-in-bounce":easeInBounce,easeOutBounce:easeOutBounce,"ease-out-bounce":easeOutBounce,easeInOutBounce:easeInOutBounce,"ease-in-out-bounce":easeInOutBounce}},{"../createBezier":104}],110:[function(require,module,exports){"use strict";require("./helpers/Float32Array");var transitionEnd=require("./helpers/transitionEnd");var Clip=require("@marcom/ac-clip").Clip;var ClipEasing=require("./clips/ClipEasing");var ClipInlineCss=require("./clips/ClipInlineCss");var ClipTransitionCss=require("./clips/ClipTransitionCss");function ClipFactory(target,duration,propsTo,options){if(target.nodeType){if(transitionEnd===undefined||options&&options.inlineStyles){return new ClipInlineCss(target,duration,propsTo,options)}return new ClipTransitionCss(target,duration,propsTo,options)}return new ClipEasing(target,duration,propsTo,options)}for(var prop in Clip){if(typeof Clip[prop]==="function"&&prop.substr(0,1)!=="_"){ClipFactory[prop]=Clip[prop].bind(Clip)}}ClipFactory.to=function(target,duration,propsTo,options){options=options||{};if(options.destroyOnComplete===undefined){options.destroyOnComplete=true}return new ClipFactory(target,duration,propsTo,options).play()};ClipFactory.from=function(target,duration,propsFrom,options){options=options||{};options.propsFrom=propsFrom;if(options.destroyOnComplete===undefined){options.destroyOnComplete=true}return new ClipFactory(target,duration,options.propsTo,options).play()};module.exports=ClipFactory},{"./clips/ClipEasing":113,"./clips/ClipInlineCss":114,"./clips/ClipTransitionCss":115,"./helpers/Float32Array":118,"./helpers/transitionEnd":127,"@marcom/ac-clip":25}],111:[function(require,module,exports){"use strict";module.exports=require("./timeline/Timeline")},{"./timeline/Timeline":129}],112:[function(require,module,exports){"use strict";module.exports={Clip:require("./Clip"),Timeline:require("./Timeline")}},{"./Clip":110,"./Timeline":111}],113:[function(require,module,exports){"use strict";var clone=require("@marcom/ac-object/clone");var create=require("@marcom/ac-object/create");var createPredefined=require("@marcom/ac-easing").createPredefined;var isCssCubicBezierString=require("../helpers/isCssCubicBezierString");var BezierCurveCssManager=require("../helpers/BezierCurveCssManager");var Clip=require("@marcom/ac-clip").Clip;var Ease=require("@marcom/ac-easing").Ease;function ClipEasing(target,duration,propsTo,options){if(options&&isCssCubicBezierString(options.ease)){options.ease=BezierCurveCssManager.create(options.ease).toEasingFunction()}options=options||{};this._propsEase=options.propsEase||{};Clip.call(this,target,duration,propsTo,options)}var Super=Clip.prototype;var proto=ClipEasing.prototype=create(Super);proto.reset=function(){var returnValue=Super.reset.call(this);if(this._clips){var i=this._clips.length;while(i--){this._clips[i].reset()}}return returnValue};proto.destroy=function(){if(this._clips){var i=this._clips.length;while(i--){this._clips[i].destroy()}this._clips=null}this._eases=null;this._storeOnUpdate=null;return Super.destroy.call(this)};proto._prepareProperties=function(){var easeCount=0;var groupsTo={};var groupsFrom={};var eases={};var prop;var ease;if(this._propsEase){for(prop in this._propsTo){if(this._propsTo.hasOwnProperty(prop)){ease=this._propsEase[prop];if(isCssCubicBezierString(ease)){ease=BezierCurveCssManager.create(ease).toEasingFunction()}if(ease===undefined){if(groupsTo[this._ease]===undefined){groupsTo[this._ease]={};groupsFrom[this._ease]={};eases[this._ease]=this._ease.easingFunction;easeCount++}groupsTo[this._ease][prop]=this._propsTo[prop];groupsFrom[this._ease][prop]=this._propsFrom[prop]}else if(typeof ease==="function"){groupsTo[easeCount]={};groupsFrom[easeCount]={};groupsTo[easeCount][prop]=this._propsTo[prop];groupsFrom[easeCount][prop]=this._propsFrom[prop];eases[easeCount]=ease;easeCount++}else{if(groupsTo[ease]===undefined){groupsTo[ease]={};groupsFrom[ease]={};eases[ease]=ease;easeCount++}groupsTo[ease][prop]=this._propsTo[prop];groupsFrom[ease][prop]=this._propsFrom[prop]}}}if(easeCount>1){var optionsClone=clone(this._options||{},true);var duration=this._duration*.001;this._storeOnUpdate=this._onUpdate;this._onUpdate=this._onUpdateClips;optionsClone.onStart=null;optionsClone.onUpdate=null;optionsClone.onDraw=null;optionsClone.onComplete=null;this._clips=[];for(ease in groupsTo){if(groupsTo.hasOwnProperty(ease)){optionsClone.ease=eases[ease];optionsClone.propsFrom=groupsFrom[ease];this._clips.push(new Clip(this._target,duration,groupsTo[ease],optionsClone))}}ease="linear";this._propsTo={};this._propsFrom={}}else{for(prop in eases){if(eases.hasOwnProperty(prop)){ease=eases[prop]}}}if(ease!==undefined){this._ease=typeof ease==="function"?new Ease(ease):createPredefined(ease)}}return Super._prepareProperties.call(this)};proto._onUpdateClips=function(clip){var progress=this._direction===1?clip.progress():1-clip.progress();var i=this._clips.length;while(i--){this._clips[i].progress(progress)}if(typeof this._storeOnUpdate==="function"){this._storeOnUpdate.call(this,this)}};module.exports=ClipEasing},{"../helpers/BezierCurveCssManager":117,"../helpers/isCssCubicBezierString":123,"@marcom/ac-clip":25,"@marcom/ac-easing":102,"@marcom/ac-object/clone":185,"@marcom/ac-object/create":186}],114:[function(require,module,exports){"use strict";var setStyle=require("@marcom/ac-dom-styles/setStyle");var convertToStyleObject=require("../helpers/convertToStyleObject");var convertToTransitionableObjects=require("../helpers/convertToTransitionableObjects");var create=require("@marcom/ac-object/create");var removeTransitions=require("../helpers/removeTransitions");var ClipEasing=require("./ClipEasing");function ClipInlineCss(target,duration,propsTo,options){options=options||{};this._el=target;this._storeOnStart=options.onStart||null;this._storeOnDraw=options.onDraw||null;this._storeOnComplete=options.onComplete||null;options.onStart=this._onStart;options.onDraw=this._onDraw;options.onComplete=this._onComplete;ClipEasing.call(this,{},duration,propsTo,options)}var Super=ClipEasing.prototype;var proto=ClipInlineCss.prototype=create(Super);proto.play=function(){var returnValue=Super.play.call(this);if(this._remainingDelay!==0){setStyle(this._el,convertToStyleObject(this._target))}return returnValue};proto.reset=function(){var returnValue=Super.reset.call(this);setStyle(this._el,convertToStyleObject(this._target));return returnValue};proto.destroy=function(){this._el=null;this._completeStyles=null;this._storeOnStart=null;this._storeOnDraw=null;this._storeOnComplete=null;return Super.destroy.call(this)};proto.target=function(){return this._el};proto._prepareProperties=function(){var converted=convertToTransitionableObjects(this._el,this._propsTo,this._propsFrom);this._target=converted.target;this._propsFrom=converted.propsFrom;this._propsTo=converted.propsTo;removeTransitions(this._el,this._target);var completeStyles=this._isYoyo?this._propsFrom:this._propsTo;this._completeStyles=convertToStyleObject(completeStyles);if(this._options.removeStylesOnComplete!==undefined){var prop;var removeStyles=this._options.removeStylesOnComplete;if(typeof removeStyles==="boolean"&&removeStyles){for(prop in this._completeStyles){if(this._completeStyles.hasOwnProperty(prop)){this._completeStyles[prop]=null}}}else if(typeof removeStyles==="object"&&removeStyles.length){var i=removeStyles.length;while(i--){prop=removeStyles[i];if(this._completeStyles.hasOwnProperty(prop)){this._completeStyles[prop]=null}}}}return Super._prepareProperties.call(this)};proto._onStart=function(clip){if(this.playing()&&this._direction===1&&this._delay===0){setStyle(this._el,convertToStyleObject(this._propsFrom))}if(typeof this._storeOnStart==="function"){this._storeOnStart.call(this,this)}};proto._onDraw=function(clip){setStyle(this._el,convertToStyleObject(this._target));if(typeof this._storeOnDraw==="function"){this._storeOnDraw.call(this,this)}};proto._onComplete=function(clip){setStyle(this._el,this._completeStyles);if(typeof this._storeOnComplete==="function"){this._storeOnComplete.call(this,this)}};module.exports=ClipInlineCss},{"../helpers/convertToStyleObject":120,"../helpers/convertToTransitionableObjects":121,"../helpers/removeTransitions":124,"./ClipEasing":113,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-object/create":186}],115:[function(require,module,exports){"use strict";var setStyle=require("@marcom/ac-dom-styles/setStyle");var getStyle=require("@marcom/ac-dom-styles/getStyle");var convertToStyleObject=require("../helpers/convertToStyleObject");var convertToTransitionableObjects=require("../helpers/convertToTransitionableObjects");var clone=require("@marcom/ac-object/clone");var create=require("@marcom/ac-object/create");var createPredefined=require("@marcom/ac-easing").createPredefined;var isCssCubicBezierString=require("../helpers/isCssCubicBezierString");var removeTransitions=require("../helpers/removeTransitions");var transitionEnd=require("../helpers/transitionEnd");var waitAnimationFrames=require("../helpers/waitAnimationFrames");var BezierCurveCssManager=require("../helpers/BezierCurveCssManager");var Clip=require("@marcom/ac-clip").Clip;var ClipEasing=require("./ClipEasing");var PageVisibilityManager=require("@marcom/ac-page-visibility").PageVisibilityManager;var DEFAULT_EASE="ease";var ERROR_EASE_NOT_SUPPORTED="%EASE% is not a supported predefined ease when transitioning with Elements "+"and CSS transition. If you need to use %EASE% then pass the inlineStyle:true option.";var ERROR_EASE_IS_FUNCTION="Function eases are not supported when using CSS transitions with Elements. "+"Either use a cubic-bezier string (e.g. 'cubic-bezier(0, 0, 1, 1)' or pass the "+"inlineStyle option as `true` to render styles each frame instead of using CSS transitions.";function ClipTransitionCss(target,duration,propsTo,options){options=options||{};this._el=target;this._storeEase=options.ease;if(typeof this._storeEase==="function"){throw new Error(ERROR_EASE_IS_FUNCTION)}this._storeOnStart=options.onStart||null;this._storeOnComplete=options.onComplete||null;options.onStart=this._onStart.bind(this);options.onComplete=this._onComplete.bind(this);this._stylesTo=clone(propsTo,true);this._stylesFrom=options.propsFrom?clone(options.propsFrom,true):{};this._propsEase=options.propsEase?clone(options.propsEase,true):{};if(isCssCubicBezierString(options.ease)){options.ease=BezierCurveCssManager.create(options.ease).toEasingFunction()}Clip.call(this,{},duration,{},options);this._propsFrom={}}var Super=Clip.prototype;var proto=ClipTransitionCss.prototype=create(Super);proto.play=function(){var returnValue=Super.play.call(this);if(this._direction===1&&this.progress()===0&&this._remainingDelay!==0){this._applyStyles(0,convertToStyleObject(this._stylesFrom))}return returnValue};proto.reset=function(){var returnValue=Super.reset.call(this);this._stylesClip.reset();this._applyStyles(0,convertToStyleObject(this._styles));return returnValue};proto.destroy=function(){PageVisibilityManager.off("changed",this._onVisibilityChanged);this._removeTransitionListener();this.off("pause",this._onPaused);this._onPaused();this._stylesClip.destroy();this._stylesClip=null;this._el=null;this._propsArray=null;this._styles=null;this._stylesFrom=null;this._stylesTo=null;this._completeStyles=null;this._storeOnStart=null;this._storeOnComplete=null;this._onTransitionEnded=null;return Super.destroy.call(this)};proto.target=function(){return this._el};proto.duration=function(duration){var returnValue=Super.duration.call(this,duration);if(duration===undefined){return returnValue}if(this.playing()){this.progress(this._progress)}return returnValue};proto.progress=function(progress){var returnValue=Super.progress.call(this,progress);if(progress===undefined){return returnValue}progress=this._direction===1?progress:1-progress;this._stylesClip.progress(progress);this._applyStyles(0,convertToStyleObject(this._styles));if(this.playing()){this._isWaitingForStylesToBeApplied=true;waitAnimationFrames(this._setStylesAfterWaiting,2)}return returnValue};proto._prepareProperties=function(){var converted=convertToTransitionableObjects(this._el,this._stylesTo,this._stylesFrom);this._styles=converted.target;this._stylesTo=converted.propsTo;this._stylesFrom=converted.propsFrom;var ease=this._storeEase||DEFAULT_EASE;this._eases={};this._propsArray=[];var convertedEase;this._styleCompleteTo=convertToStyleObject(this._stylesTo);this._styleCompleteFrom=convertToStyleObject(this._stylesFrom);this._propsEaseKeys={};var prop;for(prop in this._stylesTo){if(this._stylesTo.hasOwnProperty(prop)){this._propsArray[this._propsArray.length]=prop;if(this._propsEase[prop]===undefined){if(this._eases[ease]===undefined){convertedEase=this._convertEase(ease);this._eases[ease]=convertedEase.css}this._propsEaseKeys[prop]=ease}else if(this._eases[this._propsEase[prop]]===undefined){convertedEase=this._convertEase(this._propsEase[prop]);this._eases[this._propsEase[prop]]=convertedEase.css;this._propsEaseKeys[prop]=this._propsEase[prop];this._propsEase[prop]=convertedEase.js}else if(isCssCubicBezierString(this._propsEase[prop])){this._propsEaseKeys[prop]=this._propsEase[prop];this._propsEase[prop]=this._eases[this._propsEase[prop]]["1"].toEasingFunction()}}}this._onPaused=this._onPaused.bind(this);this.on("pause",this._onPaused);this._setOtherTransitions();this._currentTransitionStyles=this._otherTransitions;this._completeStyles=convertToStyleObject(this._isYoyo?this._stylesFrom:this._stylesTo);if(this._options.removeStylesOnComplete!==undefined){var removeStyles=this._options.removeStylesOnComplete;if(typeof removeStyles==="boolean"&&removeStyles){for(prop in this._stylesTo){this._completeStyles[prop]=null}}else if(typeof removeStyles==="object"&&removeStyles.length){var i=removeStyles.length;while(i--){this._completeStyles[removeStyles[i]]=null}}}this._onTransitionEnded=this._onTransitionEnded.bind(this);this._setStylesAfterWaiting=this._setStylesAfterWaiting.bind(this);this._onVisibilityChanged=this._onVisibilityChanged.bind(this);PageVisibilityManager.on(PageVisibilityManager.CHANGED,this._onVisibilityChanged);this._stylesClip=new ClipEasing(this._styles,1,this._stylesTo,{ease:this._options.ease,propsFrom:this._stylesFrom,propsEase:this._options.propsEase});Clip._remove(this._stylesClip);return Super._prepareProperties.call(this)};proto._convertEase=function(ease){if(typeof ease==="function"){throw new Error(ERROR_EASE_IS_FUNCTION)}var bezierCurve;var jsEase;if(isCssCubicBezierString(ease)){bezierCurve=BezierCurveCssManager.create(ease);jsEase=bezierCurve.toEasingFunction()}else{var predefinedEase=createPredefined(ease);if(predefinedEase.cssString===null){throw new Error(ERROR_EASE_NOT_SUPPORTED.replace(/%EASE%/g,ease))}bezierCurve=BezierCurveCssManager.create(predefinedEase.cssString);jsEase=ease}return{css:{1:bezierCurve,"-1":bezierCurve.reversed()},js:jsEase}};proto._complete=function(){if((this._isWaitingForStylesToBeApplied||this._isTransitionEnded||!this._isListeningForTransitionEnd)&&this.progress()===1){this._isWaitingForStylesToBeApplied=false;Super._complete.call(this)}};proto._onTransitionEnded=function(){this._isTransitionEnded=true;this._complete()};proto._addTransitionListener=function(){if(!this._isListeningForTransitionEnd&&this._el&&this._onTransitionEnded){this._isListeningForTransitionEnd=true;this._isTransitionEnded=false;this._el.addEventListener(transitionEnd,this._onTransitionEnded)}};proto._removeTransitionListener=function(){if(this._isListeningForTransitionEnd&&this._el&&this._onTransitionEnded){this._isListeningForTransitionEnd=false;this._isTransitionEnded=false;this._el.removeEventListener(transitionEnd,this._onTransitionEnded)}};proto._applyStyles=function(duration,styles){if(duration>0){var transition="";var eases={};var prop;for(prop in this._eases){if(this._eases.hasOwnProperty(prop)){eases[prop]=this._eases[prop][this._direction].splitAt(this.progress()).toCSSString()}}for(prop in this._stylesTo){if(this._stylesTo.hasOwnProperty(prop)){transition+=prop+" "+duration+"ms "+eases[this._propsEaseKeys[prop]]+" 0ms, "}}this._currentTransitionStyles=transition.substr(0,transition.length-2);if(!this._doStylesMatchCurrentStyles(styles)){this._addTransitionListener()}else{this._removeTransitionListener()}}else{this._currentTransitionStyles="";this._removeTransitionListener()}styles["transition"]=this._getOtherClipTransitionStyles()+this._currentTransitionStyles;setStyle(this._el,styles)};proto._doStylesMatchCurrentStyles=function(newStyles){var currentStyles=getStyle.apply(this,[this._el].concat([this._propsArray]));var style;for(style in newStyles){if(newStyles.hasOwnProperty(style)&&currentStyles.hasOwnProperty(style)&&newStyles[style]!==currentStyles[style]){return false}}return true};proto._setStylesAfterWaiting=function(){this._isWaitingForStylesToBeApplied=false;if(this.playing()){var duration=this._durationMs*(1-this.progress());var styles=this._direction>0?this._styleCompleteTo:this._styleCompleteFrom;this._applyStyles(duration,styles)}};proto._setOtherTransitions=function(){removeTransitions(this._el,this._stylesTo);var clips=Clip.getAll(this._el);var i=clips.length;while(i--){if(clips[i]!==this&&clips[i].playing()&&clips[i]._otherTransitions&&clips[i]._otherTransitions.length){this._otherTransitions=clips[i]._otherTransitions;return}}this._otherTransitions=getStyle(this._el,"transition").transition;if(this._otherTransitions===null||this._otherTransitions==="all 0s ease 0s"){this._otherTransitions=""}};proto._getTransitionStyles=function(){var transition=this._getOtherClipTransitionStyles();if(this._otherTransitions.length){transition+=this._otherTransitions}else if(transition.length){transition=transition.substr(0,transition.length-2)}return transition};proto._getOtherClipTransitionStyles=function(){var transition="";var clips=Clip.getAll(this._el);var i=clips.length;while(i--){if(clips[i]!==this&&clips[i].playing()&&clips[i]._currentTransitionStyles&&clips[i]._currentTransitionStyles.length){transition+=clips[i]._currentTransitionStyles+", "}}return transition};proto._onVisibilityChanged=function(evt){if(this.playing()&&!evt.isHidden){this._update({timeNow:this._getTime()});var progress=this.progress();if(progress<1){this.progress(progress)}}};proto._onPaused=function(clip){var styles=getStyle.apply(this,[this._el].concat([this._propsArray]));styles["transition"]=this._getTransitionStyles();this._removeTransitionListener();setStyle(this._el,styles)};proto._onStart=function(clip){var waitFrames=this._direction===1&&this.progress()===0&&this._delay===0?2:0;if(waitFrames){this._isWaitingForStylesToBeApplied=true;this._applyStyles(0,this._styleCompleteFrom)}waitAnimationFrames(this._setStylesAfterWaiting,waitFrames);if(typeof this._storeOnStart==="function"){this._storeOnStart.call(this,this)}};proto._onComplete=function(clip){this._removeTransitionListener();this._completeStyles["transition"]=this._getTransitionStyles();setStyle(this._el,this._completeStyles);if(typeof this._storeOnComplete==="function"){this._storeOnComplete.call(this,this)}};module.exports=ClipTransitionCss},{"../helpers/BezierCurveCssManager":117,"../helpers/convertToStyleObject":120,"../helpers/convertToTransitionableObjects":121,"../helpers/isCssCubicBezierString":123,"../helpers/removeTransitions":124,"../helpers/transitionEnd":127,"../helpers/waitAnimationFrames":128,"./ClipEasing":113,"@marcom/ac-clip":25,"@marcom/ac-dom-styles/getStyle":89,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-easing":102,"@marcom/ac-object/clone":185,"@marcom/ac-object/create":186,"@marcom/ac-page-visibility":194}],116:[function(require,module,exports){"use strict";var createBezier=require("@marcom/ac-easing").createBezier;function BezierCurveCss(curve,manager){this.manager=manager;this.p1={x:curve[0],y:curve[1]};this.p2={x:curve[2],y:curve[3]};this._isLinear=this.p1.x===this.p1.y&&this.p2.x===this.p2.y;this._cacheSplits={}}var proto=BezierCurveCss.prototype;proto.splitAt=function(percent){if(this._isLinear){return this}percent=Math.round(percent*40)/40;if(percent===0){return this}else if(this._cacheSplits[percent]!==undefined){return this._cacheSplits[percent]}var x=[this.p1.x,this.p2.x];var y=[this.p1.y,this.p2.y];var maxIterations=0;var targetX=percent;var min=0;var max=1;var startX=this._getStartX(percent,x);while(targetX!==startX&&maxIterations<1e3){if(targetX<startX){max=percent}else{min=percent}percent=min+(max-min)*.5;startX=this._getStartX(percent,x);++maxIterations}var split=this._splitBezier(percent,x,y);var normalized=this._normalize(split);var newBezierCurve=this.manager.create(normalized);this._cacheSplits[targetX]=newBezierCurve;return newBezierCurve};proto.reversed=function(){var arr=this.toArray();return this.manager.create([.5-(arr[2]-.5),.5-(arr[3]-.5),.5-(arr[0]-.5),.5-(arr[1]-.5)])};proto.toArray=function(){return[this.p1.x,this.p1.y,this.p2.x,this.p2.y]};proto.toCSSString=function(){return"cubic-bezier("+this.p1.x+", "+this.p1.y+", "+this.p2.x+", "+this.p2.y+")"};proto.toEasingFunction=function(){return createBezier.apply(this,this.toArray()).easingFunction};proto._getStartX=function(p,x){var cp=p-1;var p2=p*p;var cp2=cp*cp;var p3=p2*p;return p3-3*p2*cp*x[1]+3*p*cp2*x[0]};proto._splitBezier=function(p,x,y){var cp=p-1;var p2=p*p;var cp2=cp*cp;var p3=p2*p;return[p3-3*p2*cp*x[1]+3*p*cp2*x[0],p3-3*p2*cp*y[1]+3*p*cp2*y[0],p2-2*p*cp*x[1]+cp2*x[0],p2-2*p*cp*y[1]+cp2*y[0],p-cp*x[1],p-cp*y[1]]};proto._normalize=function(array){return[(array[2]-array[0])/(1-array[0]),(array[3]-array[1])/(1-array[1]),(array[4]-array[0])/(1-array[0]),(array[5]-array[1])/(1-array[1])]};module.exports=BezierCurveCss},{"@marcom/ac-easing":102}],117:[function(require,module,exports){"use strict";var BezierCurveCss=require("./BezierCurveCss");function BezierCurveCssManager(){this._instances={}}var proto=BezierCurveCssManager.prototype;proto.create=function(curve){var key;if(typeof curve==="string"){key=curve.replace(/ /g,"")}else{key="cubic-bezier("+curve.join(",")+")"}if(this._instances[key]===undefined){if(typeof curve==="string"){curve=curve.match(/\d*\.?\d+/g);var i=curve.length;while(i--){curve[i]=Number(curve[i])}}this._instances[key]=new BezierCurveCss(curve,this)}return this._instances[key]};module.exports=new BezierCurveCssManager},{"./BezierCurveCss":116}],118:[function(require,module,exports){"use strict";if(typeof window.Float32Array==="undefined"){window.Float32Array=function(){}}},{}],119:[function(require,module,exports){"use strict";var getDimensions=require("@marcom/ac-dom-metrics/getDimensions");var splitUnits=require("./splitUnits");var percentagePropToDimention={translateX:"width",translateY:"height"};function TransformMatrix(transform,el,styles){this._transform=transform;var split;var value;var prop;for(prop in styles){if(styles.hasOwnProperty(prop)&&typeof this._transform[prop]==="function"){split=splitUnits(styles[prop]);if(split.unit==="%"){value=this._convertPercentToPixelValue(prop,split.value,el)}else{value=split.value}this._transform[prop].call(this._transform,value)}}}var proto=TransformMatrix.prototype;proto._convertPercentToPixelValue=function(prop,value,el){prop=percentagePropToDimention[prop];var dimentions=getDimensions(el);if(dimentions[prop]){value*=.01;return dimentions[prop]*value}return value};proto.toArray=function(){return this._transform.toArray()};proto.toCSSString=function(){return this._transform.toCSSString()};module.exports=TransformMatrix},{"./splitUnits":125,"@marcom/ac-dom-metrics/getDimensions":67}],120:[function(require,module,exports){"use strict";module.exports=function convertToStyleObject(target){var styles={};var matrix;var prop;for(prop in target){if(target.hasOwnProperty(prop)&&target[prop]!==null){if(target[prop].isColor){if(target[prop].isRgb){styles[prop]="rgb("+Math.round(target[prop].r)+", "+Math.round(target[prop].g)+", "+Math.round(target[prop].b)+")"}else if(target[prop].isRgba){styles[prop]="rgba("+Math.round(target[prop].r)+", "+Math.round(target[prop].g)+", "+Math.round(target[prop].b)+", "+target[prop].a+")"}}else if(prop==="transform"){matrix=target[prop].length===6?"matrix":"matrix3d";styles[prop]=matrix+"("+target[prop].join(",")+")"}else if(!target[prop].unit){styles[prop]=target[prop].value}else{styles[prop]=target[prop].value+target[prop].unit}}}return styles}},{}],121:[function(require,module,exports){"use strict";var getStyle=require("@marcom/ac-dom-styles/getStyle");var clone=require("@marcom/ac-object/clone");var splitUnits=require("./splitUnits");var toCamCase=require("./toCamCase");var Color=require("@marcom/ac-color").Color;var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");var Transform=require("@marcom/ac-transform").Transform;var TransformMatrix=require("./TransformMatrix");var toColorObject=function(color){if(Color.isRgba(color)){color=new Color(color).rgbaObject();color["isRgba"]=true}else{color=new Color(color).rgbObject();color["isRgb"]=true}color["isColor"]=true;return color};var convertRgbToRgbaObject=function(obj){if(obj.isRgb){obj.isRgb=false;obj.isRgba=true;obj.a=1}};var standardizeColors=function(target,propsFrom,propsTo){if(target.isRgba||propsFrom.isRgba||propsTo.isRgba){convertRgbToRgbaObject(target);convertRgbToRgbaObject(propsFrom);convertRgbToRgbaObject(propsTo)}};var convertMatrixTo3d=function(matrix){return[matrix[0],matrix[1],0,0,matrix[2],matrix[3],0,0,0,0,1,0,matrix[4],matrix[5],0,1]};var standardizeMatrices=function(target,propsFrom,propsTo){if(target["transform"].length===16||propsFrom["transform"].length===16||propsTo["transform"].length===16){if(target["transform"].length===6){target["transform"]=convertMatrixTo3d(target["transform"])}if(propsFrom["transform"].length===6){propsFrom["transform"]=convertMatrixTo3d(propsFrom["transform"])}if(propsTo["transform"].length===6){propsTo["transform"]=convertMatrixTo3d(propsTo["transform"])}}};module.exports=function convertToTransitionableObjects(el,propsTo,propsFrom){var target={};propsTo=clone(propsTo,true);propsFrom=clone(propsFrom,true);var style;var mTarget;var mTo;var mFrom;var isTransformSupported=cssPropertyAvailable("transform");var prop;for(prop in propsTo){if(propsTo.hasOwnProperty(prop)&&propsTo[prop]!==null){if(prop==="transform"){if(isTransformSupported){mTarget=new Transform;style=getStyle(el,"transform")["transform"]||"none";mTarget.setMatrixValue(style);mTo=new TransformMatrix(new Transform,el,propsTo[prop])}if(mTo&&mTo.toCSSString()!==mTarget.toCSSString()){mFrom=new TransformMatrix(propsFrom[prop]?new Transform:mTarget.clone(),el,propsFrom[prop]);target[prop]=mTarget.toArray();propsTo[prop]=mTo.toArray();propsFrom[prop]=mFrom.toArray()}else{target[prop]=null;propsTo[prop]=null}}else{style=getStyle(el,prop)[toCamCase(prop)]||propsFrom[prop];if(Color.isColor(style)){target[prop]=toColorObject(style);propsFrom[prop]=propsFrom[prop]!==undefined?toColorObject(propsFrom[prop]):clone(target[prop],true);propsTo[prop]=toColorObject(propsTo[prop])}else{target[prop]=splitUnits(style);propsFrom[prop]=propsFrom[prop]!==undefined?splitUnits(propsFrom[prop]):clone(target[prop],true);propsTo[prop]=splitUnits(propsTo[prop])}}}}for(prop in propsFrom){if(propsFrom.hasOwnProperty(prop)&&propsFrom[prop]!==null&&(propsTo[prop]===undefined||propsTo[prop]===null)){if(prop==="transform"){if(isTransformSupported){mTarget=new Transform;mTarget.setMatrixValue(getComputedStyle(el).transform||getComputedStyle(el).webkitTransform||"none");mFrom=new TransformMatrix(new Transform,el,propsFrom[prop])}if(mFrom&&mFrom.toCSSString()!==mTarget.toCSSString()){mTo=new TransformMatrix(mTarget.clone());target[prop]=mTarget.toArray();propsTo[prop]=mTo.toArray();propsFrom[prop]=mFrom.toArray()}else{target[prop]=null;propsTo[prop]=null;propsFrom[prop]=null}}else{style=getStyle(el,prop)[toCamCase(prop)];if(Color.isColor(style)){target[prop]=toColorObject(style);propsTo[prop]=clone(target[prop],true);propsFrom[prop]=toColorObject(propsFrom[prop])}else{target[prop]=splitUnits(style);propsFrom[prop]=splitUnits(propsFrom[prop]);propsTo[prop]=clone(target[prop],true)}}}if(target[prop]&&target[prop].isColor){standardizeColors(target[prop],propsFrom[prop],propsTo[prop])}}if(target["transform"]){standardizeMatrices(target,propsFrom,propsTo)}return{target:target,propsTo:propsTo,propsFrom:propsFrom}}},{"./TransformMatrix":119,"./splitUnits":125,"./toCamCase":126,"@marcom/ac-color":31,"@marcom/ac-dom-styles/getStyle":89,"@marcom/ac-feature/cssPropertyAvailable":138,"@marcom/ac-object/clone":185,"@marcom/ac-transform":266}],122:[function(require,module,exports){"use strict";module.exports=function getShorthandTransition(styles){if(styles.transitionProperty){var transition="";var props=styles.transitionProperty.split(", ");var duration=styles.transitionDuration.split(", ");var ease=styles.transitionTimingFunction.replace(/\d+[,]+[\s]/gi,function(match){return match.substr(0,match.length-1)}).split(", ");var delay=styles.transitionDelay.split(", ");var i=props.length;while(i--){transition+=props[i]+" "+duration[i]+" "+ease[i]+" "+delay[i]+", "}return transition.substr(0,transition.length-2)}return false}},{}],123:[function(require,module,exports){"use strict";module.exports=function isCssCubicBezierString(str){return typeof str==="string"&&str.substr(0,13)==="cubic-bezier("}},{}],124:[function(require,module,exports){"use strict";var setStyle=require("@marcom/ac-dom-styles/setStyle");var getStyle=require("@marcom/ac-dom-styles/getStyle");var getShorthandTransition=require("./getShorthandTransition");module.exports=function removeTransitions(el,propsTo){var transition=getStyle(el,"transition","transition-property","transition-duration","transition-timing-function","transition-delay");transition=transition.transition||getShorthandTransition(transition);if(transition&&transition.length){transition=transition.split(",");var deleteCount=0;var prop;var i=transition.length;while(i--){prop=transition[i].trim().split(" ")[0];if(propsTo[prop]!==undefined){transition.splice(i,1);++deleteCount}}if(deleteCount){if(transition.length===0){transition=["all"]}setStyle(el,{transition:transition.join(",").trim()})}}}},{"./getShorthandTransition":122,"@marcom/ac-dom-styles/getStyle":89,"@marcom/ac-dom-styles/setStyle":91}],125:[function(require,module,exports){"use strict";module.exports=function splitUnits(value){value=String(value);if(value.indexOf(" ")>-1){throw new Error("Shorthand CSS is not supported. Please use longhand CSS only.")}var regex=/(\d*\.?\d*)(.*)/;var multipler=1;if(value&&value.substr(0,1)==="-"){value=value.substr(1);multipler=-1}var match=String(value).match(regex);return{value:Number(match[1])*multipler,unit:match[2]}}},{}],126:[function(require,module,exports){"use strict";module.exports=function toCamCase(str){var camelCaseReplace=function(match,group,offset,string){return offset===0&&string.substr(1,3)!=="moz"?group:group.toUpperCase()};return str.replace(/-(\w)/g,camelCaseReplace)}},{}],127:[function(require,module,exports){"use strict";var transitionEnd;module.exports=function transitionEndEvent(){if(transitionEnd){return transitionEnd}var t;var el=document.createElement("fakeelement");var transitions={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in transitions){if(el.style[t]!==undefined){transitionEnd=transitions[t];return transitionEnd}}}()},{}],128:[function(require,module,exports){"use strict";var PageVisibilityManager=require("@marcom/ac-page-visibility").PageVisibilityManager;module.exports=function waitAnimationFrames(callback,frames){if(frames){var rAF=function(cb){if(PageVisibilityManager.isHidden){setTimeout(cb,16)}else{window.requestAnimationFrame(cb)}};var count=0;var waitFunc=function(){if(count===frames){callback.call(this)}else{++count;rAF(waitFunc)}};waitFunc()}else{callback.call(this)}}},{"@marcom/ac-page-visibility":194}],129:[function(require,module,exports){"use strict";var create=require("@marcom/ac-object/create");var Clip=require("@marcom/ac-clip").Clip;var TimelineClip=require("./TimelineClip");var TimelineCallback=require("./TimelineCallback");var TimelineItemList=require("./TimelineItemList");var superProto=Clip.prototype;function Timeline(options){options=options||{};options.ease=options.ease||"linear";options.destroyOnComplete=false;this.options=options;Clip.call(this,{t:0},0,{t:1},options);this._itemList=new TimelineItemList}var proto=Timeline.prototype=create(superProto);Timeline.prototype.constructor=Timeline;proto._update=function(evt){superProto._update.call(this,evt);this._render()};proto.progress=function(progress){superProto.progress.call(this,progress);if(progress!==undefined){this._render()}return this._progress};proto._render=function(){if(this._itemList.length===0){return}var renderTime=this._target.t*this._duration;var aClip=this._itemList.head;var next=aClip;while(next){next=aClip.next;var offsetTime=renderTime-aClip.position;aClip.currentTime(offsetTime);aClip=next}};proto.addClip=function(clip,position){position=position===undefined?this.duration():position;var builtInDelay=clip._delay/1e3;this._itemList.append(new TimelineClip(clip,position+builtInDelay));this._updateDuration()};proto.addCallback=function(fn,position){position=position===undefined?this.duration():position;this._itemList.append(new TimelineCallback(fn,position));this._updateDuration()};proto.remove=function(clipOrFunction){var item=this._itemList.getItem(clipOrFunction);if(item){this._itemList.remove(item);this._updateDuration()}};proto._updateDuration=function(){var lastClip=this._itemList.head;var duration=lastClip.position+lastClip.duration();this._itemList.forEach(function(clip){var newDuration=clip.position+clip.duration();if(newDuration>=duration){lastClip=clip;duration=newDuration}});this.duration(duration)};proto.destroy=function(){var next=this._itemList.head;while(next){var timelineClip=next;next=timelineClip.next;this._itemList.remove(timelineClip)}this._duration=0;return superProto.destroy.call(this)};module.exports=Timeline},{"./TimelineCallback":130,"./TimelineClip":131,"./TimelineItemList":132,"@marcom/ac-clip":25,"@marcom/ac-object/create":186}],130:[function(require,module,exports){"use strict";function TimelineCallback(fn,position){this.callback=fn;this._delay=0;this.position=position;this._hasTriggered=false;this.prev=null;this.next=null}var proto=TimelineCallback.prototype;proto.duration=function(){return 0};proto.currentTime=function(offsetTime){if(offsetTime>=0&&!this._hasTriggered){this.callback();this._hasTriggered=true}if(offsetTime<0&&this._hasTriggered){this.callback();this._hasTriggered=false}return 0};module.exports=TimelineCallback},{}],131:[function(require,module,exports){"use strict";function TimelineClip(clip,position){this.clip=clip;this.position=position;this.duration=this.clip.duration.bind(this.clip);this.lastProgress=-1;this.prev=null;this.next=null}var proto=TimelineClip.prototype;proto.currentTime=function(offsetTime){var clampedProgress=Math.min(1,Math.max(0,offsetTime/this.clip._duration));if(clampedProgress!==clampedProgress){clampedProgress=1}if(this.lastProgress===clampedProgress){return this.lastProgress}if(this.lastProgress===0||clampedProgress===0||this.lastProgress===-1){if(this.clip._storeOnStart){this.clip._storeOnStart(this.clip)}}this.clip._playing=clampedProgress*this.clip._duration===this.clip._duration;this.lastProgress=this.clip.progress(clampedProgress);return this.lastProgress};proto.destroy=function(){this.clip.destroy();this.prev=null;this.next=null;this.duration=null};module.exports=TimelineClip},{}],132:[function(require,module,exports){"use strict";var TimelineClip=require("./TimelineClip");var TimelineCallback=require("./TimelineCallback");var TimelineItemList=function(){this.head=null;this.tail=null;this.length=0};var proto=TimelineItemList.prototype;proto.append=function(clip){clip.prev=null;clip.next=null;if(this.tail){this.tail.next=clip;clip.prev=this.tail}else{this.head=clip}this.tail=clip;this.length++};proto.remove=function(clip){if(clip===this.head){this.head=this.head.next}else if(clip===this.tail){this.tail=this.tail.prev}if(clip.prev){clip.prev.next=clip.next}if(clip.next){clip.next.prev=clip.prev}clip.next=clip.prev=null;if(this.head===null){this.tail=null}this.length--};proto.getItem=function(clipOrFunction){var next=this.head;while(next){var item=next;if(item instanceof TimelineClip&&item.clip===clipOrFunction||item instanceof TimelineCallback&&item.callback===clipOrFunction){return item}next=item.next}return null};proto.forEach=function(callback){var i=0;var next=this.head;while(next){var clip=next;callback(clip,i,this.length);next=clip.next}};proto.destroy=function(){while(this.head){var item=this.head;this.remove(item);item.destroy()}};module.exports=TimelineItemList},{"./TimelineCallback":130,"./TimelineClip":131}],133:[function(require,module,exports){"use strict";module.exports={EventEmitterMicro:require("./ac-event-emitter-micro/EventEmitterMicro")}},{"./ac-event-emitter-micro/EventEmitterMicro":134}],134:[function(require,module,exports){"use strict";function EventEmitterMicro(){this._events={}}var proto=EventEmitterMicro.prototype;proto.on=function(eventName,callback){this._events[eventName]=this._events[eventName]||[];this._events[eventName].unshift(callback)};proto.once=function(eventName,callback){var that=this;function fn(data){that.off(eventName,fn);if(data!==undefined)callback(data);else callback()}this.on(eventName,fn)};proto.off=function(eventName,callback){if(!this.has(eventName))return;if(arguments.length===1){this._events[eventName]=null;delete this._events[eventName];return}var index=this._events[eventName].indexOf(callback);if(index===-1)return;this._events[eventName].splice(index,1)};proto.trigger=function(eventName,data){if(!this.has(eventName))return;for(var i=this._events[eventName].length-1;i>=0;i--){if(data!==undefined)this._events[eventName][i](data);else this._events[eventName][i]()}};proto.has=function(eventName){if(eventName in this._events===false||this._events[eventName].length===0){return false}return true};proto.destroy=function(){for(var eventName in this._events){this._events[eventName]=null}this._events=null};module.exports=EventEmitterMicro},{}],135:[function(require,module,exports){module.exports.EventEmitter=require("./ac-event-emitter/EventEmitter")},{"./ac-event-emitter/EventEmitter":136}],136:[function(require,module,exports){"use strict";var propagationName="EventEmitter:propagation";var EventEmitter=function(context){if(context){this.context=context}};var proto=EventEmitter.prototype;var getEvents=function(){if(!this.hasOwnProperty("_events")&&typeof this._events!=="object"){this._events={}}return this._events};var parseEvents=function(args,register){var event=args[0];var callback=args[1];var context=args[2];if(typeof event!=="string"&&typeof event!=="object"||event===null||Array.isArray(event)){throw new TypeError("Expecting event name to be a string or object.")}if(typeof event==="string"&&!callback){throw new Error("Expecting a callback function to be provided.")}if(callback&&typeof callback!=="function"){if(typeof event==="object"&&typeof callback==="object"){context=callback}else{throw new TypeError("Expecting callback to be a function.")}}if(typeof event==="object"){for(var evt in event){register.call(this,evt,event[evt],context)}}if(typeof event==="string"){event=event.split(" ");event.forEach(function(evt){register.call(this,evt,callback,context)},this)}};var each=function(event,callback){var eventsArray;var i;var length;eventsArray=getEvents.call(this)[event];if(!eventsArray||eventsArray.length===0){return}eventsArray=eventsArray.slice();this._stoppedImmediatePropagation=false;for(i=0,length=eventsArray.length;i<length;i++){if(this._stoppedImmediatePropagation||callback(eventsArray[i],i)){break}}};var removeSpecificCallback=function(events,event,callback){var i=-1;each.call(this,event,function(callbackObject,index){if(callbackObject.callback===callback){i=index;return true}});if(i===-1){return}events[event].splice(i,1)};proto.on=function(){var events=getEvents.call(this);parseEvents.call(this,arguments,function(event,callback,context){events[event]=events[event]||(events[event]=[]);events[event].push({callback:callback,context:context})});return this};proto.once=function(){parseEvents.call(this,arguments,function(event,callback,context){var wrapper=function(data){callback.call(context||this,data);this.off(event,wrapper)};this.on(event,wrapper,this)});return this};proto.off=function(event,callback){var events=getEvents.call(this);if(arguments.length===0){this._events={}}else if(!event||typeof event!=="string"&&typeof event!=="object"||Array.isArray(event)){throw new TypeError("Expecting event name to be a string or object.")}if(typeof event==="object"){for(var e in event){removeSpecificCallback.call(this,events,e,event[e])}}if(typeof event==="string"){var split=event.split(" ");if(split.length===1){if(callback){removeSpecificCallback.call(this,events,event,callback)}else{events[event]=[]}}else{split.forEach(function(event){events[event]=[]})}}return this};proto.trigger=function(event,data,doNotPropagate){if(!event){throw new Error("trigger method requires an event name")}if(typeof event!=="string"){throw new TypeError("Expecting event names to be a string.")}if(doNotPropagate&&typeof doNotPropagate!=="boolean"){throw new TypeError("Expecting doNotPropagate to be a boolean.")}event=event.split(" ");event.forEach(function(evt){each.call(this,evt,function(callbackObject){callbackObject.callback.call(callbackObject.context||this.context||this,data)}.bind(this));if(!doNotPropagate){each.call(this,propagationName,function(propagation){var eventName=evt;if(propagation.prefix){eventName=propagation.prefix+eventName}propagation.emitter.trigger(eventName,data)})}},this);return this};proto.propagateTo=function(eventEmitter,prefix){var events=getEvents.call(this);if(!events[propagationName]){this._events[propagationName]=[]}events[propagationName].push({emitter:eventEmitter,prefix:prefix})};proto.stopPropagatingTo=function(eventEmitter){var events=getEvents.call(this);if(!eventEmitter){events[propagationName]=[];return}var propagationTargets=events[propagationName];var length=propagationTargets.length;var i;for(i=0;i<length;i++){if(propagationTargets[i].emitter===eventEmitter){propagationTargets.splice(i,1);break}}};proto.stopImmediatePropagation=function(){this._stoppedImmediatePropagation=true};proto.has=function(evt,callback,context){var events=getEvents.call(this);var eventsArray=events[evt];if(arguments.length===0){return Object.keys(events)}if(!eventsArray){return false}if(!callback){return eventsArray.length>0?true:false}for(var i=0,length=eventsArray.length;i<length;i++){var callbackContainer=eventsArray[i];if(context&&callback&&callbackContainer.context===context&&callbackContainer.callback===callback){return true}else if(callback&&!context&&callbackContainer.callback===callback){return true}}return false};module.exports=EventEmitter},{}],137:[function(require,module,exports){"use strict";var globalsHelper=require("./helpers/globals");var once=require("@marcom/ac-function/once");var canvasAvailable=function(){var documentObj=globalsHelper.getDocument();var canvas=documentObj.createElement("canvas");return!!(typeof canvas.getContext==="function"&&canvas.getContext("2d"))};module.exports=once(canvasAvailable);module.exports.original=canvasAvailable},{"./helpers/globals":139,"@marcom/ac-function/once":146}],138:[function(require,module,exports){"use strict";var getStyleValue=require("@marcom/ac-prefixer/getStyleValue");var getStyleProperty=require("@marcom/ac-prefixer/getStyleProperty");var memoize=require("@marcom/ac-function/memoize");function cssPropertyAvailable(property,value){if(typeof value!=="undefined"){return!!getStyleValue(property,value)}else{return!!getStyleProperty(property)}}module.exports=memoize(cssPropertyAvailable);module.exports.original=cssPropertyAvailable},{"@marcom/ac-function/memoize":145,"@marcom/ac-prefixer/getStyleProperty":202,"@marcom/ac-prefixer/getStyleValue":203}],139:[function(require,module,exports){"use strict";module.exports={getWindow:function(){return window},getDocument:function(){return document},getNavigator:function(){return navigator}}},{}],140:[function(require,module,exports){"use strict";var os=require("@marcom/useragent-detect").os;var touchAvailable=require("./touchAvailable").original;var globalsHelper=require("./helpers/globals");var once=require("@marcom/ac-function/once");function isDesktop(){var windowObj=globalsHelper.getWindow();return!touchAvailable()&&!windowObj.orientation||os.windows}module.exports=once(isDesktop);module.exports.original=isDesktop},{"./helpers/globals":139,"./touchAvailable":143,"@marcom/ac-function/once":146,"@marcom/useragent-detect":301}],141:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/matchMedia");var globalsHelper=require("./helpers/globals");var once=require("@marcom/ac-function/once");function mediaQueriesAvailable(){var windowObj=globalsHelper.getWindow();var mql=windowObj.matchMedia("only all");return!!(mql&&mql.matches)}module.exports=once(mediaQueriesAvailable);module.exports.original=mediaQueriesAvailable},{"./helpers/globals":139,"@marcom/ac-function/once":146,"@marcom/ac-polyfills/matchMedia":"@marcom/ac-polyfills/matchMedia"}],142:[function(require,module,exports){"use strict";var getStyleValue=require("@marcom/ac-prefixer/getStyleValue");var once=require("@marcom/ac-function/once");function threeDTransformsAvailable(){return!!(getStyleValue("perspective","1px")&&getStyleValue("transform","translateZ(0)"))}module.exports=once(threeDTransformsAvailable);module.exports.original=threeDTransformsAvailable},{"@marcom/ac-function/once":146,"@marcom/ac-prefixer/getStyleValue":203}],143:[function(require,module,exports){"use strict";var globalsHelper=require("./helpers/globals");var once=require("@marcom/ac-function/once");function touchAvailable(){var windowObj=globalsHelper.getWindow();var documentObj=globalsHelper.getDocument();var navigatorObj=globalsHelper.getNavigator();return!!("ontouchstart"in windowObj||windowObj.DocumentTouch&&documentObj instanceof windowObj.DocumentTouch||navigatorObj.maxTouchPoints>0||navigatorObj.msMaxTouchPoints>0)}module.exports=once(touchAvailable);module.exports.original=touchAvailable},{"./helpers/globals":139,"@marcom/ac-function/once":146}],144:[function(require,module,exports){"use strict";var globalsHelper=require("./helpers/globals");var once=require("@marcom/ac-function/once");function webGLAvailable(){var documentObj=globalsHelper.getDocument();var canvas=documentObj.createElement("canvas");if(typeof canvas.getContext==="function"){return!!(canvas.getContext("webgl")||canvas.getContext("experimental-webgl"))}return false}module.exports=once(webGLAvailable);module.exports.original=webGLAvailable},{"./helpers/globals":139,"@marcom/ac-function/once":146}],145:[function(require,module,exports){"use strict";var defaultHashFunction=function(){var key="";var i;for(i=0;i<arguments.length;i++){if(i>0){key+=","}key+=arguments[i]}return key};module.exports=function memoize(func,hashFunction){hashFunction=hashFunction||defaultHashFunction;var memoized=function(){var args=arguments;var key=hashFunction.apply(this,args);if(!(key in memoized.cache)){memoized.cache[key]=func.apply(this,args)}return memoized.cache[key]};memoized.cache={};return memoized}},{}],146:[function(require,module,exports){"use strict";module.exports=function once(func){var result;return function(){if(typeof result==="undefined"){result=func.apply(this,arguments)}return result}}},{}],147:[function(require,module,exports){"use strict";module.exports=function throttle(func,wait){var timeout=null;return function(){if(timeout===null){func.apply(this,arguments);timeout=setTimeout(function(){timeout=null},wait)}}}},{}],148:[function(require,module,exports){"use strict";module.exports={PageVisibilityManager:require("./ac-page-visibility/PageVisibilityManager")}},{"./ac-page-visibility/PageVisibilityManager":149}],149:[function(require,module,exports){"use strict";var create=require("@marcom/ac-object/create");var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;function PageVisibilityManager(){if(typeof document.addEventListener==="undefined"){return}var visibilityChange;if(typeof document.hidden!=="undefined"){this._hidden="hidden";visibilityChange="visibilitychange"}else if(typeof document.mozHidden!=="undefined"){this._hidden="mozHidden";visibilityChange="mozvisibilitychange"}else if(typeof document.msHidden!=="undefined"){this._hidden="msHidden";visibilityChange="msvisibilitychange"}else if(typeof document.webkitHidden!=="undefined"){this._hidden="webkitHidden";visibilityChange="webkitvisibilitychange"}if(typeof document[this._hidden]==="undefined"){this.isHidden=false}else{this.isHidden=document[this._hidden]}if(visibilityChange){document.addEventListener(visibilityChange,this._handleVisibilityChange.bind(this),false)}EventEmitterMicro.call(this)}var proto=PageVisibilityManager.prototype=create(EventEmitterMicro.prototype);proto.CHANGED="changed";proto._handleVisibilityChange=function(evt){this.isHidden=document[this._hidden];this.trigger(this.CHANGED,{isHidden:this.isHidden})};module.exports=new PageVisibilityManager},{"@marcom/ac-event-emitter-micro":133,"@marcom/ac-object/create":186}],150:[function(require,module,exports){"use strict";var ac_classList=require("@marcom/ac-classlist");var analyticsManager=require("./singletons/analyticsManager");var create=require("@marcom/ac-object/create");var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var Item=require("./Item");var update=require("@marcom/ac-raf-emitter/update");var draw=require("@marcom/ac-raf-emitter/draw");function Gallery(options){options=options||{};this._wrapAround=options.wrapAround||false;this._itemType=options.itemType||Item;this._items=[];this._itemsIdLookup={};this.showNext=this.showNext.bind(this);this.showPrevious=this.showPrevious.bind(this);this._update=this._update.bind(this);this._updateItems=this._updateItems.bind(this);EventEmitterMicro.call(this);Gallery._add(this,options.analyticsOptions)}Gallery.FADE="fade";Gallery.FADE_SELECTOR="[data-ac-gallery-fade]";Gallery.SLIDE="slide";Gallery.SLIDE_SELECTOR="[data-ac-gallery-slide]";Gallery.UPDATE="update";Gallery.UPDATE_COMPLETE="update:complete";var superProto=EventEmitterMicro.prototype;var proto=Gallery.prototype=create(superProto);proto.addItem=function(item,index){if(item.nodeType){item=new this._itemType(item)}else if(this._items.indexOf(item)>-1){return item}if(typeof index==="number"){this._items.splice(index,0,item)}else{this._items.push(item)}if(this._items.length===1){item.show();this._setCurrentItem(item)}else{item.hide();if(this.getNextItem()===item){this._setNextItem(item)}if(this.getPreviousItem()===item){this._setPreviousItem(item)}}if(item.getElementId()!==null){this._itemsIdLookup[item.getElementId()]=item}item.on(Item.SELECTED,this._update);return item};proto.removeItem=function(item,options){options=options||{};if(typeof item==="number"){item=this._items[item]}var index=this._items.indexOf(item);if(index>-1){var nextItem=this.getNextItem();var previousItem=this.getPreviousItem();this._items.splice(index,1);item.off(Item.SELECTED,this._update);if(nextItem===item){this._setNextItem(this.getNextItem())}if(previousItem===item){this._setPreviousItem(this.getPreviousItem())}}if(item===this._currentItem&&this._items.length&&options.setCurrentItem!==false){this._update({item:this._items[0]});this._setLastItem(null)}if(options.destroyItem&&item.getElement()){item.destroy()}return item};proto.show=function(item,options){if(typeof item==="number"){item=this._items[item]}else if(typeof item==="string"){item=this._itemsIdLookup[item]}if(item){options=options||{};this._update({item:item,interactionEvent:options.interactionEvent})}return item||null};proto.showNext=function(options){var item=this.getNextItem();if(item){this.show(item,options)}return item};proto.showPrevious=function(options){var item=this.getPreviousItem();if(item){this.show(item,options)}return item};proto.isInView=function(){return this._currentItem&&this._currentItem.isInView()};proto.getTotalItems=function(){return this._items.length};proto.getItems=function(){return this._items};proto.getItem=function(key){if(typeof key==="number"){return this.getItemAt(key)}else if(typeof key==="string"){return this.getItemById(key)}};proto.getItemAt=function(index){return this._items[index]||null};proto.getItemById=function(id){return this._itemsIdLookup[id]||null};proto.getItemIndex=function(item){return this._items.indexOf(item)};proto.getCurrentItem=function(){return this._currentItem||null};proto.getLastItem=function(){return this._lastItem||null};proto.getNextItem=function(){var item;var index=this._items.indexOf(this._currentItem);if(index<this._items.length-1){item=this._items[index+1]}else if(this._wrapAround){item=this._items[0]}return item||null};proto.getPreviousItem=function(){var item;var index=this._items.indexOf(this._currentItem);if(index>0){item=this._items[index-1]}else if(this._wrapAround){item=this._items[this._items.length-1]}return item||null};proto.getId=function(){return this._id};proto.destroy=function(options){options=options||{};if(options.destroyItems===undefined){options.destroyItems=true}this._setCurrentItem(null);if(options.destroyItems){var item;while(this._items.length){item=this._items[0];item.off(Item.SELECTED,this._update);this.removeItem(item,{destroyItem:true,setCurrentItem:false})}}this._items=null;this._itemsIdLookup=null;Gallery._remove(this);return superProto.destroy.call(this)};proto._setCurrentItem=function(item){if(this._currentItem&&this._currentItem.getElement()&&this._currentItem!==item){draw(function(el){ac_classList.remove(el,Item.CSS_CURRENT_ITEM)}.bind(this,this._currentItem.getElement()));this._setLastItem(this._currentItem)}this._currentItem=item;if(this._currentItem&&this._currentItem.getElement()){draw(function(el){ac_classList.add(el,Item.CSS_CURRENT_ITEM)}.bind(this,this._currentItem.getElement()));this._setNextItem(this.getNextItem());this._setPreviousItem(this.getPreviousItem())}};proto._setLastItem=function(item){if(this._lastItem&&this._lastItem.getElement()&&this._lastItem!==item){draw(function(el){ac_classList.remove(el,Item.CSS_LAST_ITEM)}.bind(this,this._lastItem.getElement()))}this._lastItem=item;if(this._lastItem&&this._lastItem.getElement()){draw(function(el){ac_classList.add(el,Item.CSS_LAST_ITEM)}.bind(this,this._lastItem.getElement()))}};proto._setNextItem=function(item){if(this._nextItem&&this._nextItem.getElement()&&this._nextItem!==item){draw(function(el){ac_classList.remove(el,Item.CSS_NEXT_ITEM)}.bind(this,this._nextItem.getElement()))}this._nextItem=item;if(this._nextItem&&this._nextItem.getElement()){draw(function(el){ac_classList.add(el,Item.CSS_NEXT_ITEM)}.bind(this,this._nextItem.getElement()))}};proto._setPreviousItem=function(item){if(this._previousItem&&this._previousItem.getElement()&&this._previousItem!==item){draw(function(el){ac_classList.remove(el,Item.CSS_PREVIOUS_ITEM)}.bind(this,this._previousItem.getElement()))}this._previousItem=item;if(this._previousItem&&this._previousItem.getElement()){draw(function(el){ac_classList.add(el,Item.CSS_PREVIOUS_ITEM)}.bind(this,this._previousItem.getElement()))}};proto._updateItems=function(items,silent){if(items.outgoing[0]){items.outgoing[0].hide()}items.incoming[0].show();if(!silent){this.trigger(Gallery.UPDATE_COMPLETE,items)}};proto._update=function(evt){var hasChanged=this._currentItem!==evt.item;if(hasChanged){this._setCurrentItem(evt.item)}var items={incoming:[evt.item],outgoing:this._lastItem?[this._lastItem]:[],interactionEvent:evt.interactionEvent||null};if(hasChanged){this.trigger(Gallery.UPDATE,items)}this._updateItems(items,!hasChanged)};Gallery._instantiate=function(){this._galleries=[];this._idCounter=0;return this};Gallery._add=function(gallery,analyticsOptions){this._galleries.push(gallery);gallery._id=++this._idCounter;analyticsManager.add(gallery,analyticsOptions)};Gallery._remove=function(gallery){var index=this._galleries.indexOf(gallery);if(index>-1){this._galleries.splice(index,1);analyticsManager.remove(gallery)}};Gallery.getAll=function(){return Array.prototype.slice.call(this._galleries)};Gallery.getAllInView=function(){var inView=[];var index=this._galleries.length;while(index--){if(this._galleries[index].isInView()){inView.push(this._galleries[index])}}return inView};Gallery.destroyAll=function(){var i=this._galleries.length;while(i--){this._galleries[i].destroy()}this._galleries=[]};module.exports=Gallery._instantiate()},{"./Item":151,"./singletons/analyticsManager":164,"@marcom/ac-classlist":20,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-object/create":186,"@marcom/ac-raf-emitter/draw":220,"@marcom/ac-raf-emitter/update":222}],151:[function(require,module,exports){"use strict";var ac_classList=require("@marcom/ac-classlist");var ac_addEventListener=require("@marcom/ac-dom-events/addEventListener");var ac_removeEventListener=require("@marcom/ac-dom-events/removeEventListener");var preventDefault=require("@marcom/ac-dom-events/preventDefault");var isInViewport=require("@marcom/ac-dom-metrics/isInViewport");var getPercentInViewport=require("@marcom/ac-dom-metrics/getPercentInViewport");var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var create=require("@marcom/ac-object/create");var tabManager=require("./singletons/tabManager");var keyMap=require("@marcom/ac-keyboard/keyMap");var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var Keyboard=require("@marcom/ac-keyboard");var update=require("@marcom/ac-raf-emitter/update");var draw=require("@marcom/ac-raf-emitter/draw");var CSS_CURRENT="current";function Item(el){this._el=el;this._triggerKeys=[];this._triggerEls={};this._isShown=false;this._onKeyboardInteraction=this._onKeyboardInteraction.bind(this);this._onTriggered=this._onTriggered.bind(this);this._el.setAttribute("role","tabpanel");this._focusableEls=ac_querySelectorAll(tabManager.focusableSelectors,el);EventEmitterMicro.call(this)}Item.CSS_CURRENT_ITEM="ac-gallery-currentitem";Item.CSS_LAST_ITEM="ac-gallery-lastitem";Item.CSS_NEXT_ITEM="ac-gallery-nextitem";Item.CSS_PREVIOUS_ITEM="ac-gallery-previousitem";Item.SELECTED="selected";Item.SHOW="show";Item.HIDE="hide";var proto=Item.prototype=create(EventEmitterMicro.prototype);proto.show=function(){this._isShown=true;this._addCurrentClassToTriggers();this._setTabIndexOnFocusableItems(null);this._el.removeAttribute("aria-hidden");this.trigger(Item.SHOW,this)};proto.hide=function(){this._isShown=false;this._removeCurrentClassFromTriggers();this._setTabIndexOnFocusableItems("-1");this._el.setAttribute("aria-hidden","true");this.trigger(Item.HIDE,this)};proto.addElementTrigger=function(el,eventType){eventType=eventType||"click";if(this._triggerEls[eventType]===undefined){this._triggerEls[eventType]=[]}var index=this._triggerEls[eventType].indexOf(el);if(index<0){el.setAttribute("role","tab");el.setAttribute("tabindex","0");var id=this.getElementId();if(id){el.setAttribute("aria-controls",id)}id=el.getAttribute("id");if(id&&this._el.getAttribute("aria-labelledby")===null){this._el.setAttribute("aria-labelledby",id)}ac_addEventListener(el,eventType,this._onTriggered);this._triggerEls[eventType].push(el);if(this._isShown){el.setAttribute("aria-selected","true");ac_classList.add(el,CSS_CURRENT)}else{el.setAttribute("aria-selected","false")}}};proto.removeElementTrigger=function(el,eventType){eventType=eventType||"click";if(this._triggerEls[eventType]===undefined){return}var index=this._triggerEls[eventType].indexOf(el);if(index>-1){this._cleanElementTrigger(el,eventType)}if(this._triggerEls[eventType].length===0){this._triggerEls[eventType]=undefined}};proto.addKeyTrigger=function(key){if(typeof key==="string"){key=keyMap[key.toUpperCase()]}if(typeof key==="number"){var index=this._triggerKeys.indexOf(key);if(index<0){Keyboard.onDown(key,this._onKeyboardInteraction);this._triggerKeys.push(key)}}};proto.removeKeyTrigger=function(key){if(typeof key==="string"){key=keyMap[key.toUpperCase()]}if(typeof key==="number"){var index=this._triggerKeys.indexOf(key);if(index>-1){Keyboard.offDown(key,this._onKeyboardInteraction);this._triggerKeys.splice(index,1)}}};proto.removeAllTriggers=function(){var key;var index=this._triggerKeys.length;while(index--){key=this._triggerKeys[index];Keyboard.offDown(key,this._onKeyboardInteraction)}this._triggerKeys=[];var el;var type;for(type in this._triggerEls){index=this._triggerEls[type].length;while(index--){el=this._triggerEls[type][index];this._cleanElementTrigger(el,type)}}this._triggerEls={}};proto.isInView=function(){if(this._el){return isInViewport(this._el)}return false};proto.percentageInView=function(){if(this._el){return getPercentInViewport(this._el)}return 0};proto.getElement=function(){return this._el};proto.getElementId=function(){if(this._elId!==undefined){return this._elId}this._elId=this._el.getAttribute("id")||null;return this._elId};proto.destroy=function(){if(this._isShown){this._isShown=null;ac_classList.remove(this._el,Item.CSS_CURRENT_ITEM,Item.CSS_LAST_ITEM,Item.CSS_NEXT_ITEM,Item.CSS_PREVIOUS_ITEM);this._removeCurrentClassFromTriggers()}this.removeAllTriggers();this._setTabIndexOnFocusableItems(null);this._el.removeAttribute("aria-hidden");this._el.removeAttribute("role");this._el.removeAttribute("aria-labelledby");this._triggerKeys=null;this._triggerEls=null;this._el=null};proto._addCurrentClassToTriggers=function(){var el;var type;var index;for(type in this._triggerEls){index=this._triggerEls[type].length;while(index--){el=this._triggerEls[type][index];draw(function(el){el.setAttribute("aria-selected","true");ac_classList.add(el,CSS_CURRENT)}.bind(this,el))}}};proto._removeCurrentClassFromTriggers=function(){var el;var type;var index;for(type in this._triggerEls){index=this._triggerEls[type].length;while(index--){el=this._triggerEls[type][index];draw(function(el){el.setAttribute("aria-selected","false");ac_classList.remove(el,CSS_CURRENT)}.bind(this,el))}}};proto._cleanElementTrigger=function(el,type){ac_removeEventListener(el,type,this._onTriggered);draw(function(el){el.removeAttribute("aria-selected");el.removeAttribute("role");el.removeAttribute("tabindex");el.removeAttribute("aria-controls");if(this._isShown){ac_classList.remove(el,CSS_CURRENT)}}.bind(this,el))};proto._onKeyboardInteraction=function(evt){if(this.isInView()){this._onTriggered(evt)}};proto._setTabIndexOnFocusableItems=function(index){var remove=index===null;var tabbableEls=[];this._currentTabbableEls=this._currentTabbableEls||tabManager.getTabbable(this._focusableEls);if(!remove){tabbableEls=tabManager.getTabbable(this._focusableEls);this._currentTabbableEls=tabbableEls}var i=this._currentTabbableEls.length;while(i--){if(remove){this._currentTabbableEls[i].removeAttribute("tabindex")}else{this._currentTabbableEls[i].setAttribute("tabindex",index)}}};proto._onTriggered=function(evt){preventDefault(evt);this.trigger(Item.SELECTED,{item:this,interactionEvent:evt})};module.exports=Item},{"./singletons/tabManager":165,"@marcom/ac-classlist":20,"@marcom/ac-dom-events/addEventListener":54,"@marcom/ac-dom-events/preventDefault":57,"@marcom/ac-dom-events/removeEventListener":58,"@marcom/ac-dom-metrics/getPercentInViewport":69,"@marcom/ac-dom-metrics/isInViewport":75,"@marcom/ac-dom-traversal/querySelectorAll":98,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-keyboard":175,"@marcom/ac-keyboard/keyMap":177,"@marcom/ac-object/create":186,"@marcom/ac-raf-emitter/draw":220,"@marcom/ac-raf-emitter/update":222}],152:[function(require,module,exports){"use strict";var extendProto=require("./helpers/extendProto");var Gallery=require("./Gallery");var AutoGallery=require("./auto/AutoGallery");var FadeGallery=require("./fade/FadeGallery");var FadeGalleryItem=require("./fade/FadeItem");var SlideGallery=require("./slide/SlideGallery");var SlideGalleryItem=require("./slide/SlideItem");var Item=require("./Item");Gallery.create=require("./factories/create");Gallery.autoCreate=require("./factories/autoCreate");Gallery.extend=extendProto;AutoGallery.extend=extendProto;FadeGallery.extend=extendProto;FadeGalleryItem.extend=extendProto;SlideGallery.extend=extendProto;SlideGalleryItem.extend=extendProto;Item.extend=extendProto;module.exports={Gallery:Gallery,AutoGallery:AutoGallery,FadeGallery:FadeGallery,FadeGalleryItem:FadeGalleryItem,SlideGallery:SlideGallery,SlideGalleryItem:SlideGalleryItem,Item:Item,ToggleNav:require("./navigation/ToggleNav")}},{"./Gallery":150,"./Item":151,"./auto/AutoGallery":154,"./factories/autoCreate":155,"./factories/create":156,"./fade/FadeGallery":157,"./fade/FadeItem":158,"./helpers/extendProto":159,"./navigation/ToggleNav":163,"./slide/SlideGallery":166,"./slide/SlideItem":167}],153:[function(require,module,exports){"use strict";var GalleryAnalyticsObserver;try{GalleryAnalyticsObserver=require("ac-analytics").observer.Gallery}catch(e){}var DEFAULT_ID_DATA_ATTRIBUTE="data-analytics-gallery-id";function AnalyticsManager(){this._observers={}}var proto=AnalyticsManager.prototype;proto.add=function(gallery,options){var id=gallery.getId();if(!GalleryAnalyticsObserver||this._observers[id]){return}options=options||{};if(!options.galleryName){options.galleryName=this._getAnalyticsId(gallery,options.dataAttribute)||id}if(!options.beforeUpdateEvent){options.beforeUpdateEvent="update"}if(!options.afterUpdateEvent){options.afterUpdateEvent="update:complete"}var observer=new GalleryAnalyticsObserver(gallery,options);if(observer.gallery){this._observers[id]=observer}};proto.remove=function(gallery){var id=gallery.getId();if(!GalleryAnalyticsObserver||!this._observers[id]){return}if(typeof this._observers[id].destroy==="function"){this._observers[id].destroy()}this._observers[id]=null};proto._getAnalyticsId=function(gallery,dataAttribute){if(typeof gallery.getElement==="function"){dataAttribute=dataAttribute||DEFAULT_ID_DATA_ATTRIBUTE;var el=gallery.getElement();return el.getAttribute(dataAttribute)||el.getAttribute("id")}return null};module.exports=AnalyticsManager},{"ac-analytics":"ac-analytics"}],154:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/requestAnimationFrame");var ac_classList=require("@marcom/ac-classlist");var ac_addEventListener=require("@marcom/ac-dom-events/addEventListener");var ac_removeEventListener=require("@marcom/ac-dom-events/removeEventListener");var preventDefault=require("@marcom/ac-dom-events/preventDefault");var ac_dom_styles=require("@marcom/ac-dom-styles");var ac_querySelector=require("@marcom/ac-dom-traversal/querySelector");var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var create=require("@marcom/ac-object/create");var getContentDimensions=require("@marcom/ac-dom-metrics/getContentDimensions");var keyMap=require("@marcom/ac-keyboard/keyMap");var selectElementFromDataAttributeValue=require("./../helpers/selectElementFromDataAttributeValue");var selectElementThatHasDataAttribute=require("./../helpers/selectElementThatHasDataAttribute");var throttle=require("@marcom/ac-function/throttle");var touchAvailable=require("@marcom/ac-feature/touchAvailable");var Gallery=require("./../Gallery");var Keyboard=require("@marcom/ac-keyboard");var PageVisibilityManager=require("@marcom/ac-page-visibility").PageVisibilityManager;var PointerTracker=require("@marcom/ac-pointer-tracker").PointerTracker;var ToggleNav=require("./../navigation/ToggleNav");var CSS_DISABLED_CLASS="disabled";var DEFAULT_AUTO_PLAY_DELAY=3;var DEFAULT_CONTAINER_RESIZE_DURATION=.5;var DEFAULT_ITEM_SELECTOR="[data-ac-gallery-item]";var DEFAULT_KEYBOARD_THROTTLE_DELAY=.12;var DEFAULT_PADDLENAV_TEMPLATE=require("../templates/paddlenav.js");var ERROR_NO_ELEMENT_SUPPLIED="No element supplied.";function AutoGallery(el,options){options=options||{};if(!el||el.nodeType===undefined){throw new Error(ERROR_NO_ELEMENT_SUPPLIED)}this._el=el;Gallery.call(this,options);this._itemHeights=[];this._itemHeightsLookup={};this._toggleNavDuration=options.toggleNavDuration;this._isRightToLeft=options.rightToLeft===undefined?ac_dom_styles.getStyle(el,"direction").direction==="rtl":options.rightToLeft;this._keyboardThrottleDelay=(options.keyboardThrottleDelay===undefined?DEFAULT_KEYBOARD_THROTTLE_DELAY:options.keyboardThrottleDelay)*1e3;this._resizeContainer=!!options.resizeContainer;this._setUpContainerAutoResize(options.resizeContainerOnUpdate);this._createToggleNav();this._addPaddleNav(options.addPaddleNav);this._addItems(options.itemSelector||DEFAULT_ITEM_SELECTOR);if(!this._wrapAround){this._updatePaddleNavState()}if(options.enableArrowKeys!==false){this._enableArrowKeys=true;this._addKeyboardListener()}if(options.updateOnWindowResize!==false){this._onWindowResize=this._onWindowResize.bind(this);ac_addEventListener(window,"resize",this._onWindowResize)}this.stopAutoPlay=this.stopAutoPlay.bind(this);if(options.autoPlay){var delay=typeof options.autoPlay==="number"?options.autoPlay:DEFAULT_AUTO_PLAY_DELAY;this.startAutoPlay(delay)}if(options.deeplink!==false){var item=this._getDeeplinkedItem();if(item&&item!==this._currentItem){this.show(item)}}if(this._containerResizeDuration!==false){var height=this._itemHeightsLookup[this._currentItem.getElementId()];if(height){this._setElHeight(height)}}if(this._toggleNav){this._toggleNav.start()}this._setUpSwiping(options.touch&&touchAvailable(),options.desktopSwipe)}AutoGallery.RESIZED="resized";AutoGallery.UPDATE=Gallery.UPDATE;AutoGallery.UPDATE_COMPLETE=Gallery.UPDATE_COMPLETE;var superProto=Gallery.prototype;var proto=AutoGallery.prototype=create(superProto);proto.addItem=function(item,index){if(item.nodeType){item=new this._itemType(item)}else if(this._items.indexOf(item)>-1){return item}if(this._resizeContainer){this._storeItemHeight(item,this._containerResizeDuration===false)}this._addItemTriggers(item);return superProto.addItem.call(this,item,index)};proto.removeItem=function(item,options){if(this._resizeContainer){var index=this._itemHeights.length;while(index--){if(this._itemHeights[index].item===item){this._itemHeights.splice(index,1);if(index===0&&this._itemHeights.length){this._setElHeight(this._itemHeights[0].height)}}}}return superProto.removeItem.call(this,item,options)};proto.startAutoPlay=function(delay,options){options=options||{};this._isAutoPlaying=true;this._autoPlayDelay=(delay||DEFAULT_AUTO_PLAY_DELAY)*1e3;this._cancelAutoPlayOnInteraction=options.cancelOnInteraction===undefined?true:options.cancelOnInteraction;setTimeout(this._onAutoPlayToNextItem.bind(this),this._autoPlayDelay);if(this._cancelAutoPlayOnInteraction){this.on(Gallery.UPDATE,this.stopAutoPlay)}};proto.stopAutoPlay=function(){this._isAutoPlaying=false;if(this._cancelAutoPlayOnInteraction){this.off(Gallery.UPDATE,this.stopAutoPlay)}};proto.getElement=function(){return this._el};proto.getToggleNav=function(){return this._toggleNav||null};proto.resize=function(winWidth,winHeight){if(this._resizeContainer){this._itemHeights=[];var index=this._items.length;while(index--){this._storeItemHeight(this._items[index],false)}if(this._containerResizeDuration!==false){this._setElHeight(this._itemHeightsLookup[this._currentItem.getElementId()])}else{this._setElHeight(this._itemHeights[0].height)}}if(this._toggleNav){this._toggleNav.resize()}this.trigger(AutoGallery.RESIZED,this)};proto.destroy=function(options){if(this._isAutoPlaying){this.stopAutoPlay()}if(this._resizeContainer){ac_dom_styles.setStyle(this._el,{height:null,transition:null})}if(this._enableArrowKeys){Keyboard.offDown(keyMap.ARROW_RIGHT,this._rightArrowFunc);Keyboard.offDown(keyMap.ARROW_LEFT,this._leftArrowFunc)}var index;if(this._previousButtons){index=this._previousButtons.length;while(index--){ac_removeEventListener(this._previousButtons[index],"click",this._onPaddlePrevious)}this._setPaddleDisabledState(this._previousButtons,false)}if(this._nextButtons){index=this._nextButtons.length;while(index--){ac_removeEventListener(this._nextButtons[index],"click",this._onPaddleNext)}this._setPaddleDisabledState(this._nextButtons,false)}if(this._dynamicPaddleNav){this._el.removeChild(this._dynamicPaddleNav)}if(this._hasPaddleNavStateHandler){this.off(Gallery.UPDATE,this._updatePaddleNavState)}if(this._touchSwipe){this._touchSwipe.off(PointerTracker.END,this._onSwipeEnd);this._touchSwipe.destroy();this._touchSwipe=null}if(this._clickSwipe){this._clickSwipe.off(PointerTracker.END,this._onSwipeEnd);this._clickSwipe.destroy();this._clickSwipe=null}if(this._toggleNav){this._toggleNav.destroy();this._toggleNav=null}ac_removeEventListener(window,"resize",this._onWindowResize);this._el=null;this._itemHeights=null;this._itemHeightsLookup=null;this._resizeContainer=null;this._isRightToLeft=null;this._enableArrowKeys=null;this._previousButtons=null;this._onPaddlePrevious=null;this._nextButtons=null;this._onPaddleNext=null;return superProto.destroy.call(this,options)};proto._getDeeplinkedItem=function(){var path=window.location.hash.substr(1);var item;var index=this._items.length;while(index--){item=this._items[index];if(path===item.getElementId()){return item}}return null};proto._addItems=function(itemSelector){var item;var items;var isDataAttribute=/(^\[).*(\]$)/.test(itemSelector);if(isDataAttribute){itemSelector=itemSelector.replace(/\[|\]/g,"");items=selectElementThatHasDataAttribute(itemSelector,this._el)}else{items=ac_querySelectorAll(itemSelector,this._el)}var index=0;var length=items.length;for(index;index<length;index++){item=new this._itemType(items[index]);this.addItem(item);this._addItemTriggers(item)}};proto._createToggleNav=function(){var id=this._getElementId();var selector='[data-ac-gallery-togglenav="'+id+'"], [data-ac-gallery-tabnav="'+id+'"]';var toggleNavEl=ac_querySelector(selector);if(toggleNavEl){this._toggleNav=new ToggleNav(toggleNavEl,this,{duration:this._toggleNavDuration})}};proto._addItemTriggers=function(item,additionalTriggers){var triggers=selectElementFromDataAttributeValue("data-ac-gallery-trigger",item.getElementId());if(additionalTriggers&&additionalTriggers.length){triggers=triggers.concat(additionalTriggers)}var index=0;var length=triggers.length;for(index;index<length;index++){item.addElementTrigger(triggers[index]);if(this._toggleNav){this._toggleNav.addTrigger(triggers[index],item)}}};proto._addPaddleNav=function(autoAdd){var index;var id=this._getElementId();if(autoAdd){var template=typeof autoAdd==="string"?autoAdd:DEFAULT_PADDLENAV_TEMPLATE;template=template.replace(/%ID%/g,this._getElementId());this._dynamicPaddleNav=document.createElement("div");this._dynamicPaddleNav.innerHTML=template;this._el.insertBefore(this._dynamicPaddleNav,this._el.firstChild)}this._previousButtons=selectElementFromDataAttributeValue("data-ac-gallery-previous-trigger",id);this._nextButtons=selectElementFromDataAttributeValue("data-ac-gallery-next-trigger",id);var galleryLabel=this._el.getAttribute("aria-label")||"";if(galleryLabel.length){galleryLabel="("+galleryLabel+")"}this._onPaddlePrevious=this._onPaddleInteraction.bind(null,this.showPrevious);index=this._previousButtons.length;if(index){var previousAriaLabel=this._el.getAttribute("data-ac-gallery-previouslabel");if(previousAriaLabel&&galleryLabel.length){if(this._isRightToLeft){previousAriaLabel=galleryLabel+" "+previousAriaLabel}else{previousAriaLabel+=" "+galleryLabel}}while(index--){if(previousAriaLabel&&this._previousButtons[index].getAttribute("aria-label")===null){this._previousButtons[index].setAttribute("aria-label",previousAriaLabel)}ac_addEventListener(this._previousButtons[index],"click",this._onPaddlePrevious)}}this._onPaddleNext=this._onPaddleInteraction.bind(null,this.showNext);index=this._nextButtons.length;if(index){var nextAriaLabel=this._el.getAttribute("data-ac-gallery-nextlabel");if(nextAriaLabel&&galleryLabel.length){if(this._isRightToLeft){nextAriaLabel=galleryLabel+" "+nextAriaLabel}else{nextAriaLabel+=" "+galleryLabel}}while(index--){if(nextAriaLabel&&this._nextButtons[index].getAttribute("aria-label")===null){this._nextButtons[index].setAttribute("aria-label",nextAriaLabel)}ac_addEventListener(this._nextButtons[index],"click",this._onPaddleNext)}}if(this._nextButtons.length||this._previousButtons.length){this._hasPaddleNavStateHandler=true;this._updatePaddleNavState=this._updatePaddleNavState.bind(this);this.on(Gallery.UPDATE,this._updatePaddleNavState)}};proto._onPaddleInteraction=function(method,evt){preventDefault(evt);method.call(null,{interactionEvent:evt})};proto._updatePaddleNavState=function(){if(!this._wrapAround){var index=this._items.indexOf(this._currentItem);if(index===0&&this._previousButtons.length){this._setPaddleDisabledState(this._previousButtons,true);this._setPaddleDisabledState(this._nextButtons,false)}else if(index===this._items.length-1&&this._nextButtons.length){this._setPaddleDisabledState(this._nextButtons,true);this._setPaddleDisabledState(this._previousButtons,false)}else{this._setPaddleDisabledState(this._previousButtons,false);this._setPaddleDisabledState(this._nextButtons,false)}}else{this._setPaddleDisabledState(this._previousButtons,false);this._setPaddleDisabledState(this._nextButtons,false)}};proto._setPaddleDisabledState=function(paddles,isDisabled){var index=paddles.length;while(index--){paddles[index].disabled=isDisabled;if(isDisabled){ac_classList.add(paddles[index],CSS_DISABLED_CLASS)}else{ac_classList.remove(paddles[index],CSS_DISABLED_CLASS)}}};proto._addKeyboardListener=function(){if(this._enableArrowKeys){this._onKeyboardInteraction=this._onKeyboardInteraction.bind(this);var rightArrowFunc;var leftArrowFunc;if(this._isRightToLeft){rightArrowFunc=this.showPrevious;leftArrowFunc=this.showNext}else{rightArrowFunc=this.showNext;leftArrowFunc=this.showPrevious}this._rightArrowFunc=throttle(this._onKeyboardInteraction.bind(null,rightArrowFunc),this._keyboardThrottleDelay);this._leftArrowFunc=throttle(this._onKeyboardInteraction.bind(null,leftArrowFunc),this._keyboardThrottleDelay);Keyboard.onDown(keyMap.ARROW_RIGHT,this._rightArrowFunc);Keyboard.onDown(keyMap.ARROW_LEFT,this._leftArrowFunc)}};proto._onKeyboardInteraction=function(method,evt){if(this.isInView()){var galleries=Gallery.getAllInView();if(galleries.length>1){galleries.sort(function(a,b){a=a._enableArrowKeys?a.getCurrentItem().percentageInView():0;b=b._enableArrowKeys?b.getCurrentItem().percentageInView():0;return b-a});if(this!==galleries[0]){return}}method.call(null,{interactionEvent:evt})}};proto._setUpSwiping=function(forTouch,forClick){this._onSwipeEnd=this._onSwipeEnd.bind(this);if(forTouch){this._touchSwipe=new PointerTracker(this._el,PointerTracker.TOUCH_EVENTS);this._touchSwipe.on(PointerTracker.END,this._onSwipeEnd)}if(forClick){this._clickSwipe=new PointerTracker(this._el,PointerTracker.MOUSE_EVENTS);this._clickSwipe.on(PointerTracker.END,this._onSwipeEnd)}};proto._onSwipeEnd=function(evt){var method;var options={interactionEvent:evt.interactionEvent};if(evt.swipe===PointerTracker.SWIPE_RIGHT){method=this._isRightToLeft?this.showNext:this.showPrevious}else if(evt.swipe===PointerTracker.SWIPE_LEFT){method=this._isRightToLeft?this.showPrevious:this.showNext}if(method){return method.call(this,options)}return null};proto._getElementId=function(){if(this._elementId===undefined){this._elementId=this._el.getAttribute("id")}return this._elementId};proto._setUpContainerAutoResize=function(resizeContainerOnUpdate){if(typeof resizeContainerOnUpdate==="number"){this._containerResizeDuration=resizeContainerOnUpdate}else if(resizeContainerOnUpdate){this._containerResizeDuration=DEFAULT_CONTAINER_RESIZE_DURATION}else{this._containerResizeDuration=false}if(this._containerResizeDuration!==false){this._resizeContainer=true;this._updateContainerSize=this._updateContainerSize.bind(this);this.on(Gallery.UPDATE,this._updateContainerSize)}};proto._updateContainerSize=function(items){var height=this._itemHeightsLookup[items.incoming[0].getElementId()];if(height){this._setElHeight(height,this._containerResizeDuration)}};proto._storeItemHeight=function(item,resizeEl){var bounds=getContentDimensions(item.getElement());this._itemHeights.push({item:item,height:bounds.height});this._itemHeightsLookup[item.getElementId()]=bounds.height;this._itemHeights.sort(function(a,b){return b.height-a.height});if(resizeEl&&this._itemHeights[0].item===item){this._setElHeight(bounds.height)}};proto._setElHeight=function(height,duration){var styles={height:height+"px"};if(duration){styles["transition"]="height "+duration+"s"}else{styles["transition"]=null}ac_dom_styles.setStyle(this._el,styles)};proto._onAutoPlayToNextItem=function(){if(this._isAutoPlaying){if(!PageVisibilityManager.isHidden&&this._currentItem.isInView()){if(this._cancelAutoPlayOnInteraction){this.off(Gallery.UPDATE,this.stopAutoPlay)}var item=this.showNext();if(item!==null){if(this._cancelAutoPlayOnInteraction){this.on(Gallery.UPDATE,this.stopAutoPlay)}setTimeout(this._onAutoPlayToNextItem.bind(this),this._autoPlayDelay)}}else{setTimeout(this._onAutoPlayToNextItem.bind(this),this._autoPlayDelay)}}};proto._onWindowResize=function(evt){window.requestAnimationFrame(function(){if(this._el){this.resize()}}.bind(this))};module.exports=AutoGallery},{"../templates/paddlenav.js":169,"./../Gallery":150,"./../helpers/selectElementFromDataAttributeValue":161,"./../helpers/selectElementThatHasDataAttribute":162,"./../navigation/ToggleNav":163,"@marcom/ac-classlist":20,"@marcom/ac-dom-events/addEventListener":54,"@marcom/ac-dom-events/preventDefault":57,"@marcom/ac-dom-events/removeEventListener":58,"@marcom/ac-dom-metrics/getContentDimensions":66,"@marcom/ac-dom-styles":88,"@marcom/ac-dom-traversal/querySelector":97,"@marcom/ac-dom-traversal/querySelectorAll":98,"@marcom/ac-feature/touchAvailable":143,"@marcom/ac-function/throttle":147,"@marcom/ac-keyboard":175,"@marcom/ac-keyboard/keyMap":177,"@marcom/ac-object/create":186,"@marcom/ac-page-visibility":148,"@marcom/ac-pointer-tracker":196,"@marcom/ac-polyfills/requestAnimationFrame":"@marcom/ac-polyfills/requestAnimationFrame"}],155:[function(require,module,exports){"use strict";var create=require("./create");var selectElementThatHasDataAttribute=require("./../helpers/selectElementThatHasDataAttribute");var Gallery=require("./../Gallery");var FADE_DATA_ATTRIBUTE=Gallery.FADE_SELECTOR.replace(/\[|\]/g,"");var SLIDE_DATA_ATTRIBUTE=Gallery.SLIDE_SELECTOR.replace(/\[|\]/g,"");module.exports=function autoCreate(options){options=options||{};var context=options.context||document.body;var elements;var index;elements=selectElementThatHasDataAttribute(SLIDE_DATA_ATTRIBUTE,context);index=elements.length;while(index--){create(elements[index],Gallery.SLIDE,options)}elements=selectElementThatHasDataAttribute(FADE_DATA_ATTRIBUTE,context);index=elements.length;while(index--){create(elements[index],Gallery.FADE,options)}return Gallery.getAll()}},{"./../Gallery":150,"./../helpers/selectElementThatHasDataAttribute":162,"./create":156}],156:[function(require,module,exports){"use strict";var FadeGallery=require("./../fade/FadeGallery");var Gallery=require("./../Gallery");var SlideGallery=require("./../slide/SlideGallery");var ERROR_GALLERY_TYPE_UNSUPPORTED="%TYPE% is not a supported gallery type and el has no gallery data attribute.";var FADE_DATA_ATTRIBUTE=Gallery.FADE_SELECTOR.replace(/\[|\]/g,"");var SLIDE_DATA_ATTRIBUTE=Gallery.SLIDE_SELECTOR.replace(/\[|\]/g,"");module.exports=function create(el,type,options){var GalleryType;if(typeof type==="string"){if(type===Gallery.SLIDE){GalleryType=SlideGallery}else if(type===Gallery.FADE){GalleryType=FadeGallery}}if(GalleryType===undefined){if(el.getAttribute(SLIDE_DATA_ATTRIBUTE)!==null){GalleryType=SlideGallery}else if(el.getAttribute(FADE_DATA_ATTRIBUTE)!==null){GalleryType=FadeGallery}}if(GalleryType===undefined){throw new Error(ERROR_GALLERY_TYPE_UNSUPPORTED.replace(/%TYPE%/g,type))}return new GalleryType(el,options)}},{"./../Gallery":150,"./../fade/FadeGallery":157,"./../slide/SlideGallery":166}],157:[function(require,module,exports){"use strict";var clone=require("@marcom/ac-object/clone");var create=require("@marcom/ac-object/create");var FadeItem=require("./FadeItem");var AutoGallery=require("./../auto/AutoGallery");var DEFAULT_FADE_DURATION=.5;function FadeGallery(el,options){options=clone(options)||{};options.itemType=options.itemType||FadeItem;this._fadeDuration=options.duration||DEFAULT_FADE_DURATION;options.toggleNavDuration=options.toggleNavDuration===undefined?this._fadeDuration:options.toggleNavDuration;this._crossFade=options.crossFade;this._zIndexCount=options.startZIndex||1;this._ease=options.ease;if(options.resizeContainerOnUpdate===true){options.resizeContainerOnUpdate=this._fadeDuration}this._onItemShowComplete=this._onItemShowComplete.bind(this);AutoGallery.call(this,el,options);if(this._currentItem){this._currentItem.fadeIn(0)}}FadeGallery.RESIZED=AutoGallery.RESIZED;FadeGallery.UPDATE=AutoGallery.UPDATE;FadeGallery.UPDATE_COMPLETE=AutoGallery.UPDATE_COMPLETE;var superProto=AutoGallery.prototype;var proto=FadeGallery.prototype=create(superProto);proto.addItem=function(item,index){if(item.nodeType){item=new this._itemType(item)}var returnValue=superProto.addItem.call(this,item,index);if(item!==this._currentItem){item.fadeOut()}else{item.fadeIn(0)}return returnValue};proto.destroy=function(options){var returnValue=superProto.destroy.call(this,options);this._fadeDuration=null;this._crossFade=null;this._zIndexCount=null;this._ease=null;this._onItemShowComplete=null;return returnValue};proto._onItemShowComplete=function(clip){if(clip&&clip.target()!==this._currentItem.getElement()){if(!this._currentItem.isFading()){this._currentItem.fadeIn(this._fadeDuration,this._ease,++this._zIndexCount,this._onItemShowComplete)}return}var item;var index=this._items.length;while(index--){item=this._items[index];if(item!==this._currentItem){item.fadeOut()}}if(this._incomingOutgoingItems){this.trigger(FadeGallery.UPDATE_COMPLETE,this._incomingOutgoingItems)}};proto._updateItems=function(items,silent){if(silent){return}if(this._crossFade){var callback=silent?null:this.trigger.bind(this,FadeGallery.UPDATE_COMPLETE,items);items.outgoing[0].fadeOut(this._fadeDuration*.99,this._ease);items.incoming[0].fadeIn(this._fadeDuration,this._ease,++this._zIndexCount,callback)}else{this._incomingOutgoingItems=silent?false:items;if(!items.outgoing[0].isFading()){items.incoming[0].fadeIn(this._fadeDuration,this._ease,++this._zIndexCount,this._onItemShowComplete)}}items.outgoing[0].hide();items.incoming[0].show()};module.exports=FadeGallery},{"./../auto/AutoGallery":154,"./FadeItem":158,"@marcom/ac-object/clone":185,"@marcom/ac-object/create":186}],158:[function(require,module,exports){"use strict";var setStyle=require("@marcom/ac-dom-styles/setStyle");var create=require("@marcom/ac-object/create");var fade=require("@marcom/ac-solar/fade");var fadeIn=require("@marcom/ac-solar/fadeIn");var fadeOut=require("@marcom/ac-solar/fadeOut");var Item=require("./../Item");function FadeItem(el){Item.call(this,el);setStyle(el,{position:"absolute"})}FadeItem.SELECTED=Item.SELECTED;FadeItem.SHOW=Item.SHOW;FadeItem.HIDE=Item.HIDE;var superProto=Item.prototype;var proto=FadeItem.prototype=create(superProto);proto.fadeIn=function(duration,ease,zIndex,callback){if(duration){setStyle(this._el,{zIndex:zIndex||1});this._destroyCurrentClip();this._clip=fade(this._el,0,1,duration,{ease:ease,onComplete:callback})}else{fadeIn(this._el,0);setStyle(this._el,{zIndex:zIndex||1})}};proto.fadeOut=function(duration,ease){if(duration){this._destroyCurrentClip();this._clip=fadeOut(this._el,duration,{ease:ease})}else{fadeOut(this._el,0)}};proto.isFading=function(){return!!(this._clip&&this._clip.playing())};proto.destroy=function(){setStyle(this._el,{position:null,opacity:null,zIndex:null});superProto.destroy.call(this);this._destroyCurrentClip();this._clip=null};proto._destroyCurrentClip=function(){if(this.isFading()){this._clip.destroy()}};module.exports=FadeItem},{"./../Item":151,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-object/create":186,"@marcom/ac-solar/fade":242,"@marcom/ac-solar/fadeIn":243,"@marcom/ac-solar/fadeOut":244}],159:[function(require,module,exports){"use strict";var create=require("@marcom/ac-object/create");var extend=require("@marcom/ac-object/extend");module.exports=function extendProto(proto){var self=this;var Child=function(){self.apply(this,arguments)};var childProto=create(this.prototype);Child.prototype=extend(childProto,proto);extend(Child,this);return Child}},{"@marcom/ac-object/create":186,"@marcom/ac-object/extend":188}],160:[function(require,module,exports){"use strict";var getStyle=require("@marcom/ac-dom-styles/getStyle");var getContentDimensions=require("@marcom/ac-dom-metrics/getContentDimensions");module.exports=function getElementFullWidth(el){var styles=getStyle(el,"margin-right","margin-left");return Math.round(getContentDimensions(el).width)+parseInt(styles.marginRight,10)+parseInt(styles.marginLeft,10)}},{"@marcom/ac-dom-metrics/getContentDimensions":66,"@marcom/ac-dom-styles/getStyle":89}],161:[function(require,module,exports){"use strict";var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var selectInIE7=function(dataAttribute,value){var el;var elements=document.getElementsByTagName("*");var index=0;var length=elements.length;var matches=[];for(index;index<length;index++){el=elements[index];if(el.getAttribute(dataAttribute)!==null&&el.getAttribute(dataAttribute).split(" ").indexOf(value)>-1){matches[matches.length]=el}}return matches};module.exports=function selectElementFromDataAttributeValue(dataAttribute,value){var elements=ac_querySelectorAll("["+dataAttribute+'*="'+value+'"]');if(elements.length===0&&document.documentMode===7){return selectInIE7(dataAttribute,value)}var selectedElements=[];var index=0;var length=elements.length;var values;for(index;index<length;index++){values=elements[index].getAttribute(dataAttribute);if(values===value){selectedElements.push(elements[index])}else if(values&&values.length){values=values.split(" ");if(values.indexOf(value)>-1){selectedElements.push(elements[index])}}}return selectedElements}},{"@marcom/ac-dom-traversal/querySelectorAll":98}],162:[function(require,module,exports){"use strict";var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var ancestors=require("@marcom/ac-dom-traversal/ancestors");var selectInIE7=function(dataAttribute,context){var el;var elements=document.getElementsByTagName("*");var index=0;var length=elements.length;var matches=[];for(index;index<length;index++){el=elements[index];if(el.getAttribute(dataAttribute)!==null&&(!context||ancestors(el).indexOf(context)>-1)){matches[matches.length]=el}}return matches};module.exports=function selectElementThatHasDataAttribute(dataAttribute,context){context=context||document.body;var elements=ac_querySelectorAll("["+dataAttribute+"]",context);if(elements.length===0&&document.documentMode===7){return selectInIE7(dataAttribute,context)}return elements}},{"@marcom/ac-dom-traversal/ancestors":93,"@marcom/ac-dom-traversal/querySelectorAll":98}],163:[function(require,module,exports){"use strict";var ac_addEventListener=require("@marcom/ac-dom-events/addEventListener");var ac_removeEventListener=require("@marcom/ac-dom-events/removeEventListener");var getDimensions=require("@marcom/ac-dom-metrics/getDimensions");var getPosition=require("@marcom/ac-dom-metrics/getPosition");var getStyle=require("@marcom/ac-dom-styles/getStyle");var setStyle=require("@marcom/ac-dom-styles/setStyle");var ancestors=require("@marcom/ac-dom-traversal/ancestors");var create=require("@marcom/ac-object/create");var scrollX=require("@marcom/ac-solar/scrollX");var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var Gallery=require("./../Gallery");var DEFAULT_SLIDE_DURATION=.5;function ToggleNav(el,gallery,options){options=options||{};this._el=el;this._isRightToLeft=options.rightToLeft===undefined?getStyle(el,"direction").direction==="rtl":options.rightToLeft;this._scrollType=this._scrollDirection();this._gallery=gallery;this._triggers={};this._ordered=[];this._containerEl=this._el.children[0];this._slideDuration=options.duration===undefined?DEFAULT_SLIDE_DURATION:options.duration;EventEmitterMicro.call(this)}var superProto=EventEmitterMicro.prototype;var proto=ToggleNav.prototype=create(superProto);proto.start=function(){this._onWindowLoad=this._onWindowLoad.bind(this);this._onGalleryUpdated=this._onGalleryUpdated.bind(this);this._gallery.on(Gallery.UPDATE,this._onGalleryUpdated);this.resize();ac_addEventListener(window,"load",this._onWindowLoad)};proto.addTrigger=function(el,item){if(this._triggers[item.getElementId()]!==undefined){return}var els=ancestors(el);if(els.indexOf(this._el)>-1){var triggerObject={el:el};this._triggers[item.getElementId()]=triggerObject;this._ordered.push(triggerObject)}};proto.resize=function(){if(!this._ordered.length){return}setStyle(this._containerEl,{paddingLeft:null,paddingRight:null});this._containerWidth=getDimensions(this._containerEl).width;this._width=getDimensions(this._el).width;this._viewCenter=Math.round(this._width*.5);var index=this._ordered.length;while(index--){this._setTriggerData(this._ordered[index])}this._ordered.sort(function(a,b){return a.left-b.left});if(this._containerWidth>this._width){var firstItem=this._ordered[0];var lastItem=this._ordered[this._ordered.length-1];var paddingLeft=(this._width-firstItem.width)*.5;var paddingRight=(this._width-lastItem.width)*.5;setStyle(this._containerEl,{paddingLeft:paddingLeft+"px",paddingRight:paddingRight+"px"});var trigger=this._triggers[this._gallery.getCurrentItem().getElementId()];if(trigger){this._centerNav(trigger)}}};proto.destroy=function(){this._gallery.off(Gallery.UPDATE,this._onGalleryUpdated);ac_removeEventListener(window,"load",this._onWindowLoad);setStyle(this._containerEl,{paddingLeft:null,paddingRight:null});this._el=null;this._gallery=null;this._triggers=null;this._ordered=null;this._containerEl=null;this._destroyCurrentClip();this._clip=null;return superProto.destroy.call(this)};proto._onWindowLoad=function(){ac_removeEventListener(window,"load",this._onWindowLoad);this.resize()};proto._setTriggerData=function(trigger){trigger.width=getDimensions(trigger.el).width;var position=getPosition(trigger.el);trigger.left=position.left;trigger.right=position.right;trigger.center=trigger.left+trigger.width*.5};proto._centerNav=function(trigger,duration){this._setTriggerData(trigger);this._width=getDimensions(this._el).width;this._viewCenter=Math.round(this._width*.5);var xp=Math.round(trigger.center-this._viewCenter);if(this._isRightToLeft){if(this._scrollType!=="negative"){xp=Math.abs(xp)}if(this._scrollType==="default"){xp=this._el.scrollWidth-this._el.clientWidth-xp}}this._destroyCurrentClip();if(duration){this._clip=scrollX(this._el,xp,duration)}else{this._el.scrollLeft=xp}};proto._onGalleryUpdated=function(items){var trigger=this._triggers[items.incoming[0].getElementId()];if(trigger){this._centerNav(trigger,this._slideDuration)}};proto._destroyCurrentClip=function(){if(this._clip&&this._clip.playing()){this._clip.destroy()}};proto._scrollDirection=function(){var scrollType="reverse";var scrollTest=document.createElement("div");scrollTest.style.cssText="width:2px; height:1px; position:absolute; top:-1000px; overflow:scroll; font-size: 14px;";scrollTest.style.direction="rtl";scrollTest.innerHTML="test";document.body.appendChild(scrollTest);if(scrollTest.scrollLeft>0){scrollType="default"}else{scrollTest.scrollLeft=1;if(scrollTest.scrollLeft===0){scrollType="negative"}}document.body.removeChild(scrollTest);return scrollType};module.exports=ToggleNav},{"./../Gallery":150,"@marcom/ac-dom-events/addEventListener":54,"@marcom/ac-dom-events/removeEventListener":58,"@marcom/ac-dom-metrics/getDimensions":67,"@marcom/ac-dom-metrics/getPosition":71,"@marcom/ac-dom-styles/getStyle":89,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-dom-traversal/ancestors":93,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-object/create":186,"@marcom/ac-solar/scrollX":248}],164:[function(require,module,exports){"use strict";var AnalyticsManager=require("./../analytics/AnalyticsManager");module.exports=new AnalyticsManager},{"./../analytics/AnalyticsManager":153}],165:[function(require,module,exports){"use strict";var focusableElements=["input","select","textarea","button","object"];var focusableAttribute=["href","tabindex","contenteditable"];var TabManager=function(){this.focusableSelectors=focusableElements.concat(focusableAttribute.map(function(attribute){return attribute==="href"?"a["+attribute+"]":"*["+attribute+"]"})).join(",")};var proto=TabManager.prototype;proto.isFocusable=function(element,tabIndex){var nodeName=element.nodeName.toLowerCase();var isFocusableElement=focusableElements.indexOf(nodeName)>-1;if(nodeName==="a"){return true}if(isFocusableElement){return!element.disabled}if(!element.contentEditable){return true}tabIndex=tabIndex||element.tabIndex;return isNaN(tabIndex)};proto.isTabbable=function(element){var tabIndex=element.getAttribute("tabindex");if(!isNaN(tabIndex)){return tabIndex>=0}else{return this.isFocusable(element,tabIndex)}};proto.getTabbable=function(focusableElements){var l=focusableElements.length;var tabbableElements=[];for(var i=0;i<l;i++){if(this.isTabbable(focusableElements[i])){tabbableElements.push(focusableElements[i])}}return tabbableElements};module.exports=new TabManager},{}],166:[function(require,module,exports){"use strict";var ac_classList=require("@marcom/ac-classlist");var ac_dom_styles=require("@marcom/ac-dom-styles");var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var clone=require("@marcom/ac-object/clone");var create=require("@marcom/ac-object/create");var getElementFullWidth=require("./../helpers/getElementFullWidth");var moveX=require("@marcom/ac-solar/moveX");var selectElementFromDataAttributeValue=require("./../helpers/selectElementFromDataAttributeValue");var selectElementThatHasDataAttribute=require("./../helpers/selectElementThatHasDataAttribute");var AutoGallery=require("./../auto/AutoGallery");var PointerTracker=require("@marcom/ac-pointer-tracker").PointerTracker;var SlideItem=require("./SlideItem");var SlideItemWrapper=require("./SlideItemWrapper");var draw=require("@marcom/ac-raf-emitter/draw");var DEFAULT_ITEM_CENTER_POINT=.5;var DEFAULT_SLIDE_DURATION=.5;function SlideGallery(el,options){options=clone(options)||{};options.itemType=options.itemType||SlideItem;this._itemsPerSlide=options.itemsPerSlide||1;var deeplink=options.deeplink!==false;options.deeplink=false;this._slideDuration=options.duration!==undefined?options.duration:DEFAULT_SLIDE_DURATION;options.toggleNavDuration=options.toggleNavDuration===undefined?this._slideDuration:options.toggleNavDuration;this._itemCenterPoint=options.itemCenterPoint!==undefined?options.itemCenterPoint:DEFAULT_ITEM_CENTER_POINT;this._slideOptions={ease:options.ease};if(options.resizeContainerOnUpdate===true){options.resizeContainerOnUpdate=this._slideDuration}options.touch=options.touch!==false;this._originalWrapAround=options.wrapAround||false;AutoGallery.call(this,el,options);if(deeplink){var item=this._getDeeplinkedItem();if(item){if(this._currentItem!==item){this._currentItem.hide();this._setCurrentItem(item);this._currentItem.show()}}}this._positionItems=this._positionItems.bind(this);this._createContainer();if(this._items.length!==0){this._positionItems()}this._isInstantiated=true}SlideGallery.RESIZED=AutoGallery.RESIZED;SlideGallery.UPDATE=AutoGallery.UPDATE;SlideGallery.UPDATE_COMPLETE=AutoGallery.UPDATE_COMPLETE;var superProto=AutoGallery.prototype;var proto=SlideGallery.prototype=create(superProto);proto.addItem=function(item,index){if(item.nodeType){item=new this._itemType(item)}var returnValue=superProto.addItem.call(this,item,index);if(this._containerEl!==undefined){this._addItemToContainer(item);this._positionItems()}this._updateWrapAround();return returnValue};proto.removeItem=function(item,options){if(this._containerEl&&item.getElement().parentElement===this._containerEl){var parentElement=item.getOriginalParentElement();if(parentElement){parentElement.appendChild(item.getElement())}else if(typeof item.removeItems==="function"){item.removeItems();options.destroyItem=true}var returnValue=superProto.removeItem.call(this,item,options);if(this._currentItem){this._positionItems(this._currentItem)}this._updateWrapAround();return returnValue}return superProto.removeItem.call(this,item,options)};proto.resize=function(){this._positionItems();this._snapToPosition(this._currentItem.position());return superProto.resize.call(this)};proto.destroy=function(options){this._destroyCurrentClip();this._clip=null;var index=this._items.length;while(index--){this._items[index].off(SlideItem.CENTER_POINT_CHANGED,this._positionItems)}if(this._touchSwipe){this._touchSwipe.off(PointerTracker.START,this._onSwipeStart);this._touchSwipe.off(PointerTracker.UPDATE,this._onSwipeUpdate)}if(this._clickSwipe){this._clickSwipe.off(PointerTracker.START,this._onSwipeStart);this._clickSwipe.off(PointerTracker.UPDATE,this._onSwipeUpdate)}var el=this._el;var returnValue=superProto.destroy.call(this,options);el.removeChild(this._containerEl);this._containerEl=null;this._slideDuration=null;this._itemCenterPoint=null;this._positionItems=null;this._slideOptions=null;return returnValue};proto._addItems=function(itemSelector){if(this._itemsPerSlide>1){var items;var isDataAttribute=/(^\[).*(\]$)/.test(itemSelector);if(isDataAttribute){items=selectElementThatHasDataAttribute(itemSelector.replace(/\[|\]/g,""),this._el)}else{items=ac_querySelectorAll(itemSelector,this._el)}var itemWrapper;var triggers;var elementId;var count=0;var index=0;var length=items.length;for(index;index<length;index++){if(count===0){itemWrapper=new SlideItemWrapper}itemWrapper.addItem(items[index]);elementId=items[index].getAttribute("id");if(elementId){triggers=selectElementFromDataAttributeValue("data-ac-gallery-trigger",elementId);this._addItemTriggers(itemWrapper,triggers)}if(++count===this._itemsPerSlide||index===length-1){count=0;itemWrapper.resize();this.addItem(itemWrapper)}}}else{superProto._addItems.call(this,itemSelector)}};proto._createContainer=function(){this._containerEl=document.createElement("div");ac_classList.add(this._containerEl,"ac-gallery-slidecontainer");ac_dom_styles.setStyle(this._containerEl,{position:"absolute",left:"0",top:"0",width:"100%",height:"100%"});this._el.appendChild(this._containerEl);var index=0;var length=this._items.length;for(index;index<length;index++){this._addItemToContainer(this._items[index])}};proto._addItemToContainer=function(item){draw(function(item){this._containerEl.appendChild(item.getElement())}.bind(this,item));item.on(SlideItem.CENTER_POINT_CHANGED,this._positionItems)};proto._positionItems=function(itemToSnapTo){itemToSnapTo=itemToSnapTo||this._currentItem;var items=this._items;if(this._wrapAround){items=this._shuffleItems()}var diff=this._getActualPositionX()-itemToSnapTo.position()||0;var containerWidth=parseInt(ac_dom_styles.getStyle(this._el,"width").width,10);var xPosition=0;var index=0;var length=items.length;var item;var el;var width;var offset;var centerPoint;for(index;index<length;index++){item=items[index];item.resize();el=item.getElement();ac_dom_styles.setStyle(el,{left:xPosition+"px"});width=getElementFullWidth(el);offset=containerWidth-width;centerPoint=item.centerPoint&&item.centerPoint()!==null?item.centerPoint():this._itemCenterPoint;item.position(xPosition*-1+offset*centerPoint);if(this._isRightToLeft){xPosition-=width}else{xPosition+=width}}xPosition=itemToSnapTo.position()+diff;this._snapToPosition(xPosition)};proto._getActualPositionX=function(){var transformStyles=ac_dom_styles.getStyle(this._containerEl,"transform").transform;if(!transformStyles||transformStyles==="none"){var left=ac_dom_styles.getStyle(this._containerEl,"left").left;return parseInt(left,10)}else if(transformStyles===this._transformStyles&&this._actualPositionX!==undefined){return this._actualPositionX}this._transformStyles=transformStyles;var spiltMatrix=this._transformStyles.split(",");this._actualPositionX=spiltMatrix[4]||this._currentItem.position();return this._actualPositionX*1};proto._snapToPosition=function(positionX){this._destroyCurrentClip();this._positionX=positionX;ac_dom_styles.setStyle(this._containerEl,{transition:"transform 0s, left 0s"});moveX(this._containerEl,positionX,0,this._slideOptions)};proto._slideToPosition=function(positionX,duration,callback){this._positionX=positionX;this._clip=moveX(this._containerEl,positionX,duration,{ease:this._slideOptions.ease,onComplete:callback})};proto._setUpSwiping=function(forTouch,forClick){var returnValue=superProto._setUpSwiping.call(this,forTouch,forClick);this._onSwipeStart=this._onSwipeStart.bind(this);this._onSwipeUpdate=this._onSwipeUpdate.bind(this);if(this._touchSwipe){this._touchSwipe.on(PointerTracker.START,this._onSwipeStart);this._touchSwipe.on(PointerTracker.UPDATE,this._onSwipeUpdate)}if(this._clickSwipe){this._clickSwipe.on(PointerTracker.START,this._onSwipeStart);this._clickSwipe.on(PointerTracker.UPDATE,this._onSwipeUpdate)}return returnValue};proto._onSwipeStart=function(evt){if(this._clip&&this._clip.playing()){this._destroyCurrentClip();this._positionX=this._getActualPositionX()}};proto._onSwipeUpdate=function(evt){this._destroyCurrentClip();this._snapToPosition(this._positionX-evt.diffX)};proto._onSwipeEnd=function(evt){var item=superProto._onSwipeEnd.call(this,evt);if(item===null){item=this.show(this._currentItem,{interactionEvent:evt.interactionEvent})}return item};proto._shuffleItems=function(){var twoItemGalleryIsEngaged=this._items.length===2&&!this._isAutoPlaying;if(twoItemGalleryIsEngaged){return this._items.slice()}var totalItems=this._items.length;var currentIndex=this._items.indexOf(this._currentItem);var middleIndex=Math.floor(totalItems*.5);var itemsToSlice;var removedItems;var remainingItems;if(currentIndex<middleIndex){itemsToSlice=middleIndex-currentIndex;var sliceIndex=totalItems-itemsToSlice;removedItems=this._items.slice(sliceIndex);remainingItems=this._items.slice(0,sliceIndex);return removedItems.concat(remainingItems)}else if(currentIndex>middleIndex){itemsToSlice=currentIndex-middleIndex;removedItems=this._items.slice(0,itemsToSlice);remainingItems=this._items.slice(itemsToSlice);return remainingItems.concat(removedItems)}return this._items};proto._updateItems=function(items,silent){this._destroyCurrentClip();if(this._wrapAround){this._positionItems(items.outgoing[0])}if(this.getItemIndex(items.outgoing[0])>-1){var callback=silent?null:this.trigger.bind(this,SlideGallery.UPDATE_COMPLETE,items);var duration=this._slideDuration;this._slideToPosition(items.incoming[0].position(),duration,callback);if(items.incoming[0]!==items.outgoing[0]){items.incoming[0].show();items.outgoing[0].hide()}}else{this._slideToPosition(this._currentItem.position(),this._slideDuration);items.incoming[0].show();if(!silent){this.trigger(SlideGallery.UPDATE_COMPLETE,items)}}};proto._updateWrapAround=function(){if(this._items.length<=2){this._wrapAround=false}else if(this._originalWrapAround){this._wrapAround=this._originalWrapAround}if(this._isInstantiated&&(this._previousButtons||this._nextButtons)){this._updatePaddleNavState()}};proto._destroyCurrentClip=function(){if(this._clip&&this._clip.playing()){this._clip.destroy()}};module.exports=SlideGallery},{"./../auto/AutoGallery":154,"./../helpers/getElementFullWidth":160,"./../helpers/selectElementFromDataAttributeValue":161,"./../helpers/selectElementThatHasDataAttribute":162,"./SlideItem":167,"./SlideItemWrapper":168,"@marcom/ac-classlist":20,"@marcom/ac-dom-styles":88,"@marcom/ac-dom-traversal/querySelectorAll":98,"@marcom/ac-object/clone":185,"@marcom/ac-object/create":186,"@marcom/ac-pointer-tracker":196,"@marcom/ac-raf-emitter/draw":220,"@marcom/ac-solar/moveX":246}],167:[function(require,module,exports){"use strict";var setStyle=require("@marcom/ac-dom-styles/setStyle");var create=require("@marcom/ac-object/create");var Item=require("./../Item");function SlideItem(el){Item.call(this,el);setStyle(el,{position:"absolute","will-change":"transform"});this._parentElement=el.parentElement}SlideItem.CENTER_POINT_CHANGED="centerpointchanged";SlideItem.SELECTED=Item.SELECTED;SlideItem.SHOW=Item.SHOW;SlideItem.HIDE=Item.HIDE;var superProto=Item.prototype;var proto=SlideItem.prototype=create(superProto);proto.position=function(pos){if(pos!==undefined){this._position=pos}return this._position||0};proto.centerPoint=function(point){if(point!==undefined){this._centerPoint=point;this.trigger(SlideItem.CENTER_POINT_CHANGED)}return this._centerPoint!==undefined?this._centerPoint:null};proto.getOriginalParentElement=function(){return this._parentElement};proto.resize=function(){};proto.destroy=function(){setStyle(this._el,{position:null,left:null,transform:null});superProto.destroy.call(this)};module.exports=SlideItem},{"./../Item":151,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-object/create":186}],168:[function(require,module,exports){"use strict";var ac_classlist=require("@marcom/ac-classlist");var setStyle=require("@marcom/ac-dom-styles/setStyle");var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var create=require("@marcom/ac-object/create");var tabManager=require("./../singletons/tabManager");var getElementFullWidth=require("./../helpers/getElementFullWidth");var SlideItem=require("./SlideItem");var CSS_CLASSNAME="ac-gallery-slideitemwrapper";function SlideItemWrapper(){SlideItem.call(this,document.createElement("div"));this._items=[];this._currentWidth=0;ac_classlist.add(this._el,CSS_CLASSNAME)}var superProto=SlideItem.prototype;var proto=SlideItemWrapper.prototype=create(superProto);proto.addItem=function(el){this._items.push({el:el,parentElement:el.parentElement});this._el.appendChild(el);var elId=el.getAttribute("id");if(elId){var id=this._el.getAttribute("id")||"";var seperator=id.length?"-":"";id+=seperator+elId;this._el.setAttribute("id",id)}this._focusableEls=this._focusableEls.concat(ac_querySelectorAll(tabManager.focusableSelectors,el))};proto.removeItems=function(){var el;var parentElement;var index=0;var length=this._items.length;for(index;index<length;index++){el=this._items[index].el;setStyle(el,{position:null,left:null});parentElement=this._items[index].parentElement;if(parentElement){parentElement.appendChild(el)}}};proto.resize=function(){this._currentWidth=0;var el;var index=0;var length=this._items.length;for(index;index<length;index++){el=this._items[index].el;setStyle(el,{position:"absolute",left:this._currentWidth+"px"});this._currentWidth+=getElementFullWidth(el)}setStyle(this._el,{width:this._currentWidth+"px"})};proto.destroy=function(){this.removeItems();this._items=null;this._currentWidth=null;var parentElement=this._el.parentElement;if(parentElement){parentElement.removeChild(this._el)}superProto.destroy.call(this)};module.exports=SlideItemWrapper},{"./../helpers/getElementFullWidth":160,"./../singletons/tabManager":165,"./SlideItem":167,"@marcom/ac-classlist":20,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-dom-traversal/querySelectorAll":98,"@marcom/ac-object/create":186}],169:[function(require,module,exports){"use strict";var template="";template+='<nav class="paddlenav">';template+="<ul>";template+='<li><button class="paddlenav-arrow paddlenav-arrow-previous" data-ac-gallery-previous-trigger="%ID%"></button></li>';template+='<li><button class="paddlenav-arrow paddlenav-arrow-next" data-ac-gallery-next-trigger="%ID%"></button></li>';template+="</ul>";template+="</nav>";module.exports=template},{}],170:[function(require,module,exports){(function(global){"use strict";var base64=require("base64-js");var ieee754=require("ieee754");var isArray=require("isarray");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;Buffer.poolSize=8192;var rootParent={};Buffer.TYPED_ARRAY_SUPPORT=global.TYPED_ARRAY_SUPPORT!==undefined?global.TYPED_ARRAY_SUPPORT:typedArraySupport();function typedArraySupport(){function Bar(){}try{var arr=new Uint8Array(1);arr.foo=function(){return 42};arr.constructor=Bar;return arr.foo()===42&&arr.constructor===Bar&&typeof arr.subarray==="function"&&arr.subarray(1,1).byteLength===0}catch(e){return false}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Buffer(arg){if(!(this instanceof Buffer)){if(arguments.length>1)return new Buffer(arg,arguments[1]);return new Buffer(arg)}if(!Buffer.TYPED_ARRAY_SUPPORT){this.length=0;this.parent=undefined}if(typeof arg==="number"){return fromNumber(this,arg)}if(typeof arg==="string"){return fromString(this,arg,arguments.length>1?arguments[1]:"utf8")}return fromObject(this,arg)}function fromNumber(that,length){that=allocate(that,length<0?0:checked(length)|0);if(!Buffer.TYPED_ARRAY_SUPPORT){for(var i=0;i<length;i++){that[i]=0}}return that}function fromString(that,string,encoding){if(typeof encoding!=="string"||encoding==="")encoding="utf8";var length=byteLength(string,encoding)|0;that=allocate(that,length);that.write(string,encoding);return that}function fromObject(that,object){if(Buffer.isBuffer(object))return fromBuffer(that,object);if(isArray(object))return fromArray(that,object);if(object==null){throw new TypeError("must start with number, buffer, array or string")}if(typeof ArrayBuffer!=="undefined"){if(object.buffer instanceof ArrayBuffer){return fromTypedArray(that,object)}if(object instanceof ArrayBuffer){return fromArrayBuffer(that,object)}}if(object.length)return fromArrayLike(that,object);return fromJsonObject(that,object)}function fromBuffer(that,buffer){var length=checked(buffer.length)|0;that=allocate(that,length);buffer.copy(that,0,0,length);return that}function fromArray(that,array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that}function fromTypedArray(that,array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that}function fromArrayBuffer(that,array){if(Buffer.TYPED_ARRAY_SUPPORT){array.byteLength;that=Buffer._augment(new Uint8Array(array))}else{that=fromTypedArray(that,new Uint8Array(array))}return that}function fromArrayLike(that,array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that}function fromJsonObject(that,object){var array;var length=0;if(object.type==="Buffer"&&isArray(object.data)){array=object.data;length=checked(array.length)|0}that=allocate(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that}if(Buffer.TYPED_ARRAY_SUPPORT){Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array}else{Buffer.prototype.length=undefined;Buffer.prototype.parent=undefined}function allocate(that,length){if(Buffer.TYPED_ARRAY_SUPPORT){that=Buffer._augment(new Uint8Array(length));that.__proto__=Buffer.prototype}else{that.length=length;that._isBuffer=true}var fromPool=length!==0&&length<=Buffer.poolSize>>>1;if(fromPool)that.parent=rootParent;return that}function checked(length){if(length>=kMaxLength()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+kMaxLength().toString(16)+" bytes")}return length|0}function SlowBuffer(subject,encoding){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding);var buf=new Buffer(subject,encoding);delete buf.parent;return buf}Buffer.isBuffer=function isBuffer(b){return!!(b!=null&&b._isBuffer)};Buffer.compare=function compare(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError("Arguments must be Buffers")}if(a===b)return 0;var x=a.length;var y=b.length;var i=0;var len=Math.min(x,y);while(i<len){if(a[i]!==b[i])break;++i}if(i!==len){x=a[i];y=b[i]}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!isArray(list))throw new TypeError("list argument must be an Array of Buffers.");if(list.length===0){return new Buffer(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;i++){length+=list[i].length}}var buf=new Buffer(length);var pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos);pos+=item.length}return buf};function byteLength(string,encoding){if(typeof string!=="string")string=""+string;var len=string.length;if(len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"binary":case"raw":case"raws":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;start=start|0;end=end===undefined||end===Infinity?this.length:end|0;if(!encoding)encoding="utf8";if(start<0)start=0;if(end>this.length)end=this.length;if(end<=start)return"";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype.toString=function toString(){var length=this.length|0;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;if(this.length>0){str=this.toString("hex",0,max).match(/.{2}/g).join(" ");if(this.length>max)str+=" ... "}return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return 0;return Buffer.compare(this,b)};Buffer.prototype.indexOf=function indexOf(val,byteOffset){if(byteOffset>2147483647)byteOffset=2147483647;else if(byteOffset<-2147483648)byteOffset=-2147483648;byteOffset>>=0;if(this.length===0)return-1;if(byteOffset>=this.length)return-1;if(byteOffset<0)byteOffset=Math.max(this.length+byteOffset,0);if(typeof val==="string"){if(val.length===0)return-1;return String.prototype.indexOf.call(this,val,byteOffset)}if(Buffer.isBuffer(val)){return arrayIndexOf(this,val,byteOffset)}if(typeof val==="number"){if(Buffer.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==="function"){return Uint8Array.prototype.indexOf.call(this,val,byteOffset)}return arrayIndexOf(this,[val],byteOffset)}function arrayIndexOf(arr,val,byteOffset){var foundIndex=-1;for(var i=0;byteOffset+i<arr.length;i++){if(arr[byteOffset+i]===val[foundIndex===-1?0:i-foundIndex]){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===val.length)return byteOffset+foundIndex}else{foundIndex=-1}}return-1}throw new TypeError("val must be string, number or Buffer")};Buffer.prototype.get=function get(offset){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(offset)};Buffer.prototype.set=function set(v,offset){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(v,offset)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");if(length>strLen/2){length=strLen/2}for(var i=0;i<length;i++){var parsed=parseInt(string.substr(i*2,2),16);if(isNaN(parsed))throw new Error("Invalid hex string");buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset|0;if(isFinite(length)){length=length|0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length|0;length=swap}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"binary":return binaryWrite(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){ret+=String.fromCharCode(buf[i]&127)}return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT){newBuf=Buffer._augment(this.subarray(start,end))}else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,undefined);for(var i=0;i<sliceLen;i++){newBuf[i]=this[i+start]}}if(newBuf.length)newBuf.parent=this.parent||this;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||value<min)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,1,255,0);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);this[offset]=value&255;return offset+1};function objectWriteUInt16(buf,value,offset,littleEndian){if(value<0)value=65535+value+1;for(var i=0,j=Math.min(buf.length-offset,2);i<j;i++){buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>(littleEndian?i:1-i)*8}}Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8}else{objectWriteUInt16(this,value,offset,true)}return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value&255}else{objectWriteUInt16(this,value,offset,false)}return offset+2};function objectWriteUInt32(buf,value,offset,littleEndian){if(value<0)value=4294967295+value+1;for(var i=0,j=Math.min(buf.length-offset,4);i<j;i++){buf[offset+i]=value>>>(littleEndian?i:3-i)*8&255}}Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255}else{objectWriteUInt32(this,value,offset,true)}return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255}else{objectWriteUInt32(this,value,offset,false)}return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=value<0?1:0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=value<0?1:0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8}else{objectWriteUInt16(this,value,offset,true)}return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value&255}else{objectWriteUInt16(this,value,offset,false)}return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24}else{objectWriteUInt32(this,value,offset,true)}return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255}else{objectWriteUInt32(this,value,offset,false)}return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||value<min)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range");if(offset<0)throw new RangeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;var i;if(this===target&&start<targetStart&&targetStart<end){for(i=len-1;i>=0;i--){target[i+targetStart]=this[i+start]}}else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT){for(i=0;i<len;i++){target[i+targetStart]=this[i+start]}}else{target._set(this.subarray(start,start+len),targetStart)}return len};Buffer.prototype.fill=function fill(value,start,end){if(!value)value=0;if(!start)start=0;if(!end)end=this.length;if(end<start)throw new RangeError("end < start");if(end===start)return;if(this.length===0)return;if(start<0||start>=this.length)throw new RangeError("start out of bounds");if(end<0||end>this.length)throw new RangeError("end out of bounds");var i;if(typeof value==="number"){for(i=start;i<end;i++){this[i]=value}}else{var bytes=utf8ToBytes(value.toString());var len=bytes.length;for(i=start;i<end;i++){this[i]=bytes[i%len]}}return this};Buffer.prototype.toArrayBuffer=function toArrayBuffer(){if(typeof Uint8Array!=="undefined"){if(Buffer.TYPED_ARRAY_SUPPORT){return new Buffer(this).buffer}else{var buf=new Uint8Array(this.length);for(var i=0,len=buf.length;i<len;i+=1){buf[i]=this[i]}return buf.buffer}}else{throw new TypeError("Buffer.toArrayBuffer not supported in this browser")}};var BP=Buffer.prototype;Buffer._augment=function _augment(arr){arr.constructor=Buffer;arr._isBuffer=true;arr._set=arr.set;arr.get=BP.get;arr.set=BP.set;arr.write=BP.write;arr.toString=BP.toString;arr.toLocaleString=BP.toString;arr.toJSON=BP.toJSON;arr.equals=BP.equals;arr.compare=BP.compare;arr.indexOf=BP.indexOf;arr.copy=BP.copy;arr.slice=BP.slice;arr.readUIntLE=BP.readUIntLE;arr.readUIntBE=BP.readUIntBE;arr.readUInt8=BP.readUInt8;arr.readUInt16LE=BP.readUInt16LE;arr.readUInt16BE=BP.readUInt16BE;arr.readUInt32LE=BP.readUInt32LE;arr.readUInt32BE=BP.readUInt32BE;arr.readIntLE=BP.readIntLE;arr.readIntBE=BP.readIntBE;arr.readInt8=BP.readInt8;arr.readInt16LE=BP.readInt16LE;arr.readInt16BE=BP.readInt16BE;arr.readInt32LE=BP.readInt32LE;arr.readInt32BE=BP.readInt32BE;arr.readFloatLE=BP.readFloatLE;arr.readFloatBE=BP.readFloatBE;arr.readDoubleLE=BP.readDoubleLE;arr.readDoubleBE=BP.readDoubleBE;arr.writeUInt8=BP.writeUInt8;arr.writeUIntLE=BP.writeUIntLE;arr.writeUIntBE=BP.writeUIntBE;arr.writeUInt16LE=BP.writeUInt16LE;arr.writeUInt16BE=BP.writeUInt16BE;arr.writeUInt32LE=BP.writeUInt32LE;arr.writeUInt32BE=BP.writeUInt32BE;arr.writeIntLE=BP.writeIntLE;arr.writeIntBE=BP.writeIntBE;arr.writeInt8=BP.writeInt8;arr.writeInt16LE=BP.writeInt16LE;arr.writeInt16BE=BP.writeInt16BE;arr.writeInt32LE=BP.writeInt32LE;arr.writeInt32BE=BP.writeInt32BE;arr.writeFloatLE=BP.writeFloatLE;arr.writeFloatBE=BP.writeFloatBE;arr.writeDoubleLE=BP.writeDoubleLE;arr.writeDoubleBE=BP.writeDoubleBE;arr.fill=BP.fill;arr.inspect=BP.inspect;arr.toArrayBuffer=BP.toArrayBuffer;return arr};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(str){str=stringtrim(str).replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function stringtrim(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;i++){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;i++){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;i++){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"base64-js":171,ieee754:172,isarray:173}],171:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(exports){"use strict";var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var PLUS="+".charCodeAt(0);var SLASH="/".charCodeAt(0);var NUMBER="0".charCodeAt(0);var LOWER="a".charCodeAt(0);var UPPER="A".charCodeAt(0);var PLUS_URL_SAFE="-".charCodeAt(0);var SLASH_URL_SAFE="_".charCodeAt(0);function decode(elt){var code=elt.charCodeAt(0);if(code===PLUS||code===PLUS_URL_SAFE)return 62;if(code===SLASH||code===SLASH_URL_SAFE)return 63;if(code<NUMBER)return-1;if(code<NUMBER+10)return code-NUMBER+26+26;if(code<UPPER+26)return code-UPPER;if(code<LOWER+26)return code-LOWER+26}function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0;arr=new Arr(b64.length*3/4-placeHolders);l=placeHolders>0?b64.length-4:b64.length;var L=0;function push(v){arr[L++]=v}for(i=0,j=0;i<l;i+=4,j+=3){tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3));push((tmp&16711680)>>16);push((tmp&65280)>>8);push(tmp&255)}if(placeHolders===2){tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4;push(tmp&255)}else if(placeHolders===1){tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2;push(tmp>>8&255);push(tmp&255)}return arr}function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length;function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(num&63)}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=encode(temp>>2);output+=encode(temp<<4&63);output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=encode(temp>>10);output+=encode(temp>>4&63);output+=encode(temp<<2&63);output+="=";break}return output}exports.toByteArray=b64ToByteArray;exports.fromByteArray=uint8ToBase64})(typeof exports==="undefined"?this.base64js={}:exports)},{}],172:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],173:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return toString.call(arr)=="[object Array]"}},{}],174:[function(require,module,exports){"use strict";var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var ac_addEventListener=require("@marcom/ac-dom-events/utils/addEventListener");var ac_removeEventListener=require("@marcom/ac-dom-events/utils/removeEventListener");var create=require("@marcom/ac-object/create");var KeyEvent=require("./internal/KeyEvent");var KEYDOWN="keydown";var KEYUP="keyup";function Keyboard(contextElement){this._keysDown={};this._DOMKeyDown=this._DOMKeyDown.bind(this);this._DOMKeyUp=this._DOMKeyUp.bind(this);this._context=contextElement||document;ac_addEventListener(this._context,KEYDOWN,this._DOMKeyDown,true);ac_addEventListener(this._context,KEYUP,this._DOMKeyUp,true);EventEmitterMicro.call(this)}var proto=Keyboard.prototype=create(EventEmitterMicro.prototype);proto.onDown=function(keyCode,callback){return this.on(KEYDOWN+":"+keyCode,callback)};proto.onceDown=function(keyCode,callback){return this.once(KEYDOWN+":"+keyCode,callback)};proto.offDown=function(keyCode,callback){return this.off(KEYDOWN+":"+keyCode,callback)};proto.onUp=function(keyCode,callback){return this.on(KEYUP+":"+keyCode,callback)};proto.onceUp=function(keyCode,callback){return this.once(KEYUP+":"+keyCode,callback)};proto.offUp=function(keyCode,callback){return this.off(KEYUP+":"+keyCode,callback)};proto.isDown=function(keyCode){keyCode+="";return this._keysDown[keyCode]||false};proto.isUp=function(keyCode){return!this.isDown(keyCode)};proto.destroy=function(){ac_removeEventListener(this._context,KEYDOWN,this._DOMKeyDown,true);ac_removeEventListener(this._context,KEYUP,this._DOMKeyUp,true);this._keysDown=null;this._context=null;EventEmitterMicro.prototype.destroy.call(this);return this};proto._DOMKeyDown=function(keyboardEvent){var evt=this._normalizeKeyboardEvent(keyboardEvent);var keyCode=evt.keyCode+="";this._trackKeyDown(keyCode);this.trigger(KEYDOWN+":"+keyCode,evt)};proto._DOMKeyUp=function(keyboardEvent){var evt=this._normalizeKeyboardEvent(keyboardEvent);var keyCode=evt.keyCode+="";this._trackKeyUp(keyCode);this.trigger(KEYUP+":"+keyCode,evt)};proto._normalizeKeyboardEvent=function(keyboardEvent){return new KeyEvent(keyboardEvent)};proto._trackKeyUp=function(keyCode){if(this._keysDown[keyCode]){this._keysDown[keyCode]=false}};proto._trackKeyDown=function(keyCode){if(!this._keysDown[keyCode]){this._keysDown[keyCode]=true}};module.exports=Keyboard},{"./internal/KeyEvent":176,"@marcom/ac-dom-events/utils/addEventListener":63,"@marcom/ac-dom-events/utils/removeEventListener":65,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-object/create":186}],175:[function(require,module,exports){"use strict";var Keyboard=require("./Keyboard");module.exports=new Keyboard},{"./Keyboard":174}],176:[function(require,module,exports){"use strict";var blackList=["keyLocation"];function KeyEvent(originalEvt){this.originalEvent=originalEvt;var prop;for(prop in originalEvt){if(blackList.indexOf(prop)===-1&&typeof originalEvt[prop]!=="function"){this[prop]=originalEvt[prop]}}this.location=this.originalEvent.location!==undefined?this.originalEvent.location:this.originalEvent.keyLocation}KeyEvent.prototype={preventDefault:function(){if(typeof this.originalEvent.preventDefault!=="function"){this.originalEvent.returnValue=false;return}return this.originalEvent.preventDefault()},stopPropagation:function(){return this.originalEvent.stopPropagation()}};module.exports=KeyEvent},{}],177:[function(require,module,exports){"use strict";module.exports={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,COMMAND:91,CAPSLOCK:20,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ASTERISK:106,NUMPAD_PLUS:107,NUMPAD_DASH:109,NUMPAD_DOT:110,NUMPAD_SLASH:111,NUMPAD_EQUALS:187,TICK:192,LEFT_BRACKET:219,RIGHT_BRACKET:221,BACKSLASH:220,SEMICOLON:186,APOSTRAPHE:222,APOSTROPHE:222,SPACEBAR:32,CLEAR:12,COMMA:188,DOT:190,SLASH:191}},{}],178:[function(require,module,exports){"use strict";module.exports={EventEmitter:require("./ac-event-emitter/EventEmitter")}},{"./ac-event-emitter/EventEmitter":179}],179:[function(require,module,exports){"use strict";var propagationName="EventEmitter:propagation";var EventEmitter=function(context){if(context){this.context=context}};var proto=EventEmitter.prototype;var getEvents=function(){if(!this.hasOwnProperty("_events")&&typeof this._events!=="object"){this._events={}}return this._events};var isArray=function(arg){if(typeof Array.isArray==="function"){return Array.isArray(arg)}return Object.prototype.toString.call(arg)==="[object Array]"};var parseEvents=function(args,register){var events=args[0];var callback=args[1];var context=args[2];var evt;var length;var i;if(typeof events!=="string"&&typeof events!=="object"||events===null||isArray(events)){throw new TypeError("Expecting event name to be a string or object.")}if(typeof events==="string"&&!callback){throw new Error("Expecting a callback function to be provided.")}if(callback&&typeof callback!=="function"){if(typeof events==="object"&&typeof callback==="object"){context=callback}else{throw new TypeError("Expecting callback to be a function.")}}register.call(this,events,callback,context)};var each=function(event,callback,context){var eventsArray;var i;var length;eventsArray=getEvents.call(this)[event];if(!eventsArray||eventsArray.length===0){return}eventsArray=eventsArray.slice();this._stoppedImmediatePropagation=false;for(i=0,length=eventsArray.length;i<length;i+=1){if(this._stoppedImmediatePropagation||callback.call(context,eventsArray[i],i)){break}}};var removeSpecificCallback=function(events,event,callback){var i=-1;each.call(this,event,function(callbackObject,index){if(callbackObject.callback===callback){i=index;return true}});if(i===-1){return}events[event].splice(i,1)};proto.on=function(){var events=getEvents.call(this);parseEvents.call(this,arguments,function(event,callback,context){events[event]=events[event]||(events[event]=[]);events[event].push({callback:callback,context:context})});return this};proto.once=function(){parseEvents.call(this,arguments,function(event,callback,context){var wrapper=function(data){callback.call(context||this,data);this.off(event,wrapper)};this.on(event,wrapper,this)});return this};proto.off=function(event,callback){var events=getEvents.call(this);var evt;var split;var length;var i;if(arguments.length===0){this._events={}}else if(!event||typeof event!=="string"&&typeof event!=="object"||Array.isArray(event)){throw new TypeError("Expecting event name to be a string or object.")}if(typeof event==="object"){for(evt in event){if(event.hasOwnProperty(evt)){removeSpecificCallback.call(this,events,evt,event[evt])}}}if(typeof event==="string"){split=event.split(" ");if(split.length===1){if(callback){removeSpecificCallback.call(this,events,event,callback)}else{events[event]=[]}}else{for(i=0,length=split.length;i<length;i+=1){events[split[i]]=[]}}}return this};proto.trigger=function(event,data,doNotPropagate){var eventName;var length;var evt;var i;if(!event){throw new Error("trigger method requires an event name")}if(typeof event!=="string"){throw new TypeError("Expecting event names to be a string.")}if(doNotPropagate&&typeof doNotPropagate!=="boolean"){throw new TypeError("Expecting doNotPropagate to be a boolean.")}event=event.split(" ");for(i=0,length=event.length;i<length;i+=1){evt=event[i];each.call(this,evt,function(callbackObject){callbackObject.callback.call(callbackObject.context||this.context||this,data)},this);if(!doNotPropagate){eventName=evt;each.call(this,propagationName,function(propagation){if(propagation.prefix){eventName=propagation.prefix+eventName}propagation.emitter.trigger(eventName,data)})}}return this};proto.propagateTo=function(eventEmitter,prefix){var events=getEvents.call(this);if(!events[propagationName]){this._events[propagationName]=[]}events[propagationName].push({emitter:eventEmitter,prefix:prefix})};proto.stopPropagatingTo=function(eventEmitter){var events=getEvents.call(this);if(!eventEmitter){events[propagationName]=[];return}var propagationTargets=events[propagationName];var length=propagationTargets.length;var i;for(i=0;i<length;i+=1){if(propagationTargets[i].emitter===eventEmitter){propagationTargets.splice(i,1);break}}};proto.stopImmediatePropagation=function(){this._stoppedImmediatePropagation=true};proto.has=function(evt,callback,context){var events=getEvents.call(this);var eventsArray=events[evt];var callbackContainer;var i;var l;var objKeys;var x;if(arguments.length===0){objKeys=[];for(x in events){if(events.hasOwnProperty(x)){objKeys.push(x)}}return objKeys}if(!eventsArray){return false}if(!callback){return eventsArray.length>0?true:false}for(i=0,l=eventsArray.length;i<l;i+=1){callbackContainer=eventsArray[i];if(context&&callback&&callbackContainer.context===context&&callbackContainer.callback===callback||callback&&!context&&callbackContainer.callback===callback){return true}}return false};module.exports=EventEmitter},{}],180:[function(require,module,exports){"use strict";module.exports={Modal:require("./ac-modal-basic/Modal"),Renderer:require("./ac-modal-basic/Renderer"),classNames:require("./ac-modal-basic/classNames")}},{"./ac-modal-basic/Modal":181,"./ac-modal-basic/Renderer":182,"./ac-modal-basic/classNames":183}],181:[function(require,module,exports){"use strict";var ac_DomEvents={addEventListener:require("@marcom/ac-dom-events/addEventListener"),removeEventListener:require("@marcom/ac-dom-events/removeEventListener")};var ac_DomMetrics={getScrollX:require("@marcom/ac-dom-metrics/getScrollX"),getScrollY:require("@marcom/ac-dom-metrics/getScrollY")};var ac_Object={create:require("@marcom/ac-object/create"),defaults:require("@marcom/ac-object/defaults")};var ac_Keyboard=require("ac-keyboard");var keys=require("ac-keyboard/keyMap");var EventEmitter=require("ac-event-emitter").EventEmitter;var Renderer=require("./Renderer");var proto;var modalDefaults={retainScrollPosition:false};function Modal(modalOptions,renderOptions){this.options=ac_Object.defaults(modalDefaults,modalOptions);this.renderer=new Renderer(renderOptions);this.opened=false;this._keysToClose=[keys.ESCAPE];this._keysToOpen=[];this._boundClose=this.close.bind(this)}var proto=Modal.prototype=ac_Object.create(EventEmitter.prototype);proto.open=function(){if(this.options.retainScrollPosition){this._saveScrollPosition()}if(!this.opened){this._attachEvents();this.trigger("willopen");this.renderer.open();this.opened=true;this.trigger("open")}};proto.close=function(){this.trigger("willclose");this._removeEvents();this.renderer.close();if(this.options.retainScrollPosition){this._restoreScrollPosition()}this.opened=false;this.trigger("close")};proto.render=function(){this.renderer.render()};proto.appendContent=function(el,target){this.renderer.appendContent(el,target)};proto.removeContent=function(el){this.renderer.removeContent(el)};proto.destroy=function(){this._removeEvents();this.renderer.destroy();for(var prop in this){if(this.hasOwnProperty(prop)){this[prop]=null}}};proto.addKeyToClose=function(key){var index=this._keysToClose.indexOf(key);if(index===-1){this._keysToClose.push(key);ac_Keyboard.onUp(key,this._boundClose)}};proto.removeKeyToClose=function(key){var index=this._keysToClose.indexOf(key);if(index!==-1){this._keysToClose.splice(index,1)}this._releaseKeyToClose(key)};proto._bindKeyToClose=function(key){ac_Keyboard.onUp(key,this._boundClose)};proto._releaseKeyToClose=function(key){ac_Keyboard.offUp(key,this._boundClose)};proto._removeEvents=function(){if(this.renderer.closeButton){ac_DomEvents.removeEventListener(this.renderer.closeButton,"click",this._boundClose)}this._keysToClose.forEach(this._releaseKeyToClose,this)};proto._attachEvents=function(){if(this.renderer.closeButton){ac_DomEvents.addEventListener(this.renderer.closeButton,"click",this._boundClose)}this._keysToClose.forEach(this._bindKeyToClose,this)};proto._restoreScrollPosition=function(){window.scrollTo(this._scrollX||0,this._scrollY||0)};proto._saveScrollPosition=function(){this._scrollX=ac_DomMetrics.getScrollX();this._scrollY=ac_DomMetrics.getScrollY()};module.exports=Modal},{"./Renderer":182,"@marcom/ac-dom-events/addEventListener":54,"@marcom/ac-dom-events/removeEventListener":58,"@marcom/ac-dom-metrics/getScrollX":72,"@marcom/ac-dom-metrics/getScrollY":73,"@marcom/ac-object/create":186,"@marcom/ac-object/defaults":187,"ac-event-emitter":178,"ac-keyboard":372,"ac-keyboard/keyMap":374}],182:[function(require,module,exports){"use strict";var ac_Classlist={add:require("@marcom/ac-classlist/add"),remove:require("@marcom/ac-classlist/remove")};var ac_Object={defaults:require("@marcom/ac-object/defaults")};var ac_DomNodes={remove:require("@marcom/ac-dom-nodes/remove"),isElement:require("@marcom/ac-dom-nodes/isElement")};var modalClassNames=require("./classNames");var defaults={modalElement:null,contentElement:null,closeButton:null,classNames:modalClassNames};var Renderer=function(options){options=options||{};var classNames=ac_Object.defaults(defaults.classNames,options.classNames);this.options=ac_Object.defaults(defaults,options);this.options.classNames=classNames;this.modalElement=this.options.modalElement;this.contentElement=this.options.contentElement;this.closeButton=this.options.closeButton};var proto=Renderer.prototype;proto.render=function(){if(!ac_DomNodes.isElement(this.modalElement)){this.modalElement=this.renderModalElement(this.options.classNames.modalElement)}if(!ac_DomNodes.isElement(this.contentElement)){this.contentElement=this.renderContentElement(this.options.classNames.contentElement)}if(this.closeButton!==false){if(!ac_DomNodes.isElement(this.closeButton)){this.closeButton=this.renderCloseButton(this.options.classNames.closeButton)}this.modalElement.appendChild(this.closeButton)}this.modalElement.appendChild(this.contentElement);document.body.appendChild(this.modalElement);return this.modalElement};proto.renderCloseButton=function(classNames){classNames=classNames||this.options.classNames.closeButton;return this._renderElement("button",classNames)};proto.renderModalElement=function(classNames){classNames=classNames||this.options.classNames.modalElement;return this._renderElement("div",classNames)};proto.renderContentElement=function(classNames){classNames=classNames||this.options.classNames.contentElement;return this._renderElement("div",classNames)};proto.appendContent=function(el,target){if(el&&target){if(ac_DomNodes.isElement(el)&&ac_DomNodes.isElement(target)){target.appendChild(el)}}else if(ac_DomNodes.isElement(el)){this.contentElement.appendChild(el)}};proto.removeContent=function(el){if(el){if(this.modalElement.contains(el)){ac_DomNodes.remove(el)}}else{this._emptyContent()}};proto.open=function(){var docElArgs=[document.documentElement].concat(this.options.classNames.documentElement);var modalElArgs=[this.modalElement].concat(this.options.classNames.modalOpen);ac_Classlist.add.apply(null,docElArgs);ac_Classlist.add.apply(null,modalElArgs)};proto.close=function(){var docElArgs=[document.documentElement].concat(this.options.classNames.documentElement);var modalElArgs=[this.modalElement].concat(this.options.classNames.modalOpen);ac_Classlist.remove.apply(null,docElArgs);ac_Classlist.remove.apply(null,modalElArgs)};proto.destroy=function(){var docElArgs=[document.documentElement].concat(this.options.classNames.documentElement);this.close();document.body.removeChild(this.modalElement);ac_Classlist.remove.apply(null,docElArgs);for(var prop in this){if(this.hasOwnProperty(prop)){this[prop]=null}}};proto._renderElement=function(type,classNames){var el=document.createElement(type);var args=[el];if(classNames){args=args.concat(classNames)}ac_Classlist.add.apply(null,args);return el};proto._emptyContent=function(){this.contentElement.innerHTML=""};module.exports=Renderer},{"./classNames":183,"@marcom/ac-classlist/add":13,"@marcom/ac-classlist/remove":21,"@marcom/ac-dom-nodes/isElement":85,"@marcom/ac-dom-nodes/remove":87,"@marcom/ac-object/defaults":187}],183:[function(require,module,exports){"use strict";module.exports={modalElement:"modal",modalOpen:"modal-open",documentElement:"has-modal",contentElement:"modal-content",closeButton:"modal-close"}},{}],184:[function(require,module,exports){"use strict";module.exports={clone:require("./clone"),create:require("./create"),defaults:require("./defaults"),extend:require("./extend"),getPrototypeOf:require("./getPrototypeOf"),isDate:require("./isDate"),isEmpty:require("./isEmpty"),isRegExp:require("./isRegExp"),toQueryParameters:require("./toQueryParameters")}},{"./clone":185,"./create":186,"./defaults":187,"./extend":188,"./getPrototypeOf":189,"./isDate":190,"./isEmpty":191,"./isRegExp":192,"./toQueryParameters":193}],185:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/isArray");var extend=require("./extend");var hasOwnProp=Object.prototype.hasOwnProperty;var deepClone=function(dest,source){var prop;for(prop in source){if(hasOwnProp.call(source,prop)){if(source[prop]===null){dest[prop]=null}else if(typeof source[prop]==="object"){dest[prop]=Array.isArray(source[prop])?[]:{};deepClone(dest[prop],source[prop])}else{dest[prop]=source[prop]}}}return dest};module.exports=function clone(object,deep){if(deep){return deepClone({},object)}return extend({},object)}},{"./extend":188,"@marcom/ac-polyfills/Array/isArray":"@marcom/ac-polyfills/Array/isArray"}],186:[function(require,module,exports){"use strict";var F=function(){};module.exports=function create(proto){if(arguments.length>1){throw new Error("Second argument not supported")}if(proto===null||typeof proto!=="object"){throw new TypeError("Object prototype may only be an Object.")}if(typeof Object.create==="function"){return Object.create(proto)}else{F.prototype=proto;return new F}}},{}],187:[function(require,module,exports){"use strict";var extend=require("./extend");module.exports=function defaults(defaultsObj,options){if(typeof defaultsObj!=="object"){throw new TypeError("defaults: must provide a defaults object")}options=options||{};if(typeof options!=="object"){throw new TypeError("defaults: options must be a typeof object")}return extend({},defaultsObj,options)}},{"./extend":188}],188:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.forEach");var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function extend(){var args;var dest;if(arguments.length<2){args=[{},arguments[0]]}else{args=[].slice.call(arguments)}dest=args.shift();args.forEach(function(source){if(source!=null){for(var property in source){if(hasOwnProp.call(source,property)){dest[property]=source[property]}}}});return dest}},{"@marcom/ac-polyfills/Array/prototype.forEach":"@marcom/ac-polyfills/Array/prototype.forEach"}],189:[function(require,module,exports){"use strict";var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function getPrototypeOf(obj){if(Object.getPrototypeOf){return Object.getPrototypeOf(obj)}else{if(typeof obj!=="object"){throw new Error("Requested prototype of a value that is not an object.")}else if(typeof this.__proto__==="object"){return obj.__proto__}else{var constructor=obj.constructor;var oldConstructor;if(hasOwnProp.call(obj,"constructor")){oldConstructor=constructor;if(!delete obj.constructor){return null}constructor=obj.constructor;obj.constructor=oldConstructor}return constructor?constructor.prototype:null}}}},{}],190:[function(require,module,exports){"use strict";module.exports=function isDate(date){return Object.prototype.toString.call(date)==="[object Date]"}},{}],191:[function(require,module,exports){"use strict";var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function isEmpty(object){var prop;if(typeof object!=="object"){throw new TypeError("ac-base.Object.isEmpty : Invalid parameter - expected object")}for(prop in object){if(hasOwnProp.call(object,prop)){return false}}return true}},{}],192:[function(require,module,exports){"use strict";module.exports=function isRegExp(obj){return window.RegExp?obj instanceof RegExp:false}},{}],193:[function(require,module,exports){"use strict";var joinSearchParams=require("@marcom/ac-url/joinSearchParams");module.exports=function toQueryParameters(object){if(typeof object!=="object"){throw new TypeError("toQueryParameters error: argument is not an object")}return joinSearchParams(object,false)}},{"@marcom/ac-url/joinSearchParams":271}],194:[function(require,module,exports){arguments[4][148][0].apply(exports,arguments)},{"./ac-page-visibility/PageVisibilityManager":195,dup:148}],195:[function(require,module,exports){arguments[4][149][0].apply(exports,arguments)},{"@marcom/ac-event-emitter-micro":133,"@marcom/ac-object/create":186,dup:149}],196:[function(require,module,exports){"use strict";module.exports={PointerTracker:require("./ac-pointer-tracker/PointerTracker")}},{"./ac-pointer-tracker/PointerTracker":197}],197:[function(require,module,exports){"use strict";var ac_browser=require("@marcom/ac-browser");var ac_dom_events=require("@marcom/ac-dom-events");var ac_dom_styles=require("@marcom/ac-dom-styles");var create=require("@marcom/ac-object/create");var isLowThreshold=ac_browser.os==="Android"||ac_browser.name==="IE"&&ac_browser.version<=8;var touchAvailable=require("@marcom/ac-feature/touchAvailable")();var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;function PointerTracker(el,pointerEvents,options){this._el=el;options=options||{};this._lockVertical=options.lockVertical!==false;this._swipeThreshold=options.swipeThreshold||PointerTracker.DEFAULT_SWIPE_THRESHOLD;this._pointerEvents=pointerEvents||{};this._trackHover=options.trackHover;if(!this._trackHover){this._pointerEvents.down=this._pointerEvents.down||(touchAvailable?PointerTracker.TOUCH_EVENTS.down:PointerTracker.MOUSE_EVENTS.down);this._pointerEvents.up=this._pointerEvents.up||(touchAvailable?PointerTracker.TOUCH_EVENTS.up:PointerTracker.MOUSE_EVENTS.up)}else{this._pointerEvents.down=this._pointerEvents.down||PointerTracker.MOUSE_EVENTS.over;this._pointerEvents.up=this._pointerEvents.up||PointerTracker.MOUSE_EVENTS.out}this._pointerEvents.out=this._pointerEvents.out||(touchAvailable?PointerTracker.TOUCH_EVENTS.out:PointerTracker.MOUSE_EVENTS.out);this._pointerEvents.move=this._pointerEvents.move||(touchAvailable?PointerTracker.TOUCH_EVENTS.move:PointerTracker.MOUSE_EVENTS.move);this._onMouseDown=this._onMouseDown.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onMouseOut=this._onMouseOut.bind(this);this._onMouseMove=this._onMouseMove.bind(this);EventEmitterMicro.call(this);ac_dom_events.addEventListener(this._el,this._pointerEvents.down,this._onMouseDown);this._setCursorStyle("grab")}PointerTracker.START="start";PointerTracker.END="end";PointerTracker.UPDATE="update";PointerTracker.SWIPE_RIGHT="swiperight";PointerTracker.SWIPE_LEFT="swipeleft";PointerTracker.DEFAULT_SWIPE_THRESHOLD=isLowThreshold?2:8;PointerTracker.TOUCH_EVENTS={down:"touchstart",up:"touchend",out:"mouseout",move:"touchmove"};PointerTracker.MOUSE_EVENTS={down:"mousedown",up:"mouseup",out:"mouseout",move:"mousemove",over:"mouseover"};var Super=EventEmitterMicro.prototype;var proto=PointerTracker.prototype=create(Super);proto.destroy=function(){if(this._isDragging){this._onMouseUp()}ac_dom_events.removeEventListener(this._el,this._pointerEvents.down,this._onMouseDown);this._setCursorStyle(null);this._el=null;this._pointerEvents=null;this._lockVertical=null;this._swipeThreshold=null;this._checkForTouchScrollY=null;this._isDragging=null;this._currentX=null;this._currentY=null;this._velocityX=null;this._velocityY=null;this._lastX=null;this._lastY=null;return Super.destroy.call(this)};proto._onMouseDown=function(evt){if(this._isDragging){return}this._isDragging=true;this._setCursorStyle("grabbing");ac_dom_events.removeEventListener(this._el,this._pointerEvents.down,this._onMouseDown);ac_dom_events.addEventListener(document.body,this._pointerEvents.up,this._onMouseUp);ac_dom_events.addEventListener(document,this._pointerEvents.out,this._onMouseOut);ac_dom_events.addEventListener(document.body,this._pointerEvents.move,this._onMouseMove);this._checkForTouchScrollY=this._lockVertical&&!!(evt.touches&&evt.touches[0]);if(this._checkForTouchScrollY){this._lastY=this._getTouchY(evt)}var values=this._storeAndGetValues(evt);this._velocityX=values.diffX=0;this._velocityY=values.diffY=0;this.trigger(PointerTracker.START,values)};proto._onMouseUp=function(evt){if(!this._isDragging){return}this._isDragging=false;this._setCursorStyle("grab");ac_dom_events.addEventListener(this._el,this._pointerEvents.down,this._onMouseDown);ac_dom_events.removeEventListener(document.body,this._pointerEvents.up,this._onMouseUp);ac_dom_events.removeEventListener(document,this._pointerEvents.out,this._onMouseOut);ac_dom_events.removeEventListener(document.body,this._pointerEvents.move,this._onMouseMove);var swipe;if(this._checkForTouchScrollY||this._trackHover){swipe=null}else if(this._velocityX>this._swipeThreshold){swipe=PointerTracker.SWIPE_LEFT}else if(this._velocityX*-1>this._swipeThreshold){swipe=PointerTracker.SWIPE_RIGHT}var values=this._storeAndGetValues(evt);values.swipe=swipe;this.trigger(PointerTracker.END,values);if(swipe&&!this._trackHover){this.trigger(swipe,values)}};proto._onMouseOut=function(evt){evt=evt?evt:window.event;var from=evt.relatedTarget||evt.toElement;if(!from||from.nodeName==="HTML"){this._onMouseUp(evt)}};proto._onMouseMove=function(evt){if(this._checkForTouchScrollY&&this._isVerticalTouchMove(evt)){this._onMouseUp(evt);return}ac_dom_events.preventDefault(evt);this.trigger(PointerTracker.UPDATE,this._storeAndGetValues(evt))};proto._storeAndGetValues=function(evt){if(evt===undefined){return{}}this._currentX=this._getPointerX(evt);this._currentY=this._getPointerY(evt);this._velocityX=this._lastX-this._currentX;this._velocityY=this._lastY-this._currentY;var values={x:this._currentX,y:this._currentY,lastX:this._lastX,lastY:this._lastY,diffX:this._velocityX,diffY:this._velocityY,interactionEvent:evt};this._lastX=this._currentX;this._lastY=this._currentY;return values};proto._getPointerX=function(evt){if(evt.pageX){return evt.pageX}else if(evt.touches&&evt.touches[0]){return evt.touches[0].pageX}else if(evt.clientX){return evt.clientX}return 0};proto._getPointerY=function(evt){if(evt.pageY){return evt.pageY}else if(evt.touches&&evt.touches[0]){return evt.touches[0].pageY}else if(evt.clientY){return evt.clientY}return 0};proto._getTouchX=function(evt){if(evt.touches&&evt.touches[0]){return evt.touches[0].pageX}return 0};proto._getTouchY=function(evt){if(evt.touches&&evt.touches[0]){return evt.touches[0].pageY}return 0};proto._isVerticalTouchMove=function(evt){var x=this._getTouchX(evt);var y=this._getTouchY(evt);var diffX=Math.abs(x-this._lastX);var diffY=Math.abs(y-this._lastY);this._checkForTouchScrollY=diffX<diffY;return this._checkForTouchScrollY};proto._setCursorStyle=function(cursor){ac_dom_styles.setStyle(this._el,{cursor:cursor})};module.exports=PointerTracker},{"@marcom/ac-browser":9,"@marcom/ac-dom-events":56,"@marcom/ac-dom-styles":88,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-feature/touchAvailable":143,"@marcom/ac-object/create":186}],198:[function(require,module,exports){if(!Date.now){Date.now=function now(){return(new Date).getTime()}}},{}],199:[function(require,module,exports){require("../Date/now");(function(){if("performance"in window==false){window.performance={}}if("now"in window.performance==false){var nowOffset=Date.now();if(performance.timing&&performance.timing.navigationStart){nowOffset=performance.timing.navigationStart}window.performance.now=function now(){return Date.now()-nowOffset}}})()},{"../Date/now":198}],200:[function(require,module,exports){"use strict";var eventTypeAvailable=require("./utils/eventTypeAvailable");var camelCasedEventTypes=require("./shared/camelCasedEventTypes");var windowFallbackEventTypes=require("./shared/windowFallbackEventTypes");var prefixHelper=require("./shared/prefixHelper");var cache={};module.exports=function getEventType(type,tagName){var prefixedType;var tagNameCache;var i;tagName=tagName||"div";type=type.toLowerCase();if(!(tagName in cache)){cache[tagName]={}}tagNameCache=cache[tagName];if(type in tagNameCache){return tagNameCache[type]}if(eventTypeAvailable(type,tagName)){return tagNameCache[type]=type}if(type in camelCasedEventTypes){for(i=0;i<camelCasedEventTypes[type].length;i++){prefixedType=camelCasedEventTypes[type][i];if(eventTypeAvailable(prefixedType.toLowerCase(),tagName)){return tagNameCache[type]=prefixedType}}}for(i=0;i<prefixHelper.evt.length;i++){prefixedType=prefixHelper.evt[i]+type;if(eventTypeAvailable(prefixedType,tagName)){prefixHelper.reduce(i);return tagNameCache[type]=prefixedType}}if(tagName!=="window"&&windowFallbackEventTypes.indexOf(type)){return tagNameCache[type]=getEventType(type,"window")}return tagNameCache[type]=false}},{"./shared/camelCasedEventTypes":204,"./shared/prefixHelper":206,"./shared/windowFallbackEventTypes":209,"./utils/eventTypeAvailable":211}],201:[function(require,module,exports){"use strict";var cache=require("./shared/stylePropertyCache");var getStyleProperty=require("./getStyleProperty");var getStyleValue=require("./getStyleValue");module.exports=function getStyleCSS(property,value){var css;property=getStyleProperty(property);if(!property){return false}css=cache[property].css;if(typeof value!=="undefined"){value=getStyleValue(property,value);if(value===false){return false}css+=":"+value+";"}return css}},{"./getStyleProperty":202,"./getStyleValue":203,"./shared/stylePropertyCache":207}],202:[function(require,module,exports){"use strict";var cache=require("./shared/stylePropertyCache");var getStyleTestElement=require("./shared/getStyleTestElement");var toCSS=require("./utils/toCSS");var toDOM=require("./utils/toDOM");var prefixHelper=require("./shared/prefixHelper");var memoizeStyleProperty=function(property,prefixed){var cssProperty=toCSS(property);var cssPrefixed=prefixed===false?false:toCSS(prefixed);cache[property]=cache[prefixed]=cache[cssProperty]=cache[cssPrefixed]={dom:prefixed,css:cssPrefixed};return prefixed};module.exports=function getStyleProperty(property){var properties;var ucProperty;var el;var i;property+="";if(property in cache){return cache[property].dom}el=getStyleTestElement();property=toDOM(property);ucProperty=property.charAt(0).toUpperCase()+property.substring(1);if(property==="filter"){properties=["WebkitFilter","filter"]}else{properties=(property+" "+prefixHelper.dom.join(ucProperty+" ")+ucProperty).split(" ")}for(i=0;i<properties.length;i++){if(typeof el.style[properties[i]]!=="undefined"){if(i!==0){prefixHelper.reduce(i-1)}return memoizeStyleProperty(property,properties[i])}}return memoizeStyleProperty(property,false)}},{"./shared/getStyleTestElement":205,"./shared/prefixHelper":206,"./shared/stylePropertyCache":207,"./utils/toCSS":212,"./utils/toDOM":213}],203:[function(require,module,exports){"use strict";var getStyleProperty=require("./getStyleProperty");var styleValueAvailable=require("./shared/styleValueAvailable");var prefixHelper=require("./shared/prefixHelper");var stylePropertyCache=require("./shared/stylePropertyCache");var styleValueCache={};var RE_CSS_FUNCTION_PARAMS=/(\([^\)]+\))/gi;var RE_CSS_VALUES=/([^ ,;\(]+(\([^\)]+\))?)/gi;module.exports=function getStyleValue(property,value){var cssProperty;value+="";property=getStyleProperty(property);if(!property){return false}if(styleValueAvailable(property,value)){return value}cssProperty=stylePropertyCache[property].css;value=value.replace(RE_CSS_VALUES,function(match){var values;var valueKey;var key;var i;if(match[0]==="#"||!isNaN(match[0])){return match}valueKey=match.replace(RE_CSS_FUNCTION_PARAMS,"");key=cssProperty+":"+valueKey;if(key in styleValueCache){if(styleValueCache[key]===false){return""}return match.replace(valueKey,styleValueCache[key])}values=prefixHelper.css.map(function(prefix){return prefix+match});values=[match].concat(values);for(i=0;i<values.length;i++){if(styleValueAvailable(property,values[i])){if(i!==0){prefixHelper.reduce(i-1)}styleValueCache[key]=values[i].replace(RE_CSS_FUNCTION_PARAMS,"");return values[i]}}styleValueCache[key]=false;return""});value=value.trim();return value===""?false:value}},{"./getStyleProperty":202,"./shared/prefixHelper":206,"./shared/stylePropertyCache":207,"./shared/styleValueAvailable":208}],204:[function(require,module,exports){"use strict";module.exports={transitionend:["webkitTransitionEnd","MSTransitionEnd"],animationstart:["webkitAnimationStart","MSAnimationStart"],animationend:["webkitAnimationEnd","MSAnimationEnd"],animationiteration:["webkitAnimationIteration","MSAnimationIteration"],fullscreenchange:["MSFullscreenChange"],fullscreenerror:["MSFullscreenError"]}},{}],205:[function(require,module,exports){"use strict";var el;module.exports=function getStyleTestElement(){if(!el){el=document.createElement("_")}else{el.style.cssText="";el.removeAttribute("style")}return el};module.exports.resetElement=function(){el=null}},{}],206:[function(require,module,exports){"use strict";var CSS_PREFIXES=["-webkit-","-moz-","-ms-"];var DOM_PREFIXES=["Webkit","Moz","ms"];var EVT_PREFIXES=["webkit","moz","ms"];var PrefixeHelper=function(){this.initialize()};var proto=PrefixeHelper.prototype;proto.initialize=function(){this.reduced=false;this.css=CSS_PREFIXES;this.dom=DOM_PREFIXES;this.evt=EVT_PREFIXES};proto.reduce=function(index){if(!this.reduced){this.reduced=true;this.css=[this.css[index]];this.dom=[this.dom[index]];this.evt=[this.evt[index]]}};module.exports=new PrefixeHelper},{}],207:[function(require,module,exports){"use strict";module.exports={}},{}],208:[function(require,module,exports){"use strict";var cache=require("./stylePropertyCache");var getStyleTestElement=require("./getStyleTestElement");var flagsSet=false;var supportsAvailable;var invalidStyleThrowsError;var prepareFlags=function(){var el;if(!flagsSet){flagsSet=true;supportsAvailable="CSS"in window&&"supports"in window.CSS;invalidStyleThrowsError=false;el=getStyleTestElement();try{el.style.width="invalid"}catch(e){invalidStyleThrowsError=true}}};module.exports=function styleValueAvailable(property,value){var before;var el;prepareFlags();if(supportsAvailable){property=cache[property].css;return CSS.supports(property,value)}el=getStyleTestElement();before=el.style[property];if(invalidStyleThrowsError){try{el.style[property]=value}catch(e){return false}}else{el.style[property]=value}return el.style[property]&&el.style[property]!==before};module.exports.resetFlags=function(){flagsSet=false}},{"./getStyleTestElement":205,"./stylePropertyCache":207}],209:[function(require,module,exports){"use strict";module.exports=["transitionend","animationstart","animationend","animationiteration"]},{}],210:[function(require,module,exports){"use strict";var RE_PREFIXES=/(-webkit-|-moz-|-ms-)|^(webkit|moz|ms)/gi;module.exports=function stripPrefixes(str){str=String.prototype.replace.call(str,RE_PREFIXES,"");return str.charAt(0).toLowerCase()+str.substring(1)}},{}],211:[function(require,module,exports){"use strict";var testElements={window:window,document:document};module.exports=function eventTypeAvailable(type,tagName){var el;type="on"+type;if(!(tagName in testElements)){testElements[tagName]=document.createElement(tagName)}el=testElements[tagName];if(type in el){return true}if("setAttribute"in el){el.setAttribute(type,"return;");return typeof el[type]==="function"}return false}},{}],212:[function(require,module,exports){"use strict";var RE_DOM_PREFIXES=/^(webkit|moz|ms)/gi;module.exports=function toCSS(str){var i;if(str.toLowerCase()==="cssfloat"){return"float"}if(RE_DOM_PREFIXES.test(str)){str="-"+str}return str.replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()}},{}],213:[function(require,module,exports){"use strict";var RE_CSS_WORD=/-([a-z])/g;module.exports=function toDOM(str){var i;if(str.toLowerCase()==="float"){return"cssFloat"}str=str.replace(RE_CSS_WORD,function(str,m1){return m1.toUpperCase()});if(str.substr(0,2)==="Ms"){str="ms"+str.substring(2)}return str}},{}],214:[function(require,module,exports){"use strict";var SharedInstance=require("@marcom/ac-shared-instance").SharedInstance;var sharedInstanceName="ac-raf-emitter-id-generator:sharedRAFEmitterIDGeneratorInstance",sharedInstanceVersion="1.0.3";var RAFEmitterIDGenerator=function(){this._currentID=0};RAFEmitterIDGenerator.prototype.getNewID=function(){this._currentID++;return"raf:"+this._currentID};module.exports=SharedInstance.share(sharedInstanceName,sharedInstanceVersion,RAFEmitterIDGenerator)},{"@marcom/ac-shared-instance":240}],215:[function(require,module,exports){"use strict";var proto;var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var sharedRAFExecutorInstance=require("@marcom/ac-raf-executor/sharedRAFExecutorInstance");var sharedRAFEmitterIDGeneratorInstance=require("@marcom/ac-raf-emitter-id-generator/sharedRAFEmitterIDGeneratorInstance");function RAFEmitter(options){options=options||{};EventEmitterMicro.call(this);this.id=sharedRAFEmitterIDGeneratorInstance.getNewID();this.executor=options.executor||sharedRAFExecutorInstance;this._reset();this._willRun=false;this._didDestroy=false}proto=RAFEmitter.prototype=Object.create(EventEmitterMicro.prototype);proto.run=function(){if(!this._willRun){this._willRun=true}return this._subscribe()};proto.cancel=function(){this._unsubscribe();if(this._willRun){this._willRun=false}this._reset()};proto.destroy=function(){var didCancel=this.willRun();this.cancel();this.executor=null;EventEmitterMicro.prototype.destroy.call(this);this._didDestroy=true;return didCancel};proto.willRun=function(){return this._willRun};proto.isRunning=function(){return this._isRunning};proto._subscribe=function(){return this.executor.subscribe(this)};proto._unsubscribe=function(){return this.executor.unsubscribe(this)};proto._onAnimationFrameStart=function(data){this._isRunning=true;this._willRun=false;if(!this._didEmitFrameData){this._didEmitFrameData=true;this.trigger("start",data)}};proto._onAnimationFrameEnd=function(data){if(!this._willRun){this.trigger("stop",data);this._reset()}};proto._reset=function(){this._didEmitFrameData=false;this._isRunning=false};module.exports=RAFEmitter},{"@marcom/ac-event-emitter-micro":133,"@marcom/ac-raf-emitter-id-generator/sharedRAFEmitterIDGeneratorInstance":214,"@marcom/ac-raf-executor/sharedRAFExecutorInstance":224}],216:[function(require,module,exports){"use strict";var SingleCallRAFEmitter=require("./SingleCallRAFEmitter");var RAFInterface=function(evt){this.rafEmitter=new SingleCallRAFEmitter;this.rafEmitter.on(evt,this._onRAFExecuted.bind(this));this.requestAnimationFrame=this.requestAnimationFrame.bind(this);this.cancelAnimationFrame=this.cancelAnimationFrame.bind(this);this._frameCallbacks=[];this._nextFrameCallbacks=[];this._currentFrameID=-1;this._cancelFrameIdx=-1;this._frameCallbackLength=0;this._nextFrameCallbacksLength=0;this._frameCallbackIteration=0};var proto=RAFInterface.prototype;proto.requestAnimationFrame=function(rafCallback){this._currentFrameID=this.rafEmitter.run();this._nextFrameCallbacks.push(this._currentFrameID,rafCallback);this._nextFrameCallbacksLength+=2;return this._currentFrameID};proto.cancelAnimationFrame=function(id){this._cancelFrameIdx=this._nextFrameCallbacks.indexOf(id);if(this._cancelFrameIdx===-1){return}this._nextFrameCallbacks.splice(this._cancelFrameIdx,2);this._nextFrameCallbacksLength-=2;if(this._nextFrameCallbacksLength===0){this.rafEmitter.cancel()}};proto._onRAFExecuted=function(e){this._frameCallbacks=this._nextFrameCallbacks;this._frameCallbackLength=this._nextFrameCallbacksLength;this._nextFrameCallbacks=[];this._nextFrameCallbacksLength=0;for(this._frameCallbackIteration=0;this._frameCallbackIteration<this._frameCallbackLength;this._frameCallbackIteration+=2){this._frameCallbacks[this._frameCallbackIteration+1](e.time,e)}};module.exports=RAFInterface},{"./SingleCallRAFEmitter":218}],217:[function(require,module,exports){"use strict";var RAFInterface=require("./RAFInterface");var RAFInterfaceController=function(){this.events={}};var proto=RAFInterfaceController.prototype;proto.requestAnimationFrame=function(evt){if(!this.events[evt]){this.events[evt]=new RAFInterface(evt)}return this.events[evt].requestAnimationFrame};proto.cancelAnimationFrame=function(evt){if(!this.events[evt]){this.events[evt]=new RAFInterface(evt)}return this.events[evt].cancelAnimationFrame};module.exports=new RAFInterfaceController},{"./RAFInterface":216}],218:[function(require,module,exports){"use strict";var RAFEmitter=require("./RAFEmitter");var SingleCallRAFEmitter=function(options){RAFEmitter.call(this,options)};var proto=SingleCallRAFEmitter.prototype=Object.create(RAFEmitter.prototype);proto._subscribe=function(){return this.executor.subscribe(this,true)};module.exports=SingleCallRAFEmitter},{"./RAFEmitter":215}],219:[function(require,module,exports){"use strict";var RAFInterfaceController=require("./RAFInterfaceController");module.exports=RAFInterfaceController.cancelAnimationFrame("draw")},{"./RAFInterfaceController":217}],220:[function(require,module,exports){"use strict";var RAFInterfaceController=require("./RAFInterfaceController");module.exports=RAFInterfaceController.requestAnimationFrame("draw")},{"./RAFInterfaceController":217}],221:[function(require,module,exports){"use strict";var RAFInterfaceController=require("./RAFInterfaceController");module.exports=RAFInterfaceController.requestAnimationFrame("external")},{"./RAFInterfaceController":217}],222:[function(require,module,exports){"use strict";var RAFInterfaceController=require("./RAFInterfaceController");module.exports=RAFInterfaceController.requestAnimationFrame("update")},{"./RAFInterfaceController":217}],223:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/performance/now");var proto;function RAFExecutor(options){options=options||{};this._reset();this._willRun=false;this._totalSubscribeCount=-1;this._requestAnimationFrame=window.requestAnimationFrame;this._cancelAnimationFrame=window.cancelAnimationFrame;this._boundOnAnimationFrame=this._onAnimationFrame.bind(this);this._boundOnExternalAnimationFrame=this._onExternalAnimationFrame.bind(this)}proto=RAFExecutor.prototype;proto.subscribe=function(rafEmitter,shouldPrepend){this._totalSubscribeCount++;if(!this._nextFrameSubscribers[rafEmitter.id]){if(shouldPrepend){this._nextFrameSubscribersOrder.unshift(rafEmitter.id)}else{this._nextFrameSubscribersOrder.push(rafEmitter.id)}this._nextFrameSubscribers[rafEmitter.id]=rafEmitter;this._nextFrameSubscriberArrayLength++;this._nextFrameSubscriberCount++;this._run()}return this._totalSubscribeCount};proto.unsubscribe=function(rafEmitter){if(!this._nextFrameSubscribers[rafEmitter.id]){return false}this._nextFrameSubscribers[rafEmitter.id]=null;this._nextFrameSubscriberCount--;if(this._nextFrameSubscriberCount===0){this._cancel()}return true};proto.trigger=function(evtName,data){var i;for(i=0;i<this._subscriberArrayLength;i++){if(this._subscribers[this._subscribersOrder[i]]!==null&&this._subscribers[this._subscribersOrder[i]]._didDestroy===false){this._subscribers[this._subscribersOrder[i]].trigger(evtName,data)}}};proto.destroy=function(){var didCancel=this._cancel();this._subscribers=null;this._subscribersOrder=null;this._nextFrameSubscribers=null;this._nextFrameSubscribersOrder=null;this._rafData=null;this._boundOnAnimationFrame=null;this._onExternalAnimationFrame=null;return didCancel};proto.useExternalAnimationFrame=function(shouldUseExternalAnimationFrame){if(typeof shouldUseExternalAnimationFrame!=="boolean"){return}var wasUsingExternalAnimationFrame=this._isUsingExternalAnimationFrame;if(shouldUseExternalAnimationFrame&&this._animationFrame){this._cancelAnimationFrame.call(window,this._animationFrame);this._animationFrame=null}if(this._willRun&&!shouldUseExternalAnimationFrame&&!this._animationFrame){this._animationFrame=this._requestAnimationFrame.call(window,this._boundOnAnimationFrame)}this._isUsingExternalAnimationFrame=shouldUseExternalAnimationFrame;if(shouldUseExternalAnimationFrame){return this._boundOnExternalAnimationFrame}return wasUsingExternalAnimationFrame||false};proto._run=function(){if(!this._willRun){this._willRun=true;if(this.lastFrameTime===0){this.lastFrameTime=performance.now()}this._animationFrameActive=true;if(!this._isUsingExternalAnimationFrame){this._animationFrame=this._requestAnimationFrame.call(window,this._boundOnAnimationFrame)}return true}};proto._cancel=function(){var result=false;if(this._animationFrameActive){if(this._animationFrame){this._cancelAnimationFrame.call(window,this._animationFrame);this._animationFrame=null}this._animationFrameActive=false;this._willRun=false;result=true}if(!this._isRunning){this._reset()}return result};proto._onSubscribersAnimationFrameStart=function(data){var i;for(i=0;i<this._subscriberArrayLength;i++){if(this._subscribers[this._subscribersOrder[i]]!==null&&this._subscribers[this._subscribersOrder[i]]._didDestroy===false){this._subscribers[this._subscribersOrder[i]]._onAnimationFrameStart(data)}}};proto._onSubscribersAnimationFrameEnd=function(data){var i;for(i=0;i<this._subscriberArrayLength;i++){if(this._subscribers[this._subscribersOrder[i]]!==null&&this._subscribers[this._subscribersOrder[i]]._didDestroy===false){this._subscribers[this._subscribersOrder[i]]._onAnimationFrameEnd(data)}}};proto._onAnimationFrame=function(time){this._subscribers=this._nextFrameSubscribers;this._subscribersOrder=this._nextFrameSubscribersOrder;this._subscriberArrayLength=this._nextFrameSubscriberArrayLength;this._subscriberCount=this._nextFrameSubscriberCount;this._nextFrameSubscribers={};this._nextFrameSubscribersOrder=[];this._nextFrameSubscriberArrayLength=0;this._nextFrameSubscriberCount=0;this._isRunning=true;this._willRun=false;this._didRequestNextRAF=false;this._rafData.delta=time-this.lastFrameTime;this.lastFrameTime=time;this._rafData.fps=0;if(this._rafData.delta>=1e3){this._rafData.delta=0}if(this._rafData.delta!==0){this._rafData.fps=1e3/this._rafData.delta}this._rafData.time=time;this._rafData.naturalFps=this._rafData.fps;this._rafData.timeNow=Date.now();this._onSubscribersAnimationFrameStart(this._rafData);this.trigger("update",this._rafData);this.trigger("external",this._rafData);this.trigger("draw",this._rafData);this._onSubscribersAnimationFrameEnd(this._rafData);if(!this._willRun){this._reset()}};proto._onExternalAnimationFrame=function(time){if(!this._isUsingExternalAnimationFrame){return}this._onAnimationFrame(time)};proto._reset=function(){this._rafData={time:0,delta:0,fps:0,naturalFps:0,timeNow:0};this._subscribers={};this._subscribersOrder=[];this._subscriberArrayLength=0;this._subscriberCount=0;this._nextFrameSubscribers={};this._nextFrameSubscribersOrder=[];this._nextFrameSubscriberArrayLength=0;this._nextFrameSubscriberCount=0;this._didEmitFrameData=false;this._animationFrame=null;this._animationFrameActive=false;this._isRunning=false;this._shouldReset=false;this.lastFrameTime=0};module.exports=RAFExecutor},{"@marcom/ac-polyfills/performance/now":199}],224:[function(require,module,exports){"use strict";var SharedInstance=require("@marcom/ac-shared-instance").SharedInstance;var sharedInstanceName="ac-raf-executor:sharedRAFExecutorInstance",sharedInstanceVersion="2.0.1";var RAFExecutor=require("./RAFExecutor");module.exports=SharedInstance.share(sharedInstanceName,sharedInstanceVersion,RAFExecutor)},{"./RAFExecutor":223,"@marcom/ac-shared-instance":240}],225:[function(require,module,exports){arguments[4][51][0].apply(exports,arguments)},{"./ac-dom-emitter/DOMEmitter":226,dup:51}],226:[function(require,module,exports){arguments[4][52][0].apply(exports,arguments)},{"./DOMEmitterEvent":227,"@marcom/ac-dom-events/addEventListener":54,"@marcom/ac-dom-events/dispatchEvent":55,"@marcom/ac-dom-events/removeEventListener":58,"@marcom/ac-dom-traversal/matchesSelector":96,"@marcom/ac-dom-traversal/querySelectorAll":98,"ac-event-emitter":369,dup:52}],227:[function(require,module,exports){arguments[4][53][0].apply(exports,arguments)},{"@marcom/ac-dom-events/preventDefault":57,"@marcom/ac-dom-events/stopPropagation":61,"@marcom/ac-dom-events/target":62,dup:53}],228:[function(require,module,exports){"use strict";module.exports={cname:require("./ac-cname/cname")}},{"./ac-cname/cname":229}],229:[function(require,module,exports){"use strict";var acPath=require("ac-path").path;function cname(url){return cname.addPrefix(url)}cname._prefix=function(){var sampleURL="/global/elements/blank.gif";return sampleURL.replace(/global\/.*/,"")}();cname.addPrefix=function(url){if(acPath.isAbsolute(url)){return url}cname._assertRootRelative(url);url=cname._prefix+url.replace(/^\//,"");url=url.replace(/(^.+)(\/105\/)/,"$1/");return url};cname.formatUrl=function(dirname,filename,extname,queryStr){var pathStr=acPath.format({dirname:dirname,filename:filename,extname:extname},queryStr);if(acPath.isAbsolute(pathStr)){return pathStr}cname._assertRootRelative(dirname);var url=cname.addPrefix(pathStr);return url};cname._assertRootRelative=function(pathStr){if(!acPath.isRootRelative(pathStr)){throw new URIError("Only root-relative paths are currently supported")}};module.exports=cname},{"ac-path":400}],230:[function(require,module,exports){"use strict";var ndarray=require("ndarray");var ops=require("ndarray-ops");var pool=require("typedarray-pool");module.exports=createTexture2D;var linearTypes=null;var filterTypes=null;var wrapTypes=null;function lazyInitLinearTypes(gl){linearTypes=[gl.LINEAR,gl.NEAREST_MIPMAP_LINEAR,gl.LINEAR_MIPMAP_NEAREST,gl.LINEAR_MIPMAP_NEAREST];filterTypes=[gl.NEAREST,gl.LINEAR,gl.NEAREST_MIPMAP_NEAREST,gl.NEAREST_MIPMAP_LINEAR,gl.LINEAR_MIPMAP_NEAREST,gl.LINEAR_MIPMAP_LINEAR];wrapTypes=[gl.REPEAT,gl.CLAMP_TO_EDGE,gl.MIRRORED_REPEAT]}var convertFloatToUint8=function(out,inp){ops.muls(out,inp,255)};function reshapeTexture(tex,w,h){var gl=tex.gl;var maxSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(w<0||w>maxSize||h<0||h>maxSize){throw new Error("gl-texture2d: Invalid texture size")}tex._shape=[w,h];tex.bind();gl.texImage2D(gl.TEXTURE_2D,0,tex.format,w,h,0,tex.format,tex.type,null);tex._mipLevels=[0];return tex}function Texture2D(gl,handle,width,height,format,type){this.gl=gl;this.handle=handle;this.format=format;this.type=type;this._shape=[width,height];this._mipLevels=[0];this._magFilter=gl.NEAREST;this._minFilter=gl.NEAREST;this._wrapS=gl.CLAMP_TO_EDGE;this._wrapT=gl.CLAMP_TO_EDGE;this._anisoSamples=1;var parent=this;var wrapVector=[this._wrapS,this._wrapT];Object.defineProperties(wrapVector,[{get:function(){return parent._wrapS},set:function(v){return parent.wrapS=v}},{get:function(){return parent._wrapT},set:function(v){return parent.wrapT=v}}]);this._wrapVector=wrapVector;var shapeVector=[this._shape[0],this._shape[1]];Object.defineProperties(shapeVector,[{get:function(){return parent._shape[0]},set:function(v){return parent.width=v}},{get:function(){return parent._shape[1]},set:function(v){return parent.height=v}}]);this._shapeVector=shapeVector}var proto=Texture2D.prototype;Object.defineProperties(proto,{minFilter:{get:function(){return this._minFilter},set:function(v){this.bind();var gl=this.gl;if(this.type===gl.FLOAT&&linearTypes.indexOf(v)>=0){if(!gl.getExtension("OES_texture_float_linear")){v=gl.NEAREST}}if(filterTypes.indexOf(v)<0){throw new Error("gl-texture2d: Unknown filter mode "+v)}gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,v);return this._minFilter=v}},magFilter:{get:function(){return this._magFilter},set:function(v){this.bind();var gl=this.gl;if(this.type===gl.FLOAT&&linearTypes.indexOf(v)>=0){if(!gl.getExtension("OES_texture_float_linear")){v=gl.NEAREST}}if(filterTypes.indexOf(v)<0){throw new Error("gl-texture2d: Unknown filter mode "+v)}gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,v);return this._magFilter=v}},mipSamples:{get:function(){return this._anisoSamples},set:function(i){var psamples=this._anisoSamples;this._anisoSamples=Math.max(i,1)|0;if(psamples!==this._anisoSamples){var ext=gl.getExtension("EXT_texture_filter_anisotropic");if(ext){this.gl.texParameterf(this.gl.TEXTURE_2D,ext.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(v){this.bind();if(wrapTypes.indexOf(v)<0){throw new Error("gl-texture2d: Unknown wrap mode "+v)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,v);return this._wrapS=v}},wrapT:{get:function(){return this._wrapT},set:function(v){this.bind();if(wrapTypes.indexOf(v)<0){throw new Error("gl-texture2d: Unknown wrap mode "+v)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,v);return this._wrapT=v}},wrap:{get:function(){return this._wrapVector},set:function(v){if(!Array.isArray(v)){v=[v,v]}if(v.length!==2){throw new Error("gl-texture2d: Must specify wrap mode for rows and columns")}for(var i=0;i<2;++i){if(wrapTypes.indexOf(v[i])<0){throw new Error("gl-texture2d: Unknown wrap mode "+v)}}this._wrapS=v[0];this._wrapT=v[1];var gl=this.gl;this.bind();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,this._wrapS);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,this._wrapT);return v}},shape:{get:function(){return this._shapeVector},set:function(x){if(!Array.isArray(x)){x=[x|0,x|0]}else{if(x.length!==2){throw new Error("gl-texture2d: Invalid texture shape")}}reshapeTexture(this,x[0]|0,x[1]|0);return[x[0]|0,x[1]|0]}},width:{get:function(){return this._shape[0]},set:function(w){w=w|0;reshapeTexture(this,w,this._shape[1]);return w}},height:{get:function(){return this._shape[1]},set:function(h){h=h|0;reshapeTexture(this,this._shape[0],h);return h}}});proto.bind=function(unit){var gl=this.gl;if(unit!==undefined){gl.activeTexture(gl.TEXTURE0+(unit|0))}gl.bindTexture(gl.TEXTURE_2D,this.handle);if(unit!==undefined){return unit|0}return gl.getParameter(gl.ACTIVE_TEXTURE)-gl.TEXTURE0};proto.dispose=function(){this.gl.deleteTexture(this.handle)};proto.generateMipmap=function(){this.bind();this.gl.generateMipmap(this.gl.TEXTURE_2D);var l=Math.min(this._shape[0],this._shape[1]);for(var i=0;l>0;++i,l>>>=1){if(this._mipLevels.indexOf(i)<0){this._mipLevels.push(i)}}};proto.setPixels=function(data,x_off,y_off,mip_level){var gl=this.gl;this.bind();if(Array.isArray(x_off)){mip_level=y_off;y_off=x_off[1]|0;x_off=x_off[0]|0}else{x_off=x_off||0;y_off=y_off||0}mip_level=mip_level||0;if(data instanceof HTMLCanvasElement||data instanceof ImageData||data instanceof HTMLImageElement||data instanceof HTMLVideoElement){var needsMip=this._mipLevels.indexOf(mip_level)<0;if(needsMip){gl.texImage2D(gl.TEXTURE_2D,0,this.format,this.format,this.type,data);this._mipLevels.push(mip_level)}else{gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,this.format,this.type,data)}}else if(data.shape&&data.stride&&data.data){if(data.shape.length<2||x_off+data.shape[1]>this._shape[1]>>>mip_level||y_off+data.shape[0]>this._shape[0]>>>mip_level||x_off<0||y_off<0){throw new Error("gl-texture2d: Texture dimensions are out of bounds")}texSubImageArray(gl,x_off,y_off,mip_level,this.format,this.type,this._mipLevels,data)}else{throw new Error("gl-texture2d: Unsupported data type")}};function isPacked(shape,stride){if(shape.length===3){return stride[2]===1&&stride[1]===shape[0]*shape[2]&&stride[0]===shape[2]}return stride[0]===1&&stride[1]===shape[0]}function texSubImageArray(gl,x_off,y_off,mip_level,cformat,ctype,mipLevels,array){var dtype=array.dtype;var shape=array.shape.slice();if(shape.length<2||shape.length>3){throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d")}var type=0,format=0;var packed=isPacked(shape,array.stride.slice());if(dtype==="float32"){type=gl.FLOAT}else if(dtype==="float64"){type=gl.FLOAT;packed=false;dtype="float32"}else if(dtype==="uint8"){type=gl.UNSIGNED_BYTE}else{type=gl.UNSIGNED_BYTE;packed=false;dtype="uint8"}var channels=1;if(shape.length===2){format=gl.LUMINANCE;shape=[shape[0],shape[1],1];array=ndarray(array.data,shape,[array.stride[0],array.stride[1],1],array.offset)}else if(shape.length===3){if(shape[2]===1){format=gl.ALPHA}else if(shape[2]===2){format=gl.LUMINANCE_ALPHA}else if(shape[2]===3){format=gl.RGB}else if(shape[2]===4){format=gl.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}channels=shape[2]}else{throw new Error("gl-texture2d: Invalid shape for texture")}if((format===gl.LUMINANCE||format===gl.ALPHA)&&(cformat===gl.LUMINANCE||cformat===gl.ALPHA)){format=cformat}if(format!==cformat){throw new Error("gl-texture2d: Incompatible texture format for setPixels")}var size=array.size;var needsMip=mipLevels.indexOf(mip_level)<0;if(needsMip){mipLevels.push(mip_level)}if(type===ctype&&packed){if(array.offset===0&&array.data.length===size){if(needsMip){gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,array.data)}else{gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,array.data)}}else{if(needsMip){gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,array.data.subarray(array.offset,array.offset+size))}else{gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,array.data.subarray(array.offset,array.offset+size))}}}else{var pack_buffer;if(ctype===gl.FLOAT){pack_buffer=pool.mallocFloat32(size)}else{pack_buffer=pool.mallocUint8(size)}var pack_view=ndarray(pack_buffer,shape,[shape[2],shape[2]*shape[0],1]);if(type===gl.FLOAT&&ctype===gl.UNSIGNED_BYTE){convertFloatToUint8(pack_view,array)}else{ops.assign(pack_view,array)}if(needsMip){gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,pack_buffer.subarray(0,size))}else{gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,pack_buffer.subarray(0,size))}if(ctype===gl.FLOAT){pool.freeFloat32(pack_buffer)}else{pool.freeUint8(pack_buffer)}}}function initTexture(gl){var tex=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,tex);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);return tex}function createTextureShape(gl,width,height,format,type){var maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(width<0||width>maxTextureSize||height<0||height>maxTextureSize){throw new Error("gl-texture2d: Invalid texture shape")}if(type===gl.FLOAT&&!gl.getExtension("OES_texture_float")){throw new Error("gl-texture2d: Floating point textures not supported on this platform")}var tex=initTexture(gl);gl.texImage2D(gl.TEXTURE_2D,0,format,width,height,0,format,type,null);return new Texture2D(gl,tex,width,height,format,type)}function createTextureDOM(gl,element,format,type){var tex=initTexture(gl);gl.texImage2D(gl.TEXTURE_2D,0,format,format,type,element);return new Texture2D(gl,tex,element.width|0,element.height|0,format,type)}function createTextureArray(gl,array){var dtype=array.dtype;var shape=array.shape.slice();var maxSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(shape[0]<0||shape[0]>maxSize||shape[1]<0||shape[1]>maxSize){throw new Error("gl-texture2d: Invalid texture size")}var packed=isPacked(shape,array.stride.slice());var type=0;if(dtype==="float32"){type=gl.FLOAT}else if(dtype==="float64"){type=gl.FLOAT;packed=false;dtype="float32"}else if(dtype==="uint8"){type=gl.UNSIGNED_BYTE}else{type=gl.UNSIGNED_BYTE;packed=false;dtype="uint8"}var format=0;if(shape.length===2){format=gl.LUMINANCE;shape=[shape[0],shape[1],1];array=ndarray(array.data,shape,[array.stride[0],array.stride[1],1],array.offset)}else if(shape.length===3){if(shape[2]===1){format=gl.ALPHA}else if(shape[2]===2){format=gl.LUMINANCE_ALPHA}else if(shape[2]===3){format=gl.RGB}else if(shape[2]===4){format=gl.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}}else{throw new Error("gl-texture2d: Invalid shape for texture")}if(type===gl.FLOAT&&!gl.getExtension("OES_texture_float")){type=gl.UNSIGNED_BYTE;packed=false}var buffer,buf_store;var size=array.size;if(!packed){var stride=[shape[2],shape[2]*shape[0],1];buf_store=pool.malloc(size,dtype);var buf_array=ndarray(buf_store,shape,stride,0);if((dtype==="float32"||dtype==="float64")&&type===gl.UNSIGNED_BYTE){convertFloatToUint8(buf_array,array)}else{ops.assign(buf_array,array)}buffer=buf_store.subarray(0,size)}else if(array.offset===0&&array.data.length===size){buffer=array.data}else{buffer=array.data.subarray(array.offset,array.offset+size)}var tex=initTexture(gl);gl.texImage2D(gl.TEXTURE_2D,0,format,shape[0],shape[1],0,format,type,buffer);if(!packed){pool.free(buf_store)}return new Texture2D(gl,tex,shape[0],shape[1],format,type)}function createTexture2D(gl){if(arguments.length<=1){throw new Error("gl-texture2d: Missing arguments for texture2d constructor")}if(!linearTypes){lazyInitLinearTypes(gl)}if(typeof arguments[1]==="number"){return createTextureShape(gl,arguments[1],arguments[2],arguments[3]||gl.RGBA,arguments[4]||gl.UNSIGNED_BYTE)}if(Array.isArray(arguments[1])){return createTextureShape(gl,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||gl.RGBA,arguments[3]||gl.UNSIGNED_BYTE)}if(typeof arguments[1]==="object"){var obj=arguments[1];if(obj instanceof HTMLCanvasElement||obj instanceof HTMLImageElement||obj instanceof HTMLVideoElement||obj instanceof ImageData){return createTextureDOM(gl,obj,arguments[2]||gl.RGBA,arguments[3]||gl.UNSIGNED_BYTE)}else if(obj.shape&&obj.data&&obj.stride){return createTextureArray(gl,obj)}}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:446,"ndarray-ops":445,"typedarray-pool":448}],231:[function(require,module,exports){"use strict";module.exports={TextureLoader:require("./ac-texture-loader/TextureLoader")}},{"./ac-texture-loader/TextureLoader":232}],232:[function(require,module,exports){"use strict";var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro,StackGLTexture2D=require("gl-texture2d"),ac_Object=require("@marcom/ac-object"),ac_Cname=require("ac-cname").cname,DOMEmitter=require("@marcom/ac-dom-emitter").DOMEmitter,ac_Viewport=require("@marcom/ac-viewport").Viewport;var defaultOptions={basePath:"/",ignoreBreakpoint:false,type:"image",extension:"png",allowXLarge:false,timeout:5e3};var videoExtensions=["mp4"];function TextureLoader(options){EventEmitterMicro.call(this);options=options||{};this.options=ac_Object.defaults(defaultOptions,options);this.textureUnitCount=0;this._boundOnBreakpoint=this._onBreakpoint.bind(this);ac_Viewport.on("breakpoint",this._boundOnBreakpoint);this._onBreakpoint();this.textures={}}var proto=TextureLoader.prototype=Object.create(EventEmitterMicro.prototype);proto.createTexture=function(context,name,options){var el=this._getTextureDOMElement(options);this.textures[name]={texture:{},el:el,unit:this.textureUnitCount,context:context,options:options||{}};this.textureUnitCount++;return this.textures[name].texture};proto.load=function(name,options){if(typeof name!=="string"){return false}var textureObj=this.textures[name];if(!textureObj){this.createTexture(name,options);textureObj=this.textures[name]}var requestOptions=ac_Object.defaults(textureObj.options,options||{});var assetPath=this.getAssetPath(name,requestOptions);var xhr=new XMLHttpRequest;xhr.open("GET",assetPath,true);xhr.responseType="arraybuffer";xhr.onload=this._handleXHRLoaded.bind(this,name,textureObj,requestOptions,xhr);xhr.send(null);return textureObj.texture};proto.emptyTextureCache=function(){var i;for(i in this.textures){if(this.textures.hasOwnProperty(i)){this.textures[i].texture.dispose()}}this.textures={}};proto.getAssetPath=function(name,options){options=ac_Object.defaults(this.options,options||{});var basePath=options.basePath,extension=options.extension,assetSuffix="",retinaSuffix="_2x";extension="."+extension;if(!options.ignoreBreakpoint){var breakpointName=this.breakpointName;if(breakpointName==="xlarge"&&!options.allowXLarge){breakpointName="large"}assetSuffix+="_"+breakpointName}if(options.retina===true){assetSuffix+=retinaSuffix}else if(options.retina===false){assetSuffix+=""}else{var dprSuffix="";if(window.devicePixelRatio>1.5){dprSuffix=retinaSuffix}assetSuffix+=dprSuffix}return ac_Cname.formatUrl(basePath,name+assetSuffix,extension)};proto.cancelXHR=function(){};proto.destroy=function(){this.emptyTextureCache();this.cancelXHR();ac_Viewport.off("breakpoint",this._boundOnBreakpoint);var i;for(i in this){if(this.hasOwnProperty(i)){this[i]=null}}};proto._getTextureDOMElement=function(options){var el,tagName="img";if(videoExtensions.indexOf(options.extension)>-1){tagName="video"}return document.createElement(tagName)};proto._handleXHRLoaded=function(name,textureObj,options,xhr){if(xhr.status>=400){this.trigger("error",{name:name,xhr:xhr});xhr=null;return}var URLObject=window.URL||window.webkitURL;var mimePrefix="image",tagName=textureObj.el.tagName.toLowerCase();if(tagName==="video"){mimePrefix="video"}var arrayBufferView=new Uint8Array(xhr.response),blob=new Blob([arrayBufferView],{type:mimePrefix+"/"+options.extension}),objectURL=URLObject.createObjectURL(blob);var textureDOMEmitter=new DOMEmitter(textureObj.el);var readyEvent="load";if(tagName==="video"){readyEvent="canplay"}textureDOMEmitter.on(readyEvent,this._onImageBlobTextureLoaded.bind(this,name,textureObj,textureDOMEmitter,xhr));textureObj.el.src=objectURL};proto._onImageBlobTextureLoaded=function(name,textureObj,textureDOMEmitter,xhr){textureObj.texture=StackGLTexture2D(textureObj.context,textureObj.el);this.textures[name]=textureObj;this.trigger("load",{name:name,texture:textureObj.texture,el:textureObj.el});textureDOMEmitter.destroy();xhr=textureDOMEmitter=null};proto._onBreakpoint=function(){this.breakpointName=ac_Viewport.getBreakpoint().name};module.exports=TextureLoader},{"@marcom/ac-dom-emitter":225,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-object":184,"@marcom/ac-viewport":278,"ac-cname":228,"gl-texture2d":230}],233:[function(require,module,exports){"use strict";module.exports={ShaderPlayer2D:require("./ac-shader-player-2d/ShaderPlayer2D")}},{"./ac-shader-player-2d/ShaderPlayer2D":236}],234:[function(require,module,exports){"use strict";var Color=function(value){this.w=0;this.x=0;this.y=0;this.z=0;if(value===0){return}if(Array.isArray(value)){this._setFromArray(value)}else if(typeof value==="object"){this._setFromObject(value)}else if(typeof value==="number"){this._setFromHexNumber(value)}else if(typeof value==="string"){this._setFromHexString(value)}};var proto=Color.prototype;proto._setFromArray=function(arr){this._replaceColorVals.apply(this,arr)};proto._setFromObject=function(obj){this._replaceColorVals(obj.r,obj.g,obj.b,obj.a)};proto._setFromHexNumber=function(num){this._setFromHexString(num.toString(16))};proto._setFromHexString=function(str){var rgbObj=this._hexToRGB(str);this._setFromObject(rgbObj)};proto._replaceColorVals=function(r,g,b,a){this._replaceColorVal("w",r);this._replaceColorVal("x",g);this._replaceColorVal("y",b);this._replaceColorVal("z",a)};proto._replaceColorVal=function(key,val){if(typeof val==="undefined"){return}val=val/255;if(val<0){val=0}else if(val>1){val=1}this[key]=val};proto._hexToRGB=function(hex){var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;hex=hex.replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b});var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null};module.exports=Color},{}],235:[function(require,module,exports){"use strict";var ExtensionsController=function(context){this.extensions={};this.context=context};var proto=ExtensionsController.prototype;proto.get=function(name){if(typeof this.extensions[name]!=="undefined"){return this.extensions[name]}var extension,context=this.context;if(name==="EXT_texture_filter_anisotropic"){extension=context.getExtension("EXT_texture_filter_anisotropic")||context.getExtension("MOZ_EXT_texture_filter_anisotropic")||context.getExtension("WEBKIT_EXT_texture_filter_anisotropic")}else if(name==="WEBGL_compressed_texture_s3tc"){extension=context.getExtension("WEBGL_compressed_texture_s3tc")||context.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||context.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc")}else if(name==="WEBGL_compressed_texture_pvrtc"){extension=context.getExtension("WEBGL_compressed_texture_pvrtc")||context.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc")}else{extension=context.getExtension(name)}if(extension===null){this.extensions[name]=null;return null}this.extensions[name]=extension;return extension};module.exports=ExtensionsController},{}],236:[function(require,module,exports){"use strict";var WebGLRenderer=require("./WebGLRenderer"),Color=require("./Color"),TextureController=require("./TextureController"),vertexShader=require("./vertexShader"),EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro,defaults=require("@marcom/ac-object/defaults"),ac_Clock=require("@marcom/ac-clock"),DOMEmitter=require("@marcom/ac-dom-emitter").DOMEmitter,ac_Viewport=require("@marcom/ac-viewport").Viewport;var defaultOptions={sizes:{},vertexShader:vertexShader,antialias:false,preserveDrawingBuffer:false,transparent:false,mipmap:1,reloadOnBreakpoint:false,clearColor:0,autoClearColor:false,allowXLarge:false,backgroundOpacity:0,vertexShadersPath:null,fragmentShadersPath:null,invertX:false,invertY:false,uniforms:{},minFilter:"LINEAR_MIPMAP_LINEAR",magFilter:"LINEAR"};var events={update:"update",draw:"draw",textureLoadStart:"texture-load-start",textureReloadStart:"texture-reload-start",textureLoad:"texture-load",texturesComplete:"textures-complete",resize:"resize"};function ShaderPlayer2D(options){EventEmitterMicro.call(this);this.options=defaults(defaultOptions,options||{});this.clock=options.clock||ac_Clock;this.className=options.className||this.className;this.activeClassName=options.activeClassName||this.activeClassName;this._currentSize={};this._textureController=null;this._texturesReady=true;this._shouldUpdate=true;this._progressValue=null;this._renderingReady=false;this._didBindBreakpoint=false;this._renderCount=0;this._didRender=false;this._textureKeyMap={};this._textureValMap={};this._textureUpdateMap={};this.devicePixelRatio=this._getDevicePixelRatio();this._breakpointName=this.getCurrentBreakpointName();this._setBreakpointSizes();this._boundOnUpdate=this._onUpdate.bind(this);this._boundOnDraw=this._onDraw.bind(this);this.initialize();this.domEmitter=new DOMEmitter(this.el);this.clock.on("update",this._boundOnUpdate);this.clock.on("draw",this._boundOnDraw);if(this._getSizesLength()>1||this.options.reloadOnBreakpoint){this._didBindBreakpoint=true;this._boundOnShaderPlayer2DBreakpoint=this._onShaderPlayer2DBreakpoint.bind(this);ac_Viewport.on("breakpoint",this._boundOnShaderPlayer2DBreakpoint)}this._bindDOMEvents()}var proto=ShaderPlayer2D.prototype=Object.create(EventEmitterMicro.prototype);proto.rendersBeforeVisible=0;proto.className="webgl-object";proto.activeClassName="active";proto.initialize=function(){this.options.uniforms=this._appendIncludedUniforms(this.options.uniforms);this.renderer=this.createRenderer();if(this.options.textures){this._setTextureUniforms(this.options.textures)}this._initializeRenderer();this.el=this.renderer.el;this.el.className=this.className;this.setSize()};proto.load=function(){if(!this._textureController){return}this.trigger(events.textureLoadStart);this._textureController.load()};proto.start=function(){this.clock.start()};proto.stop=function(){this.clock.stop()};proto.render=function(){if(!this.renderer||!this._texturesReady){return}if(!this._didRender){this._setInitialUniforms();this._didRender=true}this._renderCount++;if(!this._renderingReady){if(this._renderCount<this.rendersBeforeVisible){return}this.setActive()}this.renderer.render(this.scene,this.camera)};proto.createRenderer=function(){return new WebGLRenderer(this,this._getRendererOptions())};proto.setClearColor=function(color){color=color||this.options.clearColor;this.options.clearColor=color;this.renderer.setClearColor(this._getClearColor(color))};proto.setBackgroundOpacity=function(backgroundOpacity){this.options.backgroundOpacity=backgroundOpacity;this.setClearColor()};proto.setTextureMagFilter=function(name,type){var texture=this.getTexture(name);if(!texture&&this.renderer.context[type]!=="undefined"){return null}texture.texture.magFilter=this.renderer.context[type];return true};proto.setTextureMinFilter=function(name,type){var texture=this.getTexture(name);if(!texture&&this.renderer.context[type]!=="undefined"){return null}texture.texture.minFilter=this.renderer.context[type];return true};proto.createTextureController=function(options){options=options||{};if(this.options.allowXLarge){options.allowXLarge=true}if(this.options.magFilter){options.magFilter=this.options.magFilter}if(this.options.minFilter){options.minFilter=this.options.minFilter}this._textureController=new TextureController(this,options);this._boundOnTextureControllerLoad=this._onTextureControllerLoad.bind(this);this._boundOnTextureControllerComplete=this._onTextureControllerComplete.bind(this);this._boundOnTextureControllerReadyStateChanged=this._onTextureControllerReadyStateChanged.bind(this);this._textureController.on("load",this._boundOnTextureControllerLoad);this._textureController.on("complete",this._boundOnTextureControllerComplete);this._textureController.on("readystatechanged",this._boundOnTextureControllerReadyStateChanged)};proto.getSizesForBreakpoint=function(breakpointName){breakpointName=breakpointName||ac_Viewport.getBreakpoint().name;if(!this.options.sizes[breakpointName]){breakpointName="defaults"}return{name:breakpointName,sizes:this.options.sizes[breakpointName]}};proto.getUniform=function(name){if(!this.renderer){return null}return this.renderer.getUniform(name)};proto.setUniform=function(name,value){if(!this.renderer){return false}return this.renderer.setUniform(name,value)};proto.getAttribute=function(name){if(!this.renderer){return null}return this.renderer.getAttribute(name)};proto.setAttribute=function(name,value){if(!this.renderer){return false}return this.renderer.setAttribute(name,value)};proto.setUniformValues=function(obj){if(typeof obj!=="object"){return false}var i;for(i in obj){if(obj.hasOwnProperty(i)){this.setUniformValue(i,obj[i])}}};proto.setSize=function(width,height){if(typeof width!=="undefined"){this.width=width}if(typeof height!=="undefined"){this.height=height}this._setResolution();if(this.renderer){this.renderer.setSize(this.width*this.devicePixelRatio,this.height*this.devicePixelRatio,this.options.mipmap)}if(this.el){this.el.style.width=this.width+"px";this.el.style.height=this.height+"px"}};proto.setBasePath=function(basePath){if(!this._textureController){return}this._textureController.options.basePath=basePath};proto.setActive=function(){this.el.classList.add(this.activeClassName);this._renderingReady=true};proto.setInactive=function(){this.el.classList.remove(this.activeClassName);this._renderCount=0;this._renderingReady=false};proto.getTexture=function(name){if(!this.renderer||!this._textureController){return null}if(typeof this._textureKeyMap[name]!=="undefined"){name=this._textureKeyMap[name]}return this._textureController.getTexture(name)};proto.setTexture=function(name,val){};proto.getCurrentBreakpointName=function(){var breakpointName=ac_Viewport.getBreakpoint().name;if(!this.options.allowXLarge&&breakpointName==="xlarge"){breakpointName="large"}return breakpointName};proto.getTextures=function(){var textures={};var i;for(i in this._textureKeyMap){if(this._textureKeyMap.hasOwnProperty(i)){textures[i]=this.getTexture(i)}}return textures};proto.getTextureControllerTextures=function(){if(!this._textureController){return null}var result={};var i,textures=this._textureController._textureLoader.textures;for(i in textures){if(textures.hasOwnProperty(i)){result[i]=textures[i].texture}}return result};proto.refreshTexture=function(name){this._textureUpdateMap[name]=true};proto.destroy=function(){this.stop();if(this._textureController){this._textureController.destroy()}if(this._didBindBreakpoint){ac_Viewport.off("breakpoint",this._boundOnShaderPlayer2DBreakpoint)}this.domEmitter.destroy();var i;for(i in this){if(this.hasOwnProperty(i)){this[i]=null}}EventEmitterMicro.prototype.destroy.call(this)};proto._onTextureControllerLoad=function(e){this.trigger(events.textureLoad,e)};proto._onTextureControllerComplete=function(){this._texturesReady=true;this.trigger(events.texturesComplete)};proto._onTextureControllerReadyStateChanged=function(e){this._texturesReady=e.texturesReady};proto._setTextureUniforms=function(texturesObj){var i,context=this.renderer.context,textureObj;for(i in texturesObj){if(texturesObj.hasOwnProperty(i)){textureObj=texturesObj[i];if(!this._textureController){this.createTextureController()}this._texturesRequired++;this._textureKeyMap[i]=textureObj.name;this._textureValMap[textureObj.name]=i;this.options.uniforms[i]={type:"sampler2D",value:this._textureController.createTexture(context,textureObj.name,textureObj)}}}};proto._setTime=function(time){this.setUniform("time",time)};proto._setResolution=function(){this.setUniform("resolution",[this.width,this.height])};proto._setPointer=function(x,y){if(this.options.invertX){x=1-x}if(this.options.invertY){y=1-y}this.setUniform("pointer",[x,y])};proto._getDevicePixelRatio=function(){if(this.options.devicePixelRatio){return this.options.devicePixelRatio}return window.devicePixelRatio||1};proto._onShaderPlayer2DBreakpoint=function(e){var newBreakpointName=this.getCurrentBreakpointName();if(this._breakpointName===newBreakpointName){return}this._breakpointName=newBreakpointName;if(this._shouldChangeSize(newBreakpointName)){this._setBreakpointSizes()}if(this.options.reloadOnBreakpoint&&this._textureController){this._texturesReady=false;this.setInactive();this._textureController.load();this.trigger(events.textureReloadStart)}};proto._getSizesLength=function(){return Object.keys(this.options.sizes).length};proto._shouldChangeSize=function(newBreakpointName){var sizesObj=this.getSizesForBreakpoint(newBreakpointName);if(sizesObj.sizes.width===this._currentSize.sizes.width&&sizesObj.sizes.height===this._currentSize.sizes.height){return false}return true};proto._setBreakpointSizes=function(){var sizesObj=this.getSizesForBreakpoint();this._currentSize=sizesObj;this.setSize(sizesObj.sizes.width,sizesObj.sizes.height);this.trigger(events.resize)};proto._appendIncludedUniforms=function(uniforms){uniforms=uniforms||{};if(!uniforms.progress){uniforms.progress={type:"float",value:0}}if(!uniforms.time){uniforms.time={type:"float",value:0}}if(!uniforms.resolution){uniforms.resolution={type:"vec2",value:[this.width,this.height]}}if(!uniforms.pointer){uniforms.pointer={type:"vec2",value:[0,0]}}return uniforms};proto._setInitialUniforms=function(){if(!this.options||!this.options.uniforms){return}var i;for(i in this.options.uniforms){if(this.options.uniforms.hasOwnProperty(i)){this.setUniform(i,this.options.uniforms[i].value)}}};proto._onUpdate=function(e){this._setTime(e.time);this.trigger(events.update,e)};proto._onDraw=function(e){this.render();this.trigger(events.draw,e)};proto._refreshTexture=function(name){var texture=this.getTexture(name);if(!texture){return null}texture.texture.setPixels(texture.el)};proto._bindDOMEvents=function(){this.domEmitter.on("mousemove",this._handleMouseMove,this);this.domEmitter.on("touchmove",this._handleTouchMove,this)};proto._getClearColor=function(color){var clearColor=new Color(color);clearColor.z=this.options.backgroundOpacity;return clearColor};proto._initializeRenderer=function(){this.renderer.initialize(this._getRendererOptions())};proto._getRendererOptions=function(){return{clearColor:this._getClearColor(this.options.clearColor),transparent:this.options.transparent,fragmentShader:this.options.fragmentShader,vertexShader:this.options.vertexShader,uniforms:this.options.uniforms,antialias:this.options.antialias}};proto._handleMouseMove=function(e){this._setPointer(e.originalEvent.offsetX/this.width,1-e.originalEvent.offsetY/this.height)};proto._handleTouchMove=function(e){this._setPointer(e.originalEvent.touches[0].offsetX/this.width,1-e.originalEvent.touches[0].offsetY/this.height)};module.exports=ShaderPlayer2D},{"./Color":234,"./TextureController":237,"./WebGLRenderer":238,"./vertexShader":239,"@marcom/ac-clock":27,"@marcom/ac-dom-emitter":225,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-object/defaults":187,"@marcom/ac-viewport":278}],237:[function(require,module,exports){"use strict";var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro,defaults=require("@marcom/ac-object/defaults"),TextureLoader=require("@marcom/ac-texture-loader").TextureLoader;var proto;var TextureController=function(controller,options){EventEmitterMicro.call(this);this.options=options||{};this.controller=controller;this.options.basePath=this.options.basePath||window.location.pathname;this._textureLoader=new TextureLoader(this.options);this._texturesRequired=0;this._texturesLoaded=0;this._textureLoader.on("load",this._handleTextureLoaderLoaded.bind(this))};proto=TextureController.prototype=Object.create(EventEmitterMicro.prototype);proto.createTexture=function(context,name,options){if(this._textureLoader.textures[name]){throw'Existing texture "'+name+'" already registered.';return}if(!context){throw"Textures require a WebGL context in order to be created.";return}options=defaults(this.options,options||{});this._textureLoader.createTexture(context,name,options);this._texturesRequired++;return this.getTexture(name)};proto.getTexture=function(name){if(!this._textureLoader){return null}return this._textureLoader.textures[name]};proto.load=function(options){options=defaults(this.options,options||{});this._texturesLoaded=0;if(!this._textureLoader){return}var i;for(i in this._textureLoader.textures){if(this._textureLoader.textures.hasOwnProperty(i)){this._textureLoader.load(i,options)}}};proto.destroy=function(){this._textureLoader.destroy();var i;for(i in this){if(this.hasOwnProperty(i)){this[i]=null}}EventEmitterMicro.prototype.destroy.call(this)};proto._handleTextureLoaderLoaded=function(e){if(this.controller&&this.controller.renderer){var textureName=this.controller._textureValMap[e.name];var width=e.el.width,height=e.el.height;if(e.el instanceof HTMLVideoElement){width=e.el.videoWidth;height=e.el.videoHeight}if(this._isPowerOfTwo(width)&&this._isPowerOfTwo(height)){e.texture.generateMipmap();if(this.options.magFilter){e.texture.magFilter=e.texture.gl[this.options.magFilter]}if(this.options.minFilter){e.texture.minFilter=e.texture.gl[this.options.minFilter]}}else{e.texture.magFilter=e.texture.gl.LINEAR;e.texture.minFilter=e.texture.gl.LINEAR;e.texture.wrapT=e.texture.gl.CLAMP_TO_EDGE;e.texture.wrapS=e.texture.gl.CLAMP_TO_EDGE}this.controller.renderer.bindTexture(textureName)}this.trigger("load",e);this._texturesLoaded++;if(this._texturesLoaded===this._texturesRequired){this.trigger("complete")}};proto._isPowerOfTwo=function(value){return(value&value-1)===0};module.exports=TextureController},{"@marcom/ac-event-emitter-micro":133,"@marcom/ac-object/defaults":187,"@marcom/ac-texture-loader":231}],238:[function(require,module,exports){"use strict";var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro,ExtensionsController=require("./ExtensionsController"),drawTriangle=require("a-big-triangle"),StackGLShader=require("gl-shader-core");var proto;var defaultRenderSettings={clearDepth:1,clearColor:[0,0,0,0],clearStencil:0};var defaultExtensions=["OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_standard_derivatives"];var WebGLRenderer=function(controller,options){EventEmitterMicro.call(this);this.options=this._initializeOptions(options);this.controller=controller;var canvas=document.createElement("canvas");var context=canvas.getContext("webgl",this.options)||canvas.getContext("experimental-webgl",this.options);if(!context){this.trigger("error","Unable to initialize WebGL");return null}this.el=canvas;this.context=context};proto=WebGLRenderer.prototype=Object.create(WebGLRenderer.prototype);proto.initialize=function(options){var context=this.context;this.options=this._initializeOptions(options);this._shouldClearColor=true;this.options._transformedUniforms=this.transformShaderParameters(this.options.uniforms);if(this.options.attributes){this.options._transformedAttributes=this.transformShaderParameters(this.options.attributes)}var renderSettings={};renderSettings.clearFlags=this.options.clearFlags===undefined?context.COLOR_BUFFER_BIT|context.DEPTH_BUFFER_BIT:this.options.clearFlags;var i;for(i in defaultRenderSettings){if(defaultRenderSettings.hasOwnProperty(i)){renderSettings[i]=defaultRenderSettings[i];if(typeof this.options[i]!=="undefined"){renderSettings[i]=this.options[i]}}}this._renderSettings=renderSettings;this.shader=this.createShader(context,this.options.vertexShader,this.options.fragmentShader,this.options._transformedUniforms,this.options._transformedAttributes);context.pixelStorei(context.UNPACK_FLIP_Y_WEBGL,true);context.pixelStorei(context.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false);this.extensions=new ExtensionsController(this.context);var len=defaultExtensions.length;for(i=0;i<len;i++){this.extensions.get(defaultExtensions[i])}this.bindShader()};proto.createShader=function(context,vertexShader,fragmentShader,uniforms,attributes){var params=this._normalizeShaderParams({context:context,vertexShader:vertexShader,fragmentShader:fragmentShader,uniforms:uniforms||[],attributes:attributes||[]});return StackGLShader(params.context,params.vertexShader,params.fragmentShader,params.uniforms,params.attributes)};proto.linkProgram=function(context,fragmentShader,vertexShader){var program=context.createProgram();context.attachShader(program,fragmentShader);context.attachShader(program,vertexShader);context.linkProgram(program);context.useProgram(program)};proto.bindShader=function(){this.shader.bind()};proto.bindTextures=function(){if(!this.controller||!this.controller.options||!this.controller.options.textures){return}var i,textures=this.controller.options.textures;for(i in textures){if(textures.hasOwnProperty(i)){this.bindTexture(i)}}};proto.bindTexture=function(name,force){if(force||this.controller._textureUpdateMap[name]){this.controller._refreshTexture(name);this.controller._textureUpdateMap[name]=false}var textureObj=this.controller.getTexture(name);if(!textureObj){return}this.shader.uniforms[name]=textureObj.texture.bind(textureObj.unit)};proto.setClearColor=function(color){this._renderSettings.clearColor=color;this._shouldClearColor=true};proto.clearColor=function(){var context=this.context,renderSettings=this._renderSettings;context.bindFramebuffer(context.FRAMEBUFFER,null);if(renderSettings.clearFlags&context.STENCIL_BUFFER_BIT){context.clearStencil(renderSettings.clearStencil)}if(renderSettings.clearFlags&context.COLOR_BUFFER_BIT){context.clearColor(renderSettings.clearColor.w,renderSettings.clearColor.x,renderSettings.clearColor.y,renderSettings.clearColor.z)}if(renderSettings.clearFlags&context.DEPTH_BUFFER_BIT){context.clearDepth(renderSettings.clearDepth)}if(renderSettings.clearFlags){context.clear(context.COLOR_BUFFER_BIT|context.DEPTH_BUFFER_BIT|context.STENCIL_BUFFER_BIT)}};proto.render=function(){if(this.options.autoClearColor||this._shouldClearColor){this.clearColor();this._shouldClearColor=false}this.bindShader();this.bindTextures();drawTriangle(this.context)};proto.updateShader=function(options){options=options||{};if(options.uniforms){options.uniforms=this.transformShaderParameters(options.uniforms)}options.vertexShader=options.vertexShader||this.options.vertexShader;options.fragmentShader=options.fragmentShader||this.options.fragmentShader;options.uniforms=options.uniforms||this.options.uniforms;options.attributes=options.attributes||this.options.attributes;options=this._normalizeShaderParams(options);this.shader.dispose();this.shader=this.createShader(this.context,options.vertexShader,options.fragmentShader,options.uniforms,options.attributes);this.options.vertexShader=options.vertexShader;this.options.fragmentShader=options.fragmentShader;this.options.uniforms=options.uniforms;this.options.attributes=options.attributes};proto.getUniform=function(name){if(!this._hasUniform(name)){return null}return this.options.uniforms[name].value};proto.setUniform=function(name,value){if(!this._hasUniform(name)){return}this.options.uniforms[name].value=value;this.shader.uniforms[name]=value};proto.getAttribute=function(name,value){if(!this.shader){return null}return this.shader.attributes[name]};proto.setAttribute=function(name,value){if(!this.shader){return}this.shader.attributes[name]=value};proto.setSize=function(width,height,mipmap){var renderWidth=width*mipmap,renderHeight=height*mipmap;this.el.setAttribute("width",renderWidth);this.el.setAttribute("height",renderHeight);this.el.style.width=width+"px";this.el.style.height=height+"px";this.context.viewport(0,0,renderWidth|0,renderHeight|0)};proto.transformShaderParameters=function(params){params=params||{};var result=[];var i;for(i in params){if(params.hasOwnProperty(i)){result.push({name:i,type:params[i].type})}}return result};proto.destroy=function(){this.shader.dispose();EventEmitterMicro.prototype.destroy.call(this)};proto._normalizeShaderParams=function(params){if(this.options.setFloatPrecision!==false){params.fragmentShader="precision highp float;\n"+params.fragmentShader}return params};proto._initializeOptions=function(options){options.alpha=options.transparent;return options};proto._hasUniform=function(name){return this.options||this.options.uniforms||this.options.uniforms[name]};module.exports=WebGLRenderer},{"./ExtensionsController":235,"@marcom/ac-event-emitter-micro":133,"a-big-triangle":302,"gl-shader-core":429}],239:[function(require,module,exports){module.exports="attribute vec3 position;\t\t\t\t\tvarying vec2 vUV;\t\t\t\t\tvoid main() {\t\t\t\t\t\tgl_Position = vec4(position, 1.0);\t\t\t\t\t\tvUV = position.xy * 0.5 + 0.5;\t\t\t\t\t}"},{}],240:[function(require,module,exports){"use strict";module.exports={SharedInstance:require("./ac-shared-instance/SharedInstance")}},{"./ac-shared-instance/SharedInstance":241}],241:[function(require,module,exports){"use strict";var instanceScope=window,instanceSharedInstanceNamespace="AC",instanceExportKey="SharedInstance",instanceTarget=instanceScope[instanceSharedInstanceNamespace];var SharedInstance=function(){var registry={};return{get:function(name,version){var module=null;if(registry[name]&&registry[name][version]){module=registry[name][version]}return module},set:function(name,version,Module){if(!registry[name]){registry[name]={}}if(typeof Module==="function"){registry[name][version]=new Module}else{registry[name][version]=Module}return registry[name][version]},share:function(name,version,Module){var module=this.get(name,version);if(!module){module=this.set(name,version,Module)}return module},remove:function(name,version){var versionType=typeof version;if(versionType==="string"||versionType==="number"){if(!registry[name]||!registry[name][version]){return}registry[name][version]=null;return}if(registry[name]){registry[name]=null}}}}();if(!instanceTarget){instanceTarget=instanceScope[instanceSharedInstanceNamespace]={}}if(!instanceTarget[instanceExportKey]){instanceTarget[instanceExportKey]=SharedInstance}module.exports=instanceTarget[instanceExportKey]},{}],242:[function(require,module,exports){"use strict";var Clip=require("@marcom/ac-eclipse").Clip;var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");module.exports=function fade(el,from,to,duration,options){if(cssPropertyAvailable("opacity")){options=options||{};if(duration){options.autoplay=options.autoplay===false?options.autoplay:true;options.propsFrom=options.propsFrom||{};options.propsFrom.opacity=from;if(options.autoplay){return Clip.to(el,duration,{opacity:to},options)}return new Clip(el,duration,{opacity:to},options)}el.style.opacity=to;if(typeof options.onStart==="function"){options.onStart()}if(typeof options.onComplete==="function"){options.onComplete()}}else{el.style.visibility=to?"visible":"hidden";if(typeof options.onStart==="function"){options.onStart()}if(typeof options.onComplete==="function"){options.onComplete()}}}},{"@marcom/ac-eclipse":112,"@marcom/ac-feature/cssPropertyAvailable":138}],243:[function(require,module,exports){"use strict";var Clip=require("@marcom/ac-eclipse").Clip;var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");module.exports=function fadeIn(el,duration,options){var OPACITY=1;options=options||{};if(cssPropertyAvailable("opacity")){if(duration){options.autoplay=options.autoplay===false?options.autoplay:true;if(options.autoplay){return Clip.to(el,duration,{opacity:OPACITY},options)}return new Clip(el,duration,{opacity:OPACITY},options)}el.style.opacity=OPACITY;if(typeof options.onStart==="function"){options.onStart()}if(typeof options.onComplete==="function"){options.onComplete()}}else{el.style.visibility="visible";if(typeof options.onStart==="function"){options.onStart()}if(typeof options.onComplete==="function"){options.onComplete()}}}},{"@marcom/ac-eclipse":112,"@marcom/ac-feature/cssPropertyAvailable":138}],244:[function(require,module,exports){"use strict";var Clip=require("@marcom/ac-eclipse").Clip;var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");module.exports=function fadeOut(el,duration,options){var OPACITY=0;options=options||{};if(cssPropertyAvailable("opacity")){if(duration){options.autoplay=options.autoplay===false?options.autoplay:true;if(options.autoplay){return Clip.to(el,duration,{opacity:OPACITY},options)}return new Clip(el,duration,{opacity:OPACITY},options)}el.style.opacity=OPACITY;if(typeof options.onStart==="function"){options.onStart()}if(typeof options.onComplete==="function"){options.onComplete()}}else{el.style.visibility="hidden";if(typeof options.onStart==="function"){options.onStart()}if(typeof options.onComplete==="function"){options.onComplete()}}}},{"@marcom/ac-eclipse":112,"@marcom/ac-feature/cssPropertyAvailable":138}],245:[function(require,module,exports){"use strict";var Clip=require("@marcom/ac-eclipse").Clip;var ac_dom_styles=require("@marcom/ac-dom-styles");module.exports=function move(el,x,y,duration,options){options=options||{};options.autoplay=options.autoplay===false?options.autoplay:true;var storedOnStart=options.onStart||null;var storedOnComplete=options.onComplete||null;var to;to={transform:{translateX:x+"px",translateY:y+"px"}};if(duration){options.onStart=function(){el.style.willChange="transform";if(storedOnStart!==null){storedOnStart.call(this)}};options.onComplete=function(){el.style.willChange="";if(storedOnComplete!==null){storedOnComplete.call(this)}};if(options.autoplay){return Clip.to(el,duration,to,options)}return new Clip(el,duration,to,options)}ac_dom_styles.setStyle(el,to);if(typeof options.onStart==="function"){options.onStart()}if(typeof options.onComplete==="function"){options.onComplete()}}},{"@marcom/ac-dom-styles":88,"@marcom/ac-eclipse":112}],246:[function(require,module,exports){"use strict";var BrowserPrefixed=require("@marcom/ac-browser-prefixed");var Transform=require("@marcom/ac-transform").Transform;var move=require("./move");module.exports=function moveX(el,x,duration,options){var transform=new Transform;transform.setMatrixValue(getComputedStyle(el)[BrowserPrefixed.transform]);return move(el,x,transform.getTranslateY(),duration,options)}},{"./move":245,"@marcom/ac-browser-prefixed":8,"@marcom/ac-transform":266}],247:[function(require,module,exports){"use strict";var Clip=require("@marcom/ac-eclipse").Clip;module.exports=function scroll(el,x,y,duration,options){options=options||{};options.autoplay=options.autoplay===false?options.autoplay:true;var isWindow=el===window;var currentScrollPositionX;var currentScrollPositionY;if(isWindow){currentScrollPositionX=el.pageXOffset;currentScrollPositionY=el.pageYOffset}else{currentScrollPositionX=el.scrollLeft;currentScrollPositionY=el.scrollTop}var scrollPosition={x:currentScrollPositionX,y:currentScrollPositionY};var to={x:x,y:y};if(typeof options.onDraw==="function"){var storeOnDraw=options.onDraw}var newOnDraw=function(evt){if(isWindow){el.scrollTo(scrollPosition.x,scrollPosition.y)}else{el.scrollLeft=scrollPosition.x;el.scrollTop=scrollPosition.y}if(storeOnDraw){storeOnDraw.call(this,evt)}};options.onDraw=newOnDraw;if(options.autoplay){return Clip.to(scrollPosition,duration,to,options)}return new Clip(scrollPosition,duration,to,options)}},{"@marcom/ac-eclipse":112}],248:[function(require,module,exports){"use strict";var scroll=require("./scroll");module.exports=function scrollX(el,x,duration,options){var isWindow=el===window;var currentScrollPositionY;if(isWindow){currentScrollPositionY=el.pageYOffset}else{currentScrollPositionY=el.scrollTop}return scroll(el,x,currentScrollPositionY,duration,options)}},{"./scroll":247}],249:[function(require,module,exports){"use strict";module.exports="a-z\\xdf-\\xf6\\xf8-\\xff"},{}],250:[function(require,module,exports){"use strict";module.exports="\\s!?.,:;_\\-~'\"#$&*@^|/"},{}],251:[function(require,module,exports){"use strict";module.exports="A-Z\\xc0-\\xd6\\xd8-\\xde"},{}],252:[function(require,module,exports){"use strict";module.exports={capitalize:require("./capitalize"),collapseWhitespace:require("./collapseWhitespace"),splitWords:require("./splitWords"),stripTags:require("./stripTags"),supplant:require("./supplant"),toCamelCase:require("./toCamelCase"),toKebabCase:require("./toKebabCase"),toSnakeCase:require("./toSnakeCase"),trim:require("./trim"),trimLeft:require("./trimLeft"),trimRight:require("./trimRight"),LOWERCASE_CHARS:require("./LOWERCASE_CHARS"),PUNCTUATION_CHARS:require("./PUNCTUATION_CHARS"),UPPERCASE_CHARS:require("./UPPERCASE_CHARS")}},{"./LOWERCASE_CHARS":249,"./PUNCTUATION_CHARS":250,"./UPPERCASE_CHARS":251,"./capitalize":253,"./collapseWhitespace":254,"./splitWords":256,"./stripTags":257,"./supplant":258,"./toCamelCase":259,"./toKebabCase":260,"./toSnakeCase":261,"./trim":262,"./trimLeft":263,"./trimRight":264}],253:[function(require,module,exports){"use strict";module.exports=function capitalize(str){return str.charAt(0).toUpperCase()+str.slice(1)}},{}],254:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/String/prototype.trim");module.exports=function collapseWhitespace(str){return str.trim().replace(/\s+/g," ")}},{"@marcom/ac-polyfills/String/prototype.trim":"@marcom/ac-polyfills/String/prototype.trim"}],255:[function(require,module,exports){"use strict";module.exports=function normalizeTrimCharacters(chars){chars=chars?chars+"":"\\s";chars=chars.replace(/[.*+?^${}()|[\]]/g,"\\$&");return"["+chars+"]+"}},{}],256:[function(require,module,exports){"use strict";var UPPER_CASE="[A-Z\\xc0-\\xd6\\xd8-\\xde]";var LOWER_CASE="[a-z\\xdf-\\xf6\\xf8-\\xff]";var MATCH_WORDS=new RegExp("("+UPPER_CASE+"+"+LOWER_CASE+"*|"+UPPER_CASE+"*"+LOWER_CASE+"+|[0-9]+)","g");module.exports=function splitWords(str){return str.match(MATCH_WORDS)||[]}},{}],257:[function(require,module,exports){"use strict";module.exports=function stripTags(str){return str.replace(/<[^>]*>/g,"")}},{}],258:[function(require,module,exports){"use strict";module.exports=function supplant(str,obj,pattern){if(!obj){return str}pattern=pattern||/{([^{}]*)}/g;return str.replace(pattern,function(a,b){var r=obj[b];return typeof r==="string"||typeof r==="number"||typeof r==="boolean"?r:a})}},{}],259:[function(require,module,exports){"use strict";var splitWords=require("./splitWords");var transformWords=require("./utils/transformWords");var capitalize=require("./capitalize");var transformCamelCase=function(word,first,last){if(first){return word.toLowerCase()}return capitalize(word.toLowerCase())};module.exports=function toCamelCase(str){return transformWords(str,transformCamelCase)}},{"./capitalize":253,"./splitWords":256,"./utils/transformWords":265}],260:[function(require,module,exports){"use strict";var splitWords=require("./splitWords");module.exports=function toKebabCase(str){return splitWords(str).join("-").toLowerCase()}},{"./splitWords":256}],261:[function(require,module,exports){"use strict";var splitWords=require("./splitWords");module.exports=function toSnakeCase(str){return splitWords(str).join("_").toLowerCase()}},{"./splitWords":256}],262:[function(require,module,exports){"use strict";var normalizeTrimCharacters=require("./internal/normalizeTrimCharacters");module.exports=function trim(str,chars){var regExp=normalizeTrimCharacters(chars);regExp=new RegExp("^"+regExp+"|"+regExp+"$","g");return str.replace(regExp,"")}},{"./internal/normalizeTrimCharacters":255}],263:[function(require,module,exports){"use strict";var normalizeTrimCharacters=require("./internal/normalizeTrimCharacters");module.exports=function trimLeft(str,chars){var regExp=normalizeTrimCharacters(chars);regExp=new RegExp("^"+regExp,"g");return str.replace(regExp,"")}},{"./internal/normalizeTrimCharacters":255}],264:[function(require,module,exports){"use strict";var normalizeTrimCharacters=require("./internal/normalizeTrimCharacters");module.exports=function trimRight(str,chars){var regExp=normalizeTrimCharacters(chars);regExp=new RegExp(regExp+"$","g");return str.replace(regExp,"")}},{"./internal/normalizeTrimCharacters":255}],265:[function(require,module,exports){"use strict";var splitWords=require("../splitWords");module.exports=function transformWords(str,callback){var words=splitWords(str);var length=words.length;var result="";var i;for(i=0;i<length;i++){result+=callback(words[i],i===0,i===length-1)}return result}},{"../splitWords":256}],266:[function(require,module,exports){"use strict";module.exports={Transform:require("./ac-transform/Transform")}},{"./ac-transform/Transform":267}],267:[function(require,module,exports){"use strict";var mat4=require("./gl-matrix/mat4");var vec3=require("./gl-matrix/vec3");var vec4=require("./gl-matrix/vec4");var degToRad=Math.PI/180;var radToDeg=180/Math.PI;var m11=0,mA=0,m12=1,mB=1,m13=2,m14=3;var m21=4,mC=4,m22=5,mD=5,m23=6,m24=7;var m31=8,m32=9,m33=10,m34=11;var m41=12,mE=12,m42=13,mF=13,m43=14,m44=15;function Transform(){this.m=mat4.create()}var proto=Transform.prototype;proto.rotateX=function(deg){var rad=degToRad*deg;mat4.rotateX(this.m,this.m,rad);return this};proto.rotateY=function(deg){var rad=degToRad*deg;mat4.rotateY(this.m,this.m,rad);return this};proto.rotateZ=function(deg){var rad=degToRad*deg;mat4.rotateZ(this.m,this.m,rad);return this};proto.rotate=proto.rotateZ;proto.rotate3d=function(x,y,z,deg){if(y===null||y===undefined)y=x;if(z===null||y===undefined)z=x;var rad=degToRad*deg;mat4.rotate(this.m,this.m,rad,[x,y,z]);return this};proto.rotateAxisAngle=proto.rotate3d;proto.scale=function(sx,sy){sy=sy||sx;mat4.scale(this.m,this.m,[sx,sy,1]);return this};proto.scaleX=function(sx){mat4.scale(this.m,this.m,[sx,1,1]);return this};proto.scaleY=function(sy){mat4.scale(this.m,this.m,[1,sy,1]);return this};proto.scaleZ=function(sz){mat4.scale(this.m,this.m,[1,1,sz]);return this};proto.scale3d=function(sx,sy,sz){mat4.scale(this.m,this.m,[sx,sy,sz]);return this};proto.skew=function(ax,ay){if(ay===null||ay===undefined){return this.skewX(ax)}ax=degToRad*ax;ay=degToRad*ay;var transform=mat4.create();transform[mC]=Math.tan(ax);transform[mB]=Math.tan(ay);mat4.multiply(this.m,this.m,transform);return this};proto.skewX=function(ax){ax=degToRad*ax;var transform=mat4.create();transform[mC]=Math.tan(ax);mat4.multiply(this.m,this.m,transform);return this};proto.skewY=function(ay){ay=degToRad*ay;var transform=mat4.create();transform[mB]=Math.tan(ay);mat4.multiply(this.m,this.m,transform);return this};proto.translate=function(tx,ty){ty=ty||0;mat4.translate(this.m,this.m,[tx,ty,0]);return this};proto.translate3d=function(tx,ty,tz){mat4.translate(this.m,this.m,[tx,ty,tz]);return this};proto.translateX=function(tx){mat4.translate(this.m,this.m,[tx,0,0]);return this};proto.translateY=function(ty){mat4.translate(this.m,this.m,[0,ty,0]);return this};proto.translateZ=function(tz){mat4.translate(this.m,this.m,[0,0,tz]);return this};proto.perspective=function(depth){var t=mat4.create();if(depth!==0){t[m34]=-1/depth}mat4.multiply(this.m,this.m,t)};proto.inverse=function(){var t=this.clone();t.m=mat4.invert(t.m,this.m);return t};proto.reset=function(){mat4.identity(this.m);return this};proto.getTranslateXY=function(){var m=this.m;if(this.isAffine()){return[m[mE],m[mF]]}return[m[m41],m[m42]]};proto.getTranslateXYZ=function(){var m=this.m;if(this.isAffine()){return[m[mE],m[mF],0]}return[m[m41],m[m42],m[m43]]};proto.getTranslateX=function(){var m=this.m;if(this.isAffine()){return m[mE]}return m[m41]};proto.getTranslateY=function(){var m=this.m;if(this.isAffine()){return m[mF]}return m[m42]};proto.getTranslateZ=function(){var m=this.m;if(this.isAffine()){return 0}return m[m43]};proto.clone=function(){var t=new Transform;t.m=mat4.clone(this.m);return t};proto.toArray=function(){var m=this.m;if(this.isAffine()){return[m[mA],m[mB],m[mC],m[mD],m[mE],m[mF]]}return[m[m11],m[m12],m[m13],m[m14],m[m21],m[m22],m[m23],m[m24],m[m31],m[m32],m[m33],m[m34],m[m41],m[m42],m[m43],m[m44]]};proto.fromArray=function(arr){this.m=Array.prototype.slice.call(arr);return this};proto.setMatrixValue=function(string){string=String(string).trim();var m=mat4.create();if(string==="none"){this.m=m;return this}var type=string.slice(0,string.indexOf("(")),parts,i;if(type==="matrix3d"){parts=string.slice(9,-1).split(",");for(i=0;i<parts.length;i++){m[i]=parseFloat(parts[i])}}else if(type==="matrix"){parts=string.slice(7,-1).split(",");for(i=parts.length;i--;)parts[i]=parseFloat(parts[i]);m[m11]=parts[0];m[m12]=parts[1];m[m41]=parts[4];m[m21]=parts[2];m[m22]=parts[3];m[m42]=parts[5]}else{throw new TypeError("Invalid Matrix Value")}this.m=m;return this};var isZero=function(val){return Math.abs(val)<1e-4};proto.decompose=function(convertToDegrees){convertToDegrees=convertToDegrees||false;var matrix=mat4.clone(this.m);var translation=vec3.create();var scale=vec3.create();var skew=vec3.create();var perspective=vec4.create();var quaternion=vec4.create();var eulerRotation=vec3.create();for(var i=0;i<16;i++)matrix[i]/=matrix[m44];var perspectiveMatrix=mat4.clone(matrix);perspectiveMatrix[m14]=0;perspectiveMatrix[m24]=0;perspectiveMatrix[m34]=0;perspectiveMatrix[m44]=1;var a03=matrix[3],a13=matrix[7],a23=matrix[11],a30=matrix[12],a31=matrix[13],a32=matrix[14],a33=matrix[15];var rightHandSide=vec4.create();if(!isZero(matrix[m14])||!isZero(matrix[m24])||!isZero(matrix[m34])){rightHandSide[0]=matrix[m14];rightHandSide[1]=matrix[m24];rightHandSide[2]=matrix[m34];rightHandSide[3]=matrix[m44];var inversePerspectiveMatrix=mat4.invert(mat4.create(),perspectiveMatrix);var transposedInversePerspectiveMatrix=mat4.transpose(mat4.create(),inversePerspectiveMatrix);perspective=vec4.transformMat4(perspective,rightHandSide,transposedInversePerspectiveMatrix)}else{perspective=vec4.fromValues(0,0,0,1)}translation[0]=a30;translation[1]=a31;translation[2]=a32;var row=[vec3.create(),vec3.create(),vec3.create()];row[0][0]=matrix[0];row[0][1]=matrix[1];row[0][2]=matrix[2];row[1][0]=matrix[4];row[1][1]=matrix[5];row[1][2]=matrix[6];row[2][0]=matrix[8];row[2][1]=matrix[9];row[2][2]=matrix[10];scale[0]=vec3.length(row[0]);vec3.normalize(row[0],row[0]);skew[0]=vec3.dot(row[0],row[1]);row[1]=this._combine(row[1],row[0],1,-skew[0]);scale[1]=vec3.length(row[1]);vec3.normalize(row[1],row[1]);skew[0]/=scale[1];skew[1]=vec3.dot(row[0],row[2]);row[2]=this._combine(row[2],row[0],1,-skew[1]);skew[2]=vec3.dot(row[1],row[2]);row[2]=this._combine(row[2],row[1],1,-skew[2]);scale[2]=vec3.length(row[2]);vec3.normalize(row[2],row[2]);skew[1]/=scale[2];skew[2]/=scale[2];var pdum3=vec3.cross(vec3.create(),row[1],row[2]);if(vec3.dot(row[0],pdum3)<0){for(i=0;i<3;i++){scale[i]*=-1;row[i][0]*=-1;row[i][1]*=-1;row[i][2]*=-1}}quaternion[0]=.5*Math.sqrt(Math.max(1+row[0][0]-row[1][1]-row[2][2],0));quaternion[1]=.5*Math.sqrt(Math.max(1-row[0][0]+row[1][1]-row[2][2],0));quaternion[2]=.5*Math.sqrt(Math.max(1-row[0][0]-row[1][1]+row[2][2],0));quaternion[3]=.5*Math.sqrt(Math.max(1+row[0][0]+row[1][1]+row[2][2],0));if(row[2][1]>row[1][2])quaternion[0]=-quaternion[0];if(row[0][2]>row[2][0])quaternion[1]=-quaternion[1];if(row[1][0]>row[0][1])quaternion[2]=-quaternion[2];var axisAngle=vec4.fromValues(quaternion[0],quaternion[1],quaternion[2],2*Math.acos(quaternion[3]));var rotation=this._rotationFromQuat(quaternion);if(convertToDegrees){skew[0]=Math.round(skew[0]*radToDeg*100)/100;skew[1]=Math.round(skew[1]*radToDeg*100)/100;skew[2]=Math.round(skew[2]*radToDeg*100)/100;rotation[0]=Math.round(rotation[0]*radToDeg*100)/100;rotation[1]=Math.round(rotation[1]*radToDeg*100)/100;rotation[2]=Math.round(rotation[2]*radToDeg*100)/100;axisAngle[3]=Math.round(axisAngle[3]*radToDeg*100)/100}return{translation:translation,scale:scale,skew:skew,perspective:perspective,quaternion:quaternion,eulerRotation:rotation,axisAngle:axisAngle}};proto.recompose=function(translation,scale,skew,perspective,quaternion){translation=translation||vec3.create();scale=scale||vec3.create();skew=skew||vec3.create();perspective=perspective||vec4.create();quaternion=quaternion||vec4.create();var matrix=mat4.fromRotationTranslation(mat4.create(),quaternion,translation);matrix[m14]=perspective[0];matrix[m24]=perspective[1];matrix[m34]=perspective[2];matrix[m44]=perspective[3];var temp=mat4.create();if(skew[2]!==0){temp[m32]=skew[2];mat4.multiply(matrix,matrix,temp)}if(skew[1]!==0){temp[m32]=0;temp[m31]=skew[1];mat4.multiply(matrix,matrix,temp)}if(skew[0]){temp[m31]=0;temp[4]=skew[0];mat4.multiply(matrix,matrix,temp)}mat4.scale(matrix,matrix,scale);this.m=matrix;return this};proto.isAffine=function(){return this.m[m13]===0&&this.m[m14]===0&&this.m[m23]===0&&this.m[m24]===0&&this.m[m31]===0&&this.m[m32]===0&&this.m[m33]===1&&this.m[m34]===0&&this.m[m43]===0&&this.m[m44]===1};proto.toString=function(){var m=this.m;if(this.isAffine()){return"matrix("+m[mA]+", "+m[mB]+", "+m[mC]+", "+m[mD]+", "+m[mE]+", "+m[mF]+")"}return"matrix3d("+m[m11]+", "+m[m12]+", "+m[m13]+", "+m[m14]+", "+m[m21]+", "+m[m22]+", "+m[m23]+", "+m[m24]+", "+m[m31]+", "+m[m32]+", "+m[m33]+", "+m[m34]+", "+m[m41]+", "+m[m42]+", "+m[m43]+", "+m[m44]+")"};proto.toCSSString=proto.toString;proto._combine=function(A,B,ascl,bscl){var result=vec3.create();result[0]=ascl*A[0]+bscl*B[0];result[1]=ascl*A[1]+bscl*B[1];result[2]=ascl*A[2]+bscl*B[2];return result};proto._matrix2dToMat4=function(matrix){var out=mat4.create();for(var i=0;i<4;i++){for(var j=0;j<4;j++){out[i*4+j]=matrix[i][j]}}return out};proto._mat4ToMatrix2d=function(ref){var matrix=[];for(var i=0;i<4;i++){matrix[i]=[];for(var j=0;j<4;j++){matrix[i][j]=ref[i*4+j]}}return matrix};proto._rotationFromQuat=function(q){var sqw=q[3]*q[3];var sqx=q[0]*q[0];var sqy=q[1]*q[1];var sqz=q[2]*q[2];var unit=sqx+sqy+sqz+sqw;var test=q[0]*q[1]+q[2]*q[3];var x,y,z;if(test>.499*unit){y=2*Math.atan2(q[0],q[3]);z=Math.PI/2;x=0;return vec3.fromValues(x,y,z)}if(test<-.499*unit){y=-2*Math.atan2(q[0],q[3]);z=-Math.PI/2;x=0;return vec3.fromValues(x,y,z)}y=Math.atan2(2*q[1]*q[3]-2*q[0]*q[2],sqx-sqy-sqz+sqw);z=Math.asin(2*test/unit);x=Math.atan2(2*q[0]*q[3]-2*q[1]*q[2],-sqx+sqy-sqz+sqw);return vec3.fromValues(x,y,z)};module.exports=Transform},{"./gl-matrix/mat4":268,"./gl-matrix/vec3":269,"./gl-matrix/vec4":270}],268:[function(require,module,exports){var mat4={create:require("gl-mat4/create"),rotate:require("gl-mat4/rotate"),rotateX:require("gl-mat4/rotateX"),rotateY:require("gl-mat4/rotateY"),rotateZ:require("gl-mat4/rotateZ"),scale:require("gl-mat4/scale"),multiply:require("gl-mat4/multiply"),translate:require("gl-mat4/translate"),invert:require("gl-mat4/invert"),clone:require("gl-mat4/clone"),transpose:require("gl-mat4/transpose"),identity:require("gl-mat4/identity"),fromRotationTranslation:require("gl-mat4/fromRotationTranslation")};module.exports=mat4},{"gl-mat4/clone":413,"gl-mat4/create":414,"gl-mat4/fromRotationTranslation":415,"gl-mat4/identity":416,"gl-mat4/invert":417,"gl-mat4/multiply":418,"gl-mat4/rotate":419,"gl-mat4/rotateX":420,"gl-mat4/rotateY":421,"gl-mat4/rotateZ":422,"gl-mat4/scale":423,"gl-mat4/translate":424,"gl-mat4/transpose":425}],269:[function(require,module,exports){var vec3={create:require("gl-vec3/create"),dot:require("gl-vec3/dot"),normalize:require("gl-vec3/normalize"),length:require("gl-vec3/length"),cross:require("gl-vec3/cross"),fromValues:require("gl-vec3/fromValues")};module.exports=vec3},{"gl-vec3/create":434,"gl-vec3/cross":435,"gl-vec3/dot":436,"gl-vec3/fromValues":437,"gl-vec3/length":438,"gl-vec3/normalize":439}],270:[function(require,module,exports){var vec4={create:require("gl-vec4/create"),transformMat4:require("gl-vec4/transformMat4"),fromValues:require("gl-vec4/fromValues")};module.exports=vec4},{"gl-vec4/create":440,"gl-vec4/fromValues":441,"gl-vec4/transformMat4":442}],271:[function(require,module,exports){"use strict";module.exports=function joinSearchParams(obj,questionMark){var sep="&";var str="";if(obj){var keysArr=Object.keys(obj);var lastIndex=keysArr.length-1;keysArr.forEach(function(key,index){var value=obj[key];key=key.trim();value=value&&typeof value==="string"?value.trim():value;value=value===null?"":"="+value;var param=key+value+(index===lastIndex?"":sep);str=str?str.concat(param):param})}return str&&questionMark!==false?"?"+str:str}},{}],272:[function(require,module,exports){"use strict";var navigatorObj={ua:window.navigator.userAgent,platform:window.navigator.platform,vendor:window.navigator.vendor};module.exports=require("./parseUserAgent")(navigatorObj)},{"./parseUserAgent":275}],273:[function(require,module,exports){"use strict";module.exports={browser:{safari:false,chrome:false,firefox:false,ie:false,opera:false,android:false,edge:false,version:{name:"",major:0,minor:0,patch:0,documentMode:false}},os:{osx:false,ios:false,android:false,windows:false,linux:false,fireos:false,chromeos:false,version:{name:"",major:0,minor:0,patch:0}}}},{}],274:[function(require,module,exports){"use strict";module.exports={browser:[{name:"edge",userAgent:"Edge",version:["rv","Edge"],test:function(navigatorObj){return navigatorObj.ua.indexOf("Edge")>-1||navigatorObj.ua==="Mozilla/5.0 (Windows NT 10.0; Win64; x64)"}},{name:"chrome",userAgent:"Chrome"},{name:"firefox",test:function(navigatorObj){return navigatorObj.ua.indexOf("Firefox")>-1&&navigatorObj.ua.indexOf("Opera")===-1},version:"Firefox"},{name:"android",userAgent:"Android"},{name:"safari",test:function(navigatorObj){return navigatorObj.ua.indexOf("Safari")>-1&&navigatorObj.vendor.indexOf("Apple")>-1},version:"Version"},{name:"ie",test:function(navigatorObj){return navigatorObj.ua.indexOf("IE")>-1||navigatorObj.ua.indexOf("Trident")>-1},version:["MSIE","rv"],parseDocumentMode:function(){var documentModeForIE=false;if(document.documentMode){documentModeForIE=parseInt(document.documentMode,10)}return documentModeForIE}},{name:"opera",userAgent:"Opera",version:["Version","Opera"]}],os:[{name:"windows",test:function(navigatorObj){return navigatorObj.platform.indexOf("Win")>-1},version:"Windows NT"},{name:"osx",userAgent:"Mac",test:function(navigatorObj){return navigatorObj.platform.indexOf("Mac")>-1}},{name:"ios",test:function(navigatorObj){return navigatorObj.ua.indexOf("iPhone")>-1||navigatorObj.ua.indexOf("iPad")>-1},version:["iPhone OS","CPU OS"]},{name:"linux",userAgent:"Linux",test:function(navigatorObj){return navigatorObj.platform.indexOf("Linux")>-1&&navigatorObj.ua.indexOf("Android")===-1}},{name:"fireos",test:function(navigatorObj){return navigatorObj.ua.indexOf("Firefox")>-1&&navigatorObj.ua.indexOf("Mobile")>-1},version:"rv"},{name:"android",userAgent:"Android"},{name:"chromeos",userAgent:"CrOS"}]}},{}],275:[function(require,module,exports){"use strict";var defaults=require("./defaults");var dictionary=require("./dictionary");function _matchVersionStrRegExp(str){return new RegExp(str+"[a-zA-Z\\s/:]+([0-9_.]+)","i")}function _parseVersion(data,ua){if(typeof data.parseVersion==="function"){return data.parseVersion(ua)}else{var versionSearchStr=data.version||data.userAgent;if(typeof versionSearchStr==="string"){versionSearchStr=[versionSearchStr]}var versionSearchStrLength=versionSearchStr.length;var match;for(var i=0;i<versionSearchStrLength;i++){match=ua.match(_matchVersionStrRegExp(versionSearchStr[i]));if(match&&match.length>1){return match[1].replace(/_/g,".")}}}}function _parseUserAgent(dictionaryData,defaultObj,navigatorObj){var dictionaryDataLength=dictionaryData.length;var current;var currentVersion;for(var i=0;i<dictionaryDataLength;i++){if(typeof dictionaryData[i].test==="function"){if(dictionaryData[i].test(navigatorObj)===true){current=dictionaryData[i].name}}else{if(navigatorObj.ua.indexOf(dictionaryData[i].userAgent)>-1){current=dictionaryData[i].name}}if(current){defaultObj[current]=true;currentVersion=_parseVersion(dictionaryData[i],navigatorObj.ua);if(typeof currentVersion==="string"){var versionBreakdown=currentVersion.split(".");defaultObj.version.name=currentVersion;if(versionBreakdown&&versionBreakdown.length>0){defaultObj.version.major=parseInt(versionBreakdown[0]||0);defaultObj.version.minor=parseInt(versionBreakdown[1]||0);defaultObj.version.patch=parseInt(versionBreakdown[2]||0)}}else if(current==="edge"){defaultObj.version.name="12.0.0";defaultObj.version.major="12";defaultObj.version.minor="0";defaultObj.version.patch="0"}if(typeof dictionaryData[i].parseDocumentMode==="function"){defaultObj.version.documentMode=dictionaryData[i].parseDocumentMode()}return defaultObj}}return defaultObj}function parseUserAgent(navigatorObj){var userAgent={};userAgent.browser=_parseUserAgent(dictionary.browser,defaults.browser,navigatorObj);userAgent.os=_parseUserAgent(dictionary.os,defaults.os,navigatorObj);return userAgent}module.exports=parseUserAgent},{"./defaults":273,"./dictionary":274}],276:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Function/prototype.bind");require("@marcom/ac-polyfills/Object/keys");require("@marcom/ac-polyfills/Object/create");var EventEmitter=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var ac_addEventListener=require("@marcom/ac-dom-events/utils/addEventListener");var mediaQueriesAvailable=require("@marcom/ac-feature/mediaQueriesAvailable");var DEFAULT_ID="viewport-emitter";var PSEUDO_SELECTOR="::before";var RETINA_QUERY="only screen and (-webkit-min-device-pixel-ratio: 1.5), screen and (min-resolution: 1.5dppx), screen and (min-resolution: 144dpi)";function ViewportEmitter(id){EventEmitter.call(this);this._initializeElement(id);if(mediaQueriesAvailable()){this._updateViewport=this._updateViewport.bind(this);ac_addEventListener(window,"resize",this._updateViewport);ac_addEventListener(window,"orientationchange",this._updateViewport);this._retinaQuery=window.matchMedia(RETINA_QUERY);this._updateRetina();if(this._retinaQuery.addListener){this._updateRetina=this._updateRetina.bind(this);this._retinaQuery.addListener(this._updateRetina)}}this._updateViewport()}var proto=ViewportEmitter.prototype=Object.create(EventEmitter.prototype);proto.viewport=false;proto.retina=false;proto._initializeElement=function(id){var el;id=id||DEFAULT_ID;el=document.getElementById(id);if(!el){el=document.createElement("div");el.id=id;el=document.body.appendChild(el)}this._el=el};proto._getElementContent=function(){var content;if("currentStyle"in this._el){content=this._el.currentStyle["x-content"]}else{this._invalidateStyles();content=window.getComputedStyle(this._el,PSEUDO_SELECTOR).content}if(content){content=content.replace(/["']/g,"")}if(content){return content}return false};proto._updateViewport=function(){var lastViewport=this.viewport;var style;var eventData;this.viewport=this._getElementContent();if(this.viewport){this.viewport=this.viewport.split(":").pop()}if(lastViewport&&this.viewport!==lastViewport){eventData={from:lastViewport,to:this.viewport};this.trigger("change",eventData);this.trigger("from:"+lastViewport,eventData);this.trigger("to:"+this.viewport,eventData)}};proto._updateRetina=function(query){var lastRetina=this.retina;this.retina=this._retinaQuery.matches;if(lastRetina!==this.retina){this.trigger("retinachange",{from:lastRetina,to:this.retina})}};proto._invalidateStyles=function(){document.documentElement.clientWidth;this._el.innerHTML=this._el.innerHTML===" "?"":" ";document.documentElement.clientWidth};module.exports=ViewportEmitter},{"@marcom/ac-dom-events/utils/addEventListener":63,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-feature/mediaQueriesAvailable":141,"@marcom/ac-polyfills/Function/prototype.bind":"@marcom/ac-polyfills/Function/prototype.bind","@marcom/ac-polyfills/Object/create":"@marcom/ac-polyfills/Object/create","@marcom/ac-polyfills/Object/keys":"@marcom/ac-polyfills/Object/keys"}],277:[function(require,module,exports){"use strict";var ViewportEmitter=require("./ViewportEmitter");module.exports=new ViewportEmitter},{"./ViewportEmitter":276}],278:[function(require,module,exports){"use strict";module.exports={Viewport:require("./ac-viewport/Viewport")}},{"./ac-viewport/Viewport":279}],279:[function(require,module,exports){"use strict";var SharedInstance=require("@marcom/ac-shared-instance").SharedInstance,WindowDelegate=require("@marcom/ac-window-delegate").WindowDelegate,BreakpointsDelegate=require("@marcom/ac-breakpoints-delegate").BreakpointsDelegate;var sharedInstanceName="ac-viewport:Viewport",sharedInstanceVersion="3.2.0";var proto;function Viewport(options){var prop,baseObj=WindowDelegate;for(prop in baseObj){if(baseObj.hasOwnProperty(prop)){this[prop]=baseObj[prop]}else{proto[prop]=baseObj[prop]}}this.addCustomEvent(BreakpointsDelegate.getCustomEvent())}proto=Viewport.prototype;proto.getBreakpoint=function(){return BreakpointsDelegate.getBreakpoint()};proto.setBreakpoints=function(breakpoints){return BreakpointsDelegate.setBreakpoints(breakpoints)};module.exports=SharedInstance.share(sharedInstanceName,sharedInstanceVersion,Viewport)},{"@marcom/ac-breakpoints-delegate":6,"@marcom/ac-shared-instance":240,"@marcom/ac-window-delegate":280}],280:[function(require,module,exports){"use strict";module.exports={WindowDelegate:require("./ac-window-delegate/WindowDelegate"),WindowDelegateOptimizer:require("./ac-window-delegate/WindowDelegateOptimizer"),WindowDelegateCustomEvent:require("./ac-window-delegate/WindowDelegateCustomEvent")}},{"./ac-window-delegate/WindowDelegate":283,"./ac-window-delegate/WindowDelegateCustomEvent":284,"./ac-window-delegate/WindowDelegateOptimizer":285}],281:[function(require,module,exports){"use strict";var EventEmitter=require("@marcom/ac-event-emitter").EventEmitter;var CustomEventController=function(){this._emitter=new EventEmitter;this._customEvents={}};var proto=CustomEventController.prototype;proto.on=function(evts,callback,context){this._activateCustomEvents(evts);this._emitterOn.apply(this,arguments);return this};proto.once=function(evts,callback,context){this._emitterOnce.apply(this,arguments);return this};proto.off=function(evts,callback,context){this._emitterOff.apply(this,arguments);this._deactivateCustomEvents(evts);return this};proto.has=function(evt,callback,context){return this._emitter.has.apply(this._emitter,arguments)};proto.trigger=function(){this._emitter.trigger.apply(this._emitter,arguments);return this};proto.propagateTo=function(){this._emitter.propagateTo.apply(this._emitter,arguments);return this};proto.stopPropagatingTo=function(){this._emitter.stopPropagatingTo.apply(this._emitter,arguments);return this};proto.add=function(customEvent){this._customEvents[customEvent.name]=customEvent};proto.canHandleCustomEvent=function(evt){return this._customEvents.hasOwnProperty(evt)};proto.isHandlingCustomEvent=function(evt){if(this._customEvents[evt]&&this._customEvents[evt].active){return true}return false};proto._activateCustomEvents=function(evts){var evtsArr=evts.split(" "),evt,i,len=evtsArr.length;for(i=0;i<len;i++){evt=evtsArr[i];if(this._customEvents[evt]&&!this._customEvents[evt].active){this._customEvents[evt].initialize();this._customEvents[evt].active=true}}};proto._deactivateCustomEvents=function(evts){var i;if(!evts||evts.length===0){for(i in this._customEvents){if(this._customEvents.hasOwnProperty(i)){this._deactivateCustomEvent(i)}}return}var evtsArr=evts.split(" "),len=evtsArr.length;for(i=0;i<len;i++){this._deactivateCustomEvent(evtsArr[i])}};proto._deactivateCustomEvent=function(evt){if(!this.has(evt)&&this._customEvents[evt]&&this._customEvents[evt].active){this._customEvents[evt].deinitialize();this._customEvents[evt].active=false}};proto._emitterOn=function(){this._emitter.on.apply(this._emitter,arguments)};proto._emitterOnce=function(){this._emitter.once.apply(this._emitter,arguments)};proto._emitterOff=function(){this._emitter.off.apply(this._emitter,arguments)};module.exports=CustomEventController},{"@marcom/ac-event-emitter":135}],282:[function(require,module,exports){"use strict";var EventEmitter=require("@marcom/ac-event-emitter").EventEmitter;var proto;var OptimizerController=function(optimizers){EventEmitter.call(this);this.optimizers=optimizers;this._events={};this._properties={};this._initialize()};proto=OptimizerController.prototype=new EventEmitter(null);proto.canOptimizeEvent=function(evt){return this._events.hasOwnProperty(evt)};proto.canOptimizeProperty=function(prop){return this._properties.hasOwnProperty(prop)};proto.isOptimizingEvent=function(evt){if(this._events[evt]&&this._events[evt].active){return true}return false};proto.isOptimizingProperty=function(prop){if(this._properties[prop]&&this._properties[prop].active){return true}return false};proto.add=function(optimizer){this._setOptimizerEvents(optimizer);this._setOptimizerProperties(optimizer);optimizer.on("update",this._onUpdate,this);optimizer.on("activate",this._onActivate,this);optimizer.on("deactivate",this._onDeactivate,this)};proto.get=function(prop){if(this.isOptimizingProperty(prop)){return this._properties[prop].value}return null};proto.set=function(prop,val){if(!this._properties[prop]){return false}this._properties[prop].value=val;return this};proto.getOptimizerByEvent=function(evt){if(this._events[evt]){return this._events[evt]}return null};proto._initialize=function(){var i,optimizer;for(i in this.optimizers){if(this.optimizers.hasOwnProperty(i)){this.add(this.optimizers[i])}}};proto._onUpdate=function(e){this.set(e.prop,e.val)};proto._onActivate=function(optimizer){var propertyNames=optimizer.propertyNames,i,len=propertyNames.length;for(i=0;i<len;i++){this._properties[propertyNames[i]].active=true}};proto._onDeactivate=function(optimizer){var propertyNames=optimizer.propertyNames,i,len=propertyNames.length;for(i=0;i<len;i++){this._properties[propertyNames[i]].active=false}};proto._setOptimizerEvents=function(optimizer){var i,optimizerEvents=optimizer.eventNames,len=optimizerEvents.length;for(i=0;i<len;i++){this._setOptimizerEvent(optimizerEvents[i],optimizer)}};proto._setOptimizerEvent=function(evt,optimizer){if(this._events[evt]){return}this._events[evt]=optimizer};proto._setOptimizerProperties=function(optimizer){var i,optimizeProperties=optimizer.propertyNames,len=optimizeProperties.length;for(i=0;i<len;i++){this._setOptimizerProperty(optimizeProperties[i])}};proto._setOptimizerProperty=function(prop){if(this._properties.hasOwnProperty(prop)){return}this._properties[prop]={};this._properties[prop].active=false;this._properties[prop].value=null};module.exports=OptimizerController},{"@marcom/ac-event-emitter":135}],283:[function(require,module,exports){"use strict";var proto;var SharedInstance=require("@marcom/ac-shared-instance").SharedInstance,DOMEmitter=require("@marcom/ac-dom-emitter").DOMEmitter,OptimizerController=require("./OptimizerController"),CustomEventController=require("./CustomEventController"),queries=require("./queries/queries"),optimizers=require("./optimizers/optimizers");var sharedInstanceName="ac-window-delegate:WindowDelegate",sharedInstanceVersion="3.0.2";function WindowDelegate(){this._emitter=new DOMEmitter(window);this._controllers={optimizer:new OptimizerController(optimizers),customEvent:new CustomEventController};var i;for(i in queries){if(queries.hasOwnProperty(i)){this[i]=this._getProperty.bind(this,i);queries[i]=queries[i].bind(this)}}this._bindEvents()}proto=WindowDelegate.prototype;proto.on=function(evts,callback,context){var evtsObj=this._seperateCustomEvents(evts);this._optimizeEvents(evtsObj.standardEvents);this._customEventOn(evtsObj.customEvents,callback,context);this._emitterOn.apply(this,arguments);return this};proto.once=function(evts,callback,context){var evtsObj=this._seperateCustomEvents(evts);this._optimizeEvents(evtsObj.standardEvents);this._customEventOnce(evtsObj.customEvents,callback,context);this._emitterOnce.apply(this,arguments);return this};proto.off=function(evts,callback,context){var evtsObj=this._seperateCustomEvents(evts),force=false;if(!evts){force=true}this._customEventOff(evtsObj.customEvents,callback,context,force);this._emitterOff.apply(this,arguments);if(force){try{var evt;for(evt in this._controllers.optimizer._events){if(this._controllers.optimizer._events.hasOwnProperty(evt)&&this._shouldDeoptimizeEvent(evt,true)){this._deoptimizeEvent(evt)}}this._bindEvents()}catch(e){}}return this};proto.has=function(evt,callback,context){return this._emitter.has.apply(this._emitter,arguments)};proto.trigger=function(){this._emitter.trigger.apply(this._emitter,arguments);return this};proto.emitterTrigger=function(){this._emitter.emitterTrigger.apply(this._emitter,arguments);return this};proto.propagateTo=function(){this._emitter.propagateTo.apply(this._emitter,arguments);return this};proto.stopPropagatingTo=function(){this._emitter.stopPropagatingTo.apply(this._emitter,arguments);return this};proto.addOptimizer=function(optimizer){this._controllers.optimizer.add(optimizer);return this};proto.addCustomEvent=function(customEvent){this._controllers.customEvent.add(customEvent);return this};proto._emitterOn=function(){this._emitter.on.apply(this._emitter,arguments)};proto._emitterOnce=function(){this._emitter.once.apply(this._emitter,arguments)};proto._emitterOff=function(){this._emitter.off.apply(this._emitter,arguments)};proto._onEventUnbound=function(e){var evt=e.data.evt;if(this._shouldDeoptimizeEvent(evt)){this._deoptimizeEvent(evt)}};proto._customEventOn=function(evtsArr,callback,context){if(evtsArr.length===0){return}this._controllers.customEvent.on(evtsArr.join(" "),callback,context)};proto._customEventOnce=function(evtsArr,callback,context){if(evtsArr.length===0){return}this._controllers.customEvent.once(evtsArr.join(" "),callback,context)};proto._customEventOff=function(evtsArr,callback,context,force){if(!force&&evtsArr.length===0){return}if(force&&evtsArr.length===0){this._controllers.customEvent.off();return}this._controllers.customEvent.off(evtsArr.join(" "),callback,context)};proto._getProperty=function(prop,forceQuery){var value=null;if(!forceQuery){value=this._getOptimizedValue(prop)}if(value===null){value=queries[prop].call(this,forceQuery)}return value};proto._optimizeEvents=function(evts){var evt,i,len=evts.length;for(i=0;i<len;i++){evt=evts[i];if(this._shouldOptimizeEvent(evt)){this._optimizeEvent(evt)}}};proto._shouldOptimizeEvent=function(evt){if(this._controllers.optimizer.canOptimizeEvent(evt)&&!this._controllers.optimizer.isOptimizingEvent(evt)){return true}return false};proto._shouldDeoptimizeEvent=function(evt,force){if(this._controllers.optimizer.isOptimizingEvent(evt)&&(force||this._emitter._eventEmitter._events[evt].length<=1)){return true}return false};proto._optimizeEvent=function(evt){var optimizer=this._controllers.optimizer.getOptimizerByEvent(evt);optimizer.activate();this._emitterOn(evt,optimizer.callback,optimizer)};proto._deoptimizeEvent=function(evt){var optimizer=this._controllers.optimizer.getOptimizerByEvent(evt);optimizer.deactivate();this._emitterOff(evt,optimizer.callback,optimizer)};proto._getOptimizedValue=function(prop){return this._controllers.optimizer.get(prop)};proto._seperateCustomEvents=function(evtString){var result={customEvents:[],standardEvents:[]};if(typeof evtString==="string"){var evtsArray=evtString.split(" "),evt,i,len=evtsArray.length;for(i=0;i<len;i++){evt=evtsArray[i];if(this._controllers.customEvent.canHandleCustomEvent(evt)){result.customEvents.push(evt)}else{result.standardEvents.push(evt)}}}return result};proto._bindEvents=function(){this._emitter.on("dom-emitter:didoff",this._onEventUnbound,this)};module.exports=SharedInstance.share(sharedInstanceName,sharedInstanceVersion,WindowDelegate)},{"./CustomEventController":281,"./OptimizerController":282,"./optimizers/optimizers":288,"./queries/queries":297,"@marcom/ac-dom-emitter":51,"@marcom/ac-shared-instance":240}],284:[function(require,module,exports){"use strict";var EventEmitter=require("@marcom/ac-event-emitter").EventEmitter;function WindowDelegateCustomEvent(name,initializeFunc,deinitializeFunc){EventEmitter.call(this);this.name=name;this.active=false;this._initializeFunc=initializeFunc;this._deinitializeFunc=deinitializeFunc}var proto=WindowDelegateCustomEvent.prototype=new EventEmitter(null);proto.initialize=function(){if(this._initializeFunc){this._initializeFunc()}return this};proto.deinitialize=function(){if(this._deinitializeFunc){this._deinitializeFunc()}return this};module.exports=WindowDelegateCustomEvent},{"@marcom/ac-event-emitter":135}],285:[function(require,module,exports){"use strict";var EventEmitter=require("@marcom/ac-event-emitter").EventEmitter;function WindowDelegateOptimizer(config,callback){EventEmitter.call(this);this.active=false;this.eventNames=config.eventNames;this.propertyNames=config.propertyNames;this.options=config.options||{};this.callback=callback}var proto=WindowDelegateOptimizer.prototype=new EventEmitter(null);proto.update=function(prop,val){this.trigger("update",{prop:prop,val:val})};proto.activate=function(){this.active=true;this.trigger("activate",this)};proto.deactivate=function(){this.active=false;this.trigger("deactivate",this)};module.exports=WindowDelegateOptimizer},{"@marcom/ac-event-emitter":135}],286:[function(require,module,exports){"use strict";var Optimizer=require("../../WindowDelegateOptimizer"),queries=require("../../queries/queries");var config={eventNames:["resize"],propertyNames:["clientWidth","clientHeight","innerWidth","innerHeight"]};var resizeOptimizer=new Optimizer(config,function(e){var i,propertyNames=config.propertyNames,len=propertyNames.length;for(i=0;i<len;i++){this.update(propertyNames[i],queries[propertyNames[i]](true))}});module.exports=resizeOptimizer},{"../../WindowDelegateOptimizer":285,"../../queries/queries":297}],287:[function(require,module,exports){"use strict";var Optimizer=require("../../WindowDelegateOptimizer"),queries=require("../../queries/queries");var config={eventNames:["scroll"],propertyNames:["scrollX","scrollY","maxScrollX","maxScrollY"]};var scrollOptimizer=new Optimizer(config,function(e){var i,propertyNames=config.propertyNames,len=propertyNames.length;for(i=0;i<len;i++){this.update(propertyNames[i],queries[propertyNames[i]](true))}});module.exports=scrollOptimizer},{"../../WindowDelegateOptimizer":285,"../../queries/queries":297}],288:[function(require,module,exports){"use strict";var resizeEvt=require("./events/resize"),scrollEvt=require("./events/scroll");module.exports=[resizeEvt,scrollEvt]},{"./events/resize":286,"./events/scroll":287}],289:[function(require,module,exports){"use strict";var queryClientHeight=function(forceQuery){return document.documentElement.clientHeight};module.exports=queryClientHeight},{}],290:[function(require,module,exports){"use strict";var queryClientWidth=function(forceQuery){return document.documentElement.clientWidth};module.exports=queryClientWidth},{}],291:[function(require,module,exports){"use strict";var queryInnerHeight=function(forceQuery){return window.innerHeight||this.clientHeight(forceQuery)};module.exports=queryInnerHeight},{}],292:[function(require,module,exports){"use strict";var queryInnerWidth=function(forceQuery){return window.innerWidth||this.clientWidth(forceQuery)};module.exports=queryInnerWidth},{}],293:[function(require,module,exports){"use strict";var queryMaxScrollX=function(forceQuery){return document.body.scrollWidth-this.innerWidth()};module.exports=queryMaxScrollX},{}],294:[function(require,module,exports){"use strict";var queryMaxScrollY=function(forceQuery){return document.body.scrollHeight-this.innerHeight()};module.exports=queryMaxScrollY},{}],295:[function(require,module,exports){"use strict";var queryScrollX=function(forceQuery){var offset=window.pageXOffset;if(!offset){var target=document.documentElement||document.body.parentNode||document.body;offset=target.scrollLeft}return offset};module.exports=queryScrollX},{}],296:[function(require,module,exports){"use strict";var queryScrollY=function(forceQuery){var offset=window.pageYOffset;if(!offset){var target=document.documentElement||document.body.parentNode||document.body;offset=target.scrollTop}return offset};module.exports=queryScrollY},{}],297:[function(require,module,exports){"use strict";var queryInnerWidth=require("./methods/innerWidth"),queryInnerHeight=require("./methods/innerHeight"),queryClientWidth=require("./methods/clientWidth"),queryClientHeight=require("./methods/clientHeight"),queryScrollX=require("./methods/scrollX"),queryScrollY=require("./methods/scrollY"),queryMaxScrollX=require("./methods/maxScrollX"),queryMaxScrollY=require("./methods/maxScrollY");module.exports={innerWidth:queryInnerWidth,innerHeight:queryInnerHeight,clientWidth:queryClientWidth,clientHeight:queryClientHeight,scrollX:queryScrollX,scrollY:queryScrollY,maxScrollX:queryMaxScrollX,maxScrollY:queryMaxScrollY}},{"./methods/clientHeight":289,"./methods/clientWidth":290,"./methods/innerHeight":291,"./methods/innerWidth":292,"./methods/maxScrollX":293,"./methods/maxScrollY":294,"./methods/scrollX":295,"./methods/scrollY":296}],298:[function(require,module,exports){"use strict";module.exports={browser:{safari:false,chrome:false,firefox:false,ie:false,opera:false,android:false,edge:false,version:{string:"",major:0,minor:0,patch:0,documentMode:false}},os:{osx:false,ios:false,android:false,windows:false,linux:false,fireos:false,chromeos:false,version:{string:"",major:0,minor:0,patch:0}}}},{}],299:[function(require,module,exports){"use strict";module.exports={browser:[{name:"edge",userAgent:"Edge",version:["rv","Edge"],test:function(navigatorObj){return navigatorObj.ua.indexOf("Edge")>-1||navigatorObj.ua==="Mozilla/5.0 (Windows NT 10.0; Win64; x64)"}},{name:"chrome",userAgent:"Chrome"},{name:"firefox",test:function(navigatorObj){return navigatorObj.ua.indexOf("Firefox")>-1&&navigatorObj.ua.indexOf("Opera")===-1},version:"Firefox"},{name:"android",userAgent:"Android"},{name:"safari",test:function(navigatorObj){return navigatorObj.ua.indexOf("Safari")>-1&&navigatorObj.vendor.indexOf("Apple")>-1},version:"Version"},{name:"ie",test:function(navigatorObj){return navigatorObj.ua.indexOf("IE")>-1||navigatorObj.ua.indexOf("Trident")>-1},version:["MSIE","rv"],parseDocumentMode:function(){var documentModeForIE=false;if(document.documentMode){documentModeForIE=parseInt(document.documentMode,10)}return documentModeForIE}},{name:"opera",userAgent:"Opera",version:["Version","Opera"]}],os:[{name:"windows",test:function(navigatorObj){return navigatorObj.ua.indexOf("Windows")>-1},version:"Windows NT"},{name:"osx",userAgent:"Mac",test:function(navigatorObj){return navigatorObj.ua.indexOf("Macintosh")>-1}},{name:"ios",test:function(navigatorObj){return navigatorObj.ua.indexOf("iPhone")>-1||navigatorObj.ua.indexOf("iPad")>-1},version:["iPhone OS","CPU OS"]},{name:"linux",userAgent:"Linux",test:function(navigatorObj){return(navigatorObj.ua.indexOf("Linux")>-1||navigatorObj.platform.indexOf("Linux")>-1)&&navigatorObj.ua.indexOf("Android")===-1}},{name:"fireos",test:function(navigatorObj){return navigatorObj.ua.indexOf("Firefox")>-1&&navigatorObj.ua.indexOf("Mobile")>-1},version:"rv"},{name:"android",userAgent:"Android",test:function(navigatorObj){return navigatorObj.ua.indexOf("Android")>-1}},{name:"chromeos",userAgent:"CrOS"}]}},{}],300:[function(require,module,exports){"use strict";var defaults=require("./defaults");var dictionary=require("./dictionary");function _matchVersionStrRegExp(str){return new RegExp(str+"[a-zA-Z\\s/:]+([0-9_.]+)","i")}function _parseVersion(data,ua){if(typeof data.parseVersion==="function"){return data.parseVersion(ua)}else{var versionSearchStr=data.version||data.userAgent;if(typeof versionSearchStr==="string"){versionSearchStr=[versionSearchStr]}var versionSearchStrLength=versionSearchStr.length;var match;for(var i=0;i<versionSearchStrLength;i++){match=ua.match(_matchVersionStrRegExp(versionSearchStr[i]));if(match&&match.length>1){return match[1].replace(/_/g,".")}}}return false}function _parseUserAgent(dictionaryData,defaultObj,navigatorObj){var dictionaryDataLength=dictionaryData.length;var current;var currentVersion;for(var i=0;i<dictionaryDataLength;i++){if(typeof dictionaryData[i].test==="function"){if(dictionaryData[i].test(navigatorObj)===true){current=dictionaryData[i].name}}else{if(navigatorObj.ua.indexOf(dictionaryData[i].userAgent)>-1){current=dictionaryData[i].name}}if(current){defaultObj[current]=true;currentVersion=_parseVersion(dictionaryData[i],navigatorObj.ua);if(typeof currentVersion==="string"){var versionBreakdown=currentVersion.split(".");defaultObj.version.string=currentVersion;if(versionBreakdown&&versionBreakdown.length>0){defaultObj.version.major=parseInt(versionBreakdown[0]||0);defaultObj.version.minor=parseInt(versionBreakdown[1]||0);defaultObj.version.patch=parseInt(versionBreakdown[2]||0)}}else if(current==="edge"){defaultObj.version.string="12.0.0";defaultObj.version.major="12";defaultObj.version.minor="0";defaultObj.version.patch="0"}if(typeof dictionaryData[i].parseDocumentMode==="function"){defaultObj.version.documentMode=dictionaryData[i].parseDocumentMode()}return defaultObj}}return defaultObj}function parseUserAgent(navigatorObj){var userAgent={};userAgent.browser=_parseUserAgent(dictionary.browser,defaults.browser,navigatorObj);userAgent.os=_parseUserAgent(dictionary.os,defaults.os,navigatorObj);return userAgent}module.exports=parseUserAgent},{"./defaults":298,"./dictionary":299}],301:[function(require,module,exports){"use strict";var navigatorObj={ua:window.navigator.userAgent,platform:window.navigator.platform,vendor:window.navigator.vendor};module.exports=require("./parseUserAgent")(navigatorObj)},{"./parseUserAgent":300}],302:[function(require,module,exports){"use strict";var weakMap=typeof WeakMap==="undefined"?require("weak-map"):WeakMap;var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var TriangleCache=new weakMap;function createABigTriangle(gl){var triangleVAO=TriangleCache.get(gl);if(!triangleVAO||!gl.isBuffer(triangleVAO._triangleBuffer.buffer)){var buf=createBuffer(gl,new Float32Array([-1,-1,-1,4,4,-1]));triangleVAO=createVAO(gl,[{buffer:buf,type:gl.FLOAT,size:2}]);triangleVAO._triangleBuffer=buf;TriangleCache.set(gl,triangleVAO)}triangleVAO.bind();gl.drawArrays(gl.TRIANGLES,0,3);triangleVAO.unbind()}module.exports=createABigTriangle},{"gl-buffer":412,"gl-vao":433,"weak-map":450}],303:[function(require,module,exports){"use strict";module.exports={add:require("./ac-classlist/add"),contains:require("./ac-classlist/contains"),remove:require("./ac-classlist/remove"),toggle:require("./ac-classlist/toggle")}},{"./ac-classlist/add":304,"./ac-classlist/contains":305,"./ac-classlist/remove":307,"./ac-classlist/toggle":308}],304:[function(require,module,exports){"use strict";var className=require("./helpers/className");module.exports=function add(){var tokens=Array.prototype.slice.call(arguments);var el=tokens.shift(tokens);if(el.classList&&el.classList.add){el.classList.add.apply(el.classList,tokens)}else{tokens.forEach(className.add.bind(this,el))}}},{"./helpers/className":306}],305:[function(require,module,exports){"use strict";var className=require("./helpers/className");module.exports=function contains(el,token){if(el.classList&&el.classList.contains){return el.classList.contains(token)}return className.contains(el,token)}},{"./helpers/className":306}],306:[function(require,module,exports){"use strict";var getTokenRegExp=function(token){return new RegExp("(\\s|^)"+token+"(\\s|$)")};var containsClassName=function(el,token){return getTokenRegExp(token).test(el.className)};var addClassName=function(el,token){if(!containsClassName(el,token)){el.className+=" "+token}};var removeClassName=function(el,token){if(containsClassName(el,token)){el.className=el.className.replace(getTokenRegExp(token),"$1").trim()}};module.exports={contains:containsClassName,add:addClassName,remove:removeClassName}},{}],307:[function(require,module,exports){"use strict";var className=require("./helpers/className");module.exports=function remove(){var tokens=Array.prototype.slice.call(arguments);var el=tokens.shift(tokens);if(el.classList&&el.classList.remove){el.classList.remove.apply(el.classList,tokens)}else{tokens.forEach(className.remove.bind(this,el))}}},{"./helpers/className":306}],308:[function(require,module,exports){"use strict";var className=require("./helpers/className");module.exports=function toggle(el,token,force){var hasForce=typeof force!=="undefined";var addToken;if(el.classList&&el.classList.toggle){if(hasForce){return el.classList.toggle(token,force)}return el.classList.toggle(token)}if(hasForce){addToken=!!force}else{addToken=!className.contains(el,token)}if(addToken){className.add(el,token)}else{className.remove(el,token)}return addToken}},{"./helpers/className":306}],309:[function(require,module,exports){"use strict";module.exports=function addEventListener(target,type,listener,useCapture){if(target.addEventListener){target.addEventListener(type,listener,!!useCapture)}else{target.attachEvent("on"+type,listener)}return target}},{}],310:[function(require,module,exports){"use strict";module.exports=function removeEventListener(target,type,listener,useCapture){if(target.removeEventListener){target.removeEventListener(type,listener,!!useCapture)}else{target.detachEvent("on"+type,listener)}return target}},{}],311:[function(require,module,exports){"use strict";module.exports=8},{}],312:[function(require,module,exports){"use strict";module.exports=11},{}],313:[function(require,module,exports){"use strict";module.exports=9},{}],314:[function(require,module,exports){"use strict";module.exports=10},{}],315:[function(require,module,exports){"use strict";module.exports=1},{}],316:[function(require,module,exports){"use strict";module.exports=3},{}],317:[function(require,module,exports){"use strict";module.exports=function createDocumentFragment(html){var fragment=document.createDocumentFragment();var div;if(html){div=document.createElement("div");div.innerHTML=html;while(div.firstChild){fragment.appendChild(div.firstChild)}}return fragment}},{}],318:[function(require,module,exports){"use strict";require("ac-polyfills/Array/prototype.slice");require("ac-polyfills/Array/prototype.filter");var isNodeType=require("./internal/isNodeType");var ELEMENT_NODE=require("./ELEMENT_NODE");module.exports=function filterByNodeType(nodes,nodeType){nodeType=nodeType||ELEMENT_NODE;nodes=Array.prototype.slice.call(nodes);return nodes.filter(function(node){return isNodeType(node,nodeType)})}},{"./ELEMENT_NODE":315,"./internal/isNodeType":326,"ac-polyfills/Array/prototype.filter":403,"ac-polyfills/Array/prototype.slice":406}],319:[function(require,module,exports){"use strict";module.exports=function hasAttribute(el,attr){if("hasAttribute"in el){return el.hasAttribute(attr)}return el.attributes.getNamedItem(attr)!==null}},{}],320:[function(require,module,exports){"use strict";module.exports={createDocumentFragment:require("./createDocumentFragment"),filterByNodeType:require("./filterByNodeType"),hasAttribute:require("./hasAttribute"),indexOf:require("./indexOf"),insertAfter:require("./insertAfter"),insertBefore:require("./insertBefore"),insertFirstChild:require("./insertFirstChild"),insertLastChild:require("./insertLastChild"),isComment:require("./isComment"),isDocument:require("./isDocument"),isDocumentFragment:require("./isDocumentFragment"),isDocumentType:require("./isDocumentType"),isElement:require("./isElement"),isNode:require("./isNode"),isNodeList:require("./isNodeList"),isTextNode:require("./isTextNode"),remove:require("./remove"),replace:require("./replace"),COMMENT_NODE:require("./COMMENT_NODE"),DOCUMENT_FRAGMENT_NODE:require("./DOCUMENT_FRAGMENT_NODE"),DOCUMENT_NODE:require("./DOCUMENT_NODE"),DOCUMENT_TYPE_NODE:require("./DOCUMENT_TYPE_NODE"),ELEMENT_NODE:require("./ELEMENT_NODE"),TEXT_NODE:require("./TEXT_NODE")}},{"./COMMENT_NODE":311,"./DOCUMENT_FRAGMENT_NODE":312,"./DOCUMENT_NODE":313,"./DOCUMENT_TYPE_NODE":314,"./ELEMENT_NODE":315,"./TEXT_NODE":316,"./createDocumentFragment":317,"./filterByNodeType":318,"./hasAttribute":319,"./indexOf":321,"./insertAfter":322,"./insertBefore":323,"./insertFirstChild":324,"./insertLastChild":325,"./isComment":328,"./isDocument":329,"./isDocumentFragment":330,"./isDocumentType":331,"./isElement":332,"./isNode":333,"./isNodeList":334,"./isTextNode":335,"./remove":336,"./replace":337}],321:[function(require,module,exports){"use strict";require("ac-polyfills/Array/prototype.indexOf");require("ac-polyfills/Array/prototype.slice");var validate=require("./internal/validate");var filterByNodeType=require("./filterByNodeType");module.exports=function indexOf(node,nodeType){var parentNode=node.parentNode;var nodes;if(!parentNode){return 0}nodes=parentNode.childNodes;if(nodeType!==false){nodes=filterByNodeType(nodes,nodeType)}else{nodes=Array.prototype.slice.call(nodes)}return nodes.indexOf(node)}},{"./filterByNodeType":318,"./internal/validate":327,"ac-polyfills/Array/prototype.indexOf":405,"ac-polyfills/Array/prototype.slice":406}],322:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function insertAfter(node,target){validate.insertNode(node,true,"insertAfter");validate.childNode(target,true,"insertAfter");validate.hasParentNode(target,"insertAfter");if(!target.nextSibling){return target.parentNode.appendChild(node)}return target.parentNode.insertBefore(node,target.nextSibling)}},{"./internal/validate":327}],323:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function insertBefore(node,target){validate.insertNode(node,true,"insertBefore");validate.childNode(target,true,"insertBefore");validate.hasParentNode(target,"insertBefore");return target.parentNode.insertBefore(node,target)}},{"./internal/validate":327}],324:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function insertFirstChild(node,target){validate.insertNode(node,true,"insertFirstChild");validate.parentNode(target,true,"insertFirstChild");if(!target.firstChild){return target.appendChild(node)}return target.insertBefore(node,target.firstChild)}},{"./internal/validate":327}],325:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function insertLastChild(node,target){validate.insertNode(node,true,"insertLastChild");validate.parentNode(target,true,"insertLastChild");return target.appendChild(node)}},{"./internal/validate":327}],326:[function(require,module,exports){"use strict";var isNode=require("../isNode");module.exports=function isNodeType(node,nodeType){if(!isNode(node)){return false}if(typeof nodeType==="number"){return node.nodeType===nodeType}return nodeType.indexOf(node.nodeType)!==-1}},{"../isNode":333}],327:[function(require,module,exports){"use strict";var isNodeType=require("./isNodeType");var COMMENT_NODE=require("../COMMENT_NODE");var DOCUMENT_FRAGMENT_NODE=require("../DOCUMENT_FRAGMENT_NODE");var ELEMENT_NODE=require("../ELEMENT_NODE");var TEXT_NODE=require("../TEXT_NODE");var VALID_INSERT_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_INSERT_NODE=" must be an Element, TextNode, Comment, or Document Fragment";var VALID_CHILD_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE];var ERR_INVALID_CHILD_NODE=" must be an Element, TextNode, or Comment";var VALID_PARENT_NODE=[ELEMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_PARENT_NODE=" must be an Element, or Document Fragment";var ERR_NO_PARENT_NODE=" must have a parentNode";module.exports={parentNode:function(node,required,funcName,paramName){paramName=paramName||"target";if((node||required)&&!isNodeType(node,VALID_PARENT_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_PARENT_NODE)}},childNode:function(node,required,funcName,paramName){paramName=paramName||"target";if(!node&&!required){return}if(!isNodeType(node,VALID_CHILD_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_CHILD_NODE)}},insertNode:function(node,required,funcName,paramName){paramName=paramName||"node";if(!node&&!required){return}if(!isNodeType(node,VALID_INSERT_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_INSERT_NODE)}},hasParentNode:function(node,funcName,paramName){paramName=paramName||"target";if(!node.parentNode){throw new TypeError(funcName+": "+paramName+ERR_NO_PARENT_NODE)}}}},{"../COMMENT_NODE":311,"../DOCUMENT_FRAGMENT_NODE":312,"../ELEMENT_NODE":315,"../TEXT_NODE":316,"./isNodeType":326}],328:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var COMMENT_NODE=require("./COMMENT_NODE");module.exports=function isComment(obj){return isNodeType(obj,COMMENT_NODE)}},{"./COMMENT_NODE":311,"./internal/isNodeType":326}],329:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var DOCUMENT_NODE=require("./DOCUMENT_NODE");module.exports=function isDocument(obj){return isNodeType(obj,DOCUMENT_NODE)}},{"./DOCUMENT_NODE":313,"./internal/isNodeType":326}],330:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var DOCUMENT_FRAGMENT_NODE=require("./DOCUMENT_FRAGMENT_NODE");module.exports=function isDocumentFragment(obj){return isNodeType(obj,DOCUMENT_FRAGMENT_NODE)}},{"./DOCUMENT_FRAGMENT_NODE":312,"./internal/isNodeType":326}],331:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var DOCUMENT_TYPE_NODE=require("./DOCUMENT_TYPE_NODE");module.exports=function isDocumentType(obj){return isNodeType(obj,DOCUMENT_TYPE_NODE)}},{"./DOCUMENT_TYPE_NODE":314,"./internal/isNodeType":326}],332:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var ELEMENT_NODE=require("./ELEMENT_NODE");module.exports=function isElement(obj){return isNodeType(obj,ELEMENT_NODE)}},{"./ELEMENT_NODE":315,"./internal/isNodeType":326}],333:[function(require,module,exports){"use strict";module.exports=function isNode(obj){return!!(obj&&obj.nodeType)}},{}],334:[function(require,module,exports){"use strict";var nodeListToStringPattern=/^\[object (HTMLCollection|NodeList|Object)\]$/;module.exports=function isNodeList(obj){if(!obj){return false}if(typeof obj.length!=="number"){return false}if(typeof obj[0]==="object"&&(!obj[0]||!obj[0].nodeType)){return false}return nodeListToStringPattern.test(Object.prototype.toString.call(obj))}},{}],335:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var TEXT_NODE=require("./TEXT_NODE");module.exports=function isTextNode(obj){return isNodeType(obj,TEXT_NODE)}},{"./TEXT_NODE":316,"./internal/isNodeType":326}],336:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function remove(node){validate.childNode(node,true,"remove");if(!node.parentNode){return node}return node.parentNode.removeChild(node)}},{"./internal/validate":327}],337:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function replace(newNode,oldNode){validate.insertNode(newNode,true,"insertFirstChild","newNode");validate.childNode(oldNode,true,"insertFirstChild","oldNode");validate.hasParentNode(oldNode,"insertFirstChild","oldNode");return oldNode.parentNode.replaceChild(newNode,oldNode)}},{"./internal/validate":327}],338:[function(require,module,exports){"use strict";var Prefixer=require("./ac-prefixer/Prefixer");module.exports=new Prefixer;module.exports.Prefixer=Prefixer},{"./ac-prefixer/Prefixer":339}],339:[function(require,module,exports){"use strict";var camelCasedEvents=require("./Prefixer/camelCasedEvents");var RE_CSS_FUNCTION_PARAMS=/(\([^\)]+\))/gi;var RE_CSS_VALUES=/([^ ,;\(]+(\([^\)]+\))?)/gi;var RE_ALL_PREFIXES=/(-webkit-|-moz-|-ms-)|^(webkit|moz|ms)/gi;var RE_DOM_PREFIXES=/^(webkit|moz|ms)/gi;var CSS_PREFIXES=["-webkit-","-moz-","-ms-"];var DOM_PREFIXES=["Webkit","Moz","ms"];var EVT_PREFIXES=["webkit","moz","ms"];function Prefixer(){this._supportsAvailable="CSS"in window&&"supports"in window.CSS;this._cssPrefixes=CSS_PREFIXES;this._domPrefixes=DOM_PREFIXES;this._evtPrefixes=EVT_PREFIXES;this._styleProperties={};this._styleValues={};this._eventTypes={}}var proto=Prefixer.prototype;proto.getEventType=function(type){var prop;var i;type=type.toLowerCase();if(type in this._eventTypes){return this._eventTypes[type]}if(this._checkEventType("on"+type)){return this._eventTypes[type]=type}if(camelCasedEvents[type]){for(prop in camelCasedEvents[type]){if(this._checkEventType(prop)){return this._eventTypes[type]=camelCasedEvents[type][prop]}}}for(i=0;i<this._evtPrefixes.length;i++){if(this._checkEventType("on"+this._evtPrefixes[i]+type)){this._eventTypes[type]=this._evtPrefixes[i]+type;this._reduceAvailablePrefixes(i);return this._eventTypes[type]}}return this._eventTypes[type]=type};proto._checkEventType=function(type){return type in window||type in document};proto.getStyleProperty=function(property){var properties;var ucProperty;var i;property+="";if(property in this._styleProperties){return this._styleProperties[property].dom}property=this._toDOM(property);this._prepareTestElement();ucProperty=property.charAt(0).toUpperCase()+property.substr(1);if(property==="filter"){properties=["WebkitFilter","filter"]}else{properties=(property+" "+this._domPrefixes.join(ucProperty+" ")+ucProperty).split(" ")}for(i=0;i<properties.length;i++){if(this._el.style[properties[i]]!==undefined){if(i!==0){this._reduceAvailablePrefixes(i-1)}this._memoizeStyleProperty(property,properties[i]);return properties[i]}}this._memoizeStyleProperty(property,false);return false};proto._memoizeStyleProperty=function(property,prefixed){var cssProperty=this._toCSS(property);var cssPrefixed=prefixed===false?false:this._toCSS(prefixed);this._styleProperties[property]=this._styleProperties[prefixed]=this._styleProperties[cssProperty]=this._styleProperties[cssPrefixed]={dom:prefixed,css:cssPrefixed}};proto.getStyleCSS=function(property,value){var css;property=this.getStyleProperty(property);if(!property){return false}css=this._styleProperties[property].css;if(typeof value!=="undefined"){value=this.getStyleValue(property,value);if(value===false){return false}css+=":"+value+";"}return css};proto.getStyleValue=function(property,value){var cssProperty;value+="";property=this.getStyleProperty(property);if(!property){return false}if(this._testStyleValue(property,value)){return value}cssProperty=this._styleProperties[property].css;value=value.replace(RE_CSS_VALUES,function(match){var values;var valueKey;var key;var i;if(match[0]==="#"||!isNaN(match[0])){return match}valueKey=match.replace(RE_CSS_FUNCTION_PARAMS,"");key=cssProperty+":"+valueKey;if(key in this._styleValues){if(this._styleValues[key]===false){return""}return match.replace(valueKey,this._styleValues[key])}values=this._cssPrefixes.map(function(prefix){return prefix+match});values=[match].concat(values);for(i=0;i<values.length;i++){if(this._testStyleValue(property,values[i])){if(i!==0){this._reduceAvailablePrefixes(i-1)}this._styleValues[key]=values[i].replace(RE_CSS_FUNCTION_PARAMS,"");return values[i]}}this._styleValues[key]=false;return""}.bind(this));value=value.trim();return value===""?false:value};proto._testStyleValue=function(property,value){var before;if(this._supportsAvailable){property=this._styleProperties[property].css;return CSS.supports(property,value)}this._prepareTestElement();before=this._el.style[property];try{this._el.style[property]=value}catch(e){return false}return this._el.style[property]&&this._el.style[property]!==before};proto.stripPrefixes=function(str){str=String.prototype.replace.call(str,RE_ALL_PREFIXES,"");return str.charAt(0).toLowerCase()+str.slice(1)};proto._reduceAvailablePrefixes=function(index){if(this._cssPrefixes.length!==1){this._cssPrefixes=[this._cssPrefixes[index]];this._domPrefixes=[this._domPrefixes[index]];this._evtPrefixes=[this._evtPrefixes[index]]}};proto._toDOM=function(str){var i;if(str.toLowerCase()==="float"){return"cssFloat"}str=str.replace(/-([a-z])/g,function(str,m1){return m1.toUpperCase()});if(str.substr(0,2)==="Ms"){str="ms"+str.substr(2)}return str};proto._toCSS=function(str){var i;if(str.toLowerCase()==="cssfloat"){return"float"}if(RE_DOM_PREFIXES.test(str)){str="-"+str}return str.replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()};proto._prepareTestElement=function(){if(!this._el){this._el=document.createElement("_")}else{this._el.style.cssText="";this._el.removeAttribute("style")}};module.exports=Prefixer},{"./Prefixer/camelCasedEvents":340}],340:[function(require,module,exports){"use strict";module.exports={transitionend:{onwebkittransitionend:"webkitTransitionEnd",onmstransitionend:"MSTransitionEnd"},animationstart:{onwebkitanimationstart:"webkitAnimationStart",onmsanimationstart:"MSAnimationStart"},animationend:{onwebkitanimationend:"webkitAnimationEnd",onmsanimationend:"MSAnimationEnd"},animationiteration:{onwebkitanimationiteration:"webkitAnimationIteration",onmsanimationiteration:"MSAnimationIteration"},fullscreenchange:{onmsfullscreenchange:"MSFullscreenChange"},fullscreenerror:{onmsfullscreenerror:"MSFullscreenError"}}},{}],341:[function(require,module,exports){"use strict";module.exports={getStyle:require("./ac-dom-styles/getStyle"),setStyle:require("./ac-dom-styles/setStyle")}},{"./ac-dom-styles/getStyle":342,"./ac-dom-styles/setStyle":345}],342:[function(require,module,exports){"use strict";var prefixer=require("ac-prefixer");var computedStyle=require("./shim/getComputedStyle");module.exports=function getStyle(){var properties=Array.prototype.slice.call(arguments);var target=properties.shift(properties);var computed=computedStyle(target);var styles={};var property;var prefixed;var value;var i;if(typeof properties[0]!=="string"){properties=properties[0]}for(i=0;i<properties.length;i++){property=properties[i];prefixed=prefixer.getStyleProperty(property);if(prefixed){property=prefixer.stripPrefixes(prefixed);value=computed[prefixed];if(!value||value==="auto"){value=null}if(value){value=prefixer.stripPrefixes(value)}}else{value=null}styles[property]=value}return styles}},{"./shim/getComputedStyle":346,"ac-prefixer":338}],343:[function(require,module,exports){"use strict";var partialProperties={transform:["matrix","translate","translateX","translateY","scale","scaleX","scaleY","rotate","skewX","skewY","matrix3d","translate3d","translateZ","scale3d","scaleZ","rotate3d","rotateX","rotateY","rotateZ","perspective"],filter:["blur","brightness","contrast","drop-shadow","grayscale","hue-rotate","invert","saturate","sepia"]};module.exports=function combinePartialProperties(styles){var prop;var value;var func;var i;for(prop in partialProperties){value=styles[prop]?styles[prop]:"";for(i=0;i<partialProperties[prop].length;i++){func=partialProperties[prop][i];if(func in styles){value+=" "+func+"("+styles[func]+")";delete styles[func]}}value=value.trim();if(value){styles[prop]=value}}return styles}},{}],344:[function(require,module,exports){"use strict";module.exports=function cssToObject(css){var styles;var splitStyles;var colon;var len;var i;if(typeof css==="string"){styles={};splitStyles=css.split(";");len=splitStyles.length;for(i=0;i<len;i+=1){colon=splitStyles[i].indexOf(":");if(colon>0){styles[splitStyles[i].substr(0,colon).trim()]=splitStyles[i].substr(colon+1).trim()}}}else{styles=css}return styles}},{}],345:[function(require,module,exports){"use strict";var prefixer=require("ac-prefixer");var cssToObject=require("./helpers/cssToObject");var combinePartialProperties=require("./helpers/combinePartialProperties");module.exports=function setStyle(target,styles){var cssText;var cssRule;var property;var domProperty;var value;if(typeof styles!=="string"&&typeof styles!=="object"||Array.isArray(styles)){throw new TypeError("setStyle: styles must be an Object or String")}styles=cssToObject(styles);styles=combinePartialProperties(styles);cssText="";for(property in styles){value=styles[property];if(!value&&value!==0){domProperty=prefixer.getStyleProperty(property);if("removeAttribute"in target.style){target.style.removeAttribute(domProperty)}else{target.style[domProperty]=""}}else{cssRule=prefixer.getStyleCSS(property,value);if(cssRule!==false){cssText+=" "+cssRule}}}if(cssText.length){target.style.cssText+=cssText}return target}},{"./helpers/combinePartialProperties":343,"./helpers/cssToObject":344,"ac-prefixer":338}],346:[function(require,module,exports){"use strict";module.exports=function(){if("getComputedStyle"in window){return window.getComputedStyle}return function(el){var currentStyle;var property;var style;currentStyle=el.currentStyle;for(property in currentStyle){if(property==="styleFloat"){style["float"]=style["cssFloat"]=currentStyle[property]}else{style[property]=currentStyle[property]}}return style}}()},{}],347:[function(require,module,exports){"use strict";var isElement=require("ac-dom-nodes/isElement");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function ancestor(node,selector,inclusive){validate.childNode(node,true,"ancestors");validate.selector(selector,false,"ancestors");if(inclusive&&isElement(node)&&(!selector||matchesSelector(node,selector))){return node}if(node!==document.body){while((node=node.parentNode)&&isElement(node)){if(!selector||matchesSelector(node,selector)){return node}if(node===document.body){break}}}return null}},{"./internal/validate":354,"./matchesSelector":356,"ac-dom-nodes/isElement":332}],348:[function(require,module,exports){"use strict";var isElement=require("ac-dom-nodes/isElement");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function ancestors(node,selector,inclusive){var els=[];validate.childNode(node,true,"ancestors");validate.selector(selector,false,"ancestors");if(inclusive&&isElement(node)&&(!selector||matchesSelector(node,selector))){els.push(node)}if(node!==document.body){while((node=node.parentNode)&&isElement(node)){if(!selector||matchesSelector(node,selector)){els.push(node)}if(node===document.body){break}}}return els}},{"./internal/validate":354,"./matchesSelector":356,"ac-dom-nodes/isElement":332}],349:[function(require,module,exports){"use strict";var filterByNodeType=require("ac-dom-nodes/filterByNodeType");var filterBySelector=require("./filterBySelector");var validate=require("./internal/validate");module.exports=function children(node,selector){var els;validate.parentNode(node,true,"children");validate.selector(selector,false,"children");els=node.children||node.childNodes;els=filterByNodeType(els);if(selector){els=filterBySelector(els,selector)}return els}},{"./filterBySelector":350,"./internal/validate":354,"ac-dom-nodes/filterByNodeType":318}],350:[function(require,module,exports){"use strict";require("ac-polyfills/Array/prototype.slice");require("ac-polyfills/Array/prototype.filter");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function filterBySelector(nodes,selector){validate.selector(selector,true,"filterBySelector");nodes=Array.prototype.slice.call(nodes);return nodes.filter(function(el){return matchesSelector(el,selector)})}},{"./internal/validate":354,"./matchesSelector":356,"ac-polyfills/Array/prototype.filter":403,"ac-polyfills/Array/prototype.slice":406}],351:[function(require,module,exports){"use strict";var children=require("./children");var validate=require("./internal/validate");module.exports=function firstChild(node,selector){var els;validate.parentNode(node,true,"firstChild");validate.selector(selector,false,"firstChild");if(node.firstElementChild&&!selector){return node.firstElementChild}els=children(node,selector);if(els.length){return els[0]}return null}},{"./children":349,"./internal/validate":354}],352:[function(require,module,exports){"use strict";module.exports={ancestor:require("./ancestor"),ancestors:require("./ancestors"),children:require("./children"),filterBySelector:require("./filterBySelector"),firstChild:require("./firstChild"),lastChild:require("./lastChild"),matchesSelector:require("./matchesSelector"),nextSibling:require("./nextSibling"),nextSiblings:require("./nextSiblings"),previousSibling:require("./previousSibling"),previousSiblings:require("./previousSiblings"),querySelector:require("./querySelector"),querySelectorAll:require("./querySelectorAll"),siblings:require("./siblings")}},{"./ancestor":347,"./ancestors":348,"./children":349,"./filterBySelector":350,"./firstChild":351,"./lastChild":355,"./matchesSelector":356,"./nextSibling":357,"./nextSiblings":358,"./previousSibling":359,"./previousSiblings":360,"./querySelector":361,"./querySelectorAll":362,"./siblings":365}],353:[function(require,module,exports){"use strict";module.exports=window.Element?function(proto){return proto.matches||proto.matchesSelector||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector}(Element.prototype):null},{}],354:[function(require,module,exports){"use strict";require("ac-polyfills/Array/prototype.indexOf");var isNode=require("ac-dom-nodes/isNode");var COMMENT_NODE=require("ac-dom-nodes/COMMENT_NODE");var DOCUMENT_FRAGMENT_NODE=require("ac-dom-nodes/DOCUMENT_FRAGMENT_NODE");var DOCUMENT_NODE=require("ac-dom-nodes/DOCUMENT_NODE");var ELEMENT_NODE=require("ac-dom-nodes/ELEMENT_NODE");var TEXT_NODE=require("ac-dom-nodes/TEXT_NODE");var isNodeType=function(node,nodeType){if(!isNode(node)){return false}if(typeof nodeType==="number"){return node.nodeType===nodeType}return nodeType.indexOf(node.nodeType)!==-1};var VALID_PARENT_NODE=[ELEMENT_NODE,DOCUMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_PARENT_NODE=" must be an Element, Document, or Document Fragment";var VALID_CHILD_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE];var ERR_INVALID_CHILD_NODE=" must be an Element, TextNode, or Comment";var ERR_INVALID_SELECTOR=" must be a string";module.exports={parentNode:function(node,required,funcName,paramName){paramName=paramName||"node";if((node||required)&&!isNodeType(node,VALID_PARENT_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_PARENT_NODE)}},childNode:function(node,required,funcName,paramName){paramName=paramName||"node";if(!node&&!required){return}if(!isNodeType(node,VALID_CHILD_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_CHILD_NODE)}},selector:function(selector,required,funcName,paramName){paramName=paramName||"selector";if((selector||required)&&typeof selector!=="string"){throw new TypeError(funcName+": "+paramName+ERR_INVALID_SELECTOR)}}}},{"ac-dom-nodes/COMMENT_NODE":311,"ac-dom-nodes/DOCUMENT_FRAGMENT_NODE":312,"ac-dom-nodes/DOCUMENT_NODE":313,"ac-dom-nodes/ELEMENT_NODE":315,"ac-dom-nodes/TEXT_NODE":316,"ac-dom-nodes/isNode":333,"ac-polyfills/Array/prototype.indexOf":405}],355:[function(require,module,exports){"use strict";var children=require("./children");var validate=require("./internal/validate");module.exports=function lastChild(node,selector){var els;validate.parentNode(node,true,"lastChild");validate.selector(selector,false,"lastChild");if(node.lastElementChild&&!selector){return node.lastElementChild}els=children(node,selector);if(els.length){return els[els.length-1]}return null}},{"./children":349,"./internal/validate":354}],356:[function(require,module,exports){"use strict";var isElement=require("ac-dom-nodes/isElement");var nativeMatches=require("./internal/nativeMatches");var validate=require("./internal/validate");var sizzle=require("./vendor/sizzle/sizzle");module.exports=function matchesSelector(node,selector){validate.selector(selector,true,"matchesSelector");if(!isElement(node)){return false}if(!nativeMatches){return sizzle.matchesSelector(node,selector)}return nativeMatches.call(node,selector)}},{"./internal/nativeMatches":353,"./internal/validate":354,"./vendor/sizzle/sizzle":366,"ac-dom-nodes/isElement":332}],357:[function(require,module,exports){"use strict";var isElement=require("ac-dom-nodes/isElement");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function nextSibling(node,selector){validate.childNode(node,true,"nextSibling");validate.selector(selector,false,"nextSibling");if(node.nextElementSibling&&!selector){return node.nextElementSibling}while(node=node.nextSibling){if(isElement(node)){if(!selector||matchesSelector(node,selector)){return node}}}return null}},{"./internal/validate":354,"./matchesSelector":356,"ac-dom-nodes/isElement":332}],358:[function(require,module,exports){"use strict";var isElement=require("ac-dom-nodes/isElement");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function nextSiblings(node,selector){var els=[];validate.childNode(node,true,"nextSiblings");validate.selector(selector,false,"nextSiblings");while(node=node.nextSibling){if(isElement(node)){if(!selector||matchesSelector(node,selector)){els.push(node)}}}return els}},{"./internal/validate":354,"./matchesSelector":356,"ac-dom-nodes/isElement":332}],359:[function(require,module,exports){"use strict";var isElement=require("ac-dom-nodes/isElement");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function previousSibling(node,selector){validate.childNode(node,true,"previousSibling");validate.selector(selector,false,"previousSibling");if(node.previousElementSibling&&!selector){return node.previousElementSibling}while(node=node.previousSibling){if(isElement(node)){if(!selector||matchesSelector(node,selector)){return node}}}return null}},{"./internal/validate":354,"./matchesSelector":356,"ac-dom-nodes/isElement":332}],360:[function(require,module,exports){"use strict";var isElement=require("ac-dom-nodes/isElement");var matchesSelector=require("./matchesSelector");var validate=require("./internal/validate");module.exports=function previousSiblings(node,selector){var els=[];validate.childNode(node,true,"previousSiblings");validate.selector(selector,false,"previousSiblings");while(node=node.previousSibling){if(isElement(node)){if(!selector||matchesSelector(node,selector)){els.push(node)}}}return els.reverse()}},{"./internal/validate":354,"./matchesSelector":356,"ac-dom-nodes/isElement":332}],361:[function(require,module,exports){"use strict";var validate=require("./internal/validate");var querySelectorShim=require("./shims/querySelector");module.exports=function querySelector(selector,context){context=context||document;validate.parentNode(context,true,"querySelector","context");validate.selector(selector,true,"querySelector");if(!context.querySelector){return querySelectorShim(selector,context)}return context.querySelector(selector)}},{"./internal/validate":354,"./shims/querySelector":363}],362:[function(require,module,exports){"use strict";require("ac-polyfills/Array/prototype.slice");var validate=require("./internal/validate");var querySelectorAllShim=require("./shims/querySelectorAll");module.exports=function querySelectorAll(selector,context){context=context||document;validate.parentNode(context,true,"querySelectorAll","context");validate.selector(selector,true,"querySelectorAll");if(!context.querySelectorAll){return querySelectorAllShim(selector,context)}return Array.prototype.slice.call(context.querySelectorAll(selector))}},{"./internal/validate":354,"./shims/querySelectorAll":364,"ac-polyfills/Array/prototype.slice":406}],363:[function(require,module,exports){"use strict";var querySelectorAll=require("./querySelectorAll");module.exports=function querySelector(selector,context){var allResults=querySelectorAll(selector,context);return allResults.length?allResults[0]:null}},{"./querySelectorAll":364}],364:[function(require,module,exports){"use strict";require("ac-polyfills/Array/prototype.forEach");var sizzle=require("../vendor/sizzle/sizzle");var getChildren=require("../children");var isDocumentFragment=require("ac-dom-nodes/isDocumentFragment");module.exports=function querySelectorAll(selector,context){var children;var matches;if(isDocumentFragment(context)){children=getChildren(context);matches=[];children.forEach(function(node){var childMatches;if(sizzle.matchesSelector(node,selector)){matches.push(node)}childMatches=sizzle(selector,node);if(childMatches.length){matches=matches.concat(childMatches)}});return matches}return sizzle(selector,context)}},{"../children":349,"../vendor/sizzle/sizzle":366,"ac-dom-nodes/isDocumentFragment":330,"ac-polyfills/Array/prototype.forEach":404}],365:[function(require,module,exports){"use strict";var children=require("./children");var validate=require("./internal/validate");module.exports=function siblings(node,selector){var els=[];validate.childNode(node,true,"siblings");validate.selector(selector,false,"siblings");if(node.parentNode){els=children(node.parentNode,selector);els=els.filter(function(el){return el!==node})}return els}},{"./children":349,"./internal/validate":354}],366:[function(require,module,exports){(function(window,undefined){var cachedruns,dirruns,sortOrder,siblingCheck,assertGetIdNotName,document=window.document,docElem=document.documentElement,strundefined="undefined",hasDuplicate=false,baseHasDuplicate=true,done=0,slice=[].slice,push=[].push,expando=("sizcache"+Math.random()).replace(".",""),whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])",identifier="(?:[\\w#_-]|[^\\x00-\\xa0]|\\\\.)",operators="([*^$|!~]?=)",attributes="\\["+whitespace+"*("+characterEncoding+"+)"+whitespace+"*(?:"+operators+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+"+)|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+"+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|(.*))\\)|)",pos=":(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\)|)(?=[^-]|$)",combinators=whitespace+"*([\\x20\\t\\r\\n\\f>+~])"+whitespace+"*",groups="(?=[^\\x20\\t\\r\\n\\f])(?:\\\\.|"+attributes+"|"+pseudos.replace(2,7)+"|[^\\\\(),])+",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcombinators=new RegExp("^"+combinators),rgroups=new RegExp(groups+"?(?="+whitespace+"*,|$)","g"),rselector=new RegExp("^(?:(?!,)(?:(?:^|,)"+whitespace+"*"+groups+")*?|"+whitespace+"*(.*?))(\\)|$)"),rtokens=new RegExp(groups.slice(19,-6)+"\\x20\\t\\r\\n\\f>+~])+|"+combinators,"g"),rquickExpr=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,rsibling=/[\x20\t\r\n\f]*[+~]/,rendsWithNot=/:not\($/,rheader=/h\d/i,rinputs=/input|select|textarea|button/i,rbackslash=/\\(?!\\)/g,matchExpr={ID:new RegExp("^#("+characterEncoding+"+)"),CLASS:new RegExp("^\\.("+characterEncoding+"+)"),NAME:new RegExp("^\\[name=['\"]?("+characterEncoding+"+)['\"]?\\]"),TAG:new RegExp("^("+characterEncoding.replace("[-","[-\\*")+"+)"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),POS:new RegExp(pos,"ig"),needsContext:new RegExp("^"+whitespace+"*[>+~]|"+pos,"i")},classCache={},cachedClasses=[],compilerCache={},cachedSelectors=[],markFunction=function(fn){fn.sizzleFilter=true;return fn},createInputFunction=function(type){return function(elem){return elem.nodeName.toLowerCase()==="input"&&elem.type===type}},createButtonFunction=function(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}},assert=function(fn){var pass=false,div=document.createElement("div");try{pass=fn(div)}catch(e){}div=null;return pass},assertAttributes=assert(function(div){div.innerHTML="<select></select>";var type=typeof div.lastChild.getAttribute("multiple");return type!=="boolean"&&type!=="string"}),assertUsableName=assert(function(div){div.id=expando+0;div.innerHTML="<a name='"+expando+"'></a><div name='"+expando+"'></div>";docElem.insertBefore(div,docElem.firstChild);var pass=document.getElementsByName&&document.getElementsByName(expando).length===2+document.getElementsByName(expando+0).length;assertGetIdNotName=!document.getElementById(expando);docElem.removeChild(div);return pass}),assertTagNameNoComments=assert(function(div){div.appendChild(document.createComment(""));return div.getElementsByTagName("*").length===0}),assertHrefNotNormalized=assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild&&typeof div.firstChild.getAttribute!==strundefined&&div.firstChild.getAttribute("href")==="#"}),assertUsableClassName=assert(function(div){div.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0){return false}div.lastChild.className="e";return div.getElementsByClassName("e").length!==1});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var match,elem,xml,m,nodeType=context.nodeType;if(nodeType!==1&&nodeType!==9){return[]}if(!selector||typeof selector!=="string"){return results}xml=isXML(context);if(!xml&&!seed){if(match=rquickExpr.exec(selector)){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,slice.call(context.getElementsByTagName(selector),0));return results}else if((m=match[3])&&assertUsableClassName&&context.getElementsByClassName){push.apply(results,slice.call(context.getElementsByClassName(m),0));return results}}}return select(selector,context,results,seed,xml)};var Expr=Sizzle.selectors={cacheLength:50,match:matchExpr,order:["ID","TAG"],attrHandle:{},createPseudo:markFunction,find:{ID:assertGetIdNotName?function(id,context,xml){if(typeof context.getElementById!==strundefined&&!xml){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}}:function(id,context,xml){if(typeof context.getElementById!==strundefined&&!xml){var m=context.getElementById(id);return m?m.id===id||typeof m.getAttributeNode!==strundefined&&m.getAttributeNode("id").value===id?[m]:undefined:[]}},TAG:assertTagNameNoComments?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var results=context.getElementsByTagName(tag);if(tag==="*"){var elem,tmp=[],i=0;for(;elem=results[i];i++){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results}},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(rbackslash,"");match[3]=(match[4]||match[5]||"").replace(rbackslash,"");if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1]==="nth"){if(!match[2]){Sizzle.error(match[0])}match[3]=+(match[3]?match[4]+(match[5]||1):2*(match[2]==="even"||match[2]==="odd"));match[4]=+(match[6]+match[7]||match[2]==="odd")}else if(match[2]){Sizzle.error(match[0])}return match},PSEUDO:function(match){var argument,unquoted=match[4];if(matchExpr["CHILD"].test(match[0])){return null}if(unquoted&&(argument=rselector.exec(unquoted))&&argument.pop()){match[0]=match[0].slice(0,argument[0].length-unquoted.length-1);unquoted=argument[0].slice(0,-1)}match.splice(2,3,unquoted||match[3]);return match}},filter:{ID:assertGetIdNotName?function(id){id=id.replace(rbackslash,"");return function(elem){return elem.getAttribute("id")===id}}:function(id){id=id.replace(rbackslash,"");return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===id}},TAG:function(nodeName){if(nodeName==="*"){return function(){return true}}nodeName=nodeName.replace(rbackslash,"").toLowerCase();return function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className];if(!pattern){pattern=classCache[className]=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)");cachedClasses.push(className);if(cachedClasses.length>Expr.cacheLength){delete classCache[cachedClasses.shift()]}}return function(elem){return pattern.test(elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")}},ATTR:function(name,operator,check){if(!operator){return function(elem){return Sizzle.attr(elem,name)!=null}}return function(elem){var result=Sizzle.attr(elem,name),value=result+"";if(result==null){return operator==="!="}switch(operator){case"=":return value===check;case"!=":return value!==check;case"^=":return check&&value.indexOf(check)===0;case"*=":return check&&value.indexOf(check)>-1;case"$=":return check&&value.substr(value.length-check.length)===check;case"~=":return(" "+value+" ").indexOf(check)>-1;case"|=":return value===check||value.substr(0,check.length+1)===check+"-"}}},CHILD:function(type,argument,first,last){if(type==="nth"){var doneName=done++;return function(elem){var parent,diff,count=0,node=elem;if(first===1&&last===0){return true}parent=elem.parentNode;if(parent&&(parent[expando]!==doneName||!elem.sizset)){for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.sizset=++count;if(node===elem){break}}}parent[expando]=doneName}diff=elem.sizset-last;if(first===0){return diff===0}else{return diff%first===0&&diff/first>=0}}}return function(elem){var node=elem;switch(type){case"only":case"first":while(node=node.previousSibling){if(node.nodeType===1){return false}}if(type==="first"){return true}node=elem;case"last":while(node=node.nextSibling){if(node.nodeType===1){return false}}return true}}},PSEUDO:function(pseudo,argument,context,xml){var fn=Expr.pseudos[pseudo]||Expr.pseudos[pseudo.toLowerCase()];if(!fn){Sizzle.error("unsupported pseudo: "+pseudo)}if(!fn.sizzleFilter){return fn}return fn(argument,context,xml)}},pseudos:{not:markFunction(function(selector,context,xml){var matcher=compile(selector.replace(rtrim,"$1"),context,xml);return function(elem){return!matcher(elem)}}),enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},parent:function(elem){return!!elem.firstChild},empty:function(elem){return!elem.firstChild},contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),header:function(elem){return rheader.test(elem.nodeName)},text:function(elem){var type,attr;return elem.nodeName.toLowerCase()==="input"&&(type=elem.type)==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()===type)},radio:createInputFunction("radio"),checkbox:createInputFunction("checkbox"),file:createInputFunction("file"),password:createInputFunction("password"),image:createInputFunction("image"),submit:createButtonFunction("submit"),reset:createButtonFunction("reset"),button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},input:function(elem){return rinputs.test(elem.nodeName)},focus:function(elem){var doc=elem.ownerDocument;return elem===doc.activeElement&&(!doc.hasFocus||doc.hasFocus())&&!!(elem.type||elem.href)},active:function(elem){return elem===elem.ownerDocument.activeElement}},setFilters:{first:function(elements,argument,not){return not?elements.slice(1):[elements[0]]},last:function(elements,argument,not){var elem=elements.pop();return not?elements:[elem]},even:function(elements,argument,not){var results=[],i=not?1:0,len=elements.length;for(;i<len;i=i+2){results.push(elements[i])}return results},odd:function(elements,argument,not){var results=[],i=not?0:1,len=elements.length;for(;i<len;i=i+2){results.push(elements[i])}return results},lt:function(elements,argument,not){return not?elements.slice(+argument):elements.slice(0,+argument)},gt:function(elements,argument,not){return not?elements.slice(0,+argument+1):elements.slice(+argument+1)},eq:function(elements,argument,not){var elem=elements.splice(+argument,1);return not?elements:elem}}};Expr.setFilters["nth"]=Expr.setFilters["eq"];Expr.filters=Expr.pseudos;if(!assertHrefNotNormalized){Expr.attrHandle={href:function(elem){return elem.getAttribute("href",2)},type:function(elem){return elem.getAttribute("type")}}}if(assertUsableName){Expr.order.push("NAME");Expr.find["NAME"]=function(name,context){if(typeof context.getElementsByName!==strundefined){return context.getElementsByName(name)}}}if(assertUsableClassName){Expr.order.splice(1,0,"CLASS");Expr.find["CLASS"]=function(className,context,xml){if(typeof context.getElementsByClassName!==strundefined&&!xml){return context.getElementsByClassName(className)}}}try{slice.call(docElem.childNodes,0)[0].nodeType}catch(e){slice=function(i){var elem,results=[];for(;elem=this[i];i++){results.push(elem)}return results}}var isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var contains=Sizzle.contains=docElem.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:docElem.contains?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&adown.contains&&adown.contains(bup))}:function(a,b){while(b=b.parentNode){if(b===a){return true}}return false};var getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}}else{for(;node=elem[i];i++){ret+=getText(node)}}return ret};Sizzle.attr=function(elem,name){var attr,xml=isXML(elem);if(!xml){name=name.toLowerCase()}if(Expr.attrHandle[name]){return Expr.attrHandle[name](elem)}if(assertAttributes||xml){return elem.getAttribute(name)}attr=elem.getAttributeNode(name);return attr?typeof elem[name]==="boolean"?elem[name]?name:null:attr.specified?attr.value:null:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};[0,0].sort(function(){return baseHasDuplicate=0});if(docElem.compareDocumentPosition){sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}return(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}}else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}else if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;if(aup===bup){return siblingCheck(a,b)}else if(!aup){return-1}else if(!bup){return 1}while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++){if(ap[i]!==bp[i]){return siblingCheck(ap[i],bp[i])}}return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};siblingCheck=function(a,b,ret){if(a===b){return ret}var cur=a.nextSibling;while(cur){if(cur===b){return-1}cur=cur.nextSibling}return 1}}Sizzle.uniqueSort=function(results){var elem,i=1;if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(;elem=results[i];i++){if(elem===results[i-1]){results.splice(i--,1)}}}}return results};function multipleContexts(selector,contexts,results,seed){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results,seed)}}function handlePOSGroup(selector,posfilter,argument,contexts,seed,not){var results,fn=Expr.setFilters[posfilter.toLowerCase()];if(!fn){Sizzle.error(posfilter)}if(selector||!(results=seed)){multipleContexts(selector||"*",contexts,results=[],seed)}return results.length>0?fn(results,argument,not):[]}function handlePOS(selector,context,results,seed,groups){var match,not,anchor,ret,elements,currentContexts,part,lastIndex,i=0,len=groups.length,rpos=matchExpr["POS"],rposgroups=new RegExp("^"+rpos.source+"(?!"+whitespace+")","i"),setUndefined=function(){var i=1,len=arguments.length-2;for(;i<len;i++){if(arguments[i]===undefined){match[i]=undefined}}};for(;i<len;i++){rpos.exec("");selector=groups[i];ret=[];anchor=0;elements=seed;while(match=rpos.exec(selector)){lastIndex=rpos.lastIndex=match.index+match[0].length;if(lastIndex>anchor){part=selector.slice(anchor,match.index);anchor=lastIndex;currentContexts=[context];if(rcombinators.test(part)){if(elements){currentContexts=elements}elements=seed}if(not=rendsWithNot.test(part)){part=part.slice(0,-5).replace(rcombinators,"$&*")}if(match.length>1){match[0].replace(rposgroups,setUndefined)}elements=handlePOSGroup(part,match[1],match[2],currentContexts,elements,not)}}if(elements){ret=ret.concat(elements);if((part=selector.slice(anchor))&&part!==")"){multipleContexts(part,ret,results,seed)}else{push.apply(results,ret)}}else{Sizzle(selector,context,results,seed)}}return len===1?results:Sizzle.uniqueSort(results)}function tokenize(selector,context,xml){var tokens,soFar,type,groups=[],i=0,match=rselector.exec(selector),matched=!match.pop()&&!match.pop(),selectorGroups=matched&&selector.match(rgroups)||[""],preFilters=Expr.preFilter,filters=Expr.filter,checkContext=!xml&&context!==document;for(;(soFar=selectorGroups[i])!=null&&matched;i++){groups.push(tokens=[]);if(checkContext){soFar=" "+soFar}while(soFar){matched=false;if(match=rcombinators.exec(soFar)){soFar=soFar.slice(match[0].length);matched=tokens.push({part:match.pop().replace(rtrim," "),captures:match})}for(type in filters){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match,context,xml)))){soFar=soFar.slice(match.shift().length);matched=tokens.push({part:type,captures:match})}}if(!matched){break}}}if(!matched){Sizzle.error(selector)}return groups}function addCombinator(matcher,combinator,context){var dir=combinator.dir,doneName=done++;if(!matcher){matcher=function(elem){return elem===context}}return combinator.first?function(elem,context){while(elem=elem[dir]){if(elem.nodeType===1){return matcher(elem,context)&&elem}}}:function(elem,context){var cache,dirkey=doneName+"."+dirruns,cachedkey=dirkey+"."+cachedruns;while(elem=elem[dir]){if(elem.nodeType===1){if((cache=elem[expando])===cachedkey){return false}else if(typeof cache==="string"&&cache.indexOf(dirkey)===0){if(elem.sizset){return elem}}else{elem[expando]=cachedkey;if(matcher(elem,context)){elem.sizset=true;return elem}elem.sizset=false}}}}}function addMatcher(higher,deeper){return higher?function(elem,context){var result=deeper(elem,context);return result&&higher(result===true?elem:result,context)}:deeper}function matcherFromTokens(tokens,context,xml){var token,matcher,i=0;for(;token=tokens[i];i++){if(Expr.relative[token.part]){matcher=addCombinator(matcher,Expr.relative[token.part],context)}else{token.captures.push(context,xml);matcher=addMatcher(matcher,Expr.filter[token.part].apply(null,token.captures))}}return matcher}function matcherFromGroupMatchers(matchers){return function(elem,context){var matcher,j=0;for(;matcher=matchers[j];j++){if(matcher(elem,context)){return true}}return false}}var compile=Sizzle.compile=function(selector,context,xml){var tokens,group,i,cached=compilerCache[selector];if(cached&&cached.context===context){cached.dirruns++;return cached}group=tokenize(selector,context,xml);for(i=0;tokens=group[i];i++){group[i]=matcherFromTokens(tokens,context,xml)}cached=compilerCache[selector]=matcherFromGroupMatchers(group);cached.context=context;cached.runs=cached.dirruns=0;cachedSelectors.push(selector);if(cachedSelectors.length>Expr.cacheLength){delete compilerCache[cachedSelectors.shift()]}return cached};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){return Sizzle(expr,null,null,[elem]).length>0};var select=function(selector,context,results,seed,xml){selector=selector.replace(rtrim,"$1");var elements,matcher,i,len,elem,token,type,findContext,notTokens,match=selector.match(rgroups),tokens=selector.match(rtokens),contextNodeType=context.nodeType;if(matchExpr["POS"].test(selector)){return handlePOS(selector,context,results,seed,match)}if(seed){elements=slice.call(seed,0)}else if(match&&match.length===1){if(tokens.length>1&&contextNodeType===9&&!xml&&(match=matchExpr["ID"].exec(tokens[0]))){context=Expr.find["ID"](match[1],context,xml)[0];if(!context){return results}selector=selector.slice(tokens.shift().length)}findContext=(match=rsibling.exec(tokens[0]))&&!match.index&&context.parentNode||context;notTokens=tokens.pop();token=notTokens.split(":not")[0];for(i=0,len=Expr.order.length;i<len;i++){type=Expr.order[i];if(match=matchExpr[type].exec(token)){elements=Expr.find[type]((match[1]||"").replace(rbackslash,""),findContext,xml);if(elements==null){continue}if(token===notTokens){selector=selector.slice(0,selector.length-notTokens.length)+token.replace(matchExpr[type],"");if(!selector){push.apply(results,slice.call(elements,0))}}break}}}if(selector){matcher=compile(selector,context,xml);dirruns=matcher.dirruns;if(elements==null){elements=Expr.find["TAG"]("*",rsibling.test(selector)&&context.parentNode||context)}for(i=0;elem=elements[i];i++){cachedruns=matcher.runs++;if(matcher(elem,context)){results.push(elem)}}}return results};if(document.querySelectorAll){(function(){var disconnectedMatch,oldSelect=select,rescape=/'|\\/g,rattributeQuotes=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,rbuggyQSA=[],rbuggyMatches=[":active"],matches=docElem.matchesSelector||docElem.mozMatchesSelector||docElem.webkitMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector;assert(function(div){div.innerHTML="<select><option selected></option></select>";if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}});assert(function(div){div.innerHTML="<p test=''></p>";if(div.querySelectorAll("[test^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:\"\"|'')")}div.innerHTML="<input type='hidden'>";if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}});rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));select=function(selector,context,results,seed,xml){if(!seed&&!xml&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(context.nodeType===9){try{push.apply(results,slice.call(context.querySelectorAll(selector),0));return results}catch(qsaError){}}else if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var old=context.getAttribute("id"),nid=old||expando,newContext=rsibling.test(selector)&&context.parentNode||context;if(old){nid=nid.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}try{push.apply(results,slice.call(newContext.querySelectorAll(selector.replace(rgroups,"[id='"+nid+"'] $&")),0));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}return oldSelect(selector,context,results,seed,xml)};if(matches){assert(function(div){disconnectedMatch=matches.call(div,"div");try{matches.call(div,"[test!='']:sizzle");rbuggyMatches.push(Expr.match.PSEUDO)}catch(e){}});rbuggyMatches=new RegExp(rbuggyMatches.join("|"));Sizzle.matchesSelector=function(elem,expr){expr=expr.replace(rattributeQuotes,"='$1']");if(!isXML(elem)&&!rbuggyMatches.test(expr)&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,null,null,[elem]).length>0}}})()}if(typeof module==="object"&&module.exports){module.exports=Sizzle}else{window.Sizzle=Sizzle}})(window)},{}],367:[function(require,module,exports){"use strict";module.exports={EventEmitterMicro:require("./ac-event-emitter-micro/EventEmitterMicro")}},{"./ac-event-emitter-micro/EventEmitterMicro":368}],368:[function(require,module,exports){"use strict";function EventEmitterMicro(){this._events={}}var proto=EventEmitterMicro.prototype;proto.on=function(eventName,callback){this._events[eventName]=this._events[eventName]||[];this._events[eventName].unshift(callback)};proto.once=function(eventName,callback){var that=this;function fn(data){that.off(eventName,fn);if(data!==undefined)callback(data);else callback()}this.on(eventName,fn)};proto.off=function(eventName,callback){if(eventName in this._events===false)return;var index=this._events[eventName].indexOf(callback);if(index===-1)return;this._events[eventName].splice(index,1)};proto.trigger=function(eventName,data){if(eventName in this._events===false)return;for(var i=this._events[eventName].length-1;i>=0;i--){if(data!==undefined)this._events[eventName][i](data);else this._events[eventName][i]()}};proto.destroy=function(){for(var eventName in this._events){this._events[eventName]=null}this._events=null};module.exports=EventEmitterMicro},{}],369:[function(require,module,exports){arguments[4][135][0].apply(exports,arguments)},{"./ac-event-emitter/EventEmitter":370,dup:135}],370:[function(require,module,exports){arguments[4][136][0].apply(exports,arguments)},{dup:136}],371:[function(require,module,exports){"use strict";var EventEmitterMicro=require("ac-event-emitter-micro").EventEmitterMicro;var ac_addEventListener=require("ac-dom-events/utils/addEventListener");var ac_removeEventListener=require("ac-dom-events/utils/removeEventListener");var create=require("ac-object/create");var KeyEvent=require("./internal/KeyEvent");var KEYDOWN="keydown";var KEYUP="keyup";function Keyboard(){this._keysDown={};this._DOMKeyDown=this._DOMKeyDown.bind(this);this._DOMKeyUp=this._DOMKeyUp.bind(this);ac_addEventListener(document,KEYDOWN,this._DOMKeyDown,true);ac_addEventListener(document,KEYUP,this._DOMKeyUp,true);EventEmitterMicro.call(this)}var proto=Keyboard.prototype=create(EventEmitterMicro.prototype);proto.onDown=function(keyCode,callback){return this.on(KEYDOWN+":"+keyCode,callback)};proto.onceDown=function(keyCode,callback){return this.once(KEYDOWN+":"+keyCode,callback)};proto.offDown=function(keyCode,callback){return this.off(KEYDOWN+":"+keyCode,callback)};proto.onUp=function(keyCode,callback){return this.on(KEYUP+":"+keyCode,callback)};proto.onceUp=function(keyCode,callback){return this.once(KEYUP+":"+keyCode,callback)};proto.offUp=function(keyCode,callback){return this.off(KEYUP+":"+keyCode,callback)};proto.isDown=function(keyCode){keyCode+="";return this._keysDown[keyCode]||false};proto.isUp=function(keyCode){return!this.isDown(keyCode)};proto.destroy=function(){this._keysDown=null;ac_removeEventListener(document,KEYDOWN,this._DOMKeyDown);ac_removeEventListener(document,KEYUP,this._DOMKeyUp);EventEmitterMicro.prototype.destroy.call(this);return this};proto._DOMKeyDown=function(keyboardEvent){var evt=this._normalizeKeyboardEvent(keyboardEvent);var keyCode=evt.keyCode+="";this._trackKeyDown(keyCode);this.trigger(KEYDOWN+":"+keyCode,evt)};proto._DOMKeyUp=function(keyboardEvent){var evt=this._normalizeKeyboardEvent(keyboardEvent);var keyCode=evt.keyCode+="";this._trackKeyUp(keyCode);this.trigger(KEYUP+":"+keyCode,evt)};proto._trackKeyUp=function(keyCode){if(this._keysDown[keyCode]){this._keysDown[keyCode]=false}};proto._trackKeyDown=function(keyCode){if(!this._keysDown[keyCode]){this._keysDown[keyCode]=true}};proto._normalizeKeyboardEvent=function(keyboardEvent){return new KeyEvent(keyboardEvent)};module.exports=Keyboard},{"./internal/KeyEvent":373,"ac-dom-events/utils/addEventListener":309,"ac-dom-events/utils/removeEventListener":310,"ac-event-emitter-micro":367,"ac-object/create":391}],372:[function(require,module,exports){"use strict";var Keyboard=require("./Keyboard");module.exports=new Keyboard},{"./Keyboard":371}],373:[function(require,module,exports){var blackList=["keyLocation"];function KeyEvent(originalEvt){this.originalEvent=originalEvt;var prop;for(prop in originalEvt){if(blackList.indexOf(prop)===-1&&typeof originalEvt[prop]!=="function"){this[prop]=originalEvt[prop]}}this.location=this.originalEvent.location!==undefined?this.originalEvent.location:this.originalEvent.keyLocation}KeyEvent.prototype={preventDefault:function(){if(typeof this.originalEvent.preventDefault!=="function"){this.originalEvent.returnValue=false;return}return this.originalEvent.preventDefault()},stopPropagation:function(){return this.originalEvent.stopPropagation()}};module.exports=KeyEvent},{}],374:[function(require,module,exports){module.exports={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,COMMAND:91,CAPSLOCK:20,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ASTERISK:106,NUMPAD_PLUS:107,NUMPAD_DASH:109,NUMPAD_DOT:110,NUMPAD_SLASH:111,NUMPAD_EQUALS:187,TICK:192,LEFT_BRACKET:219,RIGHT_BRACKET:221,BACKSLASH:220,SEMICOLON:186,APOSTRAPHE:222,SPACEBAR:32,CLEAR:12,COMMA:188,DOT:190,SLASH:191}},{}],375:[function(require,module,exports){"use strict";module.exports={addEventListener:require("./ac-dom-events/addEventListener"),dispatchEvent:require("./ac-dom-events/dispatchEvent"),removeEventListener:require("./ac-dom-events/removeEventListener"),stop:require("./ac-dom-events/stop"),target:require("./ac-dom-events/target")}},{"./ac-dom-events/addEventListener":376,"./ac-dom-events/dispatchEvent":377,"./ac-dom-events/removeEventListener":378,"./ac-dom-events/stop":379,"./ac-dom-events/target":380}],376:[function(require,module,exports){"use strict";var prefixer=require("ac-prefixer");module.exports=function addEventListener(target,type,listener,useCapture){type=prefixer.getEventType(type);if(target.addEventListener){target.addEventListener(type,listener,useCapture)}else{type="on"+type.toLowerCase();target.attachEvent(type,listener)}return target}},{"ac-prefixer":385}],377:[function(require,module,exports){"use strict";module.exports=function dispatchEvent(target,type,options){var evt;type=type.toLowerCase();if(window.CustomEvent){if(options){evt=new CustomEvent(type,options)}else{evt=new CustomEvent(type)}target.dispatchEvent(evt)}else{evt=document.createEventObject();if(options&&"detail"in options){evt.detail=options.detail}target.fireEvent("on"+type,evt)}return target}},{}],378:[function(require,module,exports){"use strict";var prefixer=require("ac-prefixer");module.exports=function removeEventListener(target,type,listener,useCapture){type=prefixer.getEventType(type);if(target.removeEventListener){target.removeEventListener(type,listener,useCapture)}else{type="on"+type.toLowerCase();target.detachEvent(type,listener)}return target}},{"ac-prefixer":385}],379:[function(require,module,exports){"use strict";module.exports=function stop(evt){if(!evt){evt=window.event}if(evt.stopPropagation){evt.stopPropagation()}else{evt.cancelBubble=true}if(evt.preventDefault){evt.preventDefault()}evt.stopped=true;evt.returnValue=false}},{}],380:[function(require,module,exports){"use strict";module.exports=function target(evt){return typeof evt.target!=="undefined"?evt.target:evt.srcElement}},{}],381:[function(require,module,exports){var Keyboard=require("./ac-keyboard/Keyboard");module.exports=new Keyboard;module.exports.Keyboard=Keyboard;module.exports.keys=require("./ac-keyboard/keymap")},{"./ac-keyboard/Keyboard":383,"./ac-keyboard/keymap":384}],382:[function(require,module,exports){arguments[4][373][0].apply(exports,arguments)},{dup:373}],383:[function(require,module,exports){"use strict";var ac_domEvents=require("ac-dom-events");var EventEmitter=require("ac-event-emitter").EventEmitter;var KeyEvent=require("./KeyEvent");var keyMap=require("./keymap");var DOM_KEY_LOCATION_STANDARD=0;var DOM_KEY_LOCATION_LEFT=1;var DOM_KEY_LOCATION_RIGHT=2;var DOM_KEY_LOCATION_NUMPAD=3;var proto;function Keyboard(){this._keysDown={};this._keyDownEmitter=new EventEmitter;this._keyUpEmitter=new EventEmitter;ac_domEvents.addEventListener(document,"keydown",this._DOMKeyDown.bind(this),true);ac_domEvents.addEventListener(document,"keyup",this._DOMKeyUp.bind(this),true);this._listening=[]}proto=Keyboard.prototype;proto._castEventNameNumberToString=function(eventName){if(typeof eventName==="number"){return eventName.toString()}return eventName};proto._DOMKeyDown=function(keyboardEvent){var evt=this._normalizeKeyboardEvent(keyboardEvent);var keyCode=evt.keyCode.toString();this._trackKeyDown(keyCode);this._keyDownEmitter.trigger(keyCode,evt)};proto._DOMKeyUp=function(keyboardEvent){var evt=this._normalizeKeyboardEvent(keyboardEvent);var keyCode=evt.keyCode.toString();this._trackKeyUp(keyCode);this._keyUpEmitter.trigger(keyCode,evt)};proto.addKeyDown=function(){var args=Array.prototype.slice.call(arguments);var eventKeyCode=args.shift();if(eventKeyCode===undefined){throw new TypeError('Could not listen for keyup event on "'+eventKeyCode+'"')}eventKeyCode=this._castEventNameNumberToString(eventKeyCode);return this._keyDownEmitter.on.apply(this._keyDownEmitter,[eventKeyCode].concat(args))};proto.addKeyUp=function(){var args=Array.prototype.slice.call(arguments);var eventKeyCode=args.shift();if(eventKeyCode===undefined){throw new TypeError('Could not listen for keyup event on "'+eventKeyCode+'"')}eventKeyCode=this._castEventNameNumberToString(eventKeyCode);return this._keyUpEmitter.on.apply(this._keyUpEmitter,[eventKeyCode].concat(args))};proto.removeKeyDown=function(){var args=Array.prototype.slice.call(arguments);var eventKeyCode=args.shift();eventKeyCode=this._castEventNameNumberToString(eventKeyCode);return this._keyDownEmitter.off.apply(this._keyDownEmitter,[eventKeyCode].concat(args))};proto.removeKeyUp=function(){var args=Array.prototype.slice.call(arguments);var eventKeyCode=args.shift();eventKeyCode=this._castEventNameNumberToString(eventKeyCode);return this._keyUpEmitter.off.apply(this._keyUpEmitter,[eventKeyCode].concat(args))};proto.isDown=function(keyCode){return this._keysDown[keyCode]||false};proto.isUp=function(keyCode){return!this.isDown(keyCode)};proto._trackKeyUp=function(key){if(this._keysDown[key]){this._keysDown[key]=false}};proto._trackKeyDown=function(key){if(!this._keysDown[key]){this._keysDown[key]=true}};proto._normalizeKeyboardEvent=function(keyboardEvent){return new KeyEvent(keyboardEvent)};module.exports=Keyboard},{"./KeyEvent":382,"./keymap":384,"ac-dom-events":375,"ac-event-emitter":369}],384:[function(require,module,exports){arguments[4][374][0].apply(exports,arguments)},{dup:374}],385:[function(require,module,exports){arguments[4][338][0].apply(exports,arguments)},{"./ac-prefixer/Prefixer":386,dup:338}],386:[function(require,module,exports){arguments[4][339][0].apply(exports,arguments)},{"./Prefixer/camelCasedEvents":387,dup:339}],387:[function(require,module,exports){arguments[4][340][0].apply(exports,arguments)},{dup:340}],388:[function(require,module,exports){"use strict";module.exports={Modal:require("./ac-modal/Modal")}},{"./ac-modal/Modal":389}],389:[function(require,module,exports){"use strict";var ac_Classlist=require("ac-classlist");var ac_DomStyle=require("ac-dom-styles");var ac_DomEvents=require("ac-dom-events");var ac_DomNodes=require("ac-dom-nodes");var ac_DomTraversal=require("ac-dom-traversal");var ac_Object=require("ac-object");var ac_Keyboard=require("ac-keyboard");var keys=ac_Keyboard.keys;var EventEmitter=require("ac-event-emitter").EventEmitter;var docEl=document.documentElement;var proto;function Modal(contentElement){this.opened=false;this.closeButton=null;this.modalEl=null;this.contentEl=null;this._keysToClose=[keys.ESCAPE];this._keysToOpen=[];this._boundClose=this.close.bind(this);this._generateElements();if(contentElement){this.appendContent(contentElement)}}var proto=Modal.prototype=ac_Object.create(EventEmitter.prototype);proto._getScrollX=function(){var offset=window.pageXOffset;if(!offset){var target=document.documentElement||document.body.parentNode||document.body;offset=target.scrollLeft}return offset};proto._getScrollY=function(){var offset=window.pageYOffset;if(!offset){var target=document.documentElement||document.body.parentNode||document.body;offset=target.scrollTop}return offset};proto.open=function(){this._scrollX=this._getScrollX();this._scrollY=this._getScrollY();if(!this.opened){this._attachEvents();this.trigger("willopen");ac_Classlist.add(docEl,"modal-open");this.opened=true;this.trigger("open")}};proto.close=function(){this.trigger("willclose");this._removeEvents();ac_Classlist.remove(docEl,"modal-open");this._returnToScrollPosition();this.opened=false;this.trigger("close")};proto.appendContent=function(el){if(el&&ac_DomNodes.isElement(el)){this.contentEl.appendChild(el)}else{throw new TypeError(el+" is not an Element")}};proto.removeContent=function(el){if(this.contentEl.contains(el)){ac_DomNodes.remove(el)}};proto.emptyContent=function(){var children=ac_DomTraversal.children(this.contentEl);children.forEach(ac_DomNodes.remove)};proto.destroy=function(){};proto.addKeyToClose=function(key){this._keysToClose.push(key);ac_Keyboard.addKeyUp(key,this.close,this)};proto.removeKeyToClose=function(key){var index=this._keysToClose.indexOf(key);if(index!==-1){this._keysToClose.splice(index,1)}ac_Keyboard.removeKeyUp(key,this.close,this)};proto._removeEvents=function(){ac_DomEvents.removeEventListener(this.closeButton,"click",this._boundClose);this._keysToClose.forEach(this.removeKeyToClose,this)};proto._attachEvents=function(){ac_DomEvents.addEventListener(this.closeButton,"click",this._boundClose);this._keysToClose.forEach(this.addKeyToClose,this)};proto._generateCloseButton=function(){var close=document.createElement("button");ac_Classlist.add(close,"modal-close","icon","icon-closealt");return close};proto._generateModalEl=function(){var modal=document.createElement("div");ac_Classlist.add(modal,"modal");return modal};proto._createContentElement=function(){var div=document.createElement("div");ac_Classlist.add(div,"modal-content");return div};proto._generateElements=function(){this.closeButton=this._closeButton||this._generateCloseButton();this.contentEl=this._createContentElement();this.modalEl=this._modalEl||this._generateModalEl();this.modalEl.appendChild(this.closeButton);this.modalEl.appendChild(this.contentEl);document.body.appendChild(this.modalEl);ac_Classlist.add(docEl,"has-modal")};proto._returnToScrollPosition=function(){window.scrollTo(this._scrollX||0,this._scrollY||0)};module.exports=Modal},{"ac-classlist":303,"ac-dom-events":375,"ac-dom-nodes":320,"ac-dom-styles":341,"ac-dom-traversal":352,"ac-event-emitter":369,"ac-keyboard":381,"ac-object":395}],390:[function(require,module,exports){"use strict";require("ac-polyfills/Array/isArray");var extend=require("./extend");var hasOwnProp=Object.prototype.hasOwnProperty;var deepClone=function(dest,source){var prop;for(prop in source){if(hasOwnProp.call(source,prop)){if(source[prop]===null){dest[prop]=null}else if(typeof source[prop]==="object"){dest[prop]=Array.isArray(source[prop])?[]:{};deepClone(dest[prop],source[prop])}else{dest[prop]=source[prop]}}}return dest};module.exports=function clone(object,deep){if(deep){return deepClone({},object)}return extend({},object)}},{"./extend":393,"ac-polyfills/Array/isArray":402}],391:[function(require,module,exports){"use strict";var F=function(){};module.exports=function create(proto){if(arguments.length>1){throw new Error("Second argument not supported")}if(proto===null||typeof proto!=="object"){throw new TypeError("Object prototype may only be an Object.")}if(typeof Object.create==="function"){return Object.create(proto)}else{F.prototype=proto;return new F}}},{}],392:[function(require,module,exports){"use strict";var extend=require("./extend");module.exports=function defaults(defaultsObj,options){if(typeof defaultsObj!=="object"){throw new TypeError("defaults: must provide a defaults object")}options=options||{};if(typeof options!=="object"){throw new TypeError("defaults: options must be a typeof object")}return extend({},defaultsObj,options)}},{"./extend":393}],393:[function(require,module,exports){"use strict";require("ac-polyfills/Array/prototype.forEach");var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function extend(){var args;var dest;if(arguments.length<2){args=[{},arguments[0]]}else{args=[].slice.call(arguments)}dest=args.shift();args.forEach(function(source){if(source!=null){for(var property in source){if(hasOwnProp.call(source,property)){dest[property]=source[property]}}}});return dest}},{"ac-polyfills/Array/prototype.forEach":404}],394:[function(require,module,exports){"use strict";var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function getPrototypeOf(obj){if(Object.getPrototypeOf){return Object.getPrototypeOf(obj)}else{if(typeof obj!=="object"){throw new Error("Requested prototype of a value that is not an object.")}else if(typeof this.__proto__==="object"){return obj.__proto__}else{var constructor=obj.constructor;var oldConstructor;if(hasOwnProp.call(obj,"constructor")){oldConstructor=constructor;if(!delete obj.constructor){return null}constructor=obj.constructor;obj.constructor=oldConstructor}return constructor?constructor.prototype:null}}}},{}],395:[function(require,module,exports){"use strict";module.exports={clone:require("./clone"),create:require("./create"),defaults:require("./defaults"),extend:require("./extend"),getPrototypeOf:require("./getPrototypeOf"),isDate:require("./isDate"),isEmpty:require("./isEmpty"),isRegExp:require("./isRegExp"),toQueryParameters:require("./toQueryParameters")}},{"./clone":390,"./create":391,"./defaults":392,"./extend":393,"./getPrototypeOf":394,"./isDate":396,"./isEmpty":397,"./isRegExp":398,"./toQueryParameters":399}],396:[function(require,module,exports){"use strict";module.exports=function isDate(date){return Object.prototype.toString.call(date)==="[object Date]"}},{}],397:[function(require,module,exports){"use strict";var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function isEmpty(object){var prop;if(typeof object!=="object"){throw new TypeError("ac-base.Object.isEmpty : Invalid parameter - expected object")}for(prop in object){if(hasOwnProp.call(object,prop)){return false}}return true}},{}],398:[function(require,module,exports){"use strict";module.exports=function isRegExp(obj){return window.RegExp?obj instanceof RegExp:false}},{}],399:[function(require,module,exports){"use strict";var qs=require("qs");module.exports=function toQueryParameters(object){if(typeof object!=="object"){throw new TypeError("toQueryParameters error: argument is not an object")}return qs.stringify(object)}},{qs:447}],400:[function(require,module,exports){"use strict";module.exports={path:require("./ac-path/path")}},{"./ac-path/path":401}],401:[function(require,module,exports){"use strict";function path(pathStr){return path.parse(pathStr)}path.basename=function(pathStr,ext){path._assertStr(pathStr);var extMatch;var basename=pathStr.match(/[^/]*$/)[0];if(ext){extMatch=basename.match(new RegExp("(.*)"+ext+"$"));if(extMatch){basename=extMatch[1]}}return basename};path.dirname=function(pathStr){path._assertStr(pathStr);var dirMatch=pathStr.match(/^(.*)\b\/|.*/);return dirMatch[1]||pathStr};path.extname=function(pathStr){path._assertStr(pathStr);var extMatch=pathStr.match(/\.[^.]*$/);return extMatch?extMatch[0]:""};path.filename=function(pathStr){path._assertStr(pathStr);return path.basename(pathStr,path.extname(pathStr))};path.format=function(pathParams,queryStr){path._assertObj(pathParams);var pathStr=pathParams.dirname?pathParams.dirname+"/":"";if(pathParams.basename){pathStr+=pathParams.basename}else if(pathParams.filename){pathStr+=pathParams.filename;if(pathParams.extname){pathStr+=pathParams.extname}}if(queryStr){if(typeof queryStr==="string"){pathStr+="?"+queryStr}else if(Object.prototype.toString.call(queryStr)===Object.prototype.toString.call([])){pathStr+="?"+queryStr.join("&")}}return pathStr};path.isAbsolute=function(pathStr){path._assertStr(pathStr);return!!pathStr.match(/(^http(s?))/)};path.isRootRelative=function(pathStr){path._assertStr(pathStr);return!!pathStr.match(/^\/(?!\/)/)};path.parse=function(pathStr){path._assertStr(pathStr);return{dirname:path.dirname(pathStr),basename:path.basename(pathStr),filename:path.filename(pathStr),extname:path.extname(pathStr)}};path._assertStr=function(val){path._assertType(val,"string")};path._assertObj=function(val){path._assertType(val,"object")};path._assertType=function(val,type){var valType=typeof val;if(valType==="undefined"||valType!==type){throw new TypeError("path param must be of type "+type)}};module.exports=path},{}],402:[function(require,module,exports){if(!Array.isArray){Array.isArray=function(arg){return Object.prototype.toString.call(arg)==="[object Array]"}}},{}],403:[function(require,module,exports){if(!Array.prototype.filter){Array.prototype.filter=function filter(callback,thisObj){var arrayObject=Object(this);var len=arrayObject.length>>>0;var i;var results=[];if(typeof callback!=="function"){throw new TypeError(callback+" is not a function")}for(i=0;i<len;i+=1){if(i in arrayObject&&callback.call(thisObj,arrayObject[i],i,arrayObject)){results.push(arrayObject[i])}}return results}}},{}],404:[function(require,module,exports){if(!Array.prototype.forEach){Array.prototype.forEach=function forEach(callback,thisObj){var arrayObject=Object(this);var i;var currentValue;if(typeof callback!=="function"){throw new TypeError("No function object passed to forEach.")}for(i=0;i<this.length;i+=1){currentValue=arrayObject[i];callback.call(thisObj,currentValue,i,arrayObject)}}}},{}],405:[function(require,module,exports){if(!Array.prototype.indexOf){Array.prototype.indexOf=function indexOf(searchElement,fromIndex){var startIndex=fromIndex||0;var currentIndex=0;if(startIndex<0){startIndex=this.length+fromIndex-1;if(startIndex<0){throw"Wrapped past beginning of array while looking up a negative start index."}}for(currentIndex=0;currentIndex<this.length;currentIndex++){if(this[currentIndex]===searchElement){return currentIndex}}return-1}}},{}],406:[function(require,module,exports){(function(){"use strict";var _slice=Array.prototype.slice;try{_slice.call(document.documentElement)}catch(e){Array.prototype.slice=function(begin,end){end=typeof end!=="undefined"?end:this.length;if(Object.prototype.toString.call(this)==="[object Array]"){return _slice.call(this,begin,end)}var i,cloned=[],size,len=this.length;var start=begin||0;start=start>=0?start:len+start;var upTo=end?end:len;if(end<0){upTo=len+end}size=upTo-start;if(size>0){cloned=new Array(size);if(this.charAt){for(i=0;i<size;i++){cloned[i]=this.charAt(start+i)}}else{for(i=0;i<size;i++){cloned[i]=this[start+i]}}}return cloned}}})()},{}],407:[function(require,module,exports){"use strict";"use restrict";var INT_BITS=32;exports.INT_BITS=INT_BITS;exports.INT_MAX=2147483647;exports.INT_MIN=-1<<INT_BITS-1;exports.sign=function(v){return(v>0)-(v<0)};exports.abs=function(v){var mask=v>>INT_BITS-1;return(v^mask)-mask};exports.min=function(x,y){return y^(x^y)&-(x<y)};exports.max=function(x,y){return x^(x^y)&-(x<y)};exports.isPow2=function(v){return!(v&v-1)&&!!v};exports.log2=function(v){var r,shift;r=(v>65535)<<4;v>>>=r;shift=(v>255)<<3;v>>>=shift;r|=shift;shift=(v>15)<<2;v>>>=shift;r|=shift;shift=(v>3)<<1;v>>>=shift;r|=shift;return r|v>>1};exports.log10=function(v){return v>=1e9?9:v>=1e8?8:v>=1e7?7:v>=1e6?6:v>=1e5?5:v>=1e4?4:v>=1e3?3:v>=100?2:v>=10?1:0};exports.popCount=function(v){v=v-(v>>>1&1431655765);v=(v&858993459)+(v>>>2&858993459);return(v+(v>>>4)&252645135)*16843009>>>24};function countTrailingZeros(v){var c=32;v&=-v;if(v)c--;if(v&65535)c-=16;if(v&16711935)c-=8;if(v&252645135)c-=4;if(v&858993459)c-=2;if(v&1431655765)c-=1;return c}exports.countTrailingZeros=countTrailingZeros;exports.nextPow2=function(v){v+=v===0;--v;v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v+1};exports.prevPow2=function(v){v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v-(v>>>1)};exports.parity=function(v){v^=v>>>16;v^=v>>>8;v^=v>>>4;v&=15;return 27030>>>v&1};var REVERSE_TABLE=new Array(256);(function(tab){for(var i=0;i<256;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1){r<<=1;r|=v&1;--s}tab[i]=r<<s&255}})(REVERSE_TABLE);exports.reverse=function(v){return REVERSE_TABLE[v&255]<<24|REVERSE_TABLE[v>>>8&255]<<16|REVERSE_TABLE[v>>>16&255]<<8|REVERSE_TABLE[v>>>24&255]};exports.interleave2=function(x,y){x&=65535;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;x=(x|x<<1)&1431655765;y&=65535;y=(y|y<<8)&16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;y=(y|y<<1)&1431655765;return x|y<<1};exports.deinterleave2=function(v,n){v=v>>>n&1431655765;v=(v|v>>>1)&858993459;v=(v|v>>>2)&252645135;v=(v|v>>>4)&16711935;v=(v|v>>>16)&65535;return v<<16>>16};exports.interleave3=function(x,y,z){x&=1023;x=(x|x<<16)&4278190335;x=(x|x<<8)&251719695;x=(x|x<<4)&3272356035;x=(x|x<<2)&1227133513;y&=1023;y=(y|y<<16)&4278190335;y=(y|y<<8)&251719695;y=(y|y<<4)&3272356035;y=(y|y<<2)&1227133513;x|=y<<1;z&=1023;z=(z|z<<16)&4278190335;z=(z|z<<8)&251719695;z=(z|z<<4)&3272356035;z=(z|z<<2)&1227133513;return x|z<<2};exports.deinterleave3=function(v,n){v=v>>>n&1227133513;v=(v|v>>>2)&3272356035;v=(v|v>>>4)&251719695;v=(v|v>>>8)&4278190335;v=(v|v>>>16)&1023;return v<<22>>22};exports.nextCombination=function(v){var t=v|v-1;return t+1|(~t&-~t)-1>>>countTrailingZeros(v)+1}},{}],408:[function(require,module,exports){"use strict";var createThunk=require("./lib/thunk.js");function Procedure(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function compileCwise(user_args){var proc=new Procedure;proc.pre=user_args.pre;proc.body=user_args.body;proc.post=user_args.post;var proc_args=user_args.args.slice(0);proc.argTypes=proc_args;for(var i=0;i<proc_args.length;++i){var arg_type=proc_args[i];if(arg_type==="array"||typeof arg_type==="object"&&arg_type.blockIndices){proc.argTypes[i]="array";proc.arrayArgs.push(i);proc.arrayBlockIndices.push(arg_type.blockIndices?arg_type.blockIndices:0);proc.shimArgs.push("array"+i);if(i<proc.pre.args.length&&proc.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array args")}if(i<proc.post.args.length&&proc.post.args[i].count>0){throw new Error("cwise: post() block may not reference array args")}}else if(arg_type==="scalar"){proc.scalarArgs.push(i);proc.shimArgs.push("scalar"+i)}else if(arg_type==="index"){proc.indexArgs.push(i);if(i<proc.pre.args.length&&proc.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array index")}if(i<proc.body.args.length&&proc.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array index")}if(i<proc.post.args.length&&proc.post.args[i].count>0){throw new Error("cwise: post() block may not reference array index")}}else if(arg_type==="shape"){proc.shapeArgs.push(i);if(i<proc.pre.args.length&&proc.pre.args[i].lvalue){throw new Error("cwise: pre() block may not write to array shape")}if(i<proc.body.args.length&&proc.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array shape")}if(i<proc.post.args.length&&proc.post.args[i].lvalue){throw new Error("cwise: post() block may not write to array shape")}}else if(typeof arg_type==="object"&&arg_type.offset){proc.argTypes[i]="offset";proc.offsetArgs.push({array:arg_type.array,offset:arg_type.offset});proc.offsetArgIndex.push(i)}else{throw new Error("cwise: Unknown argument type "+proc_args[i])}}if(proc.arrayArgs.length<=0){throw new Error("cwise: No array arguments specified")}if(proc.pre.args.length>proc_args.length){throw new Error("cwise: Too many arguments in pre() block")}if(proc.body.args.length>proc_args.length){throw new Error("cwise: Too many arguments in body() block")}if(proc.post.args.length>proc_args.length){throw new Error("cwise: Too many arguments in post() block")}proc.debug=!!user_args.printCode||!!user_args.debug;proc.funcName=user_args.funcName||"cwise";proc.blockSize=user_args.blockSize||64;return createThunk(proc)}module.exports=compileCwise},{"./lib/thunk.js":410}],409:[function(require,module,exports){"use strict";var uniq=require("uniq");function innerFill(order,proc,body){var dimension=order.length,nargs=proc.arrayArgs.length,has_index=proc.indexArgs.length>0,code=[],vars=[],idx=0,pidx=0,i,j;for(i=0;i<dimension;++i){vars.push(["i",i,"=0"].join(""))}for(j=0;j<nargs;++j){for(i=0;i<dimension;++i){pidx=idx;idx=order[i];if(i===0){vars.push(["d",j,"s",i,"=t",j,"p",idx].join(""))}else{vars.push(["d",j,"s",i,"=(t",j,"p",idx,"-s",pidx,"*t",j,"p",pidx,")"].join(""))}}}if(vars.length>0){code.push("var "+vars.join(","))}for(i=dimension-1;i>=0;--i){idx=order[i];code.push(["for(i",i,"=0;i",i,"<s",idx,";++i",i,"){"].join(""))}code.push(body);for(i=0;i<dimension;++i){pidx=idx;idx=order[i];for(j=0;j<nargs;++j){code.push(["p",j,"+=d",j,"s",i].join(""))}if(has_index){if(i>0){code.push(["index[",pidx,"]-=s",pidx].join(""))}code.push(["++index[",idx,"]"].join(""))}code.push("}")}return code.join("\n")}function outerFill(matched,order,proc,body){var dimension=order.length,nargs=proc.arrayArgs.length,blockSize=proc.blockSize,has_index=proc.indexArgs.length>0,code=[];for(var i=0;i<nargs;++i){code.push(["var offset",i,"=p",i].join(""))}for(var i=matched;i<dimension;++i){code.push(["for(var j"+i+"=SS[",order[i],"]|0;j",i,">0;){"].join(""));code.push(["if(j",i,"<",blockSize,"){"].join(""));code.push(["s",order[i],"=j",i].join(""));code.push(["j",i,"=0"].join(""));code.push(["}else{s",order[i],"=",blockSize].join(""));code.push(["j",i,"-=",blockSize,"}"].join(""));if(has_index){code.push(["index[",order[i],"]=j",i].join(""))}}for(var i=0;i<nargs;++i){var indexStr=["offset"+i];for(var j=matched;j<dimension;++j){indexStr.push(["j",j,"*t",i,"p",order[j]].join(""))}code.push(["p",i,"=(",indexStr.join("+"),")"].join(""))}code.push(innerFill(order,proc,body));for(var i=matched;i<dimension;++i){code.push("}")}return code.join("\n")}function countMatches(orders){var matched=0,dimension=orders[0].length;while(matched<dimension){for(var j=1;j<orders.length;++j){if(orders[j][matched]!==orders[0][matched]){return matched}}++matched}return matched}function processBlock(block,proc,dtypes){var code=block.body;var pre=[];var post=[];for(var i=0;i<block.args.length;++i){var carg=block.args[i];if(carg.count<=0){continue}var re=new RegExp(carg.name,"g");var ptrStr="";var arrNum=proc.arrayArgs.indexOf(i);switch(proc.argTypes[i]){case"offset":var offArgIndex=proc.offsetArgIndex.indexOf(i);var offArg=proc.offsetArgs[offArgIndex];arrNum=offArg.array;ptrStr="+q"+offArgIndex;case"array":ptrStr="p"+arrNum+ptrStr;var localStr="l"+i;var arrStr="a"+arrNum;if(proc.arrayBlockIndices[arrNum]===0){if(carg.count===1){if(dtypes[arrNum]==="generic"){if(carg.lvalue){pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join(""));code=code.replace(re,localStr);post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))}else{code=code.replace(re,[arrStr,".get(",ptrStr,")"].join(""))}}else{code=code.replace(re,[arrStr,"[",ptrStr,"]"].join(""))}}else if(dtypes[arrNum]==="generic"){pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join(""));code=code.replace(re,localStr);if(carg.lvalue){post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))}}else{pre.push(["var ",localStr,"=",arrStr,"[",ptrStr,"]"].join(""));code=code.replace(re,localStr);if(carg.lvalue){post.push([arrStr,"[",ptrStr,"]=",localStr].join(""))}}}else{var reStrArr=[carg.name],ptrStrArr=[ptrStr];for(var j=0;j<Math.abs(proc.arrayBlockIndices[arrNum]);j++){reStrArr.push("\\s*\\[([^\\]]+)\\]");ptrStrArr.push("$"+(j+1)+"*t"+arrNum+"b"+j)}re=new RegExp(reStrArr.join(""),"g");ptrStr=ptrStrArr.join("+");if(dtypes[arrNum]==="generic"){throw new Error("cwise: Generic arrays not supported in combination with blocks!")}else{code=code.replace(re,[arrStr,"[",ptrStr,"]"].join(""))}}break;case"scalar":code=code.replace(re,"Y"+proc.scalarArgs.indexOf(i));break;case"index":code=code.replace(re,"index");break;case"shape":code=code.replace(re,"shape");break}}return[pre.join("\n"),code,post.join("\n")].join("\n").trim()}function typeSummary(dtypes){var summary=new Array(dtypes.length);var allEqual=true;for(var i=0;i<dtypes.length;++i){var t=dtypes[i];var digits=t.match(/\d+/);if(!digits){digits=""}else{digits=digits[0]}if(t.charAt(0)===0){summary[i]="u"+t.charAt(1)+digits}else{summary[i]=t.charAt(0)+digits}if(i>0){allEqual=allEqual&&summary[i]===summary[i-1]}}if(allEqual){return summary[0]}return summary.join("")}function generateCWiseOp(proc,typesig){var dimension=typesig[1].length-Math.abs(proc.arrayBlockIndices[0])|0;var orders=new Array(proc.arrayArgs.length);var dtypes=new Array(proc.arrayArgs.length);for(var i=0;i<proc.arrayArgs.length;++i){dtypes[i]=typesig[2*i];orders[i]=typesig[2*i+1]}var blockBegin=[],blockEnd=[];var loopBegin=[],loopEnd=[];var loopOrders=[];for(var i=0;i<proc.arrayArgs.length;++i){if(proc.arrayBlockIndices[i]<0){loopBegin.push(0);loopEnd.push(dimension);blockBegin.push(dimension);blockEnd.push(dimension+proc.arrayBlockIndices[i])}else{loopBegin.push(proc.arrayBlockIndices[i]);loopEnd.push(proc.arrayBlockIndices[i]+dimension);blockBegin.push(0);blockEnd.push(proc.arrayBlockIndices[i])}var newOrder=[];for(var j=0;j<orders[i].length;j++){if(loopBegin[i]<=orders[i][j]&&orders[i][j]<loopEnd[i]){newOrder.push(orders[i][j]-loopBegin[i])}}loopOrders.push(newOrder)}var arglist=["SS"];var code=["'use strict'"];var vars=[];for(var j=0;j<dimension;++j){vars.push(["s",j,"=SS[",j,"]"].join(""))}for(var i=0;i<proc.arrayArgs.length;++i){arglist.push("a"+i);arglist.push("t"+i);arglist.push("p"+i);for(var j=0;j<dimension;++j){vars.push(["t",i,"p",j,"=t",i,"[",loopBegin[i]+j,"]"].join(""))}for(var j=0;j<Math.abs(proc.arrayBlockIndices[i]);++j){vars.push(["t",i,"b",j,"=t",i,"[",blockBegin[i]+j,"]"].join(""))}}for(var i=0;i<proc.scalarArgs.length;++i){arglist.push("Y"+i)}if(proc.shapeArgs.length>0){vars.push("shape=SS.slice(0)")}if(proc.indexArgs.length>0){var zeros=new Array(dimension);for(var i=0;i<dimension;++i){zeros[i]="0"}vars.push(["index=[",zeros.join(","),"]"].join(""))}for(var i=0;i<proc.offsetArgs.length;++i){var off_arg=proc.offsetArgs[i];var init_string=[];for(var j=0;j<off_arg.offset.length;++j){if(off_arg.offset[j]===0){continue}else if(off_arg.offset[j]===1){init_string.push(["t",off_arg.array,"p",j].join(""))}else{init_string.push([off_arg.offset[j],"*t",off_arg.array,"p",j].join(""))}}if(init_string.length===0){vars.push("q"+i+"=0")}else{vars.push(["q",i,"=",init_string.join("+")].join(""))}}var thisVars=uniq([].concat(proc.pre.thisVars).concat(proc.body.thisVars).concat(proc.post.thisVars));vars=vars.concat(thisVars);if(vars.length>0){code.push("var "+vars.join(","))}for(var i=0;i<proc.arrayArgs.length;++i){code.push("p"+i+"|=0")}if(proc.pre.body.length>3){code.push(processBlock(proc.pre,proc,dtypes))}var body=processBlock(proc.body,proc,dtypes);var matched=countMatches(loopOrders);if(matched<dimension){code.push(outerFill(matched,loopOrders[0],proc,body))}else{code.push(innerFill(loopOrders[0],proc,body))}if(proc.post.body.length>3){code.push(processBlock(proc.post,proc,dtypes))}if(proc.debug){console.log("-----Generated cwise routine for ",typesig,":\n"+code.join("\n")+"\n----------")}var loopName=[proc.funcName||"unnamed","_cwise_loop_",orders[0].join("s"),"m",matched,typeSummary(dtypes)].join("");var f=new Function(["function ",loopName,"(",arglist.join(","),"){",code.join("\n"),"} return ",loopName].join(""));return f()}module.exports=generateCWiseOp},{uniq:449}],410:[function(require,module,exports){"use strict";var compile=require("./compile.js");function createThunk(proc){var code=["'use strict'","var CACHED={}"];var vars=[];var thunkName=proc.funcName+"_cwise_thunk";code.push(["return function ",thunkName,"(",proc.shimArgs.join(","),"){"].join(""));var typesig=[];var string_typesig=[];var proc_args=[["array",proc.arrayArgs[0],".shape.slice(",Math.max(0,proc.arrayBlockIndices[0]),proc.arrayBlockIndices[0]<0?","+proc.arrayBlockIndices[0]+")":")"].join("")];var shapeLengthConditions=[],shapeConditions=[];for(var i=0;i<proc.arrayArgs.length;++i){var j=proc.arrayArgs[i];vars.push(["t",j,"=array",j,".dtype,","r",j,"=array",j,".order"].join(""));typesig.push("t"+j);typesig.push("r"+j);string_typesig.push("t"+j);string_typesig.push("r"+j+".join()");proc_args.push("array"+j+".data");proc_args.push("array"+j+".stride");proc_args.push("array"+j+".offset|0");if(i>0){shapeLengthConditions.push("array"+proc.arrayArgs[0]+".shape.length===array"+j+".shape.length+"+(Math.abs(proc.arrayBlockIndices[0])-Math.abs(proc.arrayBlockIndices[i])));shapeConditions.push("array"+proc.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[0])+"]===array"+j+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[i])+"]")}}if(proc.arrayArgs.length>1){code.push("if (!("+shapeLengthConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')");code.push("for(var shapeIndex=array"+proc.arrayArgs[0]+".shape.length-"+Math.abs(proc.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {");code.push("if (!("+shapeConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')");code.push("}")}for(var i=0;i<proc.scalarArgs.length;++i){proc_args.push("scalar"+proc.scalarArgs[i])}vars.push(["type=[",string_typesig.join(","),"].join()"].join(""));vars.push("proc=CACHED[type]");code.push("var "+vars.join(","));code.push(["if(!proc){","CACHED[type]=proc=compile([",typesig.join(","),"])}","return proc(",proc_args.join(","),")}"].join(""));if(proc.debug){console.log("-----Generated thunk:\n"+code.join("\n")+"\n----------")}var thunk=new Function("compile",code.join("\n"));return thunk(compile.bind(undefined,proc))}module.exports=createThunk},{"./compile.js":409}],411:[function(require,module,exports){"use strict";function dupe_array(count,value,i){var c=count[i]|0;if(c<=0){return[]}var result=new Array(c),j;if(i===count.length-1){for(j=0;j<c;++j){result[j]=value}}else{for(j=0;j<c;++j){result[j]=dupe_array(count,value,i+1)}}return result}function dupe_number(count,value){var result,i;result=new Array(count);for(i=0;i<count;++i){result[i]=value}return result}function dupe(count,value){if(typeof value==="undefined"){value=0}switch(typeof count){case"number":if(count>0){return dupe_number(count|0,value)}break;case"object":if(typeof count.length==="number"){return dupe_array(count,value,0)}break}return[]}module.exports=dupe},{}],412:[function(require,module,exports){"use strict";var pool=require("typedarray-pool");var ops=require("ndarray-ops");var ndarray=require("ndarray");var SUPPORTED_TYPES=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function GLBuffer(gl,type,handle,length,usage){this.gl=gl;this.type=type;this.handle=handle;this.length=length;this.usage=usage}var proto=GLBuffer.prototype;proto.bind=function(){this.gl.bindBuffer(this.type,this.handle)};proto.unbind=function(){this.gl.bindBuffer(this.type,null)};proto.dispose=function(){this.gl.deleteBuffer(this.handle)};function updateTypeArray(gl,type,len,usage,data,offset){var dataLen=data.length*data.BYTES_PER_ELEMENT;if(offset<0){gl.bufferData(type,data,usage);return dataLen}if(dataLen+offset>len){throw new Error("gl-buffer: If resizing buffer, must not specify offset")}gl.bufferSubData(type,offset,data);return len}function makeScratchTypeArray(array,dtype){var res=pool.malloc(array.length,dtype);var n=array.length;for(var i=0;i<n;++i){res[i]=array[i]}return res}function isPacked(shape,stride){var n=1;for(var i=stride.length-1;i>=0;--i){if(stride[i]!==n){return false}n*=shape[i]}return true}proto.update=function(array,offset){if(typeof offset!=="number"){offset=-1}this.bind();if(typeof array==="object"&&typeof array.shape!=="undefined"){var dtype=array.dtype;if(SUPPORTED_TYPES.indexOf(dtype)<0){dtype="float32"}if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){var ext=gl.getExtension("OES_element_index_uint");if(ext&&dtype!=="uint16"){dtype="uint32"}else{dtype="uint16"}}if(dtype===array.dtype&&isPacked(array.shape,array.stride)){if(array.offset===0&&array.data.length===array.shape[0]){this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array.data,offset)}else{this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array.data.subarray(array.offset,array.shape[0]),offset)}}else{var tmp=pool.malloc(array.size,dtype);var ndt=ndarray(tmp,array.shape);ops.assign(ndt,array);if(offset<0){this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,tmp,offset)}else{this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,tmp.subarray(0,array.size),offset)}pool.free(tmp)}}else if(Array.isArray(array)){var t;if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){t=makeScratchTypeArray(array,"uint16")}else{t=makeScratchTypeArray(array,"float32")}if(offset<0){this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,t,offset)}else{this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,t.subarray(0,array.length),offset)}pool.free(t)}else if(typeof array==="object"&&typeof array.length==="number"){this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array,offset)}else if(typeof array==="number"||array===undefined){if(offset>=0){throw new Error("gl-buffer: Cannot specify offset when resizing buffer")}array=array|0;if(array<=0){array=1}this.gl.bufferData(this.type,array|0,this.usage);this.length=array}else{throw new Error("gl-buffer: Invalid data type")}};function createBuffer(gl,data,type,usage){type=type||gl.ARRAY_BUFFER;usage=usage||gl.DYNAMIC_DRAW;if(type!==gl.ARRAY_BUFFER&&type!==gl.ELEMENT_ARRAY_BUFFER){throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER")}if(usage!==gl.DYNAMIC_DRAW&&usage!==gl.STATIC_DRAW&&usage!==gl.STREAM_DRAW){throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW")}var handle=gl.createBuffer();var result=new GLBuffer(gl,type,handle,0,usage);result.update(data);return result}module.exports=createBuffer},{ndarray:446,"ndarray-ops":445,"typedarray-pool":448}],413:[function(require,module,exports){module.exports=clone;function clone(a){var out=new Float32Array(16);out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out}},{}],414:[function(require,module,exports){module.exports=create;function create(){var out=new Float32Array(16);out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out}},{}],415:[function(require,module,exports){module.exports=fromRotationTranslation;function fromRotationTranslation(out,q,v){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;out[0]=1-(yy+zz);out[1]=xy+wz;out[2]=xz-wy;out[3]=0;out[4]=xy-wz;out[5]=1-(xx+zz);out[6]=yz+wx;out[7]=0;out[8]=xz+wy;out[9]=yz-wx;out[10]=1-(xx+yy);out[11]=0;out[12]=v[0];out[13]=v[1];out[14]=v[2];out[15]=1;return out}},{}],416:[function(require,module,exports){module.exports=identity;function identity(out){out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out}},{}],417:[function(require,module,exports){module.exports=invert;function invert(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;out[0]=(a11*b11-a12*b10+a13*b09)*det;out[1]=(a02*b10-a01*b11-a03*b09)*det;out[2]=(a31*b05-a32*b04+a33*b03)*det;out[3]=(a22*b04-a21*b05-a23*b03)*det;out[4]=(a12*b08-a10*b11-a13*b07)*det;out[5]=(a00*b11-a02*b08+a03*b07)*det;out[6]=(a32*b02-a30*b05-a33*b01)*det;out[7]=(a20*b05-a22*b02+a23*b01)*det;out[8]=(a10*b10-a11*b08+a13*b06)*det;out[9]=(a01*b08-a00*b10-a03*b06)*det;out[10]=(a30*b04-a31*b02+a33*b00)*det;out[11]=(a21*b02-a20*b04-a23*b00)*det;out[12]=(a11*b07-a10*b09-a12*b06)*det;out[13]=(a00*b09-a01*b07+a02*b06)*det;out[14]=(a31*b01-a30*b03-a32*b00)*det;out[15]=(a20*b03-a21*b01+a22*b00)*det;return out}},{}],418:[function(require,module,exports){module.exports=multiply;function multiply(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];var b0=b[0],b1=b[1],b2=b[2],b3=b[3];out[0]=b0*a00+b1*a10+b2*a20+b3*a30;out[1]=b0*a01+b1*a11+b2*a21+b3*a31;out[2]=b0*a02+b1*a12+b2*a22+b3*a32;out[3]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[4];b1=b[5];b2=b[6];b3=b[7];out[4]=b0*a00+b1*a10+b2*a20+b3*a30;out[5]=b0*a01+b1*a11+b2*a21+b3*a31;out[6]=b0*a02+b1*a12+b2*a22+b3*a32;out[7]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[8];b1=b[9];b2=b[10];b3=b[11];out[8]=b0*a00+b1*a10+b2*a20+b3*a30;out[9]=b0*a01+b1*a11+b2*a21+b3*a31;out[10]=b0*a02+b1*a12+b2*a22+b3*a32;out[11]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[12];b1=b[13];b2=b[14];b3=b[15];out[12]=b0*a00+b1*a10+b2*a20+b3*a30;out[13]=b0*a01+b1*a11+b2*a21+b3*a31;out[14]=b0*a02+b1*a12+b2*a22+b3*a32;out[15]=b0*a03+b1*a13+b2*a23+b3*a33;return out}},{}],419:[function(require,module,exports){module.exports=rotate;function rotate(out,a,rad,axis){var x=axis[0],y=axis[1],z=axis[2],len=Math.sqrt(x*x+y*y+z*z),s,c,t,a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,b00,b01,b02,b10,b11,b12,b20,b21,b22;if(Math.abs(len)<1e-6){return null}len=1/len;x*=len;y*=len;z*=len;s=Math.sin(rad);c=Math.cos(rad);t=1-c;a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];b00=x*x*t+c;b01=y*x*t+z*s;b02=z*x*t-y*s;b10=x*y*t-z*s;b11=y*y*t+c;b12=z*y*t+x*s;b20=x*z*t+y*s;b21=y*z*t-x*s;b22=z*z*t+c;out[0]=a00*b00+a10*b01+a20*b02;out[1]=a01*b00+a11*b01+a21*b02;out[2]=a02*b00+a12*b01+a22*b02;out[3]=a03*b00+a13*b01+a23*b02;out[4]=a00*b10+a10*b11+a20*b12;out[5]=a01*b10+a11*b11+a21*b12;out[6]=a02*b10+a12*b11+a22*b12;out[7]=a03*b10+a13*b11+a23*b12;out[8]=a00*b20+a10*b21+a20*b22;out[9]=a01*b20+a11*b21+a21*b22;out[10]=a02*b20+a12*b21+a22*b22;out[11]=a03*b20+a13*b21+a23*b22;if(a!==out){out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}return out}},{}],420:[function(require,module,exports){module.exports=rotateX;function rotateX(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];if(a!==out){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[4]=a10*c+a20*s;out[5]=a11*c+a21*s;out[6]=a12*c+a22*s;out[7]=a13*c+a23*s;out[8]=a20*c-a10*s;out[9]=a21*c-a11*s;out[10]=a22*c-a12*s;out[11]=a23*c-a13*s;return out}},{}],421:[function(require,module,exports){module.exports=rotateY;function rotateY(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];if(a!==out){out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[0]=a00*c-a20*s;out[1]=a01*c-a21*s;out[2]=a02*c-a22*s;out[3]=a03*c-a23*s;out[8]=a00*s+a20*c;out[9]=a01*s+a21*c;out[10]=a02*s+a22*c;out[11]=a03*s+a23*c;return out}},{}],422:[function(require,module,exports){module.exports=rotateZ;function rotateZ(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];if(a!==out){out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[0]=a00*c+a10*s;out[1]=a01*c+a11*s;out[2]=a02*c+a12*s;out[3]=a03*c+a13*s;out[4]=a10*c-a00*s;out[5]=a11*c-a01*s;out[6]=a12*c-a02*s;out[7]=a13*c-a03*s;return out}},{}],423:[function(require,module,exports){module.exports=scale;function scale(out,a,v){var x=v[0],y=v[1],z=v[2];out[0]=a[0]*x;out[1]=a[1]*x;out[2]=a[2]*x;out[3]=a[3]*x;out[4]=a[4]*y;out[5]=a[5]*y;out[6]=a[6]*y;out[7]=a[7]*y;out[8]=a[8]*z;out[9]=a[9]*z;out[10]=a[10]*z;out[11]=a[11]*z;out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out}},{}],424:[function(require,module,exports){module.exports=translate;function translate(out,a,v){var x=v[0],y=v[1],z=v[2],a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23;if(a===out){out[12]=a[0]*x+a[4]*y+a[8]*z+a[12];out[13]=a[1]*x+a[5]*y+a[9]*z+a[13];out[14]=a[2]*x+a[6]*y+a[10]*z+a[14];out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]}else{a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];out[0]=a00;out[1]=a01;out[2]=a02;out[3]=a03;out[4]=a10;out[5]=a11;out[6]=a12;out[7]=a13;out[8]=a20;out[9]=a21;out[10]=a22;out[11]=a23;out[12]=a00*x+a10*y+a20*z+a[12];out[13]=a01*x+a11*y+a21*z+a[13];out[14]=a02*x+a12*y+a22*z+a[14];out[15]=a03*x+a13*y+a23*z+a[15]}return out}},{}],425:[function(require,module,exports){module.exports=transpose;function transpose(out,a){if(out===a){var a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a01;out[6]=a[9];out[7]=a[13];out[8]=a02;out[9]=a12;out[11]=a[14];out[12]=a03;out[13]=a13;out[14]=a23}else{out[0]=a[0];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a[1];out[5]=a[5];out[6]=a[9];out[7]=a[13];out[8]=a[2];out[9]=a[6];out[10]=a[10];out[11]=a[14];out[12]=a[3];out[13]=a[7];out[14]=a[11];out[15]=a[15]}return out}},{}],426:[function(require,module,exports){"use strict";module.exports=createAttributeWrapper;function ShaderAttribute(gl,program,location,dimension,name,constFunc,relink){this._gl=gl;this._program=program;this._location=location;this._dimension=dimension;this._name=name;this._constFunc=constFunc;this._relink=relink}var proto=ShaderAttribute.prototype;proto.pointer=function setAttribPointer(type,normalized,stride,offset){var gl=this._gl;gl.vertexAttribPointer(this._location,this._dimension,type||gl.FLOAT,!!normalized,stride||0,offset||0);this._gl.enableVertexAttribArray(this._location)};Object.defineProperty(proto,"location",{get:function(){return this._location},set:function(v){if(v!==this._location){this._location=v;this._gl.bindAttribLocation(this._program,v,this._name);this._gl.linkProgram(this._program);this._relink()}}});function addVectorAttribute(gl,program,location,dimension,obj,name,doLink){var constFuncArgs=["gl","v"];var varNames=[];for(var i=0;i<dimension;++i){constFuncArgs.push("x"+i);varNames.push("x"+i)}constFuncArgs.push(["if(x0.length===void 0){return gl.vertexAttrib",dimension,"f(v,",varNames.join(),")}else{return gl.vertexAttrib",dimension,"fv(v,x0)}"].join(""));var constFunc=Function.apply(undefined,constFuncArgs);var attr=new ShaderAttribute(gl,program,location,dimension,name,constFunc,doLink);Object.defineProperty(obj,name,{set:function(x){gl.disableVertexAttribArray(attr._location);constFunc(gl,attr._location,x);return x},get:function(){return attr},enumerable:true})}function createAttributeWrapper(gl,program,attributes,doLink){var obj={};for(var i=0,n=attributes.length;i<n;++i){var a=attributes[i];var name=a.name;var type=a.type;var location=gl.getAttribLocation(program,name);switch(type){case"bool":case"int":case"float":addVectorAttribute(gl,program,location,1,obj,name,doLink);break;default:if(type.indexOf("vec")>=0){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid data type for attribute "+name+": "+type)}addVectorAttribute(gl,program,location,d,obj,name,doLink)}else{throw new Error("gl-shader: Unknown data type for attribute "+name+": "+type)}break}}return obj}},{}],427:[function(require,module,exports){"use strict";var dup=require("dup");var coallesceUniforms=require("./reflect");module.exports=createUniformWrapper;function identity(x){var c=new Function("y","return function(){return y}");return c(x)}function createUniformWrapper(gl,program,uniforms,locations){function makeGetter(index){var proc=new Function("gl","prog","locations","return function(){return gl.getUniform(prog,locations["+index+"])}");return proc(gl,program,locations)}function makePropSetter(path,index,type){switch(type){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+index+"],obj"+path+")";case"float":return"gl.uniform1f(locations["+index+"],obj"+path+")";default:var vidx=type.indexOf("vec");if(0<=vidx&&vidx<=1&&type.length===4+vidx){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid data type")}switch(type.charAt(0)){case"b":case"i":return"gl.uniform"+d+"iv(locations["+index+"],obj"+path+")";case"v":return"gl.uniform"+d+"fv(locations["+index+"],obj"+path+")";default:throw new Error("gl-shader: Unrecognized data type for vector "+name+": "+type)}}else if(type.indexOf("mat")===0&&type.length===4){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+type)}return"gl.uniformMatrix"+d+"fv(locations["+index+"],false,obj"+path+")"}else{throw new Error("gl-shader: Unknown uniform data type for "+name+": "+type)}break}}function enumerateIndices(prefix,type){if(typeof type!=="object"){return[[prefix,type]]}var indices=[];for(var id in type){var prop=type[id];var tprefix=prefix;if(parseInt(id)+""===id){tprefix+="["+id+"]"}else{tprefix+="."+id}if(typeof prop==="object"){indices.push.apply(indices,enumerateIndices(tprefix,prop))}else{indices.push([tprefix,prop])}}return indices}function makeSetter(type){var code=["return function updateProperty(obj){"];var indices=enumerateIndices("",type);for(var i=0;i<indices.length;++i){var item=indices[i];var path=item[0];var idx=item[1];if(locations[idx]){code.push(makePropSetter(path,idx,uniforms[idx].type))}}code.push("return obj}");var proc=new Function("gl","prog","locations",code.join("\n"));return proc(gl,program,locations)}function defaultValue(type){switch(type){case"bool":return false;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var vidx=type.indexOf("vec");if(0<=vidx&&vidx<=1&&type.length===4+vidx){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid data type")}if(type.charAt(0)==="b"){return dup(d,false)}return dup(d)}else if(type.indexOf("mat")===0&&type.length===4){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+type)}return dup([d,d])}else{throw new Error("gl-shader: Unknown uniform data type for "+name+": "+type)}break}}function storeProperty(obj,prop,type){if(typeof type==="object"){var child=processObject(type);Object.defineProperty(obj,prop,{get:identity(child),set:makeSetter(type),enumerable:true,configurable:false})}else{if(locations[type]){Object.defineProperty(obj,prop,{get:makeGetter(type),set:makeSetter(type),enumerable:true,configurable:false})}else{obj[prop]=defaultValue(uniforms[type].type)}}}function processObject(obj){var result;if(Array.isArray(obj)){result=new Array(obj.length);for(var i=0;i<obj.length;++i){storeProperty(result,i,obj[i])}}else{result={};for(var id in obj){storeProperty(result,id,obj[id])}}return result}var coallesced=coallesceUniforms(uniforms,true);return{get:identity(processObject(coallesced)),set:makeSetter(coallesced),enumerable:true,configurable:true}}},{"./reflect":428,dup:411}],428:[function(require,module,exports){"use strict";module.exports=makeReflectTypes;function makeReflectTypes(uniforms,useIndex){var obj={};for(var i=0;i<uniforms.length;++i){var n=uniforms[i].name;var parts=n.split(".");var o=obj;for(var j=0;j<parts.length;++j){var x=parts[j].split("[");if(x.length>1){if(!(x[0]in o)){o[x[0]]=[]}o=o[x[0]];for(var k=1;k<x.length;++k){var y=parseInt(x[k]);if(k<x.length-1||j<parts.length-1){if(!(y in o)){if(k<x.length-1){o[y]=[]}else{o[y]={}}}o=o[y]}else{if(useIndex){o[y]=i}else{o[y]=uniforms[i].type}}}}else if(j<parts.length-1){if(!(x[0]in o)){o[x[0]]={}}o=o[x[0]]}else{if(useIndex){o[x[0]]=i}else{o[x[0]]=uniforms[i].type}}}}return obj}},{}],429:[function(require,module,exports){"use strict";var createUniformWrapper=require("./lib/create-uniforms");var createAttributeWrapper=require("./lib/create-attributes");var makeReflect=require("./lib/reflect");function Shader(gl,prog,vertShader,fragShader){this.gl=gl;this.handle=prog;this.attributes=null;this.uniforms=null;this.types=null;this.vertexShader=vertShader;this.fragmentShader=fragShader}Shader.prototype.bind=function(){this.gl.useProgram(this.handle)};Shader.prototype.dispose=function(){var gl=this.gl;gl.deleteShader(this.vertexShader);gl.deleteShader(this.fragmentShader);gl.deleteProgram(this.handle)};Shader.prototype.updateExports=function(uniforms,attributes){var locations=new Array(uniforms.length);var program=this.handle;var gl=this.gl;var doLink=relinkUniforms.bind(void 0,gl,program,locations,uniforms);doLink();this.types={uniforms:makeReflect(uniforms),attributes:makeReflect(attributes)};this.attributes=createAttributeWrapper(gl,program,attributes,doLink);Object.defineProperty(this,"uniforms",createUniformWrapper(gl,program,uniforms,locations))};function relinkUniforms(gl,program,locations,uniforms){for(var i=0;i<uniforms.length;++i){locations[i]=gl.getUniformLocation(program,uniforms[i].name)}}function createShader(gl,vertSource,fragSource,uniforms,attributes){var vertShader=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(vertShader,vertSource);gl.compileShader(vertShader);if(!gl.getShaderParameter(vertShader,gl.COMPILE_STATUS)){var errLog=gl.getShaderInfoLog(vertShader);console.error("gl-shader: Error compling vertex shader:",errLog);throw new Error("gl-shader: Error compiling vertex shader:"+errLog)}var fragShader=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(fragShader,fragSource);gl.compileShader(fragShader);if(!gl.getShaderParameter(fragShader,gl.COMPILE_STATUS)){var errLog=gl.getShaderInfoLog(fragShader);console.error("gl-shader: Error compiling fragment shader:",errLog);throw new Error("gl-shader: Error compiling fragment shader:"+errLog)}var program=gl.createProgram();gl.attachShader(program,fragShader);gl.attachShader(program,vertShader);attributes.forEach(function(a){if(typeof a.location==="number")gl.bindAttribLocation(program,a.location,a.name)});gl.linkProgram(program);if(!gl.getProgramParameter(program,gl.LINK_STATUS)){var errLog=gl.getProgramInfoLog(program);console.error("gl-shader: Error linking shader program:",errLog);throw new Error("gl-shader: Error linking shader program:"+errLog)}var shader=new Shader(gl,program,vertShader,fragShader);shader.updateExports(uniforms,attributes);return shader}module.exports=createShader},{"./lib/create-attributes":426,"./lib/create-uniforms":427,"./lib/reflect":428}],430:[function(require,module,exports){"use strict";function doBind(gl,elements,attributes){if(elements){elements.bind()}else{gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null)}var nattribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS)|0;if(attributes){if(attributes.length>nattribs){throw new Error("gl-vao: Too many vertex attributes")}for(var i=0;i<attributes.length;++i){var attrib=attributes[i];if(attrib.buffer){var buffer=attrib.buffer;var size=attrib.size||4;var type=attrib.type||gl.FLOAT;var normalized=!!attrib.normalized;var stride=attrib.stride||0;var offset=attrib.offset||0;buffer.bind();gl.enableVertexAttribArray(i);gl.vertexAttribPointer(i,size,type,normalized,stride,offset)}else{if(typeof attrib==="number"){gl.vertexAttrib1f(i,attrib)}else if(attrib.length===1){gl.vertexAttrib1f(i,attrib[0])}else if(attrib.length===2){gl.vertexAttrib2f(i,attrib[0],attrib[1])}else if(attrib.length===3){gl.vertexAttrib3f(i,attrib[0],attrib[1],attrib[2])}else if(attrib.length===4){gl.vertexAttrib4f(i,attrib[0],attrib[1],attrib[2],attrib[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}gl.disableVertexAttribArray(i)}}for(;i<nattribs;++i){gl.disableVertexAttribArray(i)}}else{gl.bindBuffer(gl.ARRAY_BUFFER,null);for(var i=0;i<nattribs;++i){gl.disableVertexAttribArray(i)}}}module.exports=doBind},{}],431:[function(require,module,exports){"use strict";var bindAttribs=require("./do-bind.js");function VAOEmulated(gl){this.gl=gl;this._elements=null;this._attributes=null;this._elementsType=gl.UNSIGNED_SHORT}VAOEmulated.prototype.bind=function(){bindAttribs(this.gl,this._elements,this._attributes)};VAOEmulated.prototype.update=function(attributes,elements,elementsType){this._elements=elements;this._attributes=attributes;this._elementsType=elementsType||this.gl.UNSIGNED_SHORT};VAOEmulated.prototype.dispose=function(){};VAOEmulated.prototype.unbind=function(){};VAOEmulated.prototype.draw=function(mode,count,offset){offset=offset||0;var gl=this.gl;if(this._elements){gl.drawElements(mode,count,this._elementsType,offset)}else{gl.drawArrays(mode,offset,count)}};function createVAOEmulated(gl){return new VAOEmulated(gl)}module.exports=createVAOEmulated},{"./do-bind.js":430}],432:[function(require,module,exports){"use strict";var bindAttribs=require("./do-bind.js");function VertexAttribute(location,dimension,a,b,c,d){this.location=location;this.dimension=dimension;this.a=a;this.b=b;this.c=c;this.d=d}VertexAttribute.prototype.bind=function(gl){switch(this.dimension){case 1:gl.vertexAttrib1f(this.location,this.a);break;case 2:gl.vertexAttrib2f(this.location,this.a,this.b);break;case 3:gl.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:gl.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function VAONative(gl,ext,handle){this.gl=gl;this._ext=ext;this.handle=handle;this._attribs=[];this._useElements=false;this._elementsType=gl.UNSIGNED_SHORT}VAONative.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var i=0;i<this._attribs.length;++i){this._attribs[i].bind(this.gl)}};VAONative.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};VAONative.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};VAONative.prototype.update=function(attributes,elements,elementsType){this.bind();bindAttribs(this.gl,elements,attributes);this.unbind();this._attribs.length=0;if(attributes)for(var i=0;i<attributes.length;++i){var a=attributes[i];if(typeof a==="number"){this._attribs.push(new VertexAttribute(i,1,a))}else if(Array.isArray(a)){this._attribs.push(new VertexAttribute(i,a.length,a[0],a[1],a[2],a[3]))}}this._useElements=!!elements;this._elementsType=elementsType||this.gl.UNSIGNED_SHORT};VAONative.prototype.draw=function(mode,count,offset){offset=offset||0;var gl=this.gl;if(this._useElements){gl.drawElements(mode,count,this._elementsType,offset)}else{gl.drawArrays(mode,offset,count)}};function createVAONative(gl,ext){return new VAONative(gl,ext,ext.createVertexArrayOES())}module.exports=createVAONative},{"./do-bind.js":430}],433:[function(require,module,exports){"use strict";var createVAONative=require("./lib/vao-native.js");var createVAOEmulated=require("./lib/vao-emulated.js");function ExtensionShim(gl){this.bindVertexArrayOES=gl.bindVertexArray.bind(gl);this.createVertexArrayOES=gl.createVertexArray.bind(gl);this.deleteVertexArrayOES=gl.deleteVertexArray.bind(gl)}function createVAO(gl,attributes,elements,elementsType){var ext=gl.createVertexArray?new ExtensionShim(gl):gl.getExtension("OES_vertex_array_object");var vao;if(ext){vao=createVAONative(gl,ext)}else{vao=createVAOEmulated(gl)}vao.update(attributes,elements,elementsType);return vao}module.exports=createVAO},{"./lib/vao-emulated.js":431,"./lib/vao-native.js":432}],434:[function(require,module,exports){module.exports=create;function create(){var out=new Float32Array(3);out[0]=0;out[1]=0;out[2]=0;return out}},{}],435:[function(require,module,exports){module.exports=cross;function cross(out,a,b){var ax=a[0],ay=a[1],az=a[2],bx=b[0],by=b[1],bz=b[2];out[0]=ay*bz-az*by;out[1]=az*bx-ax*bz;out[2]=ax*by-ay*bx;return out}},{}],436:[function(require,module,exports){module.exports=dot;function dot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}},{}],437:[function(require,module,exports){module.exports=fromValues;function fromValues(x,y,z){var out=new Float32Array(3);out[0]=x;out[1]=y;out[2]=z;return out}},{}],438:[function(require,module,exports){module.exports=length;function length(a){var x=a[0],y=a[1],z=a[2];return Math.sqrt(x*x+y*y+z*z)}},{}],439:[function(require,module,exports){module.exports=normalize;function normalize(out,a){var x=a[0],y=a[1],z=a[2];var len=x*x+y*y+z*z;if(len>0){len=1/Math.sqrt(len);out[0]=a[0]*len;out[1]=a[1]*len;out[2]=a[2]*len}return out}},{}],440:[function(require,module,exports){module.exports=create;function create(){var out=new Float32Array(4);out[0]=0;out[1]=0;out[2]=0;out[3]=0;return out}},{}],441:[function(require,module,exports){module.exports=fromValues;function fromValues(x,y,z,w){var out=new Float32Array(4);out[0]=x;out[1]=y;out[2]=z;out[3]=w;return out}},{}],442:[function(require,module,exports){module.exports=transformMat4;function transformMat4(out,a,m){var x=a[0],y=a[1],z=a[2],w=a[3];out[0]=m[0]*x+m[4]*y+m[8]*z+m[12]*w;out[1]=m[1]*x+m[5]*y+m[9]*z+m[13]*w;out[2]=m[2]*x+m[6]*y+m[10]*z+m[14]*w;out[3]=m[3]*x+m[7]*y+m[11]*z+m[15]*w;return out}},{}],443:[function(require,module,exports){"use strict";function iota(n){var result=new Array(n);for(var i=0;i<n;++i){result[i]=i}return result}module.exports=iota},{}],444:[function(require,module,exports){module.exports=function(obj){return obj!=null&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)};function isBuffer(obj){return!!obj.constructor&&typeof obj.constructor.isBuffer==="function"&&obj.constructor.isBuffer(obj)}function isSlowBuffer(obj){return typeof obj.readFloatLE==="function"&&typeof obj.slice==="function"&&isBuffer(obj.slice(0,0))}},{}],445:[function(require,module,exports){"use strict";var compile=require("cwise-compiler");var EmptyProc={body:"",args:[],thisVars:[],localVars:[]};function fixup(x){if(!x){return EmptyProc}for(var i=0;i<x.args.length;++i){var a=x.args[i];if(i===0){x.args[i]={name:a,lvalue:true,rvalue:!!x.rvalue,count:x.count||1}}else{x.args[i]={name:a,lvalue:false,rvalue:true,count:1}}}if(!x.thisVars){x.thisVars=[]}if(!x.localVars){x.localVars=[]}return x}function pcompile(user_args){return compile({args:user_args.args,pre:fixup(user_args.pre),body:fixup(user_args.body),post:fixup(user_args.proc),funcName:user_args.funcName})}function makeOp(user_args){var args=[];for(var i=0;i<user_args.args.length;++i){args.push("a"+i)}var wrapper=new Function("P",["return function ",user_args.funcName,"_ndarrayops(",args.join(","),") {P(",args.join(","),");return a0}"].join(""));return wrapper(pcompile(user_args))}var assign_ops={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var id in assign_ops){var op=assign_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id});exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a"+op+"=b"},rvalue:true,funcName:id+"eq"});exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"});exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a"+op+"=s"},rvalue:true,funcName:id+"seq"})}})();var unary_ops={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var id in unary_ops){var op=unary_ops[id];exports[id]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a="+op+"b"},funcName:id});exports[id+"eq"]=makeOp({args:["array"],body:{args:["a"],body:"a="+op+"a"},rvalue:true,count:2,funcName:id+"eq"})}})();var binary_ops={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var id in binary_ops){var op=binary_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id});exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"});exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=a"+op+"b"},rvalue:true,count:2,funcName:id+"eq"});exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+op+"s"},rvalue:true,count:2,funcName:id+"seq"})}})();var math_unary=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var i=0;i<math_unary.length;++i){var f=math_unary[i];exports[f]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:f});exports[f+"eq"]=makeOp({args:["array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"eq"})}})();var math_comm=["max","min","atan2","pow"];(function(){for(var i=0;i<math_comm.length;++i){var f=math_comm[i];exports[f]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f});exports[f+"s"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f+"s"});exports[f+"eq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"eq"});exports[f+"seq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"seq"})}})();var math_noncomm=["atan2","pow"];(function(){for(var i=0;i<math_noncomm.length;++i){var f=math_noncomm[i];exports[f+"op"]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"op"});exports[f+"ops"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"ops"});exports[f+"opeq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"opeq"});exports[f+"opseq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"opseq"})}})();exports.any=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});exports.all=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});exports.sum=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});exports.prod=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});exports.norm2squared=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});exports.norm2=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});exports.norminf=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});exports.norm1=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});exports.sup=compile({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});exports.inf=compile({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});exports.argmin=compile({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});exports.argmax=compile({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});exports.random=makeOp({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});exports.assign=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});exports.assigns=makeOp({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});exports.equals=compile({args:["array","array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1},{name:"y",lvalue:false,rvalue:true,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":408}],446:[function(require,module,exports){var iota=require("iota-array");var isBuffer=require("is-buffer");var hasTypedArrays=typeof Float64Array!=="undefined";function compare1st(a,b){return a[0]-b[0]}function order(){var stride=this.stride;var terms=new Array(stride.length);var i;for(i=0;i<terms.length;++i){terms[i]=[Math.abs(stride[i]),i]}terms.sort(compare1st);var result=new Array(terms.length);for(i=0;i<result.length;++i){result[i]=terms[i][1]}return result}function compileConstructor(dtype,dimension){var className=["View",dimension,"d",dtype].join("");if(dimension<0){className="View_Nil"+dtype}var useGetters=dtype==="generic";if(dimension===-1){var code="function "+className+"(a){this.data=a;};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+className+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+className+"(a){return new "+className+"(a);}";var procedure=new Function(code);return procedure()}else if(dimension===0){var code="function "+className+"(a,d) {this.data = a;this.offset = d};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+className+"_copy() {return new "+className+"(this.data,this.offset)};proto.pick=function "+className+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+className+"_get(){return "+(useGetters?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+className+"_set(v){return "+(useGetters?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+className+"(a,b,c,d){return new "+className+"(a,d)}";var procedure=new Function("TrivialArray",code);return procedure(CACHED_CONSTRUCTORS[dtype][0])}var code=["'use strict'"];var indices=iota(dimension);var args=indices.map(function(i){return"i"+i});var index_str="this.offset+"+indices.map(function(i){return"this.stride["+i+"]*i"+i}).join("+");var shapeArg=indices.map(function(i){return"b"+i}).join(",");var strideArg=indices.map(function(i){return"c"+i}).join(",");code.push("function "+className+"(a,"+shapeArg+","+strideArg+",d){this.data=a","this.shape=["+shapeArg+"]","this.stride=["+strideArg+"]","this.offset=d|0}","var proto="+className+".prototype","proto.dtype='"+dtype+"'","proto.dimension="+dimension);code.push("Object.defineProperty(proto,'size',{get:function "+className+"_size(){return "+indices.map(function(i){return"this.shape["+i+"]"}).join("*"),"}})");if(dimension===1){code.push("proto.order=[0]")}else{code.push("Object.defineProperty(proto,'order',{get:");if(dimension<4){code.push("function "+className+"_order(){");if(dimension===2){code.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})")}else if(dimension===3){code.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")}}else{code.push("ORDER})")}}code.push("proto.set=function "+className+"_set("+args.join(",")+",v){");if(useGetters){code.push("return this.data.set("+index_str+",v)}")}else{code.push("return this.data["+index_str+"]=v}")}code.push("proto.get=function "+className+"_get("+args.join(",")+"){");if(useGetters){code.push("return this.data.get("+index_str+")}")}else{code.push("return this.data["+index_str+"]}")}code.push("proto.index=function "+className+"_index(",args.join(),"){return "+index_str+"}");code.push("proto.hi=function "+className+"_hi("+args.join(",")+"){return new "+className+"(this.data,"+indices.map(function(i){return["(typeof i",i,"!=='number'||i",i,"<0)?this.shape[",i,"]:i",i,"|0"].join("")}).join(",")+","+indices.map(function(i){return"this.stride["+i+"]"}).join(",")+",this.offset)}");var a_vars=indices.map(function(i){return"a"+i+"=this.shape["+i+"]"});var c_vars=indices.map(function(i){return"c"+i+"=this.stride["+i+"]"});code.push("proto.lo=function "+className+"_lo("+args.join(",")+"){var b=this.offset,d=0,"+a_vars.join(",")+","+c_vars.join(","));for(var i=0;i<dimension;++i){code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){d=i"+i+"|0;b+=c"+i+"*d;a"+i+"-=d}")}code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"c"+i}).join(",")+",b)}");code.push("proto.step=function "+className+"_step("+args.join(",")+"){var "+indices.map(function(i){return"a"+i+"=this.shape["+i+"]"}).join(",")+","+indices.map(function(i){return"b"+i+"=this.stride["+i+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var i=0;i<dimension;++i){code.push("if(typeof i"+i+"==='number'){d=i"+i+"|0;if(d<0){c+=b"+i+"*(a"+i+"-1);a"+i+"=ceil(-a"+i+"/d)}else{a"+i+"=ceil(a"+i+"/d)}b"+i+"*=d}")}code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"b"+i}).join(",")+",c)}");var tShape=new Array(dimension);var tStride=new Array(dimension);for(var i=0;i<dimension;++i){tShape[i]="a[i"+i+"]";tStride[i]="b[i"+i+"]"}code.push("proto.transpose=function "+className+"_transpose("+args+"){"+args.map(function(n,idx){return n+"=("+n+"===undefined?"+idx+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+className+"(this.data,"+tShape.join(",")+","+tStride.join(",")+",this.offset)}");code.push("proto.pick=function "+className+"_pick("+args+"){var a=[],b=[],c=this.offset");for(var i=0;i<dimension;++i){code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){c=(c+this.stride["+i+"]*i"+i+")|0}else{a.push(this.shape["+i+"]);b.push(this.stride["+i+"])}")}code.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");code.push("return function construct_"+className+"(data,shape,stride,offset){return new "+className+"(data,"+indices.map(function(i){return"shape["+i+"]"}).join(",")+","+indices.map(function(i){return"stride["+i+"]"}).join(",")+",offset)}");var procedure=new Function("CTOR_LIST","ORDER",code.join("\n"));return procedure(CACHED_CONSTRUCTORS[dtype],order)}function arrayDType(data){if(isBuffer(data)){return"buffer"}if(hasTypedArrays){switch(Object.prototype.toString.call(data)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}}if(Array.isArray(data)){return"array"}return"generic"}var CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var id in CACHED_CONSTRUCTORS){CACHED_CONSTRUCTORS[id].push(compileConstructor(id,-1))}});function wrappedNDArrayCtor(data,shape,stride,offset){if(data===undefined){var ctor=CACHED_CONSTRUCTORS.array[0];return ctor([])}else if(typeof data==="number"){data=[data]}if(shape===undefined){shape=[data.length]}var d=shape.length;if(stride===undefined){stride=new Array(d);for(var i=d-1,sz=1;i>=0;--i){stride[i]=sz;sz*=shape[i]}}if(offset===undefined){offset=0;for(var i=0;i<d;++i){if(stride[i]<0){offset-=(shape[i]-1)*stride[i]}}}var dtype=arrayDType(data);var ctor_list=CACHED_CONSTRUCTORS[dtype];while(ctor_list.length<=d+1){ctor_list.push(compileConstructor(dtype,ctor_list.length-1))}var ctor=ctor_list[d+1];return ctor(data,shape,stride,offset)}module.exports=wrappedNDArrayCtor},{"iota-array":443,"is-buffer":444}],447:[function(require,module,exports){var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;var indexOf=typeof Array.prototype.indexOf==="function"?function(arr,el){return arr.indexOf(el)}:function(arr,el){for(var i=0;i<arr.length;i++){if(arr[i]===el)return i}return-1};var isArray=Array.isArray||function(arr){return toString.call(arr)=="[object Array]"};var objectKeys=Object.keys||function(obj){var ret=[];for(var key in obj){if(obj.hasOwnProperty(key)){ret.push(key)}}return ret};var forEach=typeof Array.prototype.forEach==="function"?function(arr,fn){return arr.forEach(fn)}:function(arr,fn){for(var i=0;i<arr.length;i++)fn(arr[i])};var reduce=function(arr,fn,initial){if(typeof arr.reduce==="function")return arr.reduce(fn,initial);var res=initial;for(var i=0;i<arr.length;i++)res=fn(res,arr[i]);return res};var isint=/^[0-9]+$/;function promote(parent,key){if(parent[key].length==0)return parent[key]={};var t={};for(var i in parent[key]){if(hasOwnProperty.call(parent[key],i)){t[i]=parent[key][i]}}parent[key]=t;return t}function parse(parts,parent,key,val){var part=parts.shift();if(hasOwnProperty.call(Object.prototype,key))return;if(!part){if(isArray(parent[key])){parent[key].push(val)}else if("object"==typeof parent[key]){parent[key]=val}else if("undefined"==typeof parent[key]){parent[key]=val}else{parent[key]=[parent[key],val]}}else{var obj=parent[key]=parent[key]||[];if("]"==part){if(isArray(obj)){if(""!=val)obj.push(val)}else if("object"==typeof obj){obj[objectKeys(obj).length]=val}else{obj=parent[key]=[parent[key],val]}}else if(~indexOf(part,"]")){part=part.substr(0,part.length-1);if(!isint.test(part)&&isArray(obj))obj=promote(parent,key);parse(parts,obj,part,val)}else{if(!isint.test(part)&&isArray(obj))obj=promote(parent,key);parse(parts,obj,part,val)}}}function merge(parent,key,val){if(~indexOf(key,"]")){var parts=key.split("["),len=parts.length,last=len-1;parse(parts,parent,"base",val)}else{if(!isint.test(key)&&isArray(parent.base)){var t={};for(var k in parent.base)t[k]=parent.base[k];parent.base=t}set(parent.base,key,val)}return parent}function compact(obj){if("object"!=typeof obj)return obj;if(isArray(obj)){var ret=[];for(var i in obj){if(hasOwnProperty.call(obj,i)){ret.push(obj[i])}}return ret}for(var key in obj){obj[key]=compact(obj[key])}return obj}function parseObject(obj){var ret={base:{}};forEach(objectKeys(obj),function(name){merge(ret,name,obj[name])});return compact(ret.base)}function parseString(str){var ret=reduce(String(str).split("&"),function(ret,pair){var eql=indexOf(pair,"="),brace=lastBraceInKey(pair),key=pair.substr(0,brace||eql),val=pair.substr(brace||eql,pair.length),val=val.substr(indexOf(val,"=")+1,val.length);if(""==key)key=pair,val="";if(""==key)return ret;return merge(ret,decode(key),decode(val))},{base:{}}).base;return compact(ret)}exports.parse=function(str){if(null==str||""==str)return{};return"object"==typeof str?parseObject(str):parseString(str)};var stringify=exports.stringify=function(obj,prefix){if(isArray(obj)){return stringifyArray(obj,prefix)}else if("[object Object]"==toString.call(obj)){return stringifyObject(obj,prefix)}else if("string"==typeof obj){return stringifyString(obj,prefix)}else{return prefix+"="+encodeURIComponent(String(obj))}};function stringifyString(str,prefix){if(!prefix)throw new TypeError("stringify expects an object");return prefix+"="+encodeURIComponent(str)}function stringifyArray(arr,prefix){var ret=[];if(!prefix)throw new TypeError("stringify expects an object");for(var i=0;i<arr.length;i++){ret.push(stringify(arr[i],prefix+"["+i+"]"))}return ret.join("&")}function stringifyObject(obj,prefix){var ret=[],keys=objectKeys(obj),key;for(var i=0,len=keys.length;i<len;++i){key=keys[i];if(""==key)continue;if(null==obj[key]){ret.push(encodeURIComponent(key)+"=")}else{ret.push(stringify(obj[key],prefix?prefix+"["+encodeURIComponent(key)+"]":encodeURIComponent(key)))}}return ret.join("&")}function set(obj,key,val){var v=obj[key];if(hasOwnProperty.call(Object.prototype,key))return;if(undefined===v){obj[key]=val}else if(isArray(v)){v.push(val)}else{obj[key]=[v,val]}}function lastBraceInKey(str){var len=str.length,brace,c;for(var i=0;i<len;++i){c=str[i];if("]"==c)brace=false;if("["==c)brace=true;if("="==c&&!brace)return i}}function decode(str){try{return decodeURIComponent(str.replace(/\+/g," "))}catch(err){return str}}},{}],448:[function(require,module,exports){(function(global,Buffer){"use strict";var bits=require("bit-twiddle");var dup=require("dup");if(!global.__TYPEDARRAY_POOL){global.__TYPEDARRAY_POOL={UINT8:dup([32,0]),UINT16:dup([32,0]),UINT32:dup([32,0]),INT8:dup([32,0]),INT16:dup([32,0]),INT32:dup([32,0]),FLOAT:dup([32,0]),DOUBLE:dup([32,0]),DATA:dup([32,0]),UINT8C:dup([32,0]),BUFFER:dup([32,0])}}var hasUint8C=typeof Uint8ClampedArray!=="undefined";var POOL=global.__TYPEDARRAY_POOL;if(!POOL.UINT8C){POOL.UINT8C=dup([32,0])}if(!POOL.BUFFER){POOL.BUFFER=dup([32,0])}var DATA=POOL.DATA,BUFFER=POOL.BUFFER;exports.free=function free(array){if(Buffer.isBuffer(array)){BUFFER[bits.log2(array.length)].push(array)}else{if(Object.prototype.toString.call(array)!=="[object ArrayBuffer]"){array=array.buffer}if(!array){return}var n=array.length||array.byteLength;var log_n=bits.log2(n)|0;DATA[log_n].push(array)}};function freeArrayBuffer(buffer){if(!buffer){return}var n=buffer.length||buffer.byteLength;var log_n=bits.log2(n);DATA[log_n].push(buffer)}function freeTypedArray(array){freeArrayBuffer(array.buffer)}exports.freeUint8=exports.freeUint16=exports.freeUint32=exports.freeInt8=exports.freeInt16=exports.freeInt32=exports.freeFloat32=exports.freeFloat=exports.freeFloat64=exports.freeDouble=exports.freeUint8Clamped=exports.freeDataView=freeTypedArray;exports.freeArrayBuffer=freeArrayBuffer;exports.freeBuffer=function freeBuffer(array){BUFFER[bits.log2(array.length)].push(array)};exports.malloc=function malloc(n,dtype){if(dtype===undefined||dtype==="arraybuffer"){return mallocArrayBuffer(n)}else{switch(dtype){case"uint8":return mallocUint8(n);case"uint16":return mallocUint16(n);case"uint32":return mallocUint32(n);case"int8":return mallocInt8(n);case"int16":return mallocInt16(n);case"int32":return mallocInt32(n);case"float":case"float32":return mallocFloat(n);case"double":case"float64":return mallocDouble(n);case"uint8_clamped":return mallocUint8Clamped(n);case"buffer":return mallocBuffer(n);case"data":case"dataview":return mallocDataView(n);default:return null}}return null};function mallocArrayBuffer(n){var n=bits.nextPow2(n);var log_n=bits.log2(n);var d=DATA[log_n];if(d.length>0){return d.pop()}return new ArrayBuffer(n)}exports.mallocArrayBuffer=mallocArrayBuffer;function mallocUint8(n){return new Uint8Array(mallocArrayBuffer(n),0,n)}exports.mallocUint8=mallocUint8;function mallocUint16(n){return new Uint16Array(mallocArrayBuffer(2*n),0,n)}exports.mallocUint16=mallocUint16;function mallocUint32(n){return new Uint32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocUint32=mallocUint32;function mallocInt8(n){return new Int8Array(mallocArrayBuffer(n),0,n)}exports.mallocInt8=mallocInt8;function mallocInt16(n){return new Int16Array(mallocArrayBuffer(2*n),0,n)}exports.mallocInt16=mallocInt16;function mallocInt32(n){return new Int32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocInt32=mallocInt32;function mallocFloat(n){return new Float32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocFloat32=exports.mallocFloat=mallocFloat;function mallocDouble(n){return new Float64Array(mallocArrayBuffer(8*n),0,n)}exports.mallocFloat64=exports.mallocDouble=mallocDouble;function mallocUint8Clamped(n){if(hasUint8C){return new Uint8ClampedArray(mallocArrayBuffer(n),0,n)}else{return mallocUint8(n)}}exports.mallocUint8Clamped=mallocUint8Clamped;function mallocDataView(n){return new DataView(mallocArrayBuffer(n),0,n)}exports.mallocDataView=mallocDataView;function mallocBuffer(n){n=bits.nextPow2(n);var log_n=bits.log2(n);var cache=BUFFER[log_n];if(cache.length>0){return cache.pop()}return new Buffer(n)}exports.mallocBuffer=mallocBuffer;exports.clearCache=function clearCache(){for(var i=0;i<32;++i){POOL.UINT8[i].length=0;POOL.UINT16[i].length=0;POOL.UINT32[i].length=0;POOL.INT8[i].length=0;POOL.INT16[i].length=0;POOL.INT32[i].length=0;POOL.FLOAT[i].length=0;POOL.DOUBLE[i].length=0;POOL.UINT8C[i].length=0;DATA[i].length=0;BUFFER[i].length=0}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"bit-twiddle":407,buffer:170,dup:411}],449:[function(require,module,exports){"use strict";function unique_pred(list,compare){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i){b=a;a=list[i];if(compare(a,b)){if(i===ptr){ptr++;continue}list[ptr++]=a}}list.length=ptr;return list}function unique_eq(list){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i,b=a){b=a;a=list[i];if(a!==b){if(i===ptr){ptr++;continue}list[ptr++]=a}}list.length=ptr;return list}function unique(list,compare,sorted){if(list.length===0){return list}if(compare){if(!sorted){list.sort(compare)}return unique_pred(list,compare)}if(!sorted){list.sort()}return unique_eq(list)}module.exports=unique},{}],450:[function(require,module,exports){(function WeakMapModule(){"use strict";if(typeof ses!=="undefined"&&ses.ok&&!ses.ok()){return}function weakMapPermitHostObjects(map){if(map.permitHostObjects___){map.permitHostObjects___(weakMapPermitHostObjects)}}if(typeof ses!=="undefined"){ses.weakMapPermitHostObjects=weakMapPermitHostObjects}var doubleWeakMapCheckSilentFailure=false;if(typeof WeakMap==="function"){var HostWeakMap=WeakMap;if(typeof navigator!=="undefined"&&/Firefox/.test(navigator.userAgent)){}else{var testMap=new HostWeakMap;var testObject=Object.freeze({});testMap.set(testObject,1);if(testMap.get(testObject)!==1){doubleWeakMapCheckSilentFailure=true}else{module.exports=WeakMap;return}}}var hop=Object.prototype.hasOwnProperty;var gopn=Object.getOwnPropertyNames;var defProp=Object.defineProperty;var isExtensible=Object.isExtensible;var HIDDEN_NAME_PREFIX="weakmap:";var HIDDEN_NAME=HIDDEN_NAME_PREFIX+"ident:"+Math.random()+"___";if(typeof crypto!=="undefined"&&typeof crypto.getRandomValues==="function"&&typeof ArrayBuffer==="function"&&typeof Uint8Array==="function"){var ab=new ArrayBuffer(25);var u8s=new Uint8Array(ab);crypto.getRandomValues(u8s);HIDDEN_NAME=HIDDEN_NAME_PREFIX+"rand:"+Array.prototype.map.call(u8s,function(u8){return(u8%36).toString(36)}).join("")+"___"}function isNotHiddenName(name){return!(name.substr(0,HIDDEN_NAME_PREFIX.length)==HIDDEN_NAME_PREFIX&&name.substr(name.length-3)==="___")}defProp(Object,"getOwnPropertyNames",{value:function fakeGetOwnPropertyNames(obj){return gopn(obj).filter(isNotHiddenName)}});if("getPropertyNames"in Object){var originalGetPropertyNames=Object.getPropertyNames;defProp(Object,"getPropertyNames",{value:function fakeGetPropertyNames(obj){return originalGetPropertyNames(obj).filter(isNotHiddenName)}})}function getHiddenRecord(key){if(key!==Object(key)){throw new TypeError("Not an object: "+key)}var hiddenRecord=key[HIDDEN_NAME];if(hiddenRecord&&hiddenRecord.key===key){return hiddenRecord}if(!isExtensible(key)){return void 0}hiddenRecord={key:key};try{defProp(key,HIDDEN_NAME,{value:hiddenRecord,writable:false,enumerable:false,configurable:false});return hiddenRecord}catch(error){return void 0}}(function(){var oldFreeze=Object.freeze;defProp(Object,"freeze",{value:function identifyingFreeze(obj){getHiddenRecord(obj);return oldFreeze(obj)}});var oldSeal=Object.seal;defProp(Object,"seal",{value:function identifyingSeal(obj){getHiddenRecord(obj);return oldSeal(obj)}});var oldPreventExtensions=Object.preventExtensions;defProp(Object,"preventExtensions",{value:function identifyingPreventExtensions(obj){getHiddenRecord(obj);return oldPreventExtensions(obj)}})})();function constFunc(func){func.prototype=null;return Object.freeze(func)}var calledAsFunctionWarningDone=false;function calledAsFunctionWarning(){if(!calledAsFunctionWarningDone&&typeof console!=="undefined"){calledAsFunctionWarningDone=true;console.warn("WeakMap should be invoked as new WeakMap(), not "+"WeakMap(). This will be an error in the future.")}}var nextId=0;var OurWeakMap=function(){if(!(this instanceof OurWeakMap)){calledAsFunctionWarning()}var keys=[];var values=[];var id=nextId++;function get___(key,opt_default){var index;var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){return id in hiddenRecord?hiddenRecord[id]:opt_default}else{index=keys.indexOf(key);return index>=0?values[index]:opt_default}}function has___(key){var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){return id in hiddenRecord}else{return keys.indexOf(key)>=0}}function set___(key,value){var index;var hiddenRecord=getHiddenRecord(key);if(hiddenRecord){hiddenRecord[id]=value}else{index=keys.indexOf(key);if(index>=0){values[index]=value}else{index=keys.length;values[index]=value;keys[index]=key}}return this}function delete___(key){var hiddenRecord=getHiddenRecord(key);var index,lastIndex;if(hiddenRecord){return id in hiddenRecord&&delete hiddenRecord[id]}else{index=keys.indexOf(key);if(index<0){return false}lastIndex=keys.length-1;keys[index]=void 0;values[index]=values[lastIndex];keys[index]=keys[lastIndex];keys.length=lastIndex;values.length=lastIndex;return true}}return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(get___)},has___:{value:constFunc(has___)},set___:{value:constFunc(set___)},delete___:{value:constFunc(delete___)}})};OurWeakMap.prototype=Object.create(Object.prototype,{get:{value:function get(key,opt_default){return this.get___(key,opt_default)},writable:true,configurable:true},has:{value:function has(key){return this.has___(key)},writable:true,configurable:true},set:{value:function set(key,value){return this.set___(key,value)},writable:true,configurable:true},delete:{value:function remove(key){return this.delete___(key)},writable:true,configurable:true}});if(typeof HostWeakMap==="function"){(function(){if(doubleWeakMapCheckSilentFailure&&typeof Proxy!=="undefined"){Proxy=undefined}function DoubleWeakMap(){if(!(this instanceof OurWeakMap)){calledAsFunctionWarning()}var hmap=new HostWeakMap;var omap=undefined;var enableSwitching=false;function dget(key,opt_default){if(omap){return hmap.has(key)?hmap.get(key):omap.get___(key,opt_default)}else{return hmap.get(key,opt_default)}}function dhas(key){return hmap.has(key)||(omap?omap.has___(key):false)}var dset;if(doubleWeakMapCheckSilentFailure){dset=function(key,value){hmap.set(key,value);if(!hmap.has(key)){if(!omap){omap=new OurWeakMap}omap.set(key,value)}return this}}else{dset=function(key,value){if(enableSwitching){try{hmap.set(key,value)}catch(e){if(!omap){omap=new OurWeakMap}omap.set___(key,value)}}else{hmap.set(key,value)}return this}}function ddelete(key){var result=!!hmap["delete"](key);if(omap){return omap.delete___(key)||result}return result}return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(dget)},has___:{value:constFunc(dhas)},set___:{value:constFunc(dset)},delete___:{value:constFunc(ddelete)},permitHostObjects___:{value:constFunc(function(token){if(token===weakMapPermitHostObjects){enableSwitching=true}else{throw new Error("bogus call to permitHostObjects___")}})}})}DoubleWeakMap.prototype=OurWeakMap.prototype;module.exports=DoubleWeakMap;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:false,configurable:true,writable:true})})()}else{if(typeof Proxy!=="undefined"){Proxy=undefined}module.exports=OurWeakMap}})()},{}],451:[function(require,module,exports){"use strict";var ShaderPlayer=require("@marcom/ac-shader-player-2d").ShaderPlayer2D;var Clip=require("@marcom/ac-clip").Clip;var defaults=require("@marcom/ac-object/defaults");var getDimensions=require("@marcom/ac-dom-metrics/getDimensions");var ac_addEventListener=require("@marcom/ac-dom-events/utils/addEventListener");var Clock=require("@marcom/ac-clock").Clock;var fragmentShader="varying vec2 vUV;uniform float progress;uniform float angle;uniform vec4 fromColorStart;uniform vec4 fromColorEnd;uniform vec4 toColorStart;uniform vec4 toColorEnd;void main() {vec4 colorFrom = mix(fromColorStart, toColorStart, progress);\tvec4 colorTo = mix(fromColorEnd, toColorEnd, progress);float rad = radians(270.0 - angle);vec2 line = vec2(cos(rad), sin(rad));float gradient = dot(vUV * 2.0 - 1.0, line);gradient = clamp((gradient + 1.0) / 2.0, 0.0, 1.0);vec4 color = mix(colorTo, colorFrom, gradient);if (line.x == vUV.x) {color = vec4(1.0, 0.0, 1.0, 1.0);}gl_FragColor = color;}";var DEFAULT_OPTIONS={duration:1,ease:"ease",className:"gradientplayer",colorStart:"#fff",colorEnd:"#fff",angle:0,fragmentShader:fragmentShader};function GradientPlayer(el,options){this.el=el;this._options=defaults(DEFAULT_OPTIONS,options);this._initialize()}var proto=GradientPlayer.prototype;proto.transitionTo=function(colorStart,colorEnd){if(!this._initialized){this._options.colorStart=colorStart;this._options.colorEnd=colorEnd;return}if(this._clip.playing()){this._clip.pause();this._gradient.fromColorStart=this._lerpVec4(this._gradient.fromColorStart,this._gradient.toColorStart,this._progressTracker.progress);this._gradient.fromColorEnd=this._lerpVec4(this._gradient.fromColorEnd,this._gradient.toColorEnd,this._progressTracker.progress)}else{this._gradient.fromColorStart=this._gradient.toColorStart;this._gradient.fromColorEnd=this._gradient.toColorEnd}this._gradient.toColorStart=this._hexToVec4(colorStart);this._gradient.toColorEnd=this._hexToVec4(colorEnd);this._updateUniforms();this._clip.reset();this._clip.play()};proto._lerpVec4=function(start,end,ratio){var vec4=[];var i;for(i=0;i<4;i++){vec4[i]=start[i]+(end[i]-start[i])*ratio}return vec4};proto._initialize=function(){var colorStart=this._hexToVec4(this._options.colorStart);var colorEnd=this._hexToVec4(this._options.colorEnd);this._gradient={angle:this._options.angle,fromColorStart:colorStart,fromColorEnd:colorEnd,toColorStart:colorStart,toColorEnd:colorEnd};this._progressTracker={progress:0};this._onUpdate=this._onUpdate.bind(this);this._onDraw=this._onDraw.bind(this);this._clip=new Clip(this._progressTracker,this._options.duration,{progress:1},{ease:this._options.ease,onUpdate:this._onUpdate,onDraw:this._onDraw});this._initializeShaderPlayer();this._initialized=true};proto._initializeShaderPlayer=function(){this._updateSize();this._shader=new ShaderPlayer({sizes:{defaults:{width:this._size.width,height:this._size.height}},uniforms:{progress:{type:"float",value:0},angle:{type:"float",value:this._gradient.angle},fromColorStart:{type:"vec4",value:this._gradient.fromColorStart},fromColorEnd:{type:"vec4",value:this._gradient.fromColorEnd},toColorStart:{type:"vec4",value:this._gradient.toColorStart},toColorEnd:{type:"vec4",value:this._gradient.toColorEnd}},fragmentShader:this._options.fragmentShader,clock:new Clock});this.el.appendChild(this._shader.el);this._updateSize=this._updateSize.bind(this);ac_addEventListener(window,"resize",this._updateSize);ac_addEventListener(window,"orientationchange",this._updateSize);this._shader.render()};proto._updateSize=function(){var size=getDimensions(this.el,true);if(!this._size||this._size.width!==size.width||this._size.height!==size.height){this._size=size;if(this._shader){this._shader.setSize(this._size.width,this._size.height);this._shader.render()}}};proto._updateUniforms=function(){if(this._shader){this._shader.setUniform("progress",this._progressTracker.progress);this._shader.setUniform("fromColorStart",this._gradient.fromColorStart);this._shader.setUniform("fromColorEnd",this._gradient.fromColorEnd);this._shader.setUniform("toColorStart",this._gradient.toColorStart);this._shader.setUniform("toColorEnd",this._gradient.toColorEnd)}};proto._hexToVec4=function(hex){if(hex.length===4){hex=hex.replace(/([a-f\d])/gi,"$1$1")}var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);if(!result){return[0,0,0,1]}return[parseInt(result[1],16)/255,parseInt(result[2],16)/255,parseInt(result[3],16)/255,1]};proto._onUpdate=function(evt){this._shader.setUniform("progress",this._progressTracker.progress)};proto._onDraw=function(evt){this._shader.render()};module.exports=GradientPlayer},{"@marcom/ac-clip":25,"@marcom/ac-clock":27,"@marcom/ac-dom-events/utils/addEventListener":63,"@marcom/ac-dom-metrics/getDimensions":67,"@marcom/ac-object/defaults":187,"@marcom/ac-shader-player-2d":233}],452:[function(require,module,exports){if("performance"in window==false){window.performance={}}if("now"in window.performance==false){var nowOffset=Date.now();if(performance.timing&&performance.timing.navigationStart){nowOffset=performance.timing.navigationStart}window.performance.now=function now(){return Date.now()-nowOffset}}},{}],453:[function(require,module,exports){"use strict";var InteractiveGalleryModal=require("./interactive-gallery/InteractiveGalleryModal");var Main=function(){return{initialize:function(){var gallery=new InteractiveGalleryModal;return this}}}();module.exports=Main.initialize()},{"./interactive-gallery/InteractiveGalleryModal":457}],454:[function(require,module,exports){"use strict";function ClipGroup(clips,callback){this._clips=clips;this._clipCount=clips.length;this._callback=callback;this._finishedCount=0;this._onComplete=this._onComplete.bind(this);for(var i=0;i<this._clipCount;i++){this._clips[i].on("complete",this._onComplete)}}var proto=ClipGroup.prototype;proto.play=function(){for(var i=0;i<this._clipCount;i++){this._clips[i].play()}};proto.pause=function(){for(var i=0;i<this._clipCount;i++){this._clips[i].pause()}};proto.reset=function(){for(var i=0;i<this._clipCount;i++){this._clips[i].reset()}};proto.destroy=function(){for(var i=0;i<this._clipCount;i++){this._clips[i].destroy()}this._clips=null;this._callback=null;this._onComplete=null};proto._onComplete=function(){this._finishedCount++;if(this._finishedCount===this._clipCount&&this._callback){this._callback()}};module.exports=ClipGroup},{}],455:[function(require,module,exports){"use strict";var ac_objDefaults=require("@marcom/ac-object/defaults");var ac_querySelector=require("@marcom/ac-dom-traversal/querySelector");var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var ac_addEventListener=require("@marcom/ac-dom-events/utils/addEventListener");var ac_removeEventListener=require("@marcom/ac-dom-events/utils/removeEventListener");var ac_preventDefault=require("@marcom/ac-dom-events/preventDefault");var ac_modalBasicClassNames=require("@marcom/ac-modal-basic").classNames;var ac_modal=require("ac-modal");var addEventListenerToElements=require("./helpers/addEventListenerToElements");var stringTemplate=require("./helpers/stringTemplate");var getDefaultId=require("./helpers/getDefaultId");var setAttribute=require("./helpers/setAttribute");var getCombinationName=require("./helpers/getCombinationName");var getGalleryViewportEmitter=require("./galleryViewportEmitter");var Clip=require("@marcom/ac-eclipse").Clip;var getIsSplitView=require("./helpers/getIsSplitView");var ac_browser=require("@marcom/ac-browser");var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");var webGLAvailable=require("@marcom/ac-feature/webGLAvailable");var touchAvailable=require("@marcom/ac-feature/touchAvailable");var cssMaskAvailable=cssPropertyAvailable("mask-image","linear-gradient(#000, #fff)");var cssClipPathAvailable=!cssMaskAvailable&&ac_browser.name==="Firefox";var SUPPORTS_TRANSFORM=cssPropertyAvailable("transform");var isDesktop=require("@marcom/ac-feature/isDesktop");var performancePolyfill=require("../_shared/performancePolyfill");var Gallery=require("@marcom/ac-gallery").Gallery;var FadeGallery=require("@marcom/ac-gallery").FadeGallery;var InteractiveGalleryItem=require("./InteractiveGalleryItem");var WatchSlideGallery=require("./WatchSlideGallery");var WatchSlideGalleryItem=require("./WatchSlideGalleryItem");var WatchCase=require("./WatchCase");var WatchCasesGallery=require("./WatchCasesGallery");var WatchBandsGallery=require("./WatchBandsGallery");var update=require("@marcom/ac-raf-emitter/update");var external=require("@marcom/ac-raf-emitter/external");var draw=require("@marcom/ac-raf-emitter/draw");var IntroTextController=require("./IntroTextController");var galleryClock=require("./galleryClock");var GradientPlayer;try{GradientPlayer=require("../_shared/GradientPlayer")}catch(e){}var acAnalytics;try{acAnalytics=require("ac-analytics")}catch(e){}var WATCH_DEFAULTS=require("../../json/interactive-gallery/defaults");var DISABLE_ZOOM_TOKEN=", maximum-scale=1, user-scalable=0";var CASES="cases";var BANDS="bands";var GRADIENT_BACKGROUND_SUPPORTED=(cssMaskAvailable||cssClipPathAvailable)&&webGLAvailable();if(ac_browser.name==="Firefox"){GRADIENT_BACKGROUND_SUPPORTED=false}var GRADIENT_START_COLOR="#fafafa";var GRADIENT_END_COLOR="#f2f2f2";var GRADIENT_ANGLE=120;var CSS_SHOW_PANES_CLASS="show-panes";var CSS_BUY_BAND_UNAVAILABLE="band-unavailable";var PRODUCT_RED_SEARCH="(PRODUCT)RED";var PRODUCT_RED_REPLACEMENT='<span class="gallery-productred-logo">'+PRODUCT_RED_SEARCH+"</span>";var BAND_MASK_TYPES=[["nylon",["nylon"]],["nike-sport-loop",["nike-sport-loop"]],["nike",["nike"]],["link",["link"]],["milanese",["milanese"]],["modern-buckle",["modern-buckle"]],["classic-buckle",["classic-buckle"]],["singletour",["singletour"]],["doubletour",["doubletour"]],["doublebuckle",["doublebuckle"]],["sport-loop",["sport-loop"]],["sport",["sport","leather-loop"]],["rallye-hermes-singletour",["rallye-hermes-singletour"]]];var DEFAULT_SLIDE_GALLERY_OPTIONS={itemType:WatchSlideGalleryItem,wrapAround:true,desktopSwipe:true};var DEFAULT_OPTIONS={startZIndex:2,enableDeeplinking:true,updateGradientForCases:true,persistCaseGradientForBands:true,enableArrowKeys:false,touch:false,desktopSwipe:false};function WatchInteractiveGallery(options){options=ac_objDefaults(DEFAULT_OPTIONS,options);var el=ac_querySelector(".gallery-container");FadeGallery.call(this,el,options);this._enableDeeplinking=options.enableDeeplinking;this._updateGradientForCases=options.updateGradientForCases;this._persistCaseGradientForBands=options.persistCaseGradientForBands;this._initialPath=options.initialPath||window.location.hash;this._urlBasePath=options.urlBasePath||window.location.pathname;this._urlParams=window.location.search;this._urlHashPrefix=options.urlHashPrefix||"";this._ogImageQueryParameter=options.ogImageQueryParameter||"cid";this._isFBFrame=window.location.hash=="#fb"&&!isDesktop();this._isIE=document.documentElement.classList.contains("ie");this.userInteractionEnabled=true;this.transitioning=false;this._hasVisitedCases=false;this._hasVisitedBands=false;this._selectedCase=null;this._selectedBand=null;this._isIntroAnimationComplete=false;this._galleryReady=false;this._handleSplitViewResize=this._handleSplitViewResize.bind(this);this._viewportMeta=ac_querySelector("meta[name=viewport]");this._contentPaneEl=ac_querySelector(".gallery-content-pane");this._casesGalleryElement=ac_querySelector("#gallery-cases",this._el);this._bandsGalleryElement=ac_querySelector("#gallery-bands",this._el);this._caseSizeElement=ac_querySelector("#gallery-selected-case-size",this._el);this._modelSeriesNameElement=ac_querySelector("#gallery-selected-model-series-name",this._el);this._caseNameElement=ac_querySelector("#gallery-selected-case-name",this._el);this._bandNameElement=ac_querySelector("#gallery-selected-band-name",this._el);this._selectionContainer=ac_querySelector(".gallery-selected",this._el);this._selectedCopyContainer=ac_querySelector(".gallery-selected-copy-text",this._el);this._selectedCaseElement=ac_querySelector(".gallery-selected-case",this._el);this._selectedBandElement=ac_querySelector(".gallery-selected-band",this._el);this._maskedElements=ac_querySelectorAll("[data-masked]",this._el);this._buyModelLinkElement=ac_querySelector("#gallery-selected-buy-model",this._el);this._buyModelTooltipElement=ac_querySelector("#gallery-selected-buy-model-tooltip",this._el);this._buyBandLinkElement=ac_querySelector("#gallery-selected-buy-band",this._el);this._buyBandUnavailableCopyElement=ac_querySelector("#gallery-selected-buy-band-unavailable-copy",this._el);this._buyBandTooltipElement=ac_querySelector("#gallery-selected-buy-band-tooltip",this._el);this._ogTitle=this._el.getAttribute("data-share-title")||ac_querySelector('meta[property="og:title"]').getAttribute("content");this._ogDescription=this._el.getAttribute("data-share-description")||ac_querySelector('meta[property="og:description"]').getAttribute("content");this._copyLinkModal=null;this._galleryViewportEmitter=getGalleryViewportEmitter();this.strings={size:this._el.getAttribute("data-string-size"),bandName:this._el.getAttribute("data-string-band-name"),bandNameAdditional:this._el.getAttribute("data-string-band-name-additional")};GRADIENT_BACKGROUND_SUPPORTED=false;if(GRADIENT_BACKGROUND_SUPPORTED&&GradientPlayer){this.gradientPlayer=new GradientPlayer(this._el,{colorStart:GRADIENT_START_COLOR,colorEnd:GRADIENT_END_COLOR,angle:GRADIENT_ANGLE})}this._casesGallery=new WatchCasesGallery(this._casesGalleryElement,ac_objDefaults(DEFAULT_SLIDE_GALLERY_OPTIONS,{itemType:WatchCase,itemSelector:".gallery-case",containerGallery:this,wrapAround:false}));this._bandsGallery=new WatchBandsGallery(this._bandsGalleryElement,ac_objDefaults(DEFAULT_SLIDE_GALLERY_OPTIONS,{itemSelector:".gallery-band-container",containerGallery:this}));update(function(){this._isSplitView=getIsSplitView()}.bind(this));draw(function(){draw(function(){var galleries=[this._casesGallery,this._bandsGallery];Promise.all(galleries.map(this._cacheGalleryItemWidths)).then(this._asyncInitialize.bind(this))}.bind(this))}.bind(this))}var superProto=FadeGallery.prototype;var proto=WatchInteractiveGallery.prototype=Object.create(superProto);proto.constructor=WatchInteractiveGallery;proto._cacheGalleryItemWidths=function(gallery){return new Promise(function(resolve,reject){update(function(){var items=gallery.getItems(),i=items.length-1;while(i>-1){gallery._storeItemHeight(items[i],false);items[i]._updateMetrics(gallery._viewportWidth);i--}gallery._memoizeMetrics()}.bind(this));draw(function(){gallery._el.style.height="";gallery._snapToPosition(gallery._getPositionForItem(gallery._currentItem));gallery.show(gallery._currentItem.id,{animated:false});resolve()}.bind(this))}.bind(this))};proto._asyncInitialize=function(){this.addItem(new InteractiveGalleryItem(CASES,this._casesGallery));this.addItem(new InteractiveGalleryItem(BANDS,this._bandsGallery));this._onCaseUpdate=this._onCaseUpdate.bind(this);this._onCaseChange=this._updateCaseInfo.bind(this);this._onBandUpdate=this._onBandUpdate.bind(this);this._onBandChange=this._updateBandInfo.bind(this);this._onNavigationUpdate=this._onNavigationUpdate.bind(this);this._onNavigationComplete=this._onNavigationComplete.bind(this);this._onIntroAnimationComplete=this._onIntroAnimationComplete.bind(this);this._onIntroAnimationResolved=this._onIntroAnimationResolved.bind(this);this._onGallerySwipeStart=this._onGallerySwipeStart.bind(this);this._onGallerySwipeNoAnimationEnd=this._onGallerySwipeNoAnimationEnd.bind(this);this._onGallerySwipeAnimationEnd=this._onGallerySwipeAnimationEnd.bind(this);this._disableLinkClick=this._disableLinkClick.bind(this);this._onGalleryReadyTransitionend=this._onGalleryReadyTransitionend.bind(this);this._casesGallery.on(Gallery.UPDATE,this._onCaseUpdate);this._bandsGallery.on(Gallery.UPDATE,this._onBandUpdate);this._casesGallery.on(WatchSlideGallery.SWIPE_START,this._onGallerySwipeStart);this._bandsGallery.on(WatchSlideGallery.SWIPE_START,this._onGallerySwipeStart);this._casesGallery.on(WatchSlideGallery.SWIPE_END,this._onGallerySwipeNoAnimationEnd);this._bandsGallery.on(WatchSlideGallery.SWIPE_END,this._onGallerySwipeNoAnimationEnd);this._casesGallery.on(WatchSlideGallery.SWIPE_END_ANIMATION,this._onGallerySwipeAnimationEnd);this._bandsGallery.on(WatchSlideGallery.SWIPE_END_ANIMATION,this._onGallerySwipeAnimationEnd);this._casesGallery.on(WatchSlideGallery.CHANGE,this._onCaseChange);this._bandsGallery.on(WatchSlideGallery.CHANGE,this._onBandChange);if(acAnalytics){new acAnalytics.observer.Event(this,{interactionEvents:["analytics-view-faces"]})}this._onCaseUpdate();this._onBandUpdate();this.on(Gallery.UPDATE,this._onNavigationUpdate);this.on(Gallery.UPDATE_COMPLETE,this._onNavigationComplete);if(this._isFBFrame){for(var i=0,l=this._shareButtons.length;i<l;i++){this._shareButtons[i].remove()}}this._onNavigationUpdate();this._onNavigationComplete();if(this._isFBFrame){this._el.classList.add("gallery-fb-frame")}this.disableZoom();var skipIntro=this._enableDeeplinking&&this.navigateTo(this._initialPath)||this._isFBFrame;if(skipIntro){this._skipAnimateIntro()}else{this._animateCopyIntro();setTimeout(function(){this._skipAnimateIntro()}.bind(this),3400)}window.addEventListener("resize",this._handleSplitViewResize);galleryClock.start()};proto._handleSplitViewResize=function(){update(function(){var isSplitView=getIsSplitView();if(this._isSplitView!==isSplitView){this._isSplitView=isSplitView;var galleries=[this._casesGallery,this._bandsGallery];Promise.all(galleries.map(this._cacheGalleryItemWidths)).then(function(){draw(function(){this._onCaseUpdate();this._onBandUpdate();external(function(){if(this.gradientPlayer){this.gradientPlayer._updateSize()}}.bind(this))}.bind(this))}.bind(this))}}.bind(this))};proto.prepareGalleryIntro=function(){return new Promise(function(resolve,reject){this._casesGallery.cacheAnimationDistances();var introImagesPromise=this._casesGallery.loadIntroImages();var shadowsMasksImagesPromise=this._casesGallery.loadShadowsAndMasks();var backgroundColorsPromise=this._casesGallery._setBandBackgroundColors();Promise.all([introImagesPromise,shadowsMasksImagesPromise,backgroundColorsPromise]).then(function(){draw(resolve)})}.bind(this))};proto.setGalleryReady=function(){draw(function(){if(this._isIE){setTimeout(function(){this.trigger("gallery-ready-transition-end")}.bind(this),300)}else{ac_addEventListener(this._el,"transitionend",this._onGalleryReadyTransitionend)}this._el.classList.add("gallery-ready");this._galleryReady=true}.bind(this))};proto._onGalleryReadyTransitionend=function(e){if(e.target!==this._el){return}this.trigger("gallery-ready-transition-end");ac_removeEventListener(this._el,"transitionend",this._onGalleryReadyTransitionend)};proto.destroy=function(){this.enableZoom();this._casesGallery.off(Gallery.UPDATE);this._bandsGallery.off(Gallery.UPDATE);this._casesGallery.off(WatchSlideGallery.CHANGE);this._bandsGallery.off(WatchSlideGallery.CHANGE);this._casesGallery.destroy();this._bandsGallery.destroy();window.removeEventListener("resize",this._handleSplitViewResize);this._galleryReady=false;this._casesGallery=null;this._bandsGallery=null;this.gradientPlayer=null;return superProto.destroy.call(this)};proto.enableZoom=function(){this._viewportMeta.setAttribute("content",this._viewportMeta.getAttribute("content").replace(DISABLE_ZOOM_TOKEN,""))};proto.disableZoom=function(){this._viewportMeta.setAttribute("content",this._viewportMeta.getAttribute("content")+DISABLE_ZOOM_TOKEN)};proto.defaultCaseForSize=function(size){return getDefaultId(WATCH_DEFAULTS.cases,[size])};proto.defaultBandForCase=function(size,caseId){return getDefaultId(WATCH_DEFAULTS.bands,[size+"/"+caseId,caseId])};proto.getProductUrlForSelectedCombination=function(){if(this._selectedCase&&this._selectedCase.skus&&this._selectedBand){return this._selectedCase.skus[this._selectedBand.id]||null}return null};proto.isCombinationBuyableSku=function(){return!!this.getProductUrlForSelectedCombination()};proto.getShopUrlForCaseOptions=function(){return this._selectedCase&&this._selectedCase.shopUrl||null};proto.getBuyUrlForSelectedCombination=function(){if(this.isCombinationBuyableSku()){return this.getProductUrlForSelectedCombination()}else{return this.getShopUrlForCaseOptions()}};proto.getBuyUrlForModel=function(){if(this._selectedCase){return this._selectedCase.skus["model"]||null}return null};proto.getBuyUrlForSelectedBand=function(){return this._selectedBand&&this._selectedBand.productUrl||null};proto.setPageTitle=function(){if(!this._originalPageTitle){this._originalPageTitle=document.title}document.title=this._ogTitle};proto.unsetPageTitle=function(){if(this._originalPageTitle){document.title=this._originalPageTitle}};proto._animateCopyIntro=function(){var introOverlay=this._el.querySelector(".gallery-intro-overlay");var introCopy=introOverlay.querySelector("h1");introOverlay.classList.add("animating-intro");setTimeout(function(){introOverlay.classList.remove("animating-intro")},3e3)};proto._animateIntro=function(){var enterAnimationDuration=2;var casesExitDuration=1.8;var introText=new IntroTextController(this);this._el.classList.add("gallery-intro-playing");introText.on("exit:complete",function(){introText.destroy();introText=null});introText.on("showpanes",function(){if(!this._casesGallery){return}this._casesGallery.animateIntroExit(casesExitDuration,this._onIntroAnimationComplete,this._onIntroAnimationResolved)}.bind(this));introText.initialize(enterAnimationDuration);var casesAnimation=this._casesGallery.getAnimateIntroEnter(enterAnimationDuration);var constantMotionAnimations=this._getConstantMotionAnimation();draw(function(){this.once("gallery-ready-transition-end",function(){draw(function(){introText.animate();casesAnimation.play();constantMotionAnimations.forEach(function(item){item.play()})}.bind(this))}.bind(this));this.setGalleryReady()}.bind(this))};proto._getConstantMotionAnimation=function(){var casesEl=document.querySelector("#gallery-cases");var textEl=document.querySelector(".gallery-intro .gallery-intro-headline-content");var clipElements=[casesEl,textEl];var duration=5;var TRANSLATIONS={xlarge:-300,large:-300,medium:-150,small:-75};var smallViewportMultiplier=1;if(this._galleryViewportEmitter.viewport==="small"){smallViewportMultiplier=1.2}return clipElements.map(function(clipEl){var propsFrom={transform:{translateX:TRANSLATIONS[this._galleryViewportEmitter.viewport]}};var propsTo={transform:{translateX:0}};return new Clip(clipEl,duration/smallViewportMultiplier,propsTo,{ease:"ease-in-out",propsFrom:propsFrom})}.bind(this))};proto._animateNavPanesEnter=function(){this._el.classList.add(CSS_SHOW_PANES_CLASS)};proto._onIntroAnimationComplete=function(){if(!this._el){return}this._isIntroAnimationComplete=true;this._animateNavPanesEnter();this._updateGradient();if(this._introSkipped){this._onIntroAnimationResolved()}};proto._onIntroAnimationResolved=function(){if(!this._el){return}this._casesGallery._introComplete();this._casesGallery.setTranslateZOnItems(false);var shadowsPromise=this._casesGallery.loadShadowsAndMasks();this._el.classList.remove("gallery-intro-playing");this._el.classList.add("gallery-intro-finished");this._casesGallery.removeAnimationTransform();var casesPromise=this._casesGallery.loadImages();if(this._introSkipped){Promise.all([shadowsPromise,casesPromise]).then(function(){this.setGalleryReady()}.bind(this))}};proto._skipAnimateIntro=function(){this._introSkipped=true;var introText=new IntroTextController(this);introText.destroy();introText=null;this._onIntroAnimationComplete()};proto._onNavigationUpdate=function(){this.previousPrevious=this.previous;this.previous=this.current;this.current=this.getCurrentItem();this.transitioning=true;this._updateBandContentAtHalfway=false;this._el.classList.add("gallery-current-"+this.current.name);this._el.classList.add("gallery-transitioning-to-"+this.current.name);this._el.classList.remove(CSS_BUY_BAND_UNAVAILABLE);if(!this._willDoInitialNavigation&&this.current.name===BANDS){this._setBandGalleryToCaseBand()}if(this.previous){this._el.classList.remove("gallery-current-"+this.previous.name);this._el.classList.add("gallery-transitioning-from-"+this.previous.name);this.userInteractionEnabled=false;this.previous.gallery.userInteractionEnabled=false}this._el.setAttribute("data-selected-case-id",this._selectedCase.casing);this._el.setAttribute("data-selected-case-size",this._selectedCase.size);var currentBand=this._getSelectedBandForGallery(this.current);var previousBand=this._getSelectedBandForGallery(this.previous);if(this._willDoInitialNavigation){if(this.current.name===BANDS){this._selectedBand=this._initialBand;this._bandsGallery.setWatchSize(this._selectedCase.size,this._selectedCase.casing);this._bandsGallery.show(this._selectedBand.id,{animated:false})}this._bandTypeWillChange=false}else{if(this.current.name===BANDS){this._updateBandPositions()}if(this.current.name===BANDS&&this.previous.name===CASES){this._setBandGalleryToCaseBand(true);this._bandsGallery.show(this._selectedBand.id,{animated:false})}if(this.current.name===BANDS&&this.previous.name===CASES){if(!this.previousPrevious||this.previousPrevious.name===BANDS){this._updateBandPositions()}else{this._updateBandContentAtHalfway=true;this._setBandGalleryToCaseBand(true);this._bandsGallery.show(this._selectedBand.id,{animated:false})}}this._bandTypeWillChange=this._willChangeBandType()}if(this._bandTypeWillChange){this._el.classList.add("gallery-band-type-changed")}if(this._selectedBand){this._el.setAttribute("data-selected-band-id",this._selectedBand.id)}else{this._el.setAttribute("data-selected-band-id",this._selectedCase.band)}this._bandNameElement.setAttribute("aria-hidden",this.current.name!==CASES&&this.current.name!==BANDS);this._buyBandLinkElement.setAttribute("aria-hidden",this.current.name!==BANDS);this._buyBandUnavailableCopyElement.setAttribute("aria-hidden",this.current.name!==BANDS);this._buyModelLinkElement.setAttribute("aria-hidden",this.current.name!==CASES);this._buyBandTooltipElement.setAttribute("aria-hidden",this.current.name!==BANDS);this._modelSeriesNameElement.setAttribute("aria-hidden",this.current.name!==CASES);this._el.classList.add("gallery-show-selected");if(this.current.name===CASES){this._hasVisitedCases=true;this._buyModelLinkElement.setAttribute("tabindex","0");this._buyBandLinkElement.setAttribute("tabindex","-1")}if(this.current.name===BANDS){this._hasVisitedBands=true;this._buyModelLinkElement.setAttribute("tabindex","-1");this._buyBandLinkElement.setAttribute("tabindex","0")}this._updateCopyScroll();this._willDoInitialNavigation=false};proto._getSelectedItemForGallery=function(gallery){if(!gallery){return null}if(gallery.name===CASES){return this._selectedCase}if(gallery.name===BANDS){return this._selectedBand}return null};proto._getSelectedBandForGallery=function(gallery){if(!gallery){return null}if(gallery.name===CASES){return this._selectedCase}if(gallery.name===BANDS){return this._selectedBand}return null};proto._getBandMaskType=function(galleryItem){var id=galleryItem.id;var bandMaskTypes=BAND_MASK_TYPES;var defaultType="sport";var i;var maskTypesLen=bandMaskTypes.length;var j;var maskTypeValsLen;for(i=0;i<maskTypesLen;i++){maskTypeValsLen=bandMaskTypes[i][1].length;for(j=0;j<maskTypeValsLen;j++){if(id.indexOf(bandMaskTypes[i][1][j])>-1){return bandMaskTypes[i][0]}}}return defaultType};proto._hideCloudBand=function(){if(this._selectedCase.casing!=="ceramic-case"){document.getElementById("cloud-sport-band-"+this._selectedCase.size).setAttribute("style","visibility: hidden;")}};proto._onHalfwayNavigationComplete=function(){if(this._updateBandContentAtHalfway){this._onBandUpdate()}};proto._onNavigationComplete=function(){this._updateCaseInfo();if(this.current.name!==CASES){this._updateBandInfo()}this._updateCopyScroll();this._updateGradient();this._updateBrowserURL();this._el.classList.remove("gallery-transitioning-to-"+this.current.name);if(this.previous){this._el.classList.remove("gallery-transitioning-from-"+this.previous.name)}this._el.classList.remove("gallery-band-type-changed");this.userInteractionEnabled=true;this.current.gallery.userInteractionEnabled=true;if(this.current.name===CASES){this._el.classList.remove("gallery-show-selected")}this.transitioning=false};proto._onGallerySwipeStart=function(){this.userInteractionEnabled=false};proto._onGallerySwipeNoAnimationEnd=function(){this.userInteractionEnabled=true};proto._onGallerySwipeAnimationEnd=function(){this.userInteractionEnabled=true};proto._removeSizeFromId=function(id){return id.replace(/^[\d]*-/,"")};proto.getShareImageName=function(){var pieces=[];if(!this._selectedCase){return null}var size=this._selectedCase.size;var caseId=this._selectedCase.casing;var bandId=this._getBandForCurrentCase();if(bandId){bandId=this._removeSizeFromId(bandId);return getCombinationName(size,caseId,bandId)}return null};proto.getCurrentPath=function(){if(!this.current){return null}var path=[];if(this.current.name===CASES){path=[this._selectedCase&&this._selectedCase.size,this._selectedCase&&this._selectedCase.id]}else{path=[this._selectedCase&&this._selectedCase.size,this._selectedCase&&this._selectedCase.casing,this._selectedBand&&this._selectedBand.id]}if(this.current.name===CASES){path=path.slice(0,2)}if(this.current.name===BANDS){path=path.slice(0,3)}return"/"+path.join("/")+this._urlParams};proto._updateBrowserURL=function(){if(!this._enableDeeplinking){return}var path=this.getCurrentPath();if(path){var hash=this._urlHashPrefix+path;var queryString="";if(typeof history.replaceState==="function"){try{history.replaceState(null,document.title,this._urlBasePath+queryString+"#"+hash)}catch(err){window.location.hash="";this._enableDeeplinking=false}}else{window.location.hash=hash}}};proto._parsePath=function(path){path=path.replace(this._urlHashPrefix,"");var components=path.replace(/^#?\/?/,"");components=components.split("?")[0];components=components.split("/");return{size:components[0]||null,caseId:components[1]||null,bandId:components[2]||null}};proto.navigateTo=function(path){path=this._parsePath(path);if(!path.size||path.size!=="40"&&path.size!=="44"){return false}var startLocation=null;this._initialCase=null;this._initialBand=null;var caseId=path.caseId;if(path.bandId){var items=this._casesGallery.getItems();var i,data,len=items.length,caseID;for(i=0;i<len;i++){data=items[i].data;if(data.casing===caseId&&data.size===path.size){caseId=items[i].data.id;break}}}var caseLookup=path.size+"-"+caseId;var bandLookup=path.size+"-"+path.bandId;if(!this._casesGallery.itemsLookup[caseLookup]){caseLookup=this.defaultCaseForSize(path.size)}else{this._initialCase=this._casesGallery.getCurrentItem().data;startLocation="gallery-cases"}this._casesGallery.show(caseLookup,{animated:false});this._updateBandPositions();var bandItem=this._lookupBandItem(bandLookup);if(path.bandId&&bandItem){var bandId=path.size+"-"+bandItem.data.id;this._bandsGallery.show(bandId,{animated:false});this._initialBand=this._bandsGallery.getCurrentItem().data;startLocation="gallery-bands"}if(!startLocation){return false}this._hasVisitedCases=true;this._hasVisitedBands=true;this._startLocation=startLocation;if(startLocation!=="gallery-cases"){this._willDoInitialNavigation=true;this.show(startLocation)}else{var currentModel=this._casesGallery.getCurrentItem();if(currentModel&&currentModel.data){this._updateBandInfo({name:currentModel.data.bandName})}}return true};proto._onCaseUpdate=function(){this._lastSelectedCase=this._selectedCase;this._selectedCase=this._casesGallery.getCurrentItem().data;var item=this._bandsGallery.getItemByBandSizeAndID(this._selectedCase.size,this._selectedCase.band);if(this._lastSelectedCase&&this._lastSelectedCase.size!==this._selectedCase.size){this._bandsGallery.setWatchSize(this._selectedCase.size,this._selectedCase.casing)}this._updateCaseInfo();this._updateBrowserURL();this._updateGradient()};proto._setBandGalleryToCaseBand=function(forceCaseBand){this._handleHiddenBands(forceCaseBand);this._bandsGallery.show(this._selectedBand.id+"-"+this._selectedBand.size,{animated:false});return};proto._willChangeBandType=function(){var current=this.getCurrentItem();var previous=this.previous;if(current&&previous){if(this._selectedBand){var newBand=this._getSelectedBandForGallery(current);var previousBand=this._getSelectedBandForGallery(previous);if(current.name===BANDS&&this._selectedBand.hidden){var defaultId=this.defaultBandForCase(this._selectedCase.size,this._selectedCase.casing);var defaultItemID=this._selectedCase.size+"-"+defaultId;newBand=this._bandsGallery.itemsLookup[defaultItemID].data}if(this._getBandMaskType(newBand)!==this._getBandMaskType(previousBand)){return true}}}return false};proto._updateCaseInfo=function(context){context=context||this._selectedCase;var caseSize=stringTemplate(this.strings.size,context);var caseName=context.casingName;var modelSeriesName=context.series;this._modelSeriesNameElement.setAttribute("data-selected-model-series",modelSeriesName);this._modelSeriesNameElement.setAttribute("aria-label",modelSeriesName);this._modelSeriesNameElement.setAttribute("aria-hidden",false);this._caseSizeElement.innerHTML=stringTemplate(this.strings.size,context);this._caseNameElement.innerHTML=caseName;if(this.current&&this.current.name===CASES){this._updateBandInfo({name:context.bandName})}this._updateModelInfo();this._updateCopyScroll()};proto._handleHiddenBands=function(forceCaseBand){var current=this.getCurrentItem();if(current&&current.name===BANDS&&!forceCaseBand){if(this._selectedBand&&this._selectedBand.hidden){var defaultId=this.defaultBandForCase(this._selectedCase.size,this._selectedCase.casing);var defaultItemID=this._selectedCase.size+"-"+defaultId;this._selectedBand=this._bandsGallery.itemsLookup[defaultItemID].data}}else if(this._selectedCase&&forceCaseBand){var bandID=this._selectedCase.size+"-"+this._selectedCase.band;this._selectedBand=this._bandsGallery.itemsLookup[bandID].data}};proto._onBandUpdate=function(){this._lastSelectedBand=this._selectedBand;this._selectedBand=this._bandsGallery.getCurrentItem().data;this._updateBrowserURL();this._updateBandInfo();this._updateGradient()};proto._updateBandInfo=function(context){this._setBandName(context);var url=this.getBuyUrlForSelectedBand();var targetedBand=context||this._selectedBand;if(targetedBand&&targetedBand.bandAvailable===false){this._setBandBuyToCopy(targetedBand)}else{this._el.classList.remove(CSS_BUY_BAND_UNAVAILABLE);ac_removeEventListener(this._buyBandLinkElement,"click",this._disableLinkClick);if(url){this._buyBandLinkElement.classList.remove("gallery-selected-link-disabled");this._buyBandLinkElement.setAttribute("aria-disabled",false);if(this._buyBandTooltipElement){this._buyBandTooltipElement.setAttribute("aria-hidden",true)}}else{this._buyBandLinkElement.classList.add("gallery-selected-link-disabled");this._buyBandLinkElement.setAttribute("aria-disabled",true);ac_addEventListener(this._buyBandLinkElement,"click",this._disableLinkClick);if(this._buyBandTooltipElement){this._buyBandTooltipElement.removeAttribute("aria-hidden")}}}this._updateModelInfo();this._updateCopyScroll()};proto._setBandBuyToCopy=function(context){this._el.classList.add(CSS_BUY_BAND_UNAVAILABLE);this._buyBandUnavailableCopyElement.textContent=context.bandUnavailableCopy||""};proto._setBandName=function(context){context=context||this._selectedBand;var name=context.name.replace(PRODUCT_RED_SEARCH,PRODUCT_RED_REPLACEMENT);this._bandNameElement.innerHTML=name};proto._getBandForCurrentCase=function(){var defaultId=this.defaultBandForCase(this._selectedCase.size,this._selectedCase.casing);var defaultItemId=this._selectedCase.size+"-"+defaultId;var currentBand=null;if(this._selectedBand){currentBand=this._selectedBand.id}if(this._selectedCase&&this.previous&&this.previous.name===CASES){currentBand=this._selectedCase.band}if(!currentBand){return defaultItemId}var currentItemId=this._selectedCase.size+"-"+currentBand;var item=this._lookupBandItem(currentItemId);var itemID=item.data.id;if(item.data.hidden){item=null;itemID=defaultId}currentItemId=this._selectedCase.size+"-"+itemID;return item?currentItemId:defaultItemId};proto._updateBandPositions=function(){this._bandsGallery.setWatchSize(this._selectedCase.size,this._selectedCase.casing);this._bandsGallery.show(this._getBandForCurrentCase(),{animated:false})};proto._lookupBandItem=function(itemId){var item=this._bandsGallery.itemsLookup[itemId];if(!item||this._selectedCase&&item.data.cases&&item.data.cases.indexOf(this._selectedCase.casing)===-1){var defaultId=this.defaultBandForCase(this._selectedCase.size,this._selectedCase.casing);var defaultItemId=this._selectedCase.size+"-"+defaultId;item=this._bandsGallery.itemsLookup[defaultItemId]}return item};proto._getBandIdFromModelsGallery=function(itemId){var items=this._casesGallery.getItems();var i;var data;var id;var len=items.length;for(i=0;i<len;i++){id="";data=null;if(items[i].data){data=items[i].data;id=data.size+"-"+data.band;if(id===itemId){return items[i]}}}return null};proto._updateModelInfo=function(){var url=this.getBuyUrlForModel();ac_removeEventListener(this._buyModelLinkElement,"click",this._disableLinkClick);if(url){this._buyModelLinkElement.classList.remove("gallery-selected-link-disabled");this._buyModelLinkElement.setAttribute("aria-disabled",false);this._buyModelTooltipElement.setAttribute("aria-hidden",true)}else{this._buyModelLinkElement.classList.add("gallery-selected-link-disabled");this._buyModelLinkElement.setAttribute("aria-disabled",true);ac_addEventListener(this._buyModelLinkElement,"click",this._disableLinkClick);this._buyModelTooltipElement.removeAttribute("aria-hidden")}};proto._updateCopyScroll=function(){if(this._didBindCopyScrollUpdate){return}this._didBindCopyScrollUpdate=true;update(function(){this._copyScrollWidth=this._selectedCopyContainer.scrollWidth}.bind(this));draw(function(){this._selectedCopyContainer.scrollLeft=this._copyScrollWidth;this._didBindCopyScrollUpdate=false}.bind(this))};proto._disableLinkClick=function(evt){ac_preventDefault(evt);return false};proto._updateGradient=function(){if(!this.gradientPlayer){return}var startColor;var endColor;if(this._isIntroAnimationComplete){if(this.current.name===CASES){if(this._selectedCase){startColor=this._selectedCase.background[0];endColor=this._selectedCase.background[1]}}else if(this._selectedBand){startColor=this._selectedBand.background[0];endColor=this._selectedBand.background[0]}}this.gradientPlayer.transitionTo(startColor||GRADIENT_START_COLOR,endColor||GRADIENT_END_COLOR)};proto._update=function(evt){if(this.userInteractionEnabled){return superProto._update.call(this,evt)}};proto._updateItems=function(items,silent){if(silent){return}this._incomingOutgoingItems=items;items.incoming[0].show();items.outgoing[0].hide();this._zIndexCount++;if(!SUPPORTS_TRANSFORM){items.outgoing[0].fadeOut();items.incoming[0].fadeIn(0,0,this._zIndexCount);this._onItemShowComplete();return}var duration=.566;var viewport=this._galleryViewportEmitter.viewport;if(viewport==="xlarge"||viewport==="large"){duration=duration*1.35}var stagger=.1;items.outgoing[0].slideOut(duration,stagger,function(){this._onHalfwayNavigationComplete();if(!items.outgoing[0].isFading()){items.incoming[0].fadeIn(duration,this._ease,this._zIndexCount)}items.incoming[0].slideIn(duration,stagger,this._onItemShowComplete)}.bind(this))};module.exports=WatchInteractiveGallery},{"../../json/interactive-gallery/defaults":475,"../_shared/GradientPlayer":451,"../_shared/performancePolyfill":452,"./InteractiveGalleryItem":456,"./IntroTextController":458,"./WatchBandsGallery":460,"./WatchCase":461,"./WatchCasesGallery":462,"./WatchSlideGallery":463,"./WatchSlideGalleryItem":464,"./galleryClock":465,"./galleryViewportEmitter":466,"./helpers/addEventListenerToElements":467,"./helpers/getCombinationName":468,"./helpers/getDefaultId":470,"./helpers/getIsSplitView":472,"./helpers/setAttribute":473,"./helpers/stringTemplate":474,"@marcom/ac-browser":9,"@marcom/ac-dom-events/preventDefault":57,"@marcom/ac-dom-events/utils/addEventListener":63,"@marcom/ac-dom-events/utils/removeEventListener":65,"@marcom/ac-dom-traversal/querySelector":97,"@marcom/ac-dom-traversal/querySelectorAll":98,"@marcom/ac-eclipse":112,"@marcom/ac-feature/cssPropertyAvailable":138,"@marcom/ac-feature/isDesktop":140,"@marcom/ac-feature/touchAvailable":143,"@marcom/ac-feature/webGLAvailable":144,"@marcom/ac-gallery":152,"@marcom/ac-modal-basic":180,"@marcom/ac-object/defaults":187,"@marcom/ac-raf-emitter/draw":220,"@marcom/ac-raf-emitter/external":221,"@marcom/ac-raf-emitter/update":222,"ac-analytics":"ac-analytics","ac-modal":388}],456:[function(require,module,exports){"use strict";var canvasAvailable=require("@marcom/ac-feature/canvasAvailable");var FadeGalleryItem=require("@marcom/ac-gallery").FadeGalleryItem;var Clip=require("@marcom/ac-clip").Clip;var ClipGroup=require("./ClipGroup");var galleryClock=require("./galleryClock");var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");var ac_addEventListener=require("@marcom/ac-dom-events/utils/addEventListener");var draw=require("@marcom/ac-raf-emitter/draw");var createBezier=require("@marcom/ac-easing").createBezier;var SLIDE_IN_EASING_FUNCTION=createBezier(.17,.84,.305,.97).easingFunction;var SUPPORTS_OPACITY=cssPropertyAvailable("opacity");function InteractiveGalleryItem(name,gallery){this._el=gallery.getElement();this.name=name;this.gallery=gallery;this._memoizeSlideDistance=this._memoizeSlideDistance.bind(this);ac_addEventListener(window,"resize",this._memoizeSlideDistance);this._memoizeSlideDistance();FadeGalleryItem.call(this,this._el)}var superProto=FadeGalleryItem.prototype;var proto=InteractiveGalleryItem.prototype=Object.create(superProto);proto.constructor=InteractiveGalleryItem;proto.show=function(){superProto.show.call(this);if(canvasAvailable()&&this.gallery.loadAnimations){this.gallery.loadAnimations()}};proto._destroyClips=function(){if(this._clipGroup){this._clipGroup.destroy()}};proto.fadeOut=function(duration,ease){this._el.style.visibility="hidden"};proto.fadeIn=function(duration,ease,zIndex,callback){draw(this._fadeIn.bind(this,duration,ease,zIndex,callback))};proto._fadeIn=function(duration,ease,zIndex,callback){this._el.style.zIndex=zIndex||1;this._el.style.visibility="inherit";if(!duration||!SUPPORTS_OPACITY){if(SUPPORTS_OPACITY){this._el.style.opacity=1}if(callback){callback()}return}var item=this.gallery.getCurrentItem();var options={ease:ease,clock:galleryClock,propsFrom:{opacity:.01},onComplete:callback};var props={opacity:1};this._destroyCurrentClip();this._clip=Clip.to(item,duration,props,options)};proto._memoizeSlideDistance=function(){this._slideDistance=window.innerWidth/2};proto.slideOut=function(duration,stagger,callback){this._destroyClips();this._resetItemPositions();var items=this.gallery.getItemsInViewport();var currentIndex=items.indexOf(this.gallery.getCurrentItem());var startItems=items.slice(0,currentIndex);var endItems=items.slice(currentIndex+1,items.length);duration=duration*.8;var distance=this._slideDistance;var clips=[];for(var i=0,j=0,il=startItems.length;i<il;i++,j++){clips.push(this._createSlideClip(startItems[i],"to",duration,distance*-1,stagger*j))}for(var i=endItems.length-1,j=0;i>=0;i--,j++){clips.push(this._createSlideClip(endItems[i],"to",duration,distance,stagger*j))}this._clipGroup=new ClipGroup(clips,this._onSlideOutComplete.bind(this,callback));this._clipGroup.play()};proto.slideIn=function(duration,stagger,callback){this._destroyClips();this._resetItemPositions();var items=this.gallery.getItemsInViewport();var currentIndex=items.indexOf(this.gallery.getCurrentItem());var startItems=items.slice(0,currentIndex);var endItems=items.slice(currentIndex+1,items.length);var distance=this._slideDistance;var clips=[];for(var i=startItems.length-1,j=0;i>=0;i--,j++){clips.push(this._createSlideClip(startItems[i],"from",duration,distance*-1,stagger*j))}for(var i=0,j=0,il=endItems.length;i<il;i++,j++){clips.push(this._createSlideClip(endItems[i],"from",duration,distance,stagger*j))}this._clipGroup=new ClipGroup(clips,this._onSlideInComplete.bind(this,callback));this._clipGroup.play()};proto._createSlideClip=function(item,propsDir,duration,distance,delay){var options={ease:"ease-in-quint",delay:delay,clock:galleryClock};var props={offset:distance};if(propsDir==="from"){options.propsFrom=props;options.ease=SLIDE_IN_EASING_FUNCTION;props={offset:0}}return new Clip(item,duration,props,options)};proto._resetItemPositions=function(){var items=this.gallery.getItems();for(var i=0,len=items.length;i<len;i++){items[i].offset=0}};proto._onSlideInComplete=function(callback){var item=this.gallery.getCurrentItem();if(item.playAnimation){item.playAnimation()}if(callback){callback()}};proto._onSlideOutComplete=function(callback){var item=this.gallery.getCurrentItem();if(item.resetAnimation){item.resetAnimation()}if(callback){callback()}};module.exports=InteractiveGalleryItem},{"./ClipGroup":454,"./galleryClock":465,"@marcom/ac-clip":25,"@marcom/ac-dom-events/utils/addEventListener":63,"@marcom/ac-easing":102,"@marcom/ac-feature/canvasAvailable":137,"@marcom/ac-feature/cssPropertyAvailable":138,"@marcom/ac-gallery":152,"@marcom/ac-raf-emitter/draw":220}],457:[function(require,module,exports){"use strict";var ac_objCreate=require("@marcom/ac-object/create");var ac_objDefaults=require("@marcom/ac-object/defaults");var ac_querySelector=require("@marcom/ac-dom-traversal/querySelector");var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var ac_addEventListener=require("@marcom/ac-dom-events/addEventListener");var ac_string=require("@marcom/ac-string");var dispatchEvent=require("@marcom/ac-dom-events/dispatchEvent");var draw=require("@marcom/ac-raf-emitter/draw");var setStyle=require("@marcom/ac-dom-styles/setStyle");var target=require("@marcom/ac-dom-events/target");var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");var Ajax=require("@marcom/ac-ajax");var Modal=require("@marcom/ac-modal-basic").Modal;var InteractiveGallery=require("./InteractiveGallery");var MODAL_CONTENT_FILE="includes/content.inc";var CSS_SHOW_BAR_CLASS="gallery-modal-show-bar";var CSS_MODAL_VISIBLE_CLASS="gallery-modal-visible";var CSS_MODAL_CLOSING_CLASS="gallery-modal-closing";var SUPPORTS_TRANSITION=cssPropertyAvailable("transition");var DEFAULT_OPTIONS={showBar:true,ctaElement:"[data-gallerycta]",modalOptions:{retainScrollPosition:true},rendererOptions:{classNames:{modalElement:"gallery-modal",modalOpen:"gallery-modal-open",documentElement:"has-gallery-modal",closeButton:["ig-modal-close","icon","icon-closealt"]}}};var DOM_EVENT_WILL_OPEN="interactive-gallery-modal-will-open";var DOM_EVENT_DID_OPEN="interactive-gallery-modal-did-open";var DOM_EVENT_WILL_CLOSE="interactive-gallery-modal-will-close";var DOM_EVENT_DID_CLOSE="interactive-gallery-modal-did-close";var DOM_EVENT_TARGET=document.documentElement;function InteractiveGalleryModal(options){this._options=ac_objDefaults(DEFAULT_OPTIONS,options);this._pageMainElement=ac_querySelector(".main");this._callToActionLink=ac_querySelector(this._options.ctaElement);this._callToActionText=this._callToActionLink&&this._callToActionLink.textContent;this._closeButtonLabel=this._callToActionLink.getAttribute("data-modal-close-label");this._modalContentUrl=this._getModalContentUrl();this._pathOnClose=window.location.pathname;this._elementsForAriaHidden=[ac_querySelector("#ac-globalnav"),ac_querySelector("#ac-globalfooter"),ac_querySelector("#ac-localnav"),ac_querySelector(".main")];Modal.call(this,this._options.modalOptions,this._options.rendererOptions);this._onModalContentSuccess=this._onModalContentSuccess.bind(this);this._onModalContentFailure=this._onModalContentSuccess.bind(this);this._onCallToActionClicked=this._onCallToActionClicked.bind(this);this._onTransitionEnd=this._onTransitionEnd.bind(this);this.render();this.renderer.modalElement.setAttribute("role","dialog");this.renderer.modalElement.setAttribute("aria-hidden","true");this.renderer.modalElement.tabIndex="-1";this.renderer.closeButton.setAttribute("aria-label",this._closeButtonLabel);this.hideBar();if(this._options.showBar){this._createCallToActionBar();this.appendContent(this._callToActionBarElement);ac_addEventListener(this._callToActionBarLink,"click",this._onCallToActionClicked)}var links=ac_querySelectorAll(this._options.ctaElement);for(var i=links.length-1;i>=0;i--){ac_addEventListener(links[i],"click",this._onCallToActionClicked)}ac_addEventListener(this.renderer.modalElement,"transitionend",this._onTransitionEnd);this._contentElement=this._contentElement||document.createElement("div");this._contentElement.className="gallery-modal-content";this.appendContent(this._contentElement)}var superProto=Modal.prototype;var proto=InteractiveGalleryModal.prototype=ac_objCreate(superProto);proto.showBar=function(){if(!this.opened){setStyle(this.renderer.modalElement,{opacity:"1"})}this.renderer.modalElement.classList.add(CSS_SHOW_BAR_CLASS)};proto.hideBar=function(){if(!this.opened){setStyle(this.renderer.modalElement,{opacity:"0"})}this.renderer.modalElement.classList.remove(CSS_SHOW_BAR_CLASS)};proto.open=function(){dispatchEvent(DOM_EVENT_TARGET,DOM_EVENT_WILL_OPEN);draw(function(){draw(function(){this.renderer.modalElement.classList.add(CSS_MODAL_VISIBLE_CLASS);draw(function(){superProto.open.apply(this,arguments);setStyle(this.renderer.modalElement,{opacity:"1"});this._fetchModalContent();if(typeof window.history.replaceState==="function"){window.history.replaceState(null,document.title,this._getGalleryPath())}if(!SUPPORTS_TRANSITION){this._onOpenEnd({target:this.renderer.modalElement})}}.bind(this))}.bind(this))}.bind(this))};proto.close=function(){dispatchEvent(DOM_EVENT_TARGET,DOM_EVENT_WILL_CLOSE);draw(function(){draw(function(){superProto.close.apply(this,arguments);if(typeof window.history.replaceState==="function"){window.history.replaceState(null,document.title,this._pathOnClose)}setStyle(this._pageMainElement,{visibility:""});for(var i=0,il=this._elementsForAriaHidden.length;i<il;i++){if(this._elementsForAriaHidden[i]){this._elementsForAriaHidden[i].setAttribute("aria-hidden","false")}}this._callToActionLink.focus();this.renderer.modalElement.setAttribute("aria-hidden","true");this.renderer.modalElement.classList.add(CSS_MODAL_CLOSING_CLASS);if(this.gallery){this.gallery.unsetPageTitle();this.gallery.enableZoom()}if(!SUPPORTS_TRANSITION){this._onCloseEnd({target:this.renderer.modalElement})}}.bind(this))}.bind(this))};proto._onOpenEnd=function(evt){if(target(evt)!==this.renderer.modalElement){return}setStyle(this._pageMainElement,{visibility:"hidden"});draw(function(){dispatchEvent(DOM_EVENT_TARGET,DOM_EVENT_DID_OPEN)})};proto._onCloseEnd=function(evt){if(target(evt)!==this.renderer.modalElement){return}if(this.gallery&&this.gallery.getItems()){this.gallery.destroy()}this._contentElement.innerHTML="";this.renderer.modalElement.classList.remove(CSS_MODAL_CLOSING_CLASS);setStyle(this.renderer.modalElement,{opacity:"0"});draw(function(){this.renderer.modalElement.classList.remove(CSS_MODAL_VISIBLE_CLASS);draw(function(){dispatchEvent(DOM_EVENT_TARGET,DOM_EVENT_DID_CLOSE)})}.bind(this))};proto._onTransitionEnd=function(evt){if(this.opened){this._onOpenEnd.call(this,evt)}else{this._onCloseEnd.call(this,evt)}};proto._getModalContentUrl=function(){var url=this._callToActionLink.href;if(url.slice(-1)!=="/"){url+="/"}url+=MODAL_CONTENT_FILE;return url};proto._fetchModalContent=function(){if(this._cachedHTMLContent){this._onModalContentSuccess()}else{Ajax.get({url:this._modalContentUrl}).then(this._onModalContentSuccess,this._onModalContentFailure)}};proto._onModalContentSuccess=function(xhr){this._cachedHTMLContent=this._cachedHTMLContent||xhr.responseText;this._contentElement.innerHTML=this._cachedHTMLContent;setTimeout(function(){draw(function(){this.gallery=new InteractiveGallery({urlBasePath:this._getGalleryPath()});this.gallery.setPageTitle();this._firstNavigationItem=ac_querySelector('[data-ac-gallery-trigger="gallery-cases"]',this.renderer.modalElement);for(var i=0,il=this._elementsForAriaHidden.length;i<il;i++){if(this._elementsForAriaHidden[i]){this._elementsForAriaHidden[i].setAttribute("aria-hidden","true")}}this.renderer.modalElement.setAttribute("aria-hidden","false");this.renderer.modalElement.focus();this._firstNavigationItem.focus()}.bind(this))}.bind(this),1e3)};proto._onModalContentFailure=function(xhr){this.close()};proto._getGalleryPath=function(){var pages=["watch/","apple-watch-series-1/","apple-watch-series-3/"];var pathname=window.location.pathname;for(var i=0,l=pages.length;i<l;i++){var page=pages[i];if(pathname.indexOf(page)>0){var base=pathname.substr(0,pathname.indexOf(page));return pathname.replace(pathname,base+"watch/interactive-gallery/")}}return pathname.replace(pathname,"/watch/interactive-gallery/")};proto._createCallToActionBar=function(){this._callToActionBarElement=document.createElement("div");this._callToActionBarElement.className="gallery-modal-cta-bar";this._callToActionBarLink=document.createElement("a");this._callToActionBarLink.href=this._callToActionLink.href;this._callToActionBarLink.className="icon icon-after icon-pluscircle";this._callToActionBarLink.setAttribute("data-analytics-title","gallery-open");this._callToActionBarLink.setAttribute("data-analytics-click","gallery-open");this._callToActionBarLink.textContent=this._callToActionText;this._callToActionBarElement.appendChild(this._callToActionBarLink)};proto._onCallToActionClicked=function(event){if(!this._canSupportModal()){return}event.preventDefault?event.preventDefault():event.returnValue=false;this.open()};proto._canSupportModal=function(){if(document.documentElement.classList.contains("no-ig-modal")){return false}return true};module.exports=InteractiveGalleryModal},{"./InteractiveGallery":455,"@marcom/ac-ajax":1,"@marcom/ac-dom-events/addEventListener":54,"@marcom/ac-dom-events/dispatchEvent":55,"@marcom/ac-dom-events/target":62,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-dom-traversal/querySelector":97,"@marcom/ac-dom-traversal/querySelectorAll":98,"@marcom/ac-feature/cssPropertyAvailable":138,"@marcom/ac-modal-basic":180,"@marcom/ac-object/create":186,"@marcom/ac-object/defaults":187,"@marcom/ac-raf-emitter/draw":220,"@marcom/ac-string":252}],458:[function(require,module,exports){"use strict";var querySelector=require("@marcom/ac-dom-traversal/querySelector");var removeNode=require("@marcom/ac-dom-nodes/remove");var Clip=require("@marcom/ac-eclipse").Clip;var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var viewportEmitter=require("@marcom/ac-viewport-emitter");var draw=require("@marcom/ac-raf-emitter/draw");var ADD_DELAY_ATTRIBUTE="data-add-delay";var HEADLINE_REFERENCE_LENGTH_US=21;var SMALL_VIEWPORT_MULTIPLIER=1.375;var ENTER_EASING="cubic-bezier(0.230, 1.000, 0.320, 1.000)";var ENTER_DURATION=1.5;var ENTER_DELAY=.125;var EXIT_DURATION=.3;var EXIT_DELAY=.05;var EXIT_STAGGER=.05;var MIN_EXIT_DELAY=151;function IntroTextController(){EventEmitterMicro.call(this);this._introContainerSelector=".gallery-intro";this._headlineSelector=".gallery-intro-headline";this._headlineElm=querySelector(this._headlineSelector);this._textCasesSelector=".gallery-intro-text-cases";this._textBandsSelector=".gallery-intro-text-bands";this._textFacesSelector=".gallery-intro-text-faces";this._textGoSelector=".gallery-intro-text-go";this._defaultExitDelay=1.03*1e3*window.innerWidth/2550;if(this._defaultExitDelay<MIN_EXIT_DELAY){this._defaultExitDelay=MIN_EXIT_DELAY}this._exitDelayTextLengthModifier=this._calcTextLengthModifier(this._headlineElm);this._exitDelayAttributeAdd=this._getExitDelayAttributeAddValue();this._smallViewportMultiplier=viewportEmitter.viewport==="small"?SMALL_VIEWPORT_MULTIPLIER:1;this._exitDelay=this._calcExitDelay();this._headlineEnterClipDuration=null;this._headlineEnterClip=null;this._casesEnterClip=null;this._bandsEnterClip=null;this._facesEnterClip=null;this._textMiddleClip=null;this._casesExitClip=null;this._bandsExitClip=null;this._facesExitClip=null}var superProto=EventEmitterMicro.prototype;var proto=IntroTextController.prototype=Object.create(superProto);proto.initialize=function(headlineEnterDuration){this._headlineEnterClipDuration=headlineEnterDuration;this._headlineEnterClip=this._createEnterHeadlineClip();var initialDelay=.05*this._smallViewportMultiplier;var duration=ENTER_DURATION*this._smallViewportMultiplier;this._casesEnterClip=this._createEnterTextClip(this._textCasesSelector,initialDelay);this._bandsEnterClip=this._createEnterTextClip(this._textBandsSelector,initialDelay);this._facesEnterClip=this._createEnterTextClip(this._textFacesSelector,initialDelay);this._casesExitClip=this._createExitTextClip(this._textCasesSelector,0);this._bandsExitClip=this._createExitTextClip(this._textBandsSelector);this._facesExitClip=this._createExitTextClip(this._textFacesSelector);this.on("enter:complete",function(){setTimeout(function(){this._animateExit()}.bind(this),this._exitDelay)}.bind(this))};proto.animate=function(){this._headlineEnterClip.on("complete",function(){this._headlineEnterClip.destroy();this._headlineEnterClip=null}.bind(this));this._headlineEnterClip.play();this._casesEnterClip.on("complete",function(){this._casesEnterClip.destroy();this._casesEnterClip=null}.bind(this));this._bandsEnterClip.on("complete",function(){this._bandsEnterClip.destroy();this._bandsEnterClip=null}.bind(this));this._facesEnterClip.on("complete",function(){this._facesEnterClip.destroy();this._facesEnterClip=null;this.trigger("enter:complete")}.bind(this));this._textMiddleClip=this._createMiddleTextClip(".gallery-intro-headline",ENTER_DELAY);draw(function(){this._casesEnterClip.play();this._drawFramesUntil(.1475).then(function(){this._bandsEnterClip.play();this._drawFramesUntil(.1475).then(function(){this._facesEnterClip.play()}.bind(this))}.bind(this))}.bind(this))};proto._drawFramesUntil=function(timeSecs,endTime){return new Promise(function(resolve,reject){var now=performance.now();endTime=endTime||now+timeSecs*1e3;if(now>=endTime){resolve();return}draw(function(){this._drawFramesUntil(timeSecs,endTime).then(resolve)}.bind(this))}.bind(this))};proto.destroy=function(){this._headlineSelector=null;this._headlineElm=null;this._textCasesSelector=null;this._textBandsSelector=null;this._textFacesSelector=null;this._textGoSelector=null;this._defaultExitDelay=null;this._exitDelayTextLengthModifier=null;this._exitDelayAttributeAdd=null;this._exitDelay=null;this._headlineEnterClipDuration=null;this.removeIntroTextContainer();superProto.destroy.call(this)};proto._calcTextLengthModifier=function(elm){var elmText=elm.textContent||elm.innerText;elmText=elmText.replace(/\W*?[^\w-\.]*/g,"");return elmText.length/HEADLINE_REFERENCE_LENGTH_US};proto._getExitDelayAttributeAddValue=function(){var introElm=querySelector(this._introContainerSelector);var value=introElm.getAttribute(ADD_DELAY_ATTRIBUTE);if(Number.parseFloat){value=Number.parseFloat(value)}else{value=parseFloat(value)}if(!value||value===0){return 0}return Math.abs(value)*1e3};proto._calcExitDelay=function(){if(this._exitDelayTextLengthModifier===1&&this._exitDelayAttributeAdd===0){return this._defaultExitDelay*this._smallViewportMultiplier}return(this._defaultExitDelay*this._exitDelayTextLengthModifier+this._exitDelayAttributeAdd)*this._smallViewportMultiplier};proto._createEnterHeadlineClip=function(){var animateToStyles={transform:{translateX:"0"}};return new Clip(this._headlineElm,this._headlineEnterClipDuration,animateToStyles)};proto._createEnterTextClip=function(elmSelector,delay){var textElm=querySelector(elmSelector);var clipDuration=ENTER_DURATION*this._smallViewportMultiplier;var animateToStyles={opacity:1,transform:{translateX:"0"}};var clipOptions={delay:(delay||ENTER_DELAY)*this._smallViewportMultiplier,ease:ENTER_EASING};return new Clip(textElm,clipDuration,animateToStyles,clipOptions)};proto._createMiddleTextClip=function(elmSelector,delay){delay=delay||0;var textElm=querySelector(elmSelector);var clipDuration=ENTER_DURATION+this._exitDelay/1e3;var animateToStyles={transform:{translateX:"0px"}};var animateFromStyles={transform:{translateX:"-300px"}};var clipOptions={delay:delay*this._smallViewportMultiplier,ease:"ease-out",propsFrom:animateFromStyles};return new Clip(textElm,clipDuration,animateToStyles,clipOptions)};proto._createExitTextClip=function(elmSelector,delay){var textElm=querySelector(elmSelector);var clipDuration=EXIT_DURATION*this._smallViewportMultiplier;var animateToStyles={opacity:0,transform:{translateX:"500px"}};var clipOptions={delay:(delay||EXIT_DELAY)*this._smallViewportMultiplier,ease:"ease-in-sine"};return new Clip(textElm,clipDuration,animateToStyles,clipOptions)};proto._animateMiddle=function(){};proto._animateExit=function(){this._facesExitClip.on("complete",function(){this._facesExitClip.destroy();this._facesExitClip=null}.bind(this));this._bandsExitClip.on("complete",function(){this._bandsExitClip.destroy();this._bandsExitClip=null}.bind(this));this._casesExitClip.on("complete",function(){this._casesExitClip.destroy();this._casesExitClip=null;this.trigger("exit:complete")}.bind(this));this._bandsExitClip.on("play",function(){this.trigger("showpanes");this._casesExitClip.play()}.bind(this));this._facesExitClip.on("play",function(){this._bandsExitClip.play()}.bind(this));this._facesExitClip.play();var order=[this._facesExitClip,this._bandsExitClip,this._casesExitClip];order.forEach(function(item,idx){setTimeout(function(){item.play()},idx*EXIT_STAGGER*1e3)})};proto.removeIntroTextContainer=function(){var containerElm=querySelector(this._introContainerSelector);if(containerElm){removeNode(containerElm)}};module.exports=IntroTextController},{"@marcom/ac-dom-nodes/remove":87,"@marcom/ac-dom-traversal/querySelector":97,"@marcom/ac-eclipse":112,"@marcom/ac-event-emitter-micro":133,"@marcom/ac-raf-emitter/draw":220,"@marcom/ac-viewport-emitter":277}],459:[function(require,module,exports){"use strict";var EventEmitter=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var ac_querySelectorAll=require("@marcom/ac-dom-traversal/querySelectorAll");var LAZY_IMAGE_ATTRIBUTE="data-lazy-image";var LAZY_MASK_ATTRIBUTE="data-lazy-image";function LazyImageLoader(el){this._images=[];if(el){this.addElement(el)}}var superProto=EventEmitter.prototype;var proto=LazyImageLoader.prototype=Object.create(superProto);proto.constructor=LazyImageLoader;proto.addElement=function(el){var images=ac_querySelectorAll("["+LAZY_IMAGE_ATTRIBUTE+"]",el);this._images=this._images.concat(images)};proto.load=function(){for(var i=0,il=this._images.length;i<il;i++){this._images[i].removeAttribute(LAZY_IMAGE_ATTRIBUTE);this._images[i].removeAttribute(LAZY_MASK_ATTRIBUTE)}};module.exports=LazyImageLoader},{"@marcom/ac-dom-traversal/querySelectorAll":98,"@marcom/ac-event-emitter-micro":133}],460:[function(require,module,exports){"use strict";var ac_objCreate=require("@marcom/ac-object/create");var ac_objDefaults=require("@marcom/ac-object/defaults");var WatchSlideGallery=require("./WatchSlideGallery");var WatchSlideGalleryItem=require("./WatchSlideGalleryItem");var DEFAULT_OPTIONS={};var EDITION_BANDS=["pebble-sport-band"];function WatchBandsGallery(el,options){options=ac_objDefaults(DEFAULT_OPTIONS,options);this._watchCaseId=null;WatchSlideGallery.call(this,el,options)}var superProto=WatchSlideGallery.prototype;var proto=WatchBandsGallery.prototype=ac_objCreate(superProto);proto.constructor=WatchBandsGallery;proto.setWatchSize=function(size,caseId){var lastSize=this._watchSize;var lastCaseId=this._watchCaseId;size=size+"";caseId=caseId+"";if(size===lastSize&&caseId===lastCaseId){return}this.editionBands=this.getItems().filter(function(item){var bandID=item.data.id;if(EDITION_BANDS.indexOf(bandID)>-1){return true}return false});var selectedCase=this.containerGallery._casesGallery.getCurrentItem();if(selectedCase.data.id.indexOf("ceramic")===-1){this._hideEditionBands()}this._watchSize=size;this._watchCaseId=caseId;this._items=this.getItemsForWatchSize(size,caseId);this.loadImagesForWatchSize(size);this._memoizeMetrics()};proto.getItemsForWatchSize=function(size,caseId){size=size+"";var items=this._itemsWatchSizeLookup[size];var filteredItems=[];for(var i=0,l=items.length;i<l;i++){var item=items[i];if(!item.data.cases||item.data.cases.indexOf(caseId)!==-1){filteredItems.push(item)}}return filteredItems};proto.getItemByBandSizeAndID=function(size,id){var items=this.getItems();var i,len=items.length;for(i=0;i<len;i++){if(items[i].data.size===size&&items[i].data.id===id){return items[i]}}return null};proto._showEditionBands=function(){this.editionBands.forEach(function(item){item.show()}.bind(this))};proto._hideEditionBands=function(){this.editionBands.forEach(function(item){item.hide()}.bind(this))};module.exports=WatchBandsGallery},{"./WatchSlideGallery":463,"./WatchSlideGalleryItem":464,"@marcom/ac-object/create":186,"@marcom/ac-object/defaults":187}],461:[function(require,module,exports){"use strict";var WatchSlideGalleryItem=require("./WatchSlideGalleryItem");var getStyle=require("@marcom/ac-dom-styles/getStyle");var update=require("@marcom/ac-raf-emitter/update");var draw=require("@marcom/ac-raf-emitter/draw");function WatchCase(el){WatchSlideGalleryItem.call(this,el);this.intro=this._lastIntro=true;this.caseEl=el;this.bandEl=this.getElement().querySelector(".gallery-band");this.bandShadowEl=this.getElement().querySelector(".gallery-band-shadow");this.caseShadowEl=this.getElement().querySelector(".gallery-case-shadow");this._shouldUseTranslateZ=true}var superProto=WatchSlideGalleryItem.prototype;var proto=WatchCase.prototype=Object.create(superProto);proto._onUpdate=function(evt){if(this.intro){if(this._lastIntro===this.intro){return}this._lastIntro=this.intro;this._inViewport=this.position<0||this._getInViewport();return}if(this._position===this._lastPosition&&this.width===this._lastWidth&&this._lastIntro===this.intro){return}this._lastIntro=this.intro;this._inViewport=this._getInViewport()};proto.loadShadowAndMask=function(){return new Promise(function(resolve,reject){draw(function(){this.bandEl.removeAttribute("data-lazy-mask");this.bandShadowEl.removeAttribute("data-lazy-image");this.caseShadowEl.removeAttribute("data-lazy-image");Promise.all([this.getMaskLoadPromise(this.bandEl),this.getImageLoadPromise(this.caseShadowEl),this.getImageLoadPromise(this.bandShadowEl)]).then(resolve)}.bind(this))}.bind(this))};proto.loadIntroFaces=function(){return new Promise(function(resolve,reject){var introFaces=Array.prototype.slice.call(this.getElement().querySelector(".gallery-intro-face"),0);draw(function(){var promises=[];introFaces.forEach(function(introFace){promsies.push(this.getMaskLoadPromise(introFace))}.bind(this));Promise.all(promises).then(resolve)}.bind(this))}.bind(this))};proto.loadImage=function(){return new Promise(function(resolve,reject){draw(function(){this.bandEl.removeAttribute("data-lazy-image");this.caseEl.removeAttribute("data-lazy-image");Promise.all([this.getImageLoadPromise(this.caseEl),this.getImageLoadPromise(this.bandEl)]).then(resolve)}.bind(this))}.bind(this))};proto.getMaskLoadPromise=function(el){return new Promise(function(resolve,reject){this._getMaskImageSrc(el).then(function(src){if(src){this._loadImage(src).then(function(result){el=null;resolve(result)})}else{el=null;resolve(null)}}.bind(this))}.bind(this))};proto.getImageLoadPromise=function(el){return new Promise(function(resolve,reject){this._getBackgroundImageSrc(el).then(function(src){if(src){this._loadImage(src).then(function(result){el=null;resolve(result)})}else{el=null;resolve(null)}}.bind(this))}.bind(this))};proto._getBackgroundImageSrc=function(el){return new Promise(function(resolve,reject){update(function(){var currentStyle=el.currentStyle;if(!currentStyle){currentStyle=window.getComputedStyle(el,false)}el=null;if(currentStyle.backgroundImage&&currentStyle.backgroundImage.indexOf("url(")===0){resolve(currentStyle.backgroundImage.slice(4,-1).replace(/"/g,""));return}resolve(null)}.bind(this))}.bind(this))};proto._getMaskImageSrc=function(el){return new Promise(function(resolve,reject){update(function(){var currentStyle=el.currentStyle;if(!currentStyle){currentStyle=window.getComputedStyle(el,false)}el=null;var maskImage=currentStyle.maskImage||currentStyle.webkitMaskImage;if(maskImage&&maskImage.indexOf("url(")===0){resolve(maskImage.slice(4,-1).replace(/"/g,""));return}resolve(null)}.bind(this))}.bind(this))};proto._loadImage=function(src){return new Promise(this._loadImagePromiseFunc.bind(this,src))};proto._loadImagePromiseFunc=function(src,resolve,reject){function onImageLoad(){this.removeEventListener("load",onImageLoad);resolve(this);resolve=null}if(!src){resolve(null);return}var img=new Image;img.addEventListener("load",onImageLoad);img.src=src};module.exports=WatchCase},{"./WatchSlideGalleryItem":464,"@marcom/ac-dom-styles/getStyle":89,"@marcom/ac-raf-emitter/draw":220,"@marcom/ac-raf-emitter/update":222}],462:[function(require,module,exports){"use strict";var ac_objDefaults=require("@marcom/ac-object/defaults");var getStyle=require("@marcom/ac-dom-styles/getStyle");var setStyle=require("@marcom/ac-dom-styles/setStyle");var threeDTransformsAvailable=require("@marcom/ac-feature/threeDTransformsAvailable");var ViewportEmitter=require("./galleryViewportEmitter")();var WatchSlideGallery=require("./WatchSlideGallery");var Clip=require("@marcom/ac-eclipse").Clip;var update=require("@marcom/ac-raf-emitter/update");var draw=require("@marcom/ac-raf-emitter/draw");var AMOUNT_OF_INTRO_CASE_IN_VIEW=.75;var SMALL_VIEWPORT_MULTIPLIER=1.375;var INITIAL_FACES_DELAY=.95;var ADDITIONAL_PADDING_TEXT_LEFT={xlarge:48,large:48,medium:36,small:-10};var IS_IPHONE_5S=window.innerWidth<=320;var ADDITIONAL_PADDING_IPHONE5S=10;var CASE_DISTANCE_FROM_TEXT={xlarge:0,large:0,medium:-24,small:-24};var SUPPORTS_3D_TRANSFORMS=threeDTransformsAvailable();var DEFAULT_OPTIONS={};function WatchCasesGallery(el,options){this._options=ac_objDefaults(DEFAULT_OPTIONS,options);WatchSlideGallery.call(this,el,this._options);this._introFacesAdded=false;this._loadIntroFacesCalled=false;this._smallViewportMultiplier=ViewportEmitter.viewport==="small"?SMALL_VIEWPORT_MULTIPLIER:1;this._introAnimationModel=this.getItemById("intro-animation-model-42");this._introAnimationFaces=JSON.parse(document.querySelector(".gallery-intro").getAttribute("data-faces-list"))}var superProto=WatchSlideGallery.prototype;var proto=WatchCasesGallery.prototype=Object.create(superProto);proto.constructor=WatchCasesGallery;proto._getCaseDistanceAmount=function(){if(ViewportEmitter.viewport){return CASE_DISTANCE_FROM_TEXT[ViewportEmitter.viewport]}return CASE_DISTANCE_FROM_TEXT.large};proto.cacheAnimationDistances=function(){var textEl=document.querySelector(".gallery-intro-headline");var textLeft=Math.round(textEl.getBoundingClientRect().left);var windowWidth=window.innerWidth;var halfViewportWidth=windowWidth/2;var galleryDistToEnd=this._getDistToGalleryEnd();var targetItem=this._items[this._items.length-1];var targetWidth=targetItem.getElement().getBoundingClientRect().width;var targetLeft=targetItem.getElement().getBoundingClientRect().left;var halfLastCaseWidth=targetItem.width/2;var additionalPaddingLeft=ADDITIONAL_PADDING_TEXT_LEFT[ViewportEmitter.viewport];if(IS_IPHONE_5S){additionalPaddingLeft=ADDITIONAL_PADDING_IPHONE5S}var leftEdge=targetLeft-targetWidth;var caseWidth=targetLeft-galleryDistToEnd;var galleryStartPosition=-(galleryDistToEnd-targetWidth-windowWidth/2+windowWidth+targetWidth);var translateXTo=-(galleryDistToEnd-targetWidth-windowWidth/2+(windowWidth-textLeft)+additionalPaddingLeft);var distanceTravelled=Math.abs(galleryStartPosition-translateXTo);this.distanceTravelled=distanceTravelled;this.galleryWidth=galleryDistToEnd;this.animationTranslateXTo=translateXTo;this.galleryStartPosition=galleryStartPosition};proto.getAnimateIntroEnter=function(enterDuration){if(typeof this.distanceTravelled==="undefined"){this.cacheAnimationDistances()}var introClip=Clip(this._containerEl,enterDuration,{transform:{translateX:this.animationTranslateXTo+"px"}},{ease:"cubic-bezier(0.230, 1.000, 0.320, 1.000)",delay:.325});var transform;if(SUPPORTS_3D_TRANSFORMS){transform="translate3d("+this.galleryStartPosition+"px, 0, 0)"}else{transform="translateX("+this.galleryStartPosition+"px)"}setStyle(this._containerEl,{transform:transform,"will-change":"transform"});introClip.on("complete",function(){setStyle(this._containerEl,{"will-change":""});introClip.destroy();introClip=null}.bind(this));this.introClip=introClip;this._showIntroAnimationImages();return introClip};proto.removeAnimationTransform=function(){draw(function(){setStyle(this.getElement(),{transform:""})}.bind(this))};proto.loadIntroFaces=function(){return new Promise(function(resolve,reject){this._loadIntroFacesCalled=true;this._loadIntroFaces(resolve)}.bind(this))};proto._loadIntroFaces=function(resolve){var targetItem=this._items[this._items.length-1];this._addIntroFaces(targetItem).then(function(faceElements){this.introFaces=faceElements;targetItem.loadIntroFaces();resolve()}.bind(this))};proto.getFacesAnimation=function(){var faceEls=this.introFaces;var itemDuration=.5/this._smallViewportMultiplier;var itemDelay=.125/this._smallViewportMultiplier;var outroDelay=.125/this._smallViewportMultiplier;var lastItemHoldDelay=.25/this._smallViewportMultiplier;var initialDelay=INITIAL_FACES_DELAY/this._smallViewportMultiplier;var ease="easeOutSine";var facesLen=faceEls.length;return faceEls.map(function(faceEl,idx){var animateOutToStyles;var animateOutFromStyles;var clipOutOptions={ease:ease,delay:outroDelay};if(idx!==facesLen-1){animateOutToStyles={transform:{translateX:"100%"}};animateOutFromStyles={transform:{translateX:"0"}}}else{animateOutToStyles={opacity:0};animateOutFromStyles={opacity:1};clipOutOptions.delay=lastItemHoldDelay;clipOutOptions.onComplete=function(){this.trigger("faces:complete")}.bind(this)}clipOutOptions.propsFrom=animateOutFromStyles;var outroClip=new Clip(faceEl,itemDuration,animateOutToStyles,clipOutOptions);var animateInToStyles={transform:{translateX:"0",scale:"1"}};var animateInFromStyles={transform:{translateX:"-100%",scale:"0.25"}};var clipInOptions={delay:initialDelay+(itemDelay+itemDuration)*idx,ease:ease,propsFrom:animateInFromStyles,onComplete:function(){if(this.introClip){this.introClip.destroy()}draw(function(){outroClip.play()})}};return new Clip(faceEl,itemDuration,animateInToStyles,clipInOptions)}.bind(this))};proto.animateIntroExit=function(exitDuration,callback,fullCompleteCallback){Clip.to(this._containerEl,exitDuration,{transform:{translateX:"0px"}},{ease:"ease-in-out-quart",onStart:window.setTimeout(callback,500),onComplete:function(){this._introComplete();if(fullCompleteCallback){fullCompleteCallback()}}.bind(this)})};proto.removeIntroFaces=function(){if(!this.introFaces){return}this.introFaces.forEach(function(item){item.parentNode.removeChild(item)});this.introFaces=null};proto.loadShadowsAndMasks=function(){var promises=[];return new Promise(function(resolve,reject){this.getItems().forEach(function(item){promises.push(item.loadShadowAndMask())});Promise.all(promises).then(resolve)}.bind(this))};proto.loadImages=function(items){return new Promise(function(resolve,reject){var promises=[];items=items||this.getItems();items.forEach(function(item){promises.push(item.loadImage())});Promise.all(promises).then(resolve)}.bind(this))};proto._addIntroFaces=function(galleryItem){return new Promise(function(resolve,reject){var elContainer=galleryItem.getElement().querySelector(".gallery-screen");var faceElementPromises=this._introAnimationFaces.map(function(item){return new Promise(function(resolve,reject){var el=document.createElement("div");el.className="gallery-intro-face-container";var backgroundImagePromise=this._getIntroFaceBackgroundImage(item,".gallery-face.gallery-face-main");var uiImagePromise=this._getIntroFaceBackgroundImage(item,".gallery-face.gallery-face-ui");Promise.all([backgroundImagePromise,uiImagePromise]).then(function(results){var backgroundImage=results[0];var uiImage=results[1];if(backgroundImage){var imageEl=document.createElement("div");imageEl.className="gallery-intro-face";imageEl.style.backgroundImage=backgroundImage;el.appendChild(imageEl)}if(uiImage){var uiEl=document.createElement("div");uiEl.className="gallery-intro-face gallery-intro-face-ui";uiEl.style.backgroundImage=uiImage;el.appendChild(uiEl)}elContainer.appendChild(el);resolve(el)})}.bind(this))}.bind(this));Promise.all(faceElementPromises).then(function(faceElements){resolve(faceElements)})}.bind(this))};proto._getIntroFaceBackgroundImage=function(faceID,querySelector){return new Promise(function(resolve,reject){var item=this._options.containerGallery._facesGallery.getItemById(faceID);if(item){var el=item.getElement().querySelector(querySelector);el.removeAttribute("data-lazy-image");update(function(){var result=getStyle(el,"backgroundImage").backgroundImage;el=null;resolve(result)})}return null}.bind(this))};proto.loadIntroImages=function(){return new Promise(function(resolve,reject){var images=[];var items=this.getItems();var itemsLen=items.length;if(!this._canUseBackgroundColorIntroAnimation()){images=items}else{update(function(){var windowWidth=window.innerWidth;var halfPageWidth=windowWidth/2;var galleryWidth=this.galleryWidth;var distanceTravelledIntoView=this.distanceTravelled;var i,currentWidth,totalWidth=-items[0].width;for(i=0;i<itemsLen;i++){currentWidth=items[i].width;if(totalWidth<=halfPageWidth){images.push(items[i]);totalWidth+=currentWidth}else{break}}totalWidth=0;for(i=itemsLen-1;i>0;i--){currentWidth=items[i].width;if(totalWidth<=distanceTravelledIntoView){images.push(items[i]);totalWidth+=currentWidth}else{break}}}.bind(this))}draw(function(){images.forEach(function(image){image.getElement().classList.add("gallery-visible-intro-image")});this.loadImages(images).then(function(){images=null;resolve()})}.bind(this))}.bind(this))};proto._showIntroAnimationImages=function(items,idx){draw(function(){var limit=3;items=items||this.getItems();idx=idx||items.length-1;var endIdx=Math.max(-1,idx-limit);while(idx>endIdx){items[idx].getElement().classList.add("gallery-visible-animation-intro-image");idx--}if(idx>-1){this._showIntroAnimationImages(items,idx)}}.bind(this))};proto._canUseBackgroundColorIntroAnimation=function(){if(document.documentElement.classList.contains("ie")||document.documentElement.classList.contains("edge")){return false}return true};proto._setBandBackgroundColors=function(){return new Promise(function(resolve,reject){if(!this._canUseBackgroundColorIntroAnimation()){resolve();return}var galleryItems=this.getItems();var promises=galleryItems.map(function(galleryItem){return new Promise(function(resolve,reject){var backgroundColor="";var band=null;update(function(){band=galleryItem.getElement().querySelector(".gallery-band");backgroundColor=galleryItem.getElement().getAttribute("data-band-background")});draw(function(){band.style.backgroundColor=backgroundColor;resolve()})})});Promise.all(promises).then(resolve)}.bind(this))};proto._getDistToGalleryEnd=function(){var galleryItems=this.getItems();var galleryLength=this.getTotalItems();var currentItemIndex=this.getCurrentItem().index;var distance=0;if(currentItemIndex===0){return this.getTotalItemWidth()}for(var i=currentItemIndex;i<galleryLength;i++){distance=distance+galleryItems[i].width}return distance};proto.setTranslateZOnItems=function(bool){if(this._items){for(var i=0;i<this._items.length;i++){this._items[i]._shouldUseTranslateZ=bool}}};proto._introComplete=function(){if(this._items){for(var i=0;i<this._items.length;i++){if(this._items[i]){this._items[i].intro=false}}}};module.exports=WatchCasesGallery},{"./WatchSlideGallery":463,"./galleryViewportEmitter":466,"@marcom/ac-dom-styles/getStyle":89,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-eclipse":112,"@marcom/ac-feature/threeDTransformsAvailable":142,"@marcom/ac-object/defaults":187,"@marcom/ac-raf-emitter/draw":220,"@marcom/ac-raf-emitter/update":222}],463:[function(require,module,exports){"use strict";var clone=require("@marcom/ac-object/clone");var getStyle=require("@marcom/ac-dom-styles/getStyle");var setStyle=require("@marcom/ac-dom-styles/setStyle");var addEventListener=require("@marcom/ac-dom-events/addEventListener");var removeEventListener=require("@marcom/ac-dom-events/removeEventListener");var preventDefault=require("@marcom/ac-dom-events/preventDefault");var getTarget=require("@marcom/ac-dom-events/target");var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");var SlideGallery=require("@marcom/ac-gallery").SlideGallery;var AutoGallery=require("@marcom/ac-gallery").AutoGallery;var Clip=require("@marcom/ac-clip").Clip;var ancestor=require("@marcom/ac-dom-traversal/ancestor");var LazyImageLoader=require("./LazyImageLoader");var getElementFullWidth=require("./helpers/getElementFullWidth");var DEFAULT_MIN_INERTIAL_SPEED=10;var DEFAULT_INERTIAL_BRAKING_SPEED=1;var DEFAULT_INERTIAL_DAMPING=.945;var ATTR_ITEM_ONSCREEN="gallery-item-on-screen";var draw=require("@marcom/ac-raf-emitter/draw");var cancelDraw=require("@marcom/ac-raf-emitter/cancelDraw");var FPS_TIME_DURATION=1e3/60;var USE_FRAME_INDEPENDENT_DAMPING=true;function WatchSlideGallery(el,options){options=clone(options)||{};this._isDestroyed=false;this.itemsLookup={};this.containerGallery=options.containerGallery;this._containerGalleryEl=this.containerGallery.getElement();this.minimumInertialSpeed=options.minimumInertialSpeed||DEFAULT_MIN_INERTIAL_SPEED;this.inertialBrakingSpeed=options.inertialBrakingSpeed||DEFAULT_INERTIAL_BRAKING_SPEED;this.inertialDamping=options.inertialDamping||DEFAULT_INERTIAL_DAMPING;this.userInteractionEnabled=false;this._lastSwipeDelta=0;this._ignoreMouseWheelDelta=0;this._animationFrameId=null;this._lastAnimationFrameTime=null;this._remainingAnimationFrameTime=0;this._decelerate=this._decelerate.bind(this);this._snapToPositionFromClip=this._snapToPositionFromClip.bind(this);SlideGallery.call(this,el,options);this.hiddenItems=this.getItems().filter(function(item){if(item.data.hidden){return true}return false});this.hiddenItems.forEach(function(item){item.removed=true;this.removeItem(item)}.bind(this));this._itemsWatchSizeLookup={};this._imageLoadersSizeLookup={};this._indexItemsByWatchSize();this._onMouseWheel=this._onMouseWheel.bind(this);addEventListener(this._containerGalleryEl,"wheel",this._onMouseWheel);this._lastWheelEventTimeStamp=0;this._onClick=this._onClick.bind(this);addEventListener(this._el,"click",this._onClick);this._memoizeMetrics();this._snapToPosition(this._getPositionForItem(this._currentItem))}WatchSlideGallery.CHANGE="update:change";WatchSlideGallery.SWIPE_START="swipe:start";WatchSlideGallery.SWIPE_END="swipe:end";WatchSlideGallery.SWIPE_END_ANIMATION="swipe:endanimation";window.Gallery=require("@marcom/ac-gallery").Gallery;var superProto=SlideGallery.prototype;var proto=WatchSlideGallery.prototype=Object.create(superProto);proto.constructor=WatchSlideGallery;proto.destroy=function(){this._cancelDeceleration();this._destroyCurrentClip();removeEventListener(this._containerGalleryEl,"wheel",this._onMouseWheel);removeEventListener(this._el,"click",this._onClick);this.itemsLookup=null;this._lastIncomingItem=null;this._itemsWatchSizeLookup=null;this._centerItem=null;this._lastSwipeDelta=null;superProto.destroy.call(this);this._isDestroyed=true};proto.getItemsForWatchSize=function(size){size=size+"";return this._itemsWatchSizeLookup[size]};proto.loadImagesForWatchSize=function(size){size=size+"";if(this._imageLoadersSizeLookup[size]){this._imageLoadersSizeLookup[size].load();this._imageLoadersSizeLookup[size]=null}};proto.setWatchSize=function(size){var lastSize=this._watchSize;size=size+"";if(size===lastSize){return}this._watchSize=size;this._items=this.getItemsForWatchSize(size);this.loadImagesForWatchSize(size);this._memoizeMetrics()};proto._indexItemsByWatchSize=function(){var items=this.getItems();for(var i=0,il=items.length;i<il;i++){var size=items[i].data.size;this._itemsWatchSizeLookup[size]=this._itemsWatchSizeLookup[size]||[];this._itemsWatchSizeLookup[size].push(items[i]);if(!this._imageLoadersSizeLookup[size]){this._imageLoadersSizeLookup[size]=new LazyImageLoader}this._imageLoadersSizeLookup[size].addElement(items[i].getElement())}};proto.resize=function(){this._memoizeMetrics();AutoGallery.prototype.resize.call(this);var gallery=this;setTimeout(function(){gallery._snapToPosition(gallery._getPositionForItem(gallery._currentItem))},100)};proto.show=function(item,options,evt){var type=typeof item;if(type==="number"){item=this._items[item]}else if(type==="string"){item=this.itemsLookup[item]}if(!item){return}options=options||{};evt=evt||options.interactionEvent;if(options.animated===false){this._updateItemsSnap=true}this._update({item:item,interactionEvent:evt});return item};proto.addItem=function(item){var returnValue=superProto.addItem.call(this,item);if(!item.data||!item.data.id){throw new Error("Item must have data.id:",item)}this.itemsLookup[item.data.size+"-"+item.data.id]=item;item.gallery=this;return returnValue};proto.isInView=function(){return this.userInteractionEnabled};proto.getItemsInViewport=function(){var items=this._items;items=items.filter(function(item){var minPosition=-this._viewportWidth/2-item.width;var maxPosition=this._viewportWidth/2;return item.position()>=minPosition&&item.position()<=maxPosition}.bind(this));items=items.sort(function(itemA,itemB){return itemA.position()-itemB.position()});return items};proto._cancelDeceleration=function(){cancelDraw(this._animationFrameId);this._lastSwipeDelta=0};proto._onSwipeStart=function(evt){if(this._isDestroyed||!this.userInteractionEnabled){return}this._cancelDeceleration();this._centerItem=this._currentItem;this._interactionWasInertialSwipe=false;this._interactionWasMouseWheel=false;this._interactionWasClick=true;this.trigger(WatchSlideGallery.SWIPE_START)};proto._onSwipeUpdate=function(evt){if(this._isDestroyed||!this.userInteractionEnabled){return}this._interactionWasClick=false;this._lastSwipeDelta=evt.diffX;this._snapToPosition(this._position-evt.diffX)};proto._onSwipeEnd=function(evt){if(this._isDestroyed||!this.userInteractionEnabled){return}if(Math.abs(this._lastSwipeDelta)>=this.minimumInertialSpeed){if(!this._interactionWasMouseWheel){var v0=-this._lastSwipeDelta;var estimatedEndX=this._estimateEndPosition(v0);if(this._items.length){var itemWidth=this._items[0].width;var movementDirection=v0>0?1:-1;var targetXDiff=estimatedEndX;var targetX=this._position+targetXDiff;var targetItemIndex=this._getRelativeItemIndexAtPosition(targetX);var roundedTargetItemIndex=Math.round(targetItemIndex);var roundedTargetX=this._getRelativePositionAtItemIndex(roundedTargetItemIndex,movementDirection);var dir=roundedTargetItemIndex<targetItemIndex?1:-1;var diff=Math.abs(roundedTargetX);var minDiff=diff;var suggestedV0=v0;var nearestV0=suggestedV0;var i=0;while(diff<=minDiff&&i++<1e4){suggestedV0+=dir*.1;var endX=this._estimateEndPosition(suggestedV0);diff=Math.abs(roundedTargetX-(this._position+endX));if(diff<=minDiff){nearestV0=suggestedV0}minDiff=Math.min(minDiff,diff)}this._lastSwipeDelta=-nearestV0}this._lastAnimationFrameTime=Date.now();this._remainingAnimationFrameTime=0;this._animationFrameId=draw(this._decelerate);return}}var updatedEvtObjForAnalytics={};if(this._interactionWasInertialSwipe||this._interactionWasMouseWheel||!this._interactionWasClick){this._removeCurrent(this._currentItem._el);this._currentItem=null;this.show(this._centerItem,updatedEvtObjForAnalytics)}else{if(evt.swipe&&!this._interactionWasInertialSwipe&&!this._isDecelerating){superProto._onSwipeEnd.call(this,updatedEvtObjForAnalytics)}this.trigger(WatchSlideGallery.SWIPE_END)}};proto._removeCurrent=function(el){if(el.classList&&el.classList.contains("ac-gallery-currentitem")){el.classList.remove("ac-gallery-currentitem")}};proto._onMouseWheel=function(evt){if(this._isDestroyed||!this.userInteractionEnabled){return}preventDefault(evt);var deltaX=Math.max(Math.min(evt.deltaX,300),-300);var deltaXAbs=Math.abs(deltaX);var timeDelta=evt.timeStamp-this._lastWheelEventTimeStamp;if(timeDelta>100||deltaXAbs>this._ignoreMouseWheelDelta){this._ignoreMouseWheelDelta=0;this._onSwipeStart(evt)}this._lastWheelEventTimeStamp=evt.timeStamp;if(this._ignoreMouseWheelDelta){this._ignoreMouseWheelDelta=deltaXAbs;return}var lastPosition=this._position;this._onSwipeUpdate({diffX:deltaX});if(lastPosition===this._position){this._ignoreMouseWheelDelta=deltaXAbs}clearTimeout(this._wheelEventTimeoutID);this._wheelEventTimeoutID=setTimeout(this._onMouseWheelComplete.bind(this,evt),100)};proto._onMouseWheelComplete=function(evt){this._interactionWasMouseWheel=true;this._onSwipeEnd(evt)};proto._onClick=function(evt){var isSliding=!!(this._clip&&this._clip.playing());if(this._interactionWasClick&&!isSliding&&this.userInteractionEnabled){var target=getTarget(evt);var el=ancestor(target,"[data-id]",true);var item;if(el){var id=el.getAttribute("data-size")+"-"+el.getAttribute("data-id");item=this.itemsLookup[id]}else{el=ancestor(target,".gallery-selected",true);if(el){item=this._currentItem}}if(!item){return}if(this._currentItem===item&&this._position===this._getPositionForItem(item)){this.containerGallery.showNext({interactionEvent:evt});return}this.show(item)}};proto._getRelativeItemIndexAtPosition=function(position){if(!this._items.length){return 0}position*=-1;var index=0;var direction=position>=0?1:-1;var laps=0;var itemsLength=this._items.length;while(position<0||position>=this._totalItemWidth){position+=this._totalItemWidth*(direction*-1);laps+=direction}while(position>0){var itemWidth=this._items[index%itemsLength].width;if(position<=itemWidth){break}position-=itemWidth;index+=1}index+=position/this._items[index].width-.5;index+=itemsLength*laps;return index};proto._getRelativePositionAtItemIndex=function(index,movementDirection){if(!this._items.length){return 0}var position=0;var direction=index>=0?1:-1;var laps=0;var itemsLength=this._items.length;while(index<0||index>=itemsLength){index+=itemsLength*(direction*-1);laps+=direction}for(var i=0;i<index;i++){position+=this._items[i].width}position+=this._items[index].width*.5;position-=this._items[index].width*.02*movementDirection*-1;position+=this._totalItemWidth*laps;return position*-1};proto._estimateEndPosition=function(startVelocity){var x=0;var v=startVelocity;while(Math.abs(v)>this.inertialBrakingSpeed){v*=this.inertialDamping;x+=v}return x};proto._dampen=function(value){var now=Date.now();var dt=now-this._lastAnimationFrameTime;var damping=this.inertialDamping;var result=value;if(USE_FRAME_INDEPENDENT_DAMPING){this._remainingAnimationFrameTime+=dt;while(this._remainingAnimationFrameTime>0){this._remainingAnimationFrameTime-=FPS_TIME_DURATION;result=result*damping;if(Math.abs(result)<this.inertialBrakingSpeed){break}if(this._remainingAnimationFrameTime>0){this._position=Math.round(this._position-result)}}}else{result=value*damping}this._lastAnimationFrameTime=now;return result};proto._decelerate=function(){if(!this._animationFrameId){return}this._isDecelerating=true;var newDelta=this._dampen(this._lastSwipeDelta);if(newDelta!=this._lastSwipeDelta){this._onSwipeUpdate({diffX:newDelta})}if(Math.abs(this._lastSwipeDelta)>=this.inertialBrakingSpeed){this._animationFrameId=draw(this._decelerate);return}this._isDecelerating=false;this._interactionWasInertialSwipe=true;this._onSwipeEnd.call(this,{diffX:this._lastSwipeDelta});this._cancelDeceleration()};proto._memoizeMetrics=function(){this._viewportWidth=window.innerWidth;this._totalItemWidth=0;var i;var item;for(i=0;i<this._items.length;i++){item=this._items[i];item.index=i;item.updateMetrics(this._viewportWidth);this._totalItemWidth+=item.width}};proto.getTotalItemWidth=function(){return this._totalItemWidth};proto._positionItems=function(itemToSnapTo){return};proto._setCenterItem=function(item){if(this._centerItem!==item){this._centerItem=item;this.trigger(WatchSlideGallery.CHANGE,this._centerItem.data)}};proto._setPosition=function(position){position=Math.round(position);position*=-1;if(position<0){if(this._wrapAround){position+=this._totalItemWidth}else{position=0;this._cancelDeceleration()}}if(position>=this._totalItemWidth){if(this._wrapAround){position=position%this._totalItemWidth}else{position=this._totalItemWidth-1;this._cancelDeceleration()}}this._position=position*-1;return this._position};proto._getPositionForItem=function(item){var itemCount=this._items.length;var position=-item.width/2;var i;for(i=0;i<item.index;i++){position-=this._items[i].width}return Math.round(position)};proto._getClosestPositionForItem=function(item){var position=this._getPositionForItem(item);var distance=position-this._position;if(this._wrapAround&&Math.abs(distance)>this._totalItemWidth/2){if(Math.abs(position)>this._totalItemWidth/2){return position+this._totalItemWidth}else{return position-this._totalItemWidth}}return position};proto._snapToPosition=function(position,animating){if(!animating){this._destroyCurrentClip()}var p=position;position=this._setPosition(position);var centerIndex=0;var centerPosition=0;var itemCount=this._items.length;var item;var i;for(i=0;i<itemCount;i++){item=this._items[i];item.position(position);if(item.getLeft()<=0&&item.getRight()>0){centerPosition=position;centerIndex=i}position+=item.width}this._setCenterItem(this._items[centerIndex]);if(!this._wrapAround){return}var halfIndex=Math.floor(itemCount/2);if(centerIndex===halfIndex){return}var moveCount=Math.abs(centerIndex-halfIndex);if(centerIndex>halfIndex){for(i=0;i<moveCount;i++){item=this._items[i];item.position(position);position+=item.width}}else{var moveStart=itemCount-1;var moveEnd=itemCount-moveCount;position=this._position;for(i=moveStart;i>=moveEnd;i--){item=this._items[i];position-=item.width;item.position(position)}}};proto._snapToPositionFromClip=function(clip){var position=clip.target().position;this._snapToPosition(position,true)};proto._slideToPosition=function(position,duration,callback){this._destroyCurrentClip();var objFrom={position:this._position};var objTo={position:position};this._clip=new Clip(objFrom,duration,objTo,{destroyOnComplete:true,ease:this._slideOptions.ease,onUpdate:this._snapToPositionFromClip,onComplete:function(){if(callback){callback()}this.trigger(WatchSlideGallery.SWIPE_END_ANIMATION)}.bind(this)});this._clip.play()};proto._createInteractionEvtForAnalytics=function(evt){if(!evt||!evt.interactionEvent){return evt}var originalEvent=clone(evt);var interactionEvent={type:originalEvent.interactionEvent.type,target:originalEvent.interactionEvent.target,srcElement:originalEvent.interactionEvent.srcElement};if(interactionEvent.type==="mouseup"){interactionEvent.type="touchend"}originalEvent.interactionEvent=interactionEvent;return originalEvent};proto._updateItems=function(items,silent){var incoming=items.incoming[0];var outgoing=this._lastIncomingItem||items.outgoing[0];var position=this._getClosestPositionForItem(incoming);var hasOutgoing=this.getItemIndex(outgoing)!==-1;var callback;if(hasOutgoing&&!silent){callback=this.trigger.bind(this,SlideGallery.UPDATE_COMPLETE,items)}if(this._updateItemsSnap){this._snapToPosition(position);if(callback){callback()}}else{this._slideToPosition(position,this._slideDuration,callback)}if(hasOutgoing){if(incoming!==outgoing){incoming.show();outgoing.hide()}}else{incoming.show();if(!silent){this.trigger(SlideGallery.UPDATE_COMPLETE,items)}}this._updateItemsSnap=false;this._lastIncomingItem=incoming};proto.showPrevious=function(options){var item=this.getPreviousItem();if(item){this.show(item)}return item};proto.showNext=function(options){var item=this.getNextItem();if(item){this.show(item)}return item};proto._setLastItem=function(item){this._lastItem=item};proto._setNextItem=function(item){this._nextItem=item};proto._setPreviousItem=function(item){this._previousItem=item};proto._createContainer=function(){this._containerEl=document.createDocumentFragment();var index=0;var length=this._items.length;for(index;index<length;index++){this._addItemToContainer(this._items[index])}var realContainerEl=document.createElement("div");realContainerEl.classList.add("ac-gallery-slidecontainer");setStyle(realContainerEl,{position:"absolute",left:"50%",top:"0",height:"100%"});realContainerEl.appendChild(this._containerEl);this._containerEl=realContainerEl;draw(this._appendContainer.bind(this))};proto._appendContainer=function(){if(this._containerEl){this._el.appendChild(this._containerEl)}};module.exports=WatchSlideGallery},{"./LazyImageLoader":459,"./helpers/getElementFullWidth":471,"@marcom/ac-clip":25,"@marcom/ac-dom-events/addEventListener":54,"@marcom/ac-dom-events/preventDefault":57,"@marcom/ac-dom-events/removeEventListener":58,"@marcom/ac-dom-events/target":62,"@marcom/ac-dom-styles/getStyle":89,"@marcom/ac-dom-styles/setStyle":91,"@marcom/ac-dom-traversal/ancestor":92,"@marcom/ac-feature/cssPropertyAvailable":138,"@marcom/ac-gallery":152,"@marcom/ac-object/clone":185,"@marcom/ac-raf-emitter/cancelDraw":219,"@marcom/ac-raf-emitter/draw":220}],464:[function(require,module,exports){"use strict";var GalleryItem=require("@marcom/ac-gallery").Item;var SlideGalleryItem=require("@marcom/ac-gallery").SlideGalleryItem;var cssPropertyAvailable=require("@marcom/ac-feature/cssPropertyAvailable");var threeDTransformsAvailable=require("@marcom/ac-feature/threeDTransformsAvailable");var prefixes=require("@marcom/ac-browser-prefixed");var getDataForElement=require("./helpers/getDataForElement");var galleryClock=require("./galleryClock");var getElementFullWidth=require("./helpers/getElementFullWidth");var SUPPORTS_TRANSFORM=cssPropertyAvailable("transform");var SUPPORTS_TRANSFORM_3D=threeDTransformsAvailable();var update=require("@marcom/ac-raf-emitter/update");function WatchSlideGalleryItem(el){GalleryItem.call(this,el);this._parentElement=el.parentElement;this.data=getDataForElement(el);this._position=0;this.offset=0;this.opacity=1;this._inViewport=true;this._firstDraw=true;this.rendered=true;this._el.setAttribute("aria-hidden","true");if(SUPPORTS_TRANSFORM_3D){this._el.style.willChange="transform"}this.updateMetrics();this._onUpdate=this._onUpdate.bind(this);galleryClock.on("update",this._onUpdate);this._onDraw=this._onDraw.bind(this);galleryClock.on("draw",this._onDraw)}var superProto=SlideGalleryItem.prototype;var proto=WatchSlideGalleryItem.prototype=Object.create(superProto);proto.constructor=WatchSlideGalleryItem;proto.show=function(){this._isShown=true;this._addCurrentClassToTriggers();this._setTabIndexOnFocusableItems(null);this.trigger(GalleryItem.SHOW,this)};proto.hide=function(){this._isShown=false;this._removeCurrentClassFromTriggers();this._setTabIndexOnFocusableItems("-1");this.trigger(GalleryItem.HIDE,this)};proto._onUpdate=function(evt){if(this._position===this._lastPosition&&this.width===this._lastWidth){return}this._inViewport=this._getInViewport()};proto._getInViewport=function(){if(!SUPPORTS_TRANSFORM){return true}var positionBuffer=this._viewportWidth/3;var minPosition=-this._viewportWidth/2-this.width-positionBuffer;var maxPosition=this._viewportWidth/2+positionBuffer;return this._position>=minPosition&&this._position<=maxPosition};proto._onVisibilityChanged=function(inViewport){this._el.style.visibility=inViewport?"inherit":"hidden"};proto._onDraw=function(evt){if(this._firstDraw){this._el.style.left="0";this._el.style.right="auto";this._el.style.position="absolute";this._firstDraw=false}if(this._inViewport!==this._lastInViewport){this._lastInViewport=this._inViewport;this._onVisibilityChanged(this._inViewport)}if(!this._inViewport){this.setRendered(false);return}if(this._position!==this._lastPosition||this.offset!==this._lastOffset||this.width!==this._lastWidth){this._lastPosition=this._position;this._lastOffset=this.offset;this._lastWidth=this.width;var position=this._position+this.offset+"px";this.setRendered(true);if(SUPPORTS_TRANSFORM){var transform="translateX("+position+")";if(this._shouldUseTranslateZ&&SUPPORTS_TRANSFORM_3D){transform+=" translateZ(0)"}this._el.style[prefixes.transform]=transform}else{this._el.style.left=position}}if(SUPPORTS_TRANSFORM){if(this.opacity!==this._lastOpacity){this._lastOpacity=this.opacity;this._el.style.opacity=this.opacity}}};proto.getLeft=function(){return this._position};proto.getRight=function(){return this._position+this.width};proto.isInViewport=function(){return!!this._inViewport};proto.updateMetrics=function(viewportWidth){update(this._updateMetrics.bind(this,viewportWidth))};proto._updateMetrics=function(viewportWidth){this._viewportWidth=viewportWidth||window.innerWidth;var wasRendered=this.rendered;this.setRendered(true);this.width=getElementFullWidth(this._el);if(!wasRendered){this.setRendered(false)}};proto.setRendered=function(bool){if(bool){if(this.rendered){return}this._el.style.display="";this.rendered=true;return}if(!this.rendered){return}this._el.style.display="none";this.rendered=false};proto.destroy=function(){galleryClock.off("update",this._onUpdate);galleryClock.off("draw",this._onDraw);superProto.destroy.call(this)};module.exports=WatchSlideGalleryItem},{"./galleryClock":465,"./helpers/getDataForElement":469,"./helpers/getElementFullWidth":471,"@marcom/ac-browser-prefixed":8,"@marcom/ac-feature/cssPropertyAvailable":138,"@marcom/ac-feature/threeDTransformsAvailable":142,"@marcom/ac-gallery":152,"@marcom/ac-raf-emitter/update":222}],465:[function(require,module,exports){"use strict";var Clock=require("@marcom/ac-clock").Clock;module.exports=new Clock},{"@marcom/ac-clock":27}],466:[function(require,module,exports){"use strict";var ViewportEmitter=require("@marcom/ac-viewport-emitter/ViewportEmitter");var galleryViewportEmitter;module.exports=function getGalleryViewportEmitter(){if(!galleryViewportEmitter){galleryViewportEmitter=new ViewportEmitter("gallery-viewport-emitter")}return galleryViewportEmitter}},{"@marcom/ac-viewport-emitter/ViewportEmitter":276}],467:[function(require,module,exports){"use strict";var ac_addEventListener=require("@marcom/ac-dom-events/addEventListener");module.exports=function addEventListenerToElements(els,eventName,handler){for(var i=0,il=els.length;i<il;i++){ac_addEventListener(els[i],eventName,handler)}}},{"@marcom/ac-dom-events/addEventListener":54}],468:[function(require,module,exports){"use strict";module.exports=function getCombinationName(size,caseId,bandId,faceId){return[].concat(size,caseId,bandId,faceId).join("_").replace(/-/g,"_")}},{}],469:[function(require,module,exports){"use strict";module.exports=function getDataForElement(element){var data={};data.id=element.getAttribute("data-id");data.name=element.getAttribute("aria-label");data.size=element.getAttribute("data-size");var cases=element.getAttribute("data-cases");var series=element.getAttribute("data-series");var casing=element.getAttribute("data-casing");var casingName=element.getAttribute("data-casing-name");var band=element.getAttribute("data-band");var bandName=element.getAttribute("data-band-name");var bandAvailable=element.getAttribute("data-band-available");var bandUnavailableCopy=element.getAttribute("data-band-unavailable-copy");var bandBackground=element.getAttribute("data-band-background");var hidden=element.getAttribute("data-hidden");if(series){data.series=series}if(casing){data.casing=casing}if(casingName){data.casingName=casingName}if(band){data.band=band}if(bandName){data.bandName=bandName}if(bandAvailable!=="false"){data.bandAvailable=true}else{data.bandAvailable=false}if(bandUnavailableCopy){data.bandUnavailableCopy=bandUnavailableCopy}if(bandBackground){data.bandBackground=bandBackground}if(hidden){data.hidden=hidden}if(cases){data.cases=cases.split(",")}var background=element.getAttribute("data-background");if(background){data.background=background.split(/,\s?/)}var attr=element.attributes;for(var i=0,il=attr.length;i<il;i++){if(attr[i].name.indexOf("data-sku-")===0){data.skus=data.skus||{};data.skus[attr[i].name.replace(/^data-sku-/,"")]=attr[i].value}else if(attr[i].name==="data-buy"){data.productUrl=attr[i].value}}return data}},{}],470:[function(require,module,exports){"use strict";module.exports=function getDefaultId(obj,propertiesToCheck){var value;propertiesToCheck=propertiesToCheck||[];propertiesToCheck.push("default");for(var i=0,il=propertiesToCheck.length;i<il;i++){if(obj[propertiesToCheck[i]]){value=obj[propertiesToCheck[i]];break}}if(Array.isArray(value)){value=value[Math.floor(Math.random()*value.length)]}return value}},{}],471:[function(require,module,exports){"use strict";var ac_getStyle=require("@marcom/ac-dom-styles/getStyle");module.exports=function getElementFullWidth(el){var styles=ac_getStyle(el,"margin-right","margin-left","width");var width=Math.round(el.offsetWidth)||Math.round(parseInt(styles.width,10));return width+parseInt(styles.marginRight,10)+parseInt(styles.marginLeft,10)}},{"@marcom/ac-dom-styles/getStyle":89}],472:[function(require,module,exports){"use strict";var ac_useragent=require("@marcom/ac-useragent");module.exports=function(){var screenWidth;if(ac_useragent.os.ios&&ac_useragent.os.version.major>=10){if(window.orientation%180===0){screenWidth=window.screen.width}else{screenWidth=window.screen.height}var innerWidth=document.documentElement.clientWidth;if(screenWidth!==innerWidth){return true}}return false}},{"@marcom/ac-useragent":272}],473:[function(require,module,exports){"use strict";module.exports=function setAttribute(el,name,value){if(Array.isArray(el)){Array.prototype.forEach.call(el,function(item){item.setAttribute(name,value)})}else{el.setAttribute(name,value)}}},{}],474:[function(require,module,exports){"use strict";var REGEX=/\{([^\}]*)\}/g;module.exports=function stringTemplate(str,context){context=context||{};return str.replace(REGEX,function(match,property){return context[property]||""})}},{}],475:[function(require,module,exports){module.exports={cases:{default:"silver-aluminum"},bands:{default:"white-sport","aluminum-space-gray":"black-sport","44/gold-aluminum-case":"midnight-blue-sport-band","40/gold-aluminum-case":"midnight-blue-sport-band","44/rose-gold-aluminum-case":"midnight-blue-sport-band","40/rose-gold-aluminum-case":"pink-sand-sport-band","space-black-stainless-steel-case":"black-sport-band","44/ceramic-case":"soft-white-sport-band","40/ceramic-case":"soft-white-sport-band"}}},{}]},{},[453]);